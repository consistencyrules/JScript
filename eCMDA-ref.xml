<?xml version="1.0" encoding="windows-1252"?>
<RefData version="1.0" exporter="EA.25">
	<DataSet name="Automation Scripts" table="t_script" filter="ScriptName='#ScriptName#' and ScriptCategory='#ScriptCategory#'" stoplist=";ScriptID;">
		<DataRow>
			<Column name="ScriptID" value="1"/>
			<Column name="ScriptCategory" value="3955A83E-9E54-4810-8053-FACC68CD4782"/>
			<Column name="ScriptName" value="{1D8F72EE-E7D8-4c38-B09B-5F18EDF79508}"/>
			<Column name="Notes" value="&lt;Group Type=&quot;NORMAL&quot; Notes=&quot;&quot;/&gt;&#xA;"/>
			<Column name="Script" value="eCMDA"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="2"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{1B00BEE9-D949-423a-AE5E-C33AEB5243B4}"/>
			<Column name="ScriptAuthor" value="{1D8F72EE-E7D8-4c38-B09B-5F18EDF79508}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;eCMDA&quot; Type=&quot;Internal&quot; Language=&quot;JScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="!INC Local Scripts.EAConstants-JScript&#xA;&#xA;/*&#xA; * Script Name: eCMDA&#xA; * Author: J. Niepostyn&#xA; * Purpose: Software architecture construction&#xA; * Date: 2025.06.20&#xA; */&#xA;	&#xA;function main()&#xA;{&#xA;	var thePackage as EA.Package;&#xA;	var newModelID = 0;&#xA;	var theParentPackage as EA.Package;	&#xA;	var theParentParentPackage as EA.Package;	&#xA;	var thePParentParentPackage as EA.Package;	&#xA;	var elements as EA.Collection;&#xA;&#xA;	// Get the currently selected package in the tree to work on&#xA;	thePackage = Repository.GetTreeSelectedPackage();&#xA;	elements = thePackage.Elements;&#xA;	// Show the script output window&#xA;	Repository.EnsureOutputVisible( &quot;Script&quot; );&#xA;	&#xA;	// The package was selected&#xA;	if ( thePackage != null &amp;&amp; thePackage.ParentID != 0 )&#xA;	{&#xA;		theParentPackage = Repository.GetPackageByID(thePackage.ParentID);&#xA;		if(theParentPackage.ParentID&gt;0)&#xA;			theParentParentPackage = Repository.GetPackageByID(theParentPackage.ParentID);&#xA;		else&#xA;			theParentParentPackage = null;&#xA;		if(theParentParentPackage!=null&amp;&amp;theParentParentPackage.ParentID&gt;0)&#xA;			thePParentParentPackage = Repository.GetPackageByID(theParentParentPackage.ParentID);&#xA;		else&#xA;			thePParentParentPackage = null;&#xA;		// the selected package is called &quot;Context Layer&quot; or &quot;Decomposition Processes&quot;&#xA;		if(thePackage.Name === &quot;Context Layer&quot; || thePackage.Name === &quot;Decomposition Processes&quot; || thePackage.Name === &quot;Business Use Cases&quot;||&#xA;			thePackage.Name === &quot;Business State&quot;||thePackage.Name === &quot;Business Class&quot;||&#xA;			theParentPackage.Name === &quot;Business Process Layer&quot;||theParentPackage.Name === &quot;System Use Case&quot;||&#xA;			theParentParentPackage!=null&amp;&amp;theParentParentPackage.Name === &quot;User Layer&quot;||theParentParentPackage!=null&amp;&amp;theParentParentPackage.Name === &quot;Internal Use Cases&quot;||&#xA;			thePParentParentPackage!=null&amp;&amp;thePParentParentPackage.Name === &quot;Sequence Layer&quot;)&#xA;		{&#xA;			// the selected package is not empty and it has only one diagram&#xA;			//if(elements.Count&gt;0 &amp;&amp; thePackage.Diagrams.Count==1) &#xA;			if(thePackage.Diagrams.Count==1) &#xA;			{&#xA;				Repository.EnableUIUpdates(false);&#xA;				//Repository.EnableUIUpdates(true);&#xA;				// Context diagram element verification&#xA;				var diagramObjects as EA.Collection;&#xA;				diagramObjects = thePackage.Diagrams.GetAt(0).DiagramObjects;&#xA;				var diagramObject as EA.DiagramObject;&#xA;				var testElement as EA.Element;&#xA;				Session.Output( &quot;Count of &quot; +thePackage.Diagrams.GetAt(0).Name+&quot; diagram objects:&quot; + diagramObjects.Count );&#xA;				// Navigate the elements collection of selected diagram&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;				{&#xA;					var diagramObjectOmitted = false;&#xA;					diagramObject = diagramObjects.GetAt(i);&#xA;					  &#xA;					var delements as EA.Collection;&#xA;					delements = thePackage.Elements;&#xA;					// Navigate the elements collection of selected package&#xA;					for ( var j = 0 ; j &lt; elements.Count ; j++ ) //elements can be placed inside the Activity Partition&#xA;					{&#xA;						var currentElement as EA.Element;&#xA;						currentElement = elements.GetAt( j );&#xA;						// The found element in the package is the selected diagram element&#xA;						if(currentElement.ElementID == diagramObject.ElementID) &#xA;						{&#xA;							diagramObjectOmitted = true;&#xA;							// Get value of the tag&#xA;							var stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,null); &#xA;							do {&#xA;								string4=stringLast;&#xA;								if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;									Session.Output( &quot;Element named '&quot; + currentElement.Name +&quot;' and type '&quot;+currentElement.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;									Session.Output( &quot;The index of the first occurence of ';' is: &quot; + string4.indexOf(&quot;;&quot;));&#xA;									do {&#xA;										var string5 = string4;&#xA;										if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;											string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;											string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;										} else&#xA;										string4=null;&#xA;										realizeConsistencyRule(string5,currentElement,thePackage); &#xA;									} while (string4!=null&amp;&amp;string4!=&quot;&quot;); &#xA;								} else&#xA;								if(currentElement.Name == null || currentElement.Name == &quot;&quot;) &#xA;								{&#xA;									var parentId = currentElement.ClassifierId; //ParentID;&#xA;									currentElement=Repository.GetElementByID(parentId);&#xA;									Session.Output( &quot;An instance of class ':&quot; + currentElement.Name +&quot;' has no Tag.&quot;);&#xA;								} else&#xA;									Session.Output( &quot;Element named '&quot; + currentElement.Name +&quot;' has no Tag.&quot;);&#xA;								if(currentElement.Type==&quot;Sequence&quot;) { //Lifeline&#xA;									var connector as EA.Connector;&#xA;									connector=null;&#xA;									for(i=0;i&lt;currentElement.Connectors.Count;i++) {&#xA;										var connector=currentElement.Connectors.GetAt(i);&#xA;										if(connector.Type==&quot;Sequence&quot;) { //message&#xA;											diagramObjectOmitted = true;&#xA;											// Get value of the tag&#xA;											var stringLast1 = getTagsValue(connector,&quot;Consistency rules&quot;,null); &#xA;											do {&#xA;												var string4=stringLast1;&#xA;												if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;													Session.Output( &quot;Element named '&quot; + connector.Name +&quot;' and type '&quot;+connector.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;													Session.Output( &quot;The index of the first occurence of ';' is: &quot; + string4.indexOf(&quot;;&quot;));&#xA;													do {&#xA;														var string5 = string4;&#xA;														if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;															string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;															string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;														} else&#xA;															string4=null;&#xA;														realizeConsistencyRule(string5,connector,thePackage); &#xA;													} while (string4!=null&amp;&amp;string4!=&quot;&quot;); // jedna regu&#322;a, to pomija t&#261; ostatni&#261;&#xA;												} else&#xA;													Session.Output( &quot;Element named '&quot; + connector.Name +&quot;' has no Tag.&quot;);&#xA;											} while(stringLast1!=null&amp;&amp;(stringLast1 = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast1))!=null);&#xA;										}&#xA;									}&#xA;								}&#xA;							} while(stringLast!=null&amp;&amp;(stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast))!=null);&#xA;							break;&#xA;					    } &#xA;						if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;							for(var k=0; k&lt;currentElement.Elements.Count(); k++) {&#xA;								var currentElement1 as EA.Element;&#xA;								currentElement1 = currentElement.Elements.GetAt( k );&#xA;								// The found element in the package is the selected diagram element&#xA;								if(currentElement1.ElementID == diagramObject.ElementID) &#xA;								{&#xA;									diagramObjectOmitted = true;&#xA;									// Get value of the tag&#xA;									var stringLast = getTagsValue(currentElement1,&quot;Consistency rules&quot;,null); &#xA;									do {&#xA;										var string4=stringLast;&#xA;										if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;											Session.Output( &quot;Element named '&quot; + currentElement1.Name +&quot;' and type '&quot;+currentElement1.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;											Session.Output( &quot;The index of the first occurence of ';' is: &quot; + string4.indexOf(&quot;;&quot;));&#xA;											//var co=string4.indexOf(&quot;;&quot;);&#xA;											do {&#xA;												//co=string4.indexOf(&quot;;&quot;);&#xA;												var string5 = string4;&#xA;												if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;													string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;													string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;												} else&#xA;												string4=null;&#xA;												realizeConsistencyRule(string5,currentElement1,thePackage); &#xA;											} while (string4!=null&amp;&amp;string4!=&quot;&quot;); // jedna regu&#322;a, to pomija t&#261; ostatni&#261;&#xA;										} else&#xA;										if(currentElement1.Name == null || currentElement1.Name == &quot;&quot;) &#xA;										{&#xA;											var parentId = currentElement1.ClassifierId; //ParentID;&#xA;											currentElement1=Repository.GetElementByID(parentId);&#xA;											Session.Output( &quot;An instance of class ':&quot; + currentElement1.Name +&quot;' has no Tag.&quot;);&#xA;										} else&#xA;											Session.Output( &quot;Element named '&quot; + currentElement1.Name +&quot;' has no Tag.&quot;);&#xA;									} while(stringLast!=null&amp;&amp;(stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast))!=null);&#xA;									break;&#xA;								} &#xA;								if(currentElement1.Type==&quot;ActivityPartition&quot;) {&#xA;									for(var l=0; l&lt;currentElement.Elements.Count(); l++) {&#xA;										var currentElement2 as EA.Element;&#xA;										currentElement2 = currentElement1.Elements.GetAt( l );&#xA;										// The found element in the package is the selected diagram element&#xA;										if(currentElement2.ElementID == diagramObject.ElementID) &#xA;										{&#xA;											diagramObjectOmitted = true;&#xA;											// Get value of the tag&#xA;											var stringLast = getTagsValue(currentElement2,&quot;Consistency rules&quot;,null); &#xA;											do {&#xA;												var string4=stringLast;&#xA;												if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;													Session.Output( &quot;Element named '&quot; + currentElement2.Name +&quot;' and type '&quot;+currentElement2.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;													Session.Output( &quot;The index of the first occurence of ';' is: &quot; + string4.indexOf(&quot;;&quot;));&#xA;													//var co=string4.indexOf(&quot;;&quot;);&#xA;													do {&#xA;														//co=string4.indexOf(&quot;;&quot;);&#xA;														var string5 = string4;&#xA;														if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;															string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;															string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;														} else&#xA;														string4=null;&#xA;														realizeConsistencyRule(string5,currentElement2,thePackage); &#xA;													} while (string4!=null&amp;&amp;string4!=&quot;&quot;); // jedna regu&#322;a, to pomija t&#261; ostatni&#261;&#xA;												} else&#xA;												if(currentElement2.Name == null || currentElement2.Name == &quot;&quot;) &#xA;												{&#xA;													var parentId = currentElement2.ClassifierId; //ParentID;&#xA;													currentElement2=Repository.GetElementByID(parentId);&#xA;													Session.Output( &quot;An instance of class ':&quot; + currentElement2.Name +&quot;' has no Tag.&quot;);&#xA;												} else&#xA;													Session.Output( &quot;Element named '&quot; + currentElement2.Name +&quot;' has no Tag.&quot;);&#xA;											} while(stringLast!=null&amp;&amp;(stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast))!=null);&#xA;											break;&#xA;										} 										&#xA;									}&#xA;								}&#xA;							}&#xA;						} &#xA;					}&#xA;					if(diagramObjectOmitted == false) { //elements outside the current package &#xA;						currentElement=Repository.GetElementByID(diagramObject.ElementID);&#xA;						if(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Class&quot;) {&#xA;							var stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,null); &#xA;							do {&#xA;								var string4 = stringLast;&#xA;								if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;									Session.Output( &quot;Element named '&quot; + currentElement.Name +&quot;' and type '&quot;+currentElement.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;									Session.Output( &quot;The index of the first occurence of ';' is: &quot; + string4.indexOf(&quot;;&quot;));&#xA;									do {&#xA;										var string5 = string4;&#xA;										if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;											string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;											string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;										} else&#xA;										string4=null;&#xA;										realizeConsistencyRule(string5,currentElement,thePackage); &#xA;									} while (string4!=null&amp;&amp;string4!=&quot;&quot;); &#xA;								} &#xA;							} while(stringLast!=null&amp;&amp;(stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast))!=null);&#xA;						}&#xA;					}&#xA;&#xA;				}&#xA;				Repository.EnableUIUpdates(true);&#xA;				Session.Output(&quot;Process complete&quot;);&#xA;			} else&#xA;				Session.Output( &quot;The package '&quot; +thePackage.Name+&quot;' does not include only one diagram or an element&quot; );		  &#xA;		} else&#xA;			Session.Output( &quot;Neither Package 'Context Layer' nor 'Decomposition Processes' nor 'Business Use Cases' has been selected&quot; );&#xA;	} else &#xA;		Session.Output( &quot;Nothing to do !&quot; );&#xA;}&#xA;//Create a package in thepackage with the nameOfPackage and kindOfPackage&#xA;function CreatePackage (thepackage,/*packages,*/nameOfPackage,kindOfPackage) &#xA;{&#xA;	//var thepackages as EA.Collection;&#xA;	var thepackage1 as EA.Collection;&#xA;	var subPackage as EA.Package;&#xA;	&#xA;	//thepackages = packages;&#xA;	thepackage1 = thepackage;&#xA;	subPackage = thepackage1.AddNew( nameOfPackage,kindOfPackage);&#xA;	subPackage.Update();&#xA;	Session.Output( &quot;Added new subpackage: '&quot; + subPackage.Name+&quot;' under parent package '&quot; + thepackage.Name + &quot;'&quot; );&#xA;	return subPackage;&#xA;}&#xA;//Create a diagram in the subpackage with the nameOfPackage and kindOfDiagram&#xA;function CreateDiagram(subpackage,nameOfPackage,kindOfDiagram)&#xA;{&#xA;	var subPackage as EA.Package;&#xA;&#xA;	subPackage = subpackage;&#xA;	testDiagram = subPackage.Diagrams.AddNew( nameOfPackage, kindOfDiagram );&#xA;	testDiagram.Update();&#xA;&#xA;	Session.Output( &quot;Added diagram '&quot; + testDiagram.Name + &quot;' to package &quot; + subPackage.Name );&#xA;	return testDiagram;&#xA;}&#xA;//Get the value of the tag named theName from theElement&#xA;function getTagsValue(theElement, theName, theValue)&#xA;{&#xA;	var tags as EA.Collection;&#xA;	tags = theElement.TaggedValues;&#xA;		&#xA;	var currentTag as EA.TaggedValue;&#xA;	currentTag = null;&#xA;	var occurence=false;&#xA;	&#xA;	// List all element tag&#xA;	for ( var i = 0 ; i &lt; tags.Count ; i++ )&#xA;	{&#xA;&#xA;		currentTag = tags.GetAt( i );&#xA;	&#xA;		if ( currentTag.Name == theName ) {&#xA;			if(theValue==null)&#xA;				return currentTag.Value;&#xA;			if(occurence)&#xA;				return currentTag.Value;&#xA;			if(!occurence&amp;&amp;theValue==currentTag.Value)&#xA;				occurence=true;&#xA;		}&#xA;	}&#xA;    return null;&#xA;}&#xA;//Constructing the target structure of elements based on the consistency rule&#xA;function realizeConsistencyRule(consistencyRule,currentElement,thePackage) {&#xA;var currentElement as EA.Element;&#xA;var thePackage as EA.Package;&#xA;var theParentPackage as EA.Package;&#xA;var thePParentPackage as EA.Package;&#xA;var thePPParentPackage as EA.Package;&#xA;var correctCR=null;&#xA;var parameters = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;var connectors = [ [null,null,null], [null,null],];&#xA;&#xA;	correctCR=verifyConsistencyRule(thePackage, consistencyRule, currentElement); //rule verification &#xA;	parameters=getArgumentsCR(correctCR, consistencyRule); // get arguments of Consistency rule &#xA;	if(correctCR != null) {&#xA;		switch(correctCR) {&#xA;			case &quot;ZpvYu&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				theParentPackage=Repository.GetPackageByID(theParentPackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;User Layer&quot;)&#xA;					break;		&#xA;				connectors = getConnectionA(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createZYcomplexYu(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;YuQlml&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				theParentPackage=Repository.GetPackageByID(theParentPackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;Internal Use Cases&quot;)&#xA;					break;		&#xA;				connectors = getConnectionB(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createYQcomplexQlml(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;QlmlMqyq&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				thePParentPackage=Repository.GetPackageByID(theParentPackage.ParentID);&#xA;				thePPParentPackage=Repository.GetPackageByID(thePParentPackage.ParentID);&#xA;				if(thePPParentPackage.Name!=&quot;Sequence Layer&quot;)&#xA;					break;		&#xA;				connectors = getConnectionQ(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createQMcomplexMqyq(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;CchZiv&quot;:&#xA;				if(thePackage.Name!=&quot;Business Class&quot;)&#xA;					break;&#xA;				connectors = getConnectionC(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createCZcomplexAvi(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;SrsZiv&quot;:&#xA;				if(thePackage.Name!=&quot;Business State&quot;)&#xA;					break;&#xA;				connectors = getConnectionS(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createSZcomplexZiv(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;UauZpv&quot;:&#xA;				connectors = getConnectionB(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createUZcomplexZpv(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;AivSrst&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;Business Process Layer&quot;)&#xA;					break;	&#xA;				connectors = getConnectionA(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createAScomplexSrst(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;AiviCczc&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;Business Process Layer&quot;)&#xA;					break;	&#xA;				connectors = getConnectionA(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createACcomplex(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;ApUau&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;Business Process Layer&quot;)&#xA;					break;		&#xA;				connectors = getConnectionA(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createAUcomplexUau(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;BauApvpv&quot;:&#xA;				if(thePackage.Name!=&quot;Business Use Cases&quot;)&#xA;					break;&#xA;				connectors = getConnectionB(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createBAcomplexApv(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;RiviAvivi&quot;:&#xA;				if(thePackage.Name!=&quot;Decomposition Processes&quot;)&#xA;					break;&#xA;				connectors = getConnectionR(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createRAcomplexAvi(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;RiviAvi&quot;:&#xA;				if(thePackage.Name!=&quot;Decomposition Processes&quot;)&#xA;					break;&#xA;				connectors = getConnectionR(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createRAcomplex(correctCR, thePackage, parameters, connectors,0);&#xA;				break;&#xA;			case &quot;BauApv&quot;:&#xA;				if(thePackage.Name!=&quot;Business Use Cases&quot;)&#xA;					break;&#xA;				connectors = getConnectionB(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createBAcomplex(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;RevBau&quot;:&#xA;			case &quot;ReviBaua&quot;:&#xA;			case &quot;RviBau&quot;:&#xA;			case &quot;RiviBaua&quot;:&#xA;				if(thePackage.Name!=&quot;Decomposition Processes&quot;)&#xA;					break;&#xA;				connectors = getConnectionR(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createRBcomplexBaua(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;XevBau&quot;:&#xA;			case &quot;XivBau&quot;:&#xA;			case &quot;XviBau&quot;:&#xA;				if(thePackage.Name!=&quot;Decomposition Processes&quot;)&#xA;					break;&#xA;				if(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Class&quot;)&#xA;					connectors = getConnectionX(thePackage, correctCR.substr(5), currentElement.Name, parameters[0][1], parameters[0][2]);&#xA;				else if(currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Class&quot;)&#xA;					if(parameters[0][0]!=null&amp;&amp;parameters[0][0]==&quot; &quot;&amp;&amp;parameters[1][0]!=null)&#xA;						connectors = getConnectionX(thePackage, correctCR.substr(5), parameters[1][0], currentElement.Name, parameters[0][2]);&#xA;					else&#xA;						connectors = getConnectionX(thePackage, correctCR.substr(5), parameters[0][0], currentElement.Name, parameters[0][2]);&#xA;				else if(currentElement.Type==&quot;Object&quot;) &#xA;					if(currentElement.Name!=&quot;&quot;)&#xA;						connectors = getConnectionX(thePackage, correctCR.substr(5), parameters[0][0], parameters[0][1], currentElement.Name);&#xA;					else if(currentElement.ClassifierID&gt;0)&#xA;						connectors = getConnectionX(thePackage, correctCR.substr(5), parameters[0][0], parameters[0][1], &quot;:&quot;+(Repository.GetElementByID(currentElement.ClassifierID).Name));&#xA;					else&#xA;						connectors = getConnectionX(thePackage, correctCR.substr(5), parameters[0][0], parameters[0][1], parameters[0][2]);&#xA;				createXBcomplex(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;XeRi&quot;:&#xA;			case &quot;XiRi&quot;:&#xA;			case &quot;XevRv&quot;:&#xA;			case &quot;XivRv&quot;:&#xA;			case &quot;XviRv&quot;:&#xA;				if(thePackage.Name!=&quot;Context Layer&quot;)&#xA;					break;&#xA;				createXRsimple(consistencyRule, correctCR, thePackage, parameters,currentElement);&#xA;				break;&#xA;			case &quot;XeviRevi&quot;:&#xA;			case &quot;XeviRivi&quot;:&#xA;			case &quot;XiviRivi&quot;:&#xA;				if(thePackage.Name!=&quot;Context Layer&quot;)&#xA;					break;&#xA;				connectors = getConnectionR(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); //the first element&#xA;				createXRcomplex(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			default:&#xA;				Session.Output( &quot;Consistency rule '&quot; + consistencyRule + &quot;' is correct '&quot;+correctCR+&quot;', changes will be implemented.&quot;);&#xA;		}&#xA;	} else {&#xA;		Session.Output( &quot;Consistency rule '&quot; + consistencyRule + &quot;' is not correct - nothing to do.&quot;);&#xA;		return;&#xA;	}&#xA;}&#xA;//Multiple calls to createRAcomplex depending on multi-value parameters&#xA;function createRAcomplexAvi(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var parameter11;&#xA;var parameter31;&#xA;var parameter12;&#xA;var parameter32;&#xA;	&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][0]=parameters[1][2*n];&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;			parameter1[1][0]=(n+1)+&quot;. Action&quot;;&#xA;		if(n==0) {&#xA;			parameter11=&quot;Start&quot;;&#xA;			parameter31=&quot;&quot;;&#xA;		} else {&#xA;			parameter11=parameters[1][2*n-1];&#xA;			parameter31=parameters[3][2*n-1];&#xA;		}&#xA;		parameter12=parameters[1][2*n+1];&#xA;		parameter32=parameters[3][2*n+1];&#xA;		do {&#xA;			if(parameter11.indexOf(&quot;,&quot;)&gt;0) {&#xA;				parameter1[1][1]=parameter11.substr(0,parameter11.indexOf(&quot;,&quot;));&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter11=parameter11.substr(parameter11.indexOf(&quot;,&quot;)+1);&#xA;				parameter1[3][1]=parameter31.substr(0,parameter31.indexOf(&quot;,&quot;));&#xA;				parameter31=parameter31.substr(parameter31.indexOf(&quot;,&quot;)+1);&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter11.length&gt;0)&#xA;					parameter11=parameter11+&quot;,&quot;;&#xA;				if(parameter31.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter31.length&gt;0)&#xA;					parameter31=parameter31+&quot;,&quot;;&#xA;			} else {&#xA;				parameter1[1][1]=parameter11;&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter1[3][1]=parameter31;&#xA;			}&#xA;			do {&#xA;				if(parameter12.indexOf(&quot;,&quot;)&gt;0) {&#xA;					parameter1[1][2]=parameter12.substr(0,parameter12.indexOf(&quot;,&quot;));&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter12=parameter12.substr(parameter12.indexOf(&quot;,&quot;)+1);&#xA;					parameter1[3][2]=parameter32.substr(0,parameter32.indexOf(&quot;,&quot;));&#xA;					parameter32=parameter32.substr(parameter32.indexOf(&quot;,&quot;)+1);&#xA;					if(parameter12.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.length&gt;0)&#xA;						parameter12=parameter12+&quot;,&quot;;&#xA;					if(parameter32.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter32.length&gt;0)&#xA;						parameter32=parameter32+&quot;,&quot;;&#xA;				} else {&#xA;					parameter1[1][2]=parameter12;&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter1[3][2]=parameter32;&#xA;				}&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.indexOf(&quot;,&quot;)&lt;0)&#xA;					createRAcomplex(correctCR, thePackage, parameter1, connectors,1);&#xA;				else&#xA;					createRAcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;			} while(parameter12.indexOf(&quot;,&quot;)&gt;0);	&#xA;		} while(parameter11.indexOf(&quot;,&quot;)&gt;0);&#xA;	} &#xA;}&#xA;//Multiple calls to createAUcomplex depending on multi-value parameters&#xA;function createAUcomplexUau(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=connectors[0].length-1; //how many use cases are there in the rule&#xA;&#xA;	parameter1[1][0]=connectors[0][0].Name;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][1]=connectors[0][n+1].Name;&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. Use Case&quot;;&#xA;		createAUcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;}&#xA;//Multiple calls to createBAcomplex depending on multi-value parameters&#xA;function createBAcomplexApv(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var tmpActors = [];&#xA;	&#xA;	tmpActors=getActorsofUseCase(null, connectors[0][1], 0);&#xA;	tmpActors.reverse();&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][0]=parameters[1][2*n]; //if the partition is empty&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;			if(tmpActors.length&gt;0)&#xA;				parameter1[1][0]=tmpActors.pop();&#xA;			else&#xA;				parameter1[1][0]=&quot;Actor&quot;+(n+1);&#xA;		parameter1[1][1]=parameters[1][2*n+1]; //if the action is empty&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. Action&quot;;&#xA;		createBAcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;}&#xA;//Multiple calls to createRAcomplex depending on multi-value parameters&#xA;function createRBcomplexBaua(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var parameter11;&#xA;var parameter13;&#xA;var tmpActorL = [];	&#xA;var tmpActorR = [];	&#xA;var iterationL=0;&#xA;var iterationR=0;&#xA;//RevBau, ReviBaua, RviBau, RiviBaua&#xA;	&#xA;	parameter11=parameters[1][0];&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1)==&quot;aua&quot;)&#xA;		parameter13=parameters[1][2];&#xA;	do {&#xA;		if(parameter11.indexOf(&quot;,&quot;)&gt;-1) {&#xA;			tmpActorL.push(parameter11.substr(0,parameter11.indexOf(&quot;,&quot;)));&#xA;			iterationL=iterationL+1;&#xA;			parameter11=parameter11.substr(parameter11.indexOf(&quot;,&quot;)+1);&#xA;		}&#xA;		else {&#xA;			tmpActorL.push(parameter11);&#xA;			iterationL=iterationL+1;&#xA;			parameter11=&quot;&quot;;&#xA;		}&#xA;	} while(parameter11!=&quot;&quot;);&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1)==&quot;aua&quot;) {&#xA;		do {&#xA;			if(parameter13.indexOf(&quot;,&quot;)&gt;-1) {&#xA;				tmpActorR.push(parameter13.substr(0,parameter13.indexOf(&quot;,&quot;)));&#xA;				iterationR=iterationR+1;&#xA;				parameter13=parameter13.substr(parameter13.indexOf(&quot;,&quot;)+1);&#xA;			}&#xA;			else {&#xA;				tmpActorR.push(parameter13);&#xA;				iterationR=iterationR+1;&#xA;				parameter13=&quot;&quot;;&#xA;			}&#xA;		} while(parameter13!=&quot;&quot;);&#xA;	}&#xA;	if(iterationR==0)&#xA;		iterationR=1;&#xA;	if(iterationL==0)&#xA;		iterationL=1;&#xA;	parameter1[0]=parameters[0];&#xA;	parameter1[2]=parameters[2];	&#xA;	parameter1[3]=parameters[3];&#xA;	for(var m=0; m&lt;iterationL; m++) {&#xA;		parameter1[1][0]=tmpActorL[m];&#xA;		parameter1[1][1]=parameters[1][1];&#xA;		for(var n=0; n&lt;iterationR; n++) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1)==&quot;aua&quot;) &#xA;				parameter1[1][2]=tmpActorR[n];	&#xA;			else&#xA;				parameter1[1][2]=&quot; &quot;;	&#xA;			createRBcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;		}&#xA;	} &#xA;}&#xA;//Verification of the full consistency rule and return of the recognized shortcut&#xA;function verifyConsistencyRule(thePackage, consistencyRule, currentElement) {&#xA;	var stringCR=consistencyRule;&#xA;	var theParentPackage as EA.Package;&#xA;	var theParentParentPackage as EA.Package;&#xA;	var thePParentParentPackage as EA.Package;	&#xA;	&#xA;	theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;	if(theParentPackage.ParentID&gt;0)&#xA;		theParentParentPackage=Repository.GetPackageByID(theParentPackage.ParentID);&#xA;	else&#xA;		theParentParentPackage = null;&#xA;	if(theParentParentPackage!=null&amp;&amp;theParentParentPackage.ParentID&gt;0)&#xA;		thePParentParentPackage=Repository.GetPackageByID(theParentParentPackage.ParentID);&#xA;	else&#xA;		thePParentParentPackage = null;&#xA;	while (stringCR.indexOf(&quot;(&quot;)&gt;0)&#xA;    {&#xA;		var i= stringCR.indexOf(&quot;(&quot;);&#xA;		var string2=stringCR.substr(i);&#xA;		var j = string2.indexOf(&quot;)&quot;);&#xA;		if(j&lt;0)&#xA;			return null;&#xA;		var string1=stringCR.substr(0,i)+stringCR.substr(j+i+1);&#xA;		stringCR=string1;&#xA;    }&#xA;	if(thePackage.Name===&quot;Context Layer&quot;) {&#xA;		if(stringCR==&quot;XeRi&quot;&amp;&amp;currentElement.Type==&quot;Event&quot; || stringCR== &quot;XeRi«information»&quot;&amp;&amp;currentElement.Type==&quot;Event&quot;)&#xA;			return &quot;XeRi&quot;;&#xA;		else if((stringCR==&quot;XevRv&quot;||stringCR== &quot;XevRv«subprocess»&quot;||stringCR== &quot;Xev«process»Rv&quot;||stringCR== &quot;Xev«process»Rv«subprocess»&quot;)&amp;&amp;(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;) )&#xA;			return &quot;XevRv&quot;;&#xA;		else if((stringCR==&quot;XiRi&quot;||stringCR== &quot;Xi«product»Ri&quot;||stringCR== &quot;XiRi«subproduct»&quot;||stringCR== &quot;Xi«product»Ri«subproduct»&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Class&quot;))&#xA;			return &quot;XiRi&quot;; //tutaj zako&#324;czy&#322;em wariancje&#xA;		else if(stringCR==&quot;XivRv&quot;&amp;&amp;(currentElement.Type==&quot;Class&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;) || stringCR== &quot;Xi«rules»v«process»Rv«subprocess»&quot;&amp;&amp;(currentElement.Type==&quot;Class&quot;||currentElement.Type==&quot;Activity&quot;) )&#xA;			return &quot;XivRv&quot;;&#xA;		else if(stringCR==&quot;XviRv&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;) || stringCR==&quot;Xv«process»i«product»Rv«subprocess»&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;) )&#xA;			return &quot;XviRv&quot;;&#xA;		else if(stringCR==&quot;XiviRivi&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Class&quot;) || stringCR==&quot;Xi«product»v«process»i«product»Ri«product»v«subprocess»i«product»&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Class&quot;) )&#xA;			return &quot;XiviRivi&quot;;&#xA;		else if((stringCR==&quot;XeviRevi&quot;||  //tu juz zrobione&#xA;				 stringCR==&quot;Xev«process»iRevi&quot;||stringCR==&quot;Xevi«product»Revi&quot;||stringCR==&quot;XeviRev«subprocess»i&quot;||stringCR==&quot;XeviRevi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Revi&quot;||stringCR==&quot;XeviRev«subprocess»i«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»iRev«subprocess»i&quot;||stringCR==&quot;Xev«process»iRevi«product»&quot;||&#xA;				 stringCR==&quot;Xevi«product»Rev«subprocess»i&quot;||stringCR==&quot;Xevi«product»Revi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Rev«subprocess»i&quot;||stringCR==&quot;Xev«process»i«product»Revi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»iRev«subprocess»i«product»&quot;||stringCR==&quot;Xevi«product»Rev«subprocess»i«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Rev«subprocess»i«product»&quot;)&amp;&amp;&#xA;				 (currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;) )&#xA;			return &quot;XeviRevi&quot;;&#xA;		else if((stringCR==&quot;XeviRivi&quot;||&#xA;				 stringCR==&quot;Xev«process»iRivi&quot;||stringCR==&quot;Xevi«product»Rivi&quot;||stringCR==&quot;XeviRiv«subprocess»i&quot;||stringCR==&quot;XeviRivi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Rivi&quot;||stringCR==&quot;XeviRiv«subprocess»i«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»iRiv«subprocess»i&quot;||stringCR==&quot;Xev«process»iRivi«product»&quot;||&#xA;				 stringCR==&quot;Xevi«product»Riv«subprocess»i&quot;||stringCR==&quot;Xevi«product»Rivi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Riv«subprocess»i&quot;||stringCR==&quot;Xev«process»i«product»Rivi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»iRiv«subprocess»i«product»&quot;||stringCR==&quot;Xevi«product»Riv«subprocess»i«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Riv«subprocess»i«product»&quot;)&amp;&amp;&#xA;				 (currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;) )&#xA;			return &quot;XeviRivi&quot;;&#xA;		else if(stringCR==&quot;XevBau&quot;&amp;&amp;(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;XevBau&quot;;	&#xA;		else if(stringCR==&quot;XviBau&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;XviBau&quot;;&#xA;		else if(stringCR==&quot;XivBau&quot;&amp;&amp;(currentElement.Type==&quot;Class&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;XivBau&quot;;&#xA;	} else&#xA;	if(thePackage.Name===&quot;Decomposition Processes&quot;) {&#xA;		if((stringCR==&quot;RevBau&quot;||stringCR== &quot;Rev«subprocess»Bau&quot;)&amp;&amp;(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RevBau&quot;;&#xA;		else if((stringCR==&quot;ReviBaua&quot;||stringCR== &quot;Rev«subprocess»iBaua&quot;||stringCR== &quot;Revi«product»Baua&quot;||stringCR== &quot;Rev«subprocess»i«product»Baua&quot;)&amp;&amp;(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;))&#xA;			return &quot;ReviBaua&quot;;&#xA;		else if((stringCR==&quot;RviBau&quot;||stringCR== &quot;Rv«subprocess»i«product»Bau&quot;||stringCR== &quot;Rvi«product»Bau&quot;||stringCR== &quot;Rv«subprocess»iBau&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RviBau&quot;;&#xA;		else if((stringCR==&quot;RiviBaua&quot;|| stringCR== &quot;Riv«subprocess»iBau&quot;||stringCR== &quot;Riv«subprocess»i«product»Bau&quot;||stringCR== &quot;Ri«product»v«subprocess»i«product»Bau&quot;||stringCR== &quot;Ri«product»v«subprocess»iBau&quot;||&#xA;			                       stringCR== &quot;Rivi«product»Bau&quot;||stringCR== &quot;Ri«product»vi«product»Bau&quot;||stringCR== &quot;Ri«product»viBau&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RiviBaua&quot;;&#xA;		else if((stringCR==&quot;RiviAvi&quot;|| stringCR== &quot;Riv«subprocess»iAvi&quot;||stringCR== &quot;Riv«subprocess»i«product»Avi&quot;||stringCR== &quot;Ri«product»v«subprocess»i«product»Avi&quot;||stringCR== &quot;Ri«product»v«subprocess»iAvi&quot;||&#xA;			                       stringCR== &quot;Rivi«product»Avi&quot;||stringCR== &quot;Ri«product»vi«product»Avi&quot;||stringCR== &quot;Ri«product»viAvi&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RiviAvi&quot;;&#xA;		else if((stringCR==&quot;RiviAvivi&quot;||stringCR==&quot;RiviAvivivi&quot;||stringCR==&quot;RiviAvivivivi&quot;||stringCR==&quot;RiviAvivivivivi&quot;||stringCR==&quot;RiviAvivivivivivi&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RiviAvivi&quot;;&#xA;	} else	&#xA;	if(thePackage.Name===&quot;Business Use Cases&quot;) {&#xA;		if((stringCR==&quot;BauApv&quot;)&amp;&amp;(currentElement.Type==&quot;Actor&quot;||currentElement.Type==&quot;UseCase&quot;))&#xA;			return &quot;BauApv&quot;;&#xA;		else if((stringCR==&quot;BauApvpv&quot;||stringCR==&quot;BauApvpvpv&quot;||stringCR==&quot;BauApvpvpvpv&quot;||stringCR==&quot;BauApvpvpvpvpv&quot;||stringCR==&quot;BauApvpvpvpvpvpv&quot;)&amp;&amp;(currentElement.Type==&quot;Actor&quot;||currentElement.Type==&quot;UseCase&quot;))&#xA;			return &quot;BauApvpv&quot;;&#xA;	} else&#xA;	if(theParentPackage.Name===&quot;Business Process Layer&quot;) {&#xA;		if((stringCR==&quot;ApUau&quot;)&amp;&amp;(currentElement.Type==&quot;ActivityPartition&quot;))&#xA;			return &quot;ApUau&quot;;&#xA;		else if((stringCR==&quot;AiviCczc&quot;)&amp;&amp;(currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;))&#xA;			return &quot;AiviCczc&quot;;		&#xA;		else if((stringCR==&quot;AivSrst&quot;)&amp;&amp;(currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;))&#xA;			return &quot;AivSrst&quot;;&#xA;	} else&#xA;	if(theParentPackage.Name===&quot;System Use Case&quot;) {&#xA;		if((stringCR==&quot;UauZpv&quot;||stringCR==&quot;UauZpvpv&quot;||stringCR==&quot;UauZpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpvpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpvpvpvpvpv&quot;)&amp;&amp;(currentElement.Type==&quot;UseCase&quot;||currentElement.Type==&quot;Actor&quot;))&#xA;			return &quot;UauZpv&quot;;&#xA;	} else&#xA;	if(thePackage.Name===&quot;Business Class&quot;) {&#xA;		if((stringCR==&quot;CchZiv&quot;||stringCR==&quot;CchZivi&quot;||stringCR==&quot;CchZivivi&quot;||stringCR==&quot;CchZivivivi&quot;||stringCR==&quot;CchZivivivivi&quot;||stringCR==&quot;CchZivivivivivi&quot;||stringCR==&quot;CchZivivivivivivi&quot;)&amp;&amp;(currentElement.Type==&quot;Class&quot;||currentElement.Type==&quot;Association&quot;))&#xA;			return &quot;CchZiv&quot;;&#xA;	} else	&#xA;	if(thePackage.Name===&quot;Business State&quot;) {&#xA;		if((stringCR==&quot;SrsZiv&quot;||stringCR==&quot;SrsZivi&quot;||stringCR==&quot;SrsZivivi&quot;||stringCR==&quot;SrsZivivivi&quot;||stringCR==&quot;SrsZivivivivi&quot;||stringCR==&quot;SrsZivivivivivi&quot;||stringCR==&quot;SrsZivivivivivivi&quot;)&amp;&amp;(currentElement.Type==&quot;Region&quot;||currentElement.Type==&quot;State&quot;||currentElement.Type==&quot;StateMachine&quot;))&#xA;			return &quot;SrsZiv&quot;;&#xA;	} else	&#xA;	if(theParentParentPackage!=null&amp;&amp;theParentParentPackage.Name===&quot;User Layer&quot;) {&#xA;		if((stringCR==&quot;ZpvYu&quot;)&amp;&amp;currentElement.Type==&quot;ActivityPartition&quot;)&#xA;			return &quot;ZpvYu&quot;;&#xA;	} else&#xA;	if(theParentParentPackage!=null&amp;&amp;theParentParentPackage.Name===&quot;Internal Use Cases&quot;) {&#xA;		if((stringCR==&quot;YuQlm&quot;||stringCR==&quot;YuQlml&quot;||stringCR==&quot;YuQlmlml&quot;||stringCR==&quot;YuQlmlmlml&quot;||stringCR==&quot;YuQlmlmlml&quot;||stringCR==&quot;YuQlmlmlmlml&quot;)&amp;&amp;(currentElement.Type==&quot;UseCase&quot;||currentElement.Type==&quot;Actor&quot;))&#xA;			return &quot;YuQlml&quot;;&#xA;	} else&#xA;	if(thePParentParentPackage!=null&amp;&amp;thePParentParentPackage.Name===&quot;Sequence Layer&quot;) {&#xA;	if(stringCR==&quot;QlmlMqyq&quot;&amp;&amp;(currentElement.Type==&quot;Lifeline&quot;||currentElement.Type==&quot;Sequence&quot;))&#xA;		return &quot;QlmlMqyq&quot;;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Return of rule parameters, and in case of repeating rules, return of extended parameters in index 1 and possibly 3&#xA;function getArgumentsCR(correctCR, consistencyRule)&#xA;{&#xA;	var string0 = consistencyRule;&#xA;	var inParameters = [ null,null];&#xA;	var diagram=0;&#xA;	var parameters = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	//[0]-the first diagram's parameters,[1]-the second diagram's parameters,[2]-the first diagram's states,[3]-the second diagram's states.&#xA;&#xA;	//RiviAvivi, BauApvpv&#xA;	if(correctCR==consistencyRule)&#xA;		return parameters;&#xA;	if(string0.charAt(0)&lt;'A' &amp;&amp; string0.charAt(0)&gt;'Z')&#xA;		return parameters;&#xA;	string0=string0.substring(1);&#xA;	var index=0;&#xA;	while((string0.charAt(0)&lt;'A' || string0.charAt(0)&gt;'Z')&amp;&amp;index&lt;3) {&#xA;		if(string0.charAt(1)=='('||string0.charAt(1)=='«'&amp;&amp;   //i(,e(,v(&#xA;			(string0.charAt(0)=='i'&amp;&amp;string0.charAt(10)=='('|| //i«product»(&#xA;			 string0.charAt(0)=='v'&amp;&amp;string0.charAt(10)=='('|| //v«process»(&#xA;			 string0.charAt(0)=='i'&amp;&amp;string0.charAt(8)=='(')) //i«rules»(&#xA;		{  //there is argument for the next parameter&#xA;			string0=string0.substr(string0.indexOf(&quot;(&quot;));&#xA;			inParameters = [ null,null];&#xA;			inParameters=getInArgument(string0.substr(1,string0.indexOf(&quot;)&quot;)-1), parameters[diagram][index], parameters[diagram+2][index]);&#xA;			parameters[diagram][index]=inParameters[0];&#xA;			parameters[diagram+2][index]=inParameters[1];&#xA;			string0=string0.substr(string0.indexOf(&quot;)&quot;)+1);&#xA;		} else {&#xA;			//there is no argument for the first parameter&#xA;			if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(9)=='»') //i«product»,v«process»&#xA;				string0=string0.substr(10);&#xA;			else if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(7)=='»') //i«rules»(&#xA;				string0=string0.substr(8);&#xA;			else&#xA;				string0=string0.substr(1); //to the second letter&#xA;		}&#xA;		index=index+1;&#xA;	}&#xA;	if(string0.charAt(0)&lt;'A' || string0.charAt(0)&gt;'Z') {&#xA;		Session.Output(&quot;Interruption of parameter processing at: '&quot;+string0+&quot;'&quot;);&#xA;		return parameters;&#xA;	}&#xA;	else {&#xA;		string0=string0.substr(1); // the second diagram&#xA;		diagram=1;&#xA;	}	&#xA;	//parameters of the second diagram&#xA;	index=0;&#xA;	while(string0!=&quot;&quot;&amp;&amp;string0!=&quot; &quot;) {&#xA;		if(string0.charAt(1)=='('||string0.charAt(1)=='«'&amp;&amp;&#xA;			(string0.charAt(0)=='i'&amp;&amp;string0.charAt(13)=='('|| //i«subproduct»(&#xA;			 string0.charAt(0)=='v'&amp;&amp;string0.charAt(13)=='('|| //v«subprocess»(&#xA;			 string0.charAt(0)=='i'&amp;&amp;string0.charAt(14)=='('|| //i«information»(&#xA;			 string0.charAt(0)=='i'&amp;&amp;string0.charAt(10)=='(')) //i«product»(&#xA;		{  //there is argument for the first parameter&#xA;			string0=string0.substr(string0.indexOf(&quot;(&quot;));&#xA;			inParameters = [ null,null];&#xA;			inParameters=getInArgument(string0.substr(1,string0.indexOf(&quot;)&quot;)-1), parameters[diagram][index], parameters[diagram+2][index]);&#xA;			parameters[diagram][index]=inParameters[0];&#xA;			parameters[diagram+2][index]=inParameters[1];&#xA;			string0=string0.substr(string0.indexOf(&quot;)&quot;)+1);&#xA;		} else &#xA;		if(string0.charAt(0)=='(') {&#xA;			if(string0.indexOf(')')&lt;0)&#xA;				return parameters;&#xA;			parameters.push(string0.substr(1,string0.indexOf(')')-1));&#xA;			index=index-1;&#xA;			string0=string0.substr(string0.indexOf(')')+1);&#xA;		} else {&#xA;			//there is no argument for the first parameter&#xA;			if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(12)=='»') //i«subproduct»,v«subprocess»&#xA;				string0=string0.substr(13);&#xA;			else if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(13)=='»') //i«information»(&#xA;				string0=string0.substr(14);&#xA;			else if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(9)=='»') //i«product»(&#xA;				string0=string0.substr(10);&#xA;			else&#xA;				string0=string0.substr(1);&#xA;			if(index&gt;=3) //RiviAvivi, BauApvpv&#xA;				parameters[diagram][index]=&quot; &quot;;				&#xA;		}&#xA;		index=index+1;&#xA;	}&#xA;	return parameters;&#xA;}&#xA;//Returns the next string for processing and a list of identified states&#xA;function getInArgument(string1, parameter0, parameter2) {&#xA;	var inParameters = [ null,null];&#xA;	var string2;&#xA;	var parA = &quot;&quot;;&#xA;	var parB = &quot;&quot;;&#xA;	&#xA;	if(string1.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;string1.indexOf(&quot;]&quot;)&gt;string1.indexOf(&quot;[&quot;))&#xA;	{&#xA;		string2=string1.substr(string1.indexOf(&quot;[&quot;)+1,string1.indexOf(&quot;]&quot;)-string1.indexOf(&quot;[&quot;)-1);&#xA;		if(string2!=&quot;&quot;) {&#xA;			do {&#xA;				parB = parB +string2; //state&#xA;				parA = parA +string1.substr(0,string1.indexOf(&quot;[&quot;));&#xA;				string1=string1.substr(string1.indexOf(&quot;]&quot;)+1);&#xA;				if(string1.indexOf(&quot;,&quot;)&gt;-1) {&#xA;					parA = parA +string1.substr(0,string1.indexOf(&quot;,&quot;)+1);&#xA;					string1=string1.substr(string1.indexOf(&quot;,&quot;)+1);&#xA;					if(string1.indexOf(&quot;,&quot;)&lt;0&amp;&amp;string1.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;string1.indexOf(&quot;]&quot;)&gt;string1.indexOf(&quot;[&quot;)) {&#xA;						parB = parB + &quot;,&quot;;&#xA;						string2=string1.substr(string1.indexOf(&quot;[&quot;)+1,string1.indexOf(&quot;]&quot;)-string1.indexOf(&quot;[&quot;)-1);&#xA;					} else &#xA;					if(string1.indexOf(&quot;,&quot;)&gt;=0&amp;&amp;string1.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;string1.indexOf(&quot;]&quot;)&gt;string1.indexOf(&quot;[&quot;)&amp;&amp;string1.indexOf(&quot;[&quot;)&lt;string1.indexOf(&quot;,&quot;)) {&#xA;						parB = parB + &quot;,&quot;;&#xA;						string2=string1.substr(string1.indexOf(&quot;[&quot;)+1,string1.indexOf(&quot;]&quot;)-string1.indexOf(&quot;[&quot;)-1);&#xA;					} else &#xA;					if(string1.indexOf(&quot;,&quot;)&gt;=0&amp;&amp;string1.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;string1.indexOf(&quot;]&quot;)&gt;string1.indexOf(&quot;[&quot;)&amp;&amp;string1.indexOf(&quot;[&quot;)&gt;string1.indexOf(&quot;,&quot;)) {&#xA;						parB = parB + &quot;,&quot;;&#xA;						string2=&quot;&quot;;&#xA;					} else &#xA;					if(string1.indexOf(&quot;,&quot;)&lt;0&amp;&amp;string1.indexOf(&quot;[&quot;)&lt;0) {&#xA;						parA = parA +string1;&#xA;						string2=null;&#xA;					}&#xA;				} else {&#xA;					parA = parA +string1;&#xA;					string2=null;&#xA;				}&#xA;			} while (string2!=null);&#xA;		} else&#xA;			parA = string1;&#xA;	} else&#xA;		parA = string1;&#xA;	inParameters[0] = parA;&#xA;	inParameters[1] = parB; 	&#xA;	return inParameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the context diagram&#xA;function getConnectionX(thePackage, type, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//Checking whether the elements from the X diagram, &#xA;	//indicated by the new elements from the R diagram, &#xA;	//are connected to each other&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var otherElements = [];&#xA;	var delements as EA.Collection;&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	delements = thePackage.Elements;&#xA;	//Finding elements in the X diagram&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;	    var coto as EA.Element;&#xA;		coto=null;&#xA;	    var testElement as EA.Element;&#xA;	    testElement = delements.GetAt( j );&#xA;		if(testElement.ClassfierID!=null&amp;&amp;testElement.ClassfierID&gt;0)&#xA;			coto=Repository.GetElementByID(testElement.ClassfierID);&#xA;		if(theElement1==null &amp;&amp; //gdy nazwa zdarzenia ze strony R lub pierwsze znalezione&#xA;			(nameElement1!=&quot; &quot;&amp;&amp; nameElement1!=&quot;&quot; &amp;&amp; (testElement.Name == nameElement1 || nameElement1.substr(0,1)==&quot;:&quot; &amp;&amp; coto!=null&amp;&amp;coto.Name==nameElement1.substr(1))||&#xA;		    (nameElement1==&quot; &quot;||nameElement1==&quot;&quot;) &amp;&amp; type.substr(0,1)==&quot;e&quot; &amp;&amp; (testElement.Type == &quot;Event&quot;)||&#xA;		    (nameElement1==&quot; &quot;||nameElement1==&quot;&quot;) &amp;&amp; type.substr(0,1)==&quot;i&quot; &amp;&amp; (testElement.Type == &quot;Object&quot;)||&#xA;		    (nameElement1==&quot; &quot;||nameElement1==&quot;&quot;) &amp;&amp; type.substr(0,1)==&quot;i&quot; &amp;&amp; (testElement.Type == &quot;Class&quot;)))&#xA;			theElement1 = testElement;&#xA;		else &#xA;		if(theElement2==null &amp;&amp; //tu zawsze powinien by&#263; jeden proces&#xA;			(nameElement2!=&quot; &quot;&amp;&amp; nameElement2!=&quot;&quot; &amp;&amp; (testElement.Name == nameElement2 || nameElement2.substr(0,1)==&quot;:&quot; &amp;&amp; coto!=null&amp;&amp;coto.Name==nameElement2.substr(1))||&#xA;		    (nameElement2==&quot; &quot;||nameElement2==&quot;&quot;) &amp;&amp; type.substr(1,1)==&quot;e&quot; &amp;&amp; (testElement.Type == &quot;Event&quot;)||&#xA;		    (nameElement2==&quot; &quot;||nameElement2==&quot;&quot;) &amp;&amp; type.substr(1,1)==&quot;i&quot; &amp;&amp; (testElement.Type == &quot;Object&quot;)||&#xA;		    (nameElement2==&quot; &quot;||nameElement2==&quot;&quot;) &amp;&amp; type.substr(1,1)==&quot;v&quot; &amp;&amp; (testElement.Type == &quot;Activity&quot;)))&#xA;			theElement2 = testElement;&#xA;		else &#xA;		if(theElement3==null &amp;&amp; //gdy nazwa na obiekcie po stronie R&#xA;			(nameElement3!=&quot; &quot;&amp;&amp; nameElement3!=&quot;&quot; &amp;&amp; (testElement.Name == nameElement3 || nameElement3.substr(0,1)==&quot;:&quot; &amp;&amp; coto!=null&amp;&amp;coto.Name==nameElement3.substr(1))||&#xA;		    (nameElement3==&quot; &quot;||nameElement3==&quot;&quot;) &amp;&amp; type.substr(2,1)==&quot;e&quot; &amp;&amp; (testElement.Type == &quot;Event&quot;)||&#xA;		    (nameElement3==&quot; &quot;||nameElement3==&quot;&quot;) &amp;&amp; type.substr(2,1)==&quot;i&quot; &amp;&amp; (testElement.Type == &quot;Object&quot;)||&#xA;		    (nameElement3==&quot; &quot;||nameElement3==&quot;&quot;) &amp;&amp; type.substr(2,1)==&quot;i&quot; &amp;&amp; (testElement.Type == &quot;Class&quot;)))&#xA;			theElement3 = testElement;&#xA;		else&#xA;			otherElements.push(testElement);&#xA;		//if(theElement1!=null &amp;&amp; theElement2!=null &amp;&amp; theElement3!=null)&#xA;			//break;&#xA;	}&#xA;	parameters[0][0]=theElement1;&#xA;	parameters[0][1]=theElement2;&#xA;	parameters[0][2]=theElement3;&#xA;	if(theElement2==null || theElement1==null &amp;&amp; theElement3==null)&#xA;		return parameters;&#xA;	var theConnector as EA.Connector;&#xA;	var diagramObjects as EA.Collection;&#xA;	var diagramObject as EA.DiagramObject;	&#xA;	var diagramObject1 as EA.DiagramObject;	&#xA;	var diagramObject2 as EA.DiagramObject;	&#xA;	var diagramObject3 as EA.DiagramObject;	&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	diagramObjects = thePackage.Diagrams.GetAt(0).DiagramObjects;&#xA;	for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;	{&#xA;	    diagramObject = diagramObjects.GetAt(i);&#xA;		if(theElement1!=null&amp;&amp;theElement1.ElementID == diagramObject.ElementID) &#xA;			diagramObject1=diagramObject;&#xA;		else if(theElement2!=null&amp;&amp;theElement2.ElementID == diagramObject.ElementID)&#xA;			diagramObject2=diagramObject;&#xA;		else if(theElement3!=null&amp;&amp;theElement3.ElementID == diagramObject.ElementID)&#xA;			diagramObject3=diagramObject;&#xA;		else {&#xA;			//here it can be that theElementx==null, and it need to match element with diagramObject&#xA;			var foundElement as EA.Element;&#xA;			foundElement=null;&#xA;			for ( var j = 0 ; j &lt; otherElements.length ; j++ ) {&#xA;				if(otherElements[j].ElementID==diagramObject.ElementID) {&#xA;					foundElement=otherElements[j];&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(foundElement!=null) {&#xA;				if(type.substr(0,1)==&quot;e&quot;&amp;&amp;foundElement.Type==&quot;Event&quot;&amp;&amp;theElement1==null&amp;&amp;diagramObject1==null) {&#xA;					diagramObject1=diagramObject;&#xA;					theElement1=foundElement;&#xA;					parameters[0][0]=theElement1;&#xA;				} else &#xA;				if(type.substr(0,1)==&quot;i&quot;&amp;&amp;foundElement.Type==&quot;Object&quot;&amp;&amp;theElement1==null&amp;&amp;diagramObject1==null) {&#xA;					diagramObject1=diagramObject;&#xA;					theElement1=foundElement;&#xA;					parameters[0][0]=theElement1;&#xA;				} else &#xA;				if(type.substr(1,1)==&quot;e&quot;&amp;&amp;foundElement.Type==&quot;Event&quot;&amp;&amp;theElement2==null&amp;&amp;diagramObject2==null) {&#xA;					diagramObject1=diagramObject;&#xA;					theElement1=foundElement;&#xA;					parameters[0][0]=theElement1;&#xA;				} else &#xA;				if(type.substr(1,1)==&quot;i&quot;&amp;&amp;foundElement.Type==&quot;Object&quot;&amp;&amp;theElement2==null&amp;&amp;diagramObject2==null) {&#xA;					diagramObject2=diagramObject;&#xA;					theElement2=foundElement;&#xA;					parameters[0][1]=theElement2;&#xA;				} else &#xA;				if(type.substr(2,1)==&quot;i&quot;&amp;&amp;foundElement.Type==&quot;Object&quot;&amp;&amp;theElement3==null&amp;&amp;diagramObject3==null) {&#xA;					diagramObject3=diagramObject;&#xA;					theElement3=foundElement;&#xA;					parameters[0][2]=theElement3;				&#xA;				} else &#xA;				if(type.substr(2,1)==&quot;e&quot;&amp;&amp;foundElement.Type==&quot;Event&quot;&amp;&amp;theElement3==null&amp;&amp;diagramObject3==null) {&#xA;					diagramObject3=diagramObject;&#xA;					theElement3=foundElement;&#xA;					parameters[0][2]=theElement3;	&#xA;				}  &#xA;			}&#xA;		}&#xA;		if(diagramObject1!=null&amp;&amp;diagramObject2!=null&amp;&amp;diagramObject3!=null)&#xA;			break;			&#xA;	}&#xA;	if(diagramObject2==null || diagramObject1==null &amp;&amp; diagramObject3==null)&#xA;		return parameters;&#xA;	//Identifying connectors&#xA;	var Connectors as EA.Collection;&#xA;	Connectors = theElement1.Connectors;&#xA;	var theConnector as EA.Connector;&#xA;	var thisConnector as EA.Connector;&#xA;	thisConnector=null;&#xA;    //identifying connector element for 1,2 elements&#xA;	for(i=0;i&lt;Connectors.Count;i++)&#xA;	{&#xA;		theConnector=Connectors.GetAt(i);&#xA;		if( theConnector.SupplierID == theElement1.ElementID &amp;&amp; theConnector.ClientID == theElement2.ElementID ||&#xA;		theConnector.ClientID == theElement1.ElementID &amp;&amp; theConnector.SupplierID == theElement2.ElementID) {&#xA;			parameters[1][0] = theConnector;&#xA;			break;&#xA;		}&#xA;	}&#xA;    //identifying connector element for 2,3 elements&#xA;	Connectors = theElement3.Connectors;&#xA;	thisConnector=null;&#xA;	for(i=0;i&lt;Connectors.Count;i++)&#xA;	{&#xA;		theConnector=Connectors.GetAt(i);&#xA;		if( theConnector.SupplierID == theElement2.ElementID &amp;&amp; theConnector.ClientID == theElement3.ElementID ||&#xA;		theConnector.ClientID == theElement2.ElementID &amp;&amp; theConnector.SupplierID == theElement3.ElementID) {&#xA;			parameters[1][1] = theConnector;&#xA;			break;&#xA;		}&#xA;	}&#xA;	return parameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the process decomposition diagram&#xA;function getConnectionR(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var searchConnectors = [ null, null];&#xA;&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.Type==&quot;Event&quot;) { //RevBau, ReviBaua&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(type.substr(2,1)==&quot;v&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, nameElement2, 0);&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Object&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			if(type.substr(3,1)==&quot;i&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 0);&#xA;			else&#xA;			if(type.substr(3,1)!=&quot;B&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Activity&quot;, nameElement3, 0);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][2]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;			}&#xA;		}&#xA;	}&#xA;	else&#xA;	if((currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;)&amp;&amp;type.substr(2,1)==&quot;v&quot;) {  //RevBau, RiviBaua, ReviBaua - redundant&#xA;		theElement2=currentElement;		&#xA;		parameters[0][1]=theElement2;&#xA;		if(type.substr(1,1)==&quot;e&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Event&quot;, nameElement1, 1);	&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);	&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][0]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement1=searchConnectors[0];&#xA;		}&#xA;		if(type.substr(3,1)==&quot;i&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 0);	&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][2]= searchConnectors[0];&#xA;			parameters[1][1] = searchConnectors[1];&#xA;			theElement3=searchConnectors[0];&#xA;		}&#xA;		//if type==RiviBaua&#xA;	}&#xA;	else&#xA;	if((currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;)&amp;&amp;type.substr(1,1)==&quot;v&quot;)	{	//RviBau, RvivBuau&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(type.substr(2,1)==&quot;i&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Object&quot;, nameElement2, 0);	&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement2=searchConnectors[0];&#xA;		}&#xA;		//RvivBuau&#xA;	}&#xA;	else&#xA;	if(currentElement.Type==&quot;Object&quot;&amp;&amp;type.substr(2,1)==&quot;i&quot;) {		//RviBau, RvivBuau - redundant&#xA;		theElement2=currentElement;&#xA;		parameters[0][1]=theElement2;&#xA;		if(type.substr(1,1)==&quot;i&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);	&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Activity&quot;, nameElement1, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][0]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement1=searchConnectors[0];&#xA;		}&#xA;		//RvivBuau&#xA;	}&#xA;	else&#xA;	if(currentElement.Type==&quot;Object&quot;&amp;&amp;type.substr(3,1)==&quot;i&quot;&amp;&amp;type.substr(1,1)==&quot;i&quot;) //RiviBaua&#xA;	{		&#xA;		theElement1=currentElement;&#xA;		theElement3=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 0);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][2]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;			}&#xA;		} else {&#xA;			parameters[0][0]=null;&#xA;			parameters[0][2]=currentElement;&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, nameElement2, 1);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][1]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;				theElement2=searchConnectors[0];&#xA;				searchConnector = [ null, null];&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;				if(searchConnectors[0]!=null) {&#xA;					parameters[0][0]= searchConnectors[0];&#xA;					parameters[1][0] = searchConnectors[1];&#xA;				}&#xA;			}&#xA;		}&#xA;		//type==RiviBaua - you should look at all objects&#xA;	}&#xA;	else	&#xA;	if(currentElement.Type==&quot;Object&quot;&amp;&amp;type.substr(3,1)==&quot;i&quot;&amp;&amp;type.substr(1,1)!=&quot;i&quot;) {	//ReviBaua-redundant&#xA;		theElement3=currentElement;&#xA;		parameters[0][2]=theElement3;&#xA;		if(type.substr(2,1)==&quot;v&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, nameElement3, 1);&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Object&quot;, nameElement3, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][1] = searchConnectors[1];&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			if(type.substr(1,1)==&quot;e&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Event&quot;, nameElement1, 1);&#xA;			else&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][0]= searchConnectors[0];&#xA;				parameters[1][0] = searchConnectors[1];&#xA;			}&#xA;		}&#xA;	}&#xA;	return parameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the business use case diagram&#xA;function getConnectionB(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var searchConnectors = [ null, null];&#xA;&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.Type==&quot;Actor&quot;) { //BauApv&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(type.substr(2,1)==&quot;u&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;UseCase&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;		}&#xA;	} else&#xA;	if(currentElement.Type==&quot;UseCase&quot;&amp;&amp;type==&quot;YuQlml&quot;) { //BauApv&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(type.substr(1,1)==&quot;u&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;UseCase&quot;, nameElement2, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;		}&#xA;	} else	&#xA;	if(currentElement.Type==&quot;UseCase&quot;) { //BauApv&#xA;		theElement2=currentElement;&#xA;		parameters[0][1]=theElement2;&#xA;		if(type.substr(1,1)==&quot;a&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Actor&quot;, nameElement1, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][0]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;		}&#xA;	}	&#xA;	return parameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the business process diagram&#xA;function getConnectionA(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var searchConnectors = [ null, null];&#xA;	var index=0;&#xA;	var statesArray = [];&#xA;	var stateObject;&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(type.substr(0,4)==&quot;AivS&quot;) {&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(nameElement1==null||nameElement1==&quot;&quot;||nameElement1==&quot; &quot;||nameElement1.indexOf(&quot;:&quot;)&lt;0) &#xA;			nameElement1=&quot;:&quot;+(Repository.GetElementByID(theElement1.ClassifierID)).Name;&#xA;		statObject=getStatesOfObject(theElement1);&#xA;		if(statObject==null) &#xA;			return parameters;&#xA;		statesArray.push(statObject);&#xA;		searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, &quot;&quot;, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;			if(searchConnectors[0]!=null) {&#xA;				theElement3=searchConnectors[0];&#xA;				statObject=getStatesOfObject(theElement3);&#xA;				if(statObject==null) &#xA;					return parameters;&#xA;				statesArray.push(statObject);				&#xA;				searchConnector = [ null, null];&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, &quot;&quot;, 1);&#xA;				if(searchConnectors[0]!=null) {&#xA;					theElement2=searchConnectors[0];&#xA;					searchConnector = [ null, null];&#xA;					searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;					if(searchConnectors[0]!=null) {&#xA;						theElement3=searchConnectors[0];&#xA;						statObject=getStatesOfObject(theElement3);&#xA;						if(statObject==null) &#xA;							return parameters;&#xA;						statesArray.push(statObject);				&#xA;						searchConnector = [ null, null];&#xA;						searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, &quot;&quot;, 1);&#xA;						if(searchConnectors[0]!=null) {&#xA;							theElement2=searchConnectors[0];&#xA;							searchConnector = [ null, null];&#xA;							searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;							if(searchConnectors[0]!=null) {&#xA;								theElement3=searchConnectors[0];&#xA;								statObject=getStatesOfObject(theElement3);&#xA;								if(statObject==null) &#xA;									return parameters;&#xA;								statesArray.push(statObject);				&#xA;								searchConnector = [ null, null];&#xA;							}&#xA;						}&#xA;					}&#xA;				}&#xA;			}				&#xA;		}&#xA;		statesArray.reverse();&#xA;		searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, &quot;&quot;, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 0);&#xA;			if(searchConnectors[0]!=null) {&#xA;				theElement3=searchConnectors[0];&#xA;				statObject=getStatesOfObject(theElement3);&#xA;				if(statObject==null) &#xA;					return parameters;&#xA;				statesArray.push(statObject);				&#xA;				searchConnector = [ null, null];&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, &quot;&quot;, 0);&#xA;				if(searchConnectors[0]!=null) {&#xA;					theElement2=searchConnectors[0];&#xA;					searchConnector = [ null, null];&#xA;					searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 0);&#xA;					if(searchConnectors[0]!=null) {&#xA;						theElement3=searchConnectors[0];&#xA;						statObject=getStatesOfObject(theElement3);&#xA;						if(statObject==null) &#xA;							return parameters;&#xA;						statesArray.push(statObject);				&#xA;						searchConnector = [ null, null];&#xA;						searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, &quot;&quot;, 0);&#xA;						if(searchConnectors[0]!=null) {&#xA;							theElement2=searchConnectors[0];&#xA;							searchConnector = [ null, null];&#xA;							searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 0);&#xA;							if(searchConnectors[0]!=null) {&#xA;								theElement3=searchConnectors[0];&#xA;								statObject=getStatesOfObject(theElement3);&#xA;								if(statObject==null) &#xA;									return parameters;&#xA;								statesArray.push(statObject);				&#xA;								searchConnector = [ null, null];&#xA;							}&#xA;						}&#xA;					}&#xA;				}&#xA;			}				&#xA;		}&#xA;		statesArray.reverse();&#xA;		var index=0;&#xA;		while(statesArray.length&gt;0) {&#xA;			statObject=statesArray.pop();&#xA;			parameters[1][index]=statObject;&#xA;			index++;&#xA;		}&#xA;	} else&#xA;	if(currentElement.Type==&quot;ActivityPartition&quot;) { //ApvUau&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		for(var i=0; i&lt;currentElement.Elements.Count(); i++) {&#xA;			theElement2=currentElement.Elements.GetAt(i);&#xA;			if(theElement2.Type==&quot;Action&quot;||theElement2.Type==&quot;Activity&quot;) {&#xA;				index++;&#xA;				parameters[0][index]=theElement2;				&#xA;			}&#xA;		}&#xA;	} else&#xA;	if(currentElement.Type==&quot;Object&quot;) { //AiviCczc&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(type.substr(2,1)==&quot;v&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, nameElement2, 0);&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Object&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			if(type.substr(3,1)==&quot;i&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 0);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][2]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;			}&#xA;		}&#xA;	} else&#xA;	if(currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Activity&quot;) { //AiviCczc&#xA;		theElement2=currentElement;&#xA;		parameters[0][1]=theElement2;&#xA;		if(type.substr(2,1)==&quot;v&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;		else &#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][0]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement1=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			if(type.substr(3,1)==&quot;i&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 0);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][2]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;			}&#xA;		}&#xA;	} 	&#xA;	return parameters;&#xA;}&#xA;//Returning the state of a given element&#xA;function getStatesOfObject(theElement) {&#xA;	var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+theElement.ElementID;&#xA;	var sqlRespond=Repository.SQLQuery(sqlCommand);&#xA;	var stateObject=null;&#xA;	if(sqlRespond!=null)&#xA;		stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;	if(stateObject==null||stateObject==&quot;&quot;)&#xA;		return null;&#xA;	else&#xA;		return stateObject;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the sequence diagram&#xA;function getConnectionQ(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.ObjectType==otConnector) { //QlmlMqyq&#xA;		theElement1=Repository.GetElementByID(currentElement.ClientID);&#xA;		theElement2=currentElement;&#xA;		theElement3=Repository.GetElementByID(currentElement.SupplierID);&#xA;		parameters[0][0]=theElement1;&#xA;		parameters[0][1]=theElement2;&#xA;		parameters[0][2]=theElement3;&#xA;		if((nameElement1==null||nameElement1==&quot;&quot;||nameElement1==&quot; &quot;)&amp;&amp;(nameElement2==null||nameElement2==&quot;&quot;||nameElement2==&quot; &quot;)&amp;&amp;(nameElement3==null||nameElement3==&quot;&quot;||nameElement3==&quot; &quot;)) {&#xA;			for( var k=0; k&lt;theElement3.Connectors.Count;k++) {&#xA;				theElement2=theElement3.Connectors.GetAt(k);&#xA;				if(theElement2.ClientID==theElement3.ElementID&amp;&amp;theElement2.SupplierID!=theElement1.ElementID) {&#xA;					parameters[0][3]=theElement2;&#xA;					parameters[0][4]=Repository.GetElementByID(theElement2.SupplierID);&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(parameters[0][4]!=null&amp;&amp;parameters[0][4].Type==&quot;Sequence&quot;) {&#xA;				for( var k=0; k&lt;parameters[0][4].Connectors.Count;k++) {&#xA;					theElement2=parameters[0][4].Connectors.GetAt(k);&#xA;					if(theElement2.ClientID==parameters[0][4].ElementID&amp;&amp;theElement2.SupplierID!=parameters[0][2].ElementID) {&#xA;						parameters[0][5]=theElement2;&#xA;						parameters[0][6]=Repository.GetElementByID(theElement2.SupplierID);&#xA;						break;&#xA;					}&#xA;				}				&#xA;			}&#xA;			if(parameters[0][6]!=null&amp;&amp;parameters[0][6].Type==&quot;Sequence&quot;) {&#xA;				for( var k=0; k&lt;parameters[0][6].Connectors.Count;k++) {&#xA;					theElement2=parameters[0][6].Connectors.GetAt(k);&#xA;					if(theElement2.ClientID==parameters[0][6].ElementID&amp;&amp;theElement2.SupplierID!=parameters[0][4].ElementID) {&#xA;						parameters[0][7]=theElement2;&#xA;						parameters[0][8]=Repository.GetElementByID(theElement2.SupplierID);&#xA;						break;&#xA;					}&#xA;				}				&#xA;			}&#xA;		}&#xA;	} else&#xA;	if(currentElement.ObjectType==otElement) { //QlmlMqyq&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		for( var k=0; k&lt;theElement1.Connectors.Count;k++) {&#xA;			theElement2=theElement1.Connectors.GetAt(k);&#xA;			if(theElement2.ClientID==theElement1.ElementID) {&#xA;				parameters[0][1]=theElement2;&#xA;				parameters[0][2]=Repository.GetElementByID(theElement2.SupplierID);&#xA;				break;&#xA;			}&#xA;		}&#xA;	} 	&#xA;	return parameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the business class diagram&#xA;function getConnectionC(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.ObjectType==otConnector) { //CchZiv&#xA;		theElement1=Repository.GetElementByID(currentElement.ClientID);&#xA;		theElement2=currentElement;&#xA;		theElement3=Repository.GetElementByID(currentElement.SupplierID);&#xA;		parameters[0][0]=theElement1;&#xA;		parameters[0][1]=theElement2;&#xA;		parameters[0][2]=theElement3;&#xA;	} else&#xA;	if(currentElement.ObjectType==otElement) { //CchZiv&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;	} 	&#xA;	return parameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the business state machine diagram&#xA;function getConnectionS(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.ObjectType==otConnector) { //SrsZiv&#xA;		theElement1=Repository.GetElementByID(currentElement.ClientID);&#xA;		theElement2=currentElement;&#xA;		theElement3=Repository.GetElementByID(currentElement.SupplierID);&#xA;		parameters[0][0]=theElement1;&#xA;		parameters[0][1]=theElement2;&#xA;		parameters[0][2]=theElement3;&#xA;	} else&#xA;	if(currentElement.ObjectType==otElement) { //SrsZiv&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;	} 	&#xA;	return parameters;&#xA;}&#xA;//Create target elements in composite consistency rule from context diagram to process decomposition diagram&#xA;function createXRcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;PDD&quot;,&quot;&quot;);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	if(conns[0][2]!=null&amp;&amp;conns[0][2].Notes==&quot;instancja decyzji&quot;)&#xA;		Session.Output(&quot;coto&quot;);&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var i = 0, j=0 ; i &lt; diagramObjects.Count ; i++ )&#xA;	{&#xA;		var coto as EA.Element;&#xA;		var cotoParent as EA.Element;&#xA;&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID&gt;0)&#xA;			coto=Repository.GetElementByID(diagramObject.ElementID);&#xA;		else&#xA;			coto=null;&#xA;		if(coto.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		//Element named '' and type 'Object' has the value of the Tag:Xe(Decision1)v()iRe(Decision1)vi&#xA;        //if(params[1][2]!=null&amp;&amp;params[1][2]!=&quot;&quot;&amp;&amp;params[1][2]!=&quot; &quot;&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&gt;-1)&#xA;			//var toto=params[1][2].substr(0,params[1][2].indexOf(&quot;:&quot;));&#xA;		if(diagramObject1==null&amp;&amp;conns[0][0]!=null&amp;&amp;conns[0][0].ElementID == diagramObject.ElementID) //verification of the element linked from the X diagram &#xA;			diagramObject1=diagramObject; //The element1 from X is linked to the object diagram&#xA;		else&#xA;		if(diagramObject1==null&amp;&amp;coto.Type==&quot;Event&quot;&amp;&amp;coto.Name==params[1][0]) //verification of an existing element in the R diagram&#xA;			diagramObject1=diagramObject; //The element1 from X is not linked to the object diagram&#xA;		else&#xA;		//what about the object	as the input element? Not event could be?&#xA;		if(diagramObject2==null&amp;&amp;coto.Type==&quot;Activity&quot;&amp;&amp;coto.Name==params[1][1]) //verification of an existing element in the R diagram&#xA;			diagramObject2=diagramObject; //The element1 from X is linked to the object diagram&#xA;		else&#xA;		if(diagramObject3==null&amp;&amp;conns[0][2]!=null&amp;&amp;conns[0][2].ElementID == diagramObject.ElementID) &#xA;			diagramObject3=diagramObject; //The element3 from X is linked to the object diagram&#xA;		else&#xA;		if(diagramObject3==null&amp;&amp;coto.Type==&quot;Object&quot;&amp;&amp;&#xA;			(coto.Name==params[1][2]|| //There is only the name of the instance&#xA;			 params[1][2].indexOf(&quot;:&quot;)&gt;-1&amp;&amp;coto.Name!=&quot;&quot;&amp;&amp;coto.Name!=&quot; &quot;&amp;&amp;coto.Name==params[1][2].substr(0,params[1][2].indexOf(&quot;:&quot;))||&#xA;			 (coto.Name==&quot;&quot;||coto.Name==&quot; &quot;)&amp;&amp;coto.ClassifierID&gt;0&amp;&amp;cotoParent.Name==params[1][2].substr(1))) //verification of an existing element in the R diagram&#xA;			diagramObject3=diagramObject; //The element1 from X is linked to the object diagram&#xA;		else {&#xA;			if(coto!=null)&#xA;				otherDiagObjects.push(diagramObject);&#xA;		}&#xA;	}&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Name==params[1][0] || //XeviRe(name1)vi, XiviRi(name1)vi&#xA;			currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;params[1][0]!=null&amp;&amp;params[1][0]!=&quot;&quot;&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;currentElement.Name==params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;))&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==params[1][0].substr(params[1][0].indexOf(&quot;:&quot;)+1) || //XiviRi(name1:class1)vi&#xA;			currentElement.Name==&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==params[1][0].substr(1) ) //XiviRi(:class1)vi&#xA;			//There is already an element named name1&#xA;			delement1=currentElement;&#xA;		else 		&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Name==params[1][1] ) //XeviRev(name1)i, XiviRiv(name1)i&#xA;			delement2=currentElement;&#xA;		else 		&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Name==params[1][2] || //XeviRevi(name1), XiviRivi(name1)&#xA;			//moze warto rozwazyc równiez klas&#281; tego elementu&#xA;		    currentElement.Name!=&quot;&quot;&amp;&amp;params[1][2]!=null&amp;&amp;params[1][2]!=&quot;&quot;&amp;&amp;params[1][2]!=&quot; &quot;&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&gt;0&amp;&amp;currentElement.Name==params[1][2].substr(0,params[1][2].indexOf(&quot;:&quot;))&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==params[1][2].substr(params[1][2].indexOf(&quot;:&quot;)+1) || //XeviRevi(name1:class1), XiviRivi(name1:class1)&#xA;			currentElement.Name==&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==params[1][2].substr(1)) //XeviRevi(:class1), XiviRivi(:class1)&#xA;			delement3=currentElement;	&#xA;		else&#xA;			if(currentElement!=null)&#xA;				otherElements.push(currentElement);&#xA;		if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;delement3!=null)&#xA;			break;&#xA;	}&#xA;	if(delement1==null) { //There is no element1 in the package, but this element could have been placed in the R diagram via a link from the package containing the X diagram&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null||conns[0][0].Name!=params[1][0].Name) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;e&quot;) { &#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0]!=conns[0][0].Name) {&#xA;					testElement = subPackage.Elements.AddNew( params[1][0], &quot;Event&quot; ); //&quot;Event&quot; to jest &quot;Signal&quot;&#xA;					testElement.Subtype=1; //Receive&#xA;					if(conns[0][0]!=null) {&#xA;						//an aggregation to the event from diagram X should be created&#xA;						// Create a connector between the two elements&#xA;						var connector = testElement.Connectors.AddNew(&quot;&quot;, &quot;Aggregation&quot;);&#xA;						connector.SupplierID = conns[0][0].ElementID;&#xA;						connector.Update();&#xA;						//testElement.Connectors.Refresh;&#xA;					}&#xA;					testElement.Update();&#xA;					diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				} else&#xA;				if(params[1][0]!=null&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]!=&quot; &quot;&amp;&amp;params[1][0]==conns[0][0].Name)) {&#xA;					//XeviRe()vi||Xe(name1)viRe(name1)vi&#xA;					testElement=conns[0][0];&#xA;				} else&#xA;					Session.Output(&quot;Line 1665, params, conns:&quot;+params+&quot;\n&quot;+conns[0][0].Name+&quot;'&quot;+conns[0][1].Name+&quot;,&quot;+conns[0][2].Name);&#xA;			} else&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;) { &#xA;				var nameOfObject;&#xA;				var nameOfClass;&#xA;				var identOfClass=null;&#xA;				//in the one case object element does not have parent class&#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;params[1][0].length) {&#xA;					//XeviRevi(name1:class1)&#xA;					nameOfObject=params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;));&#xA;				    nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				} else if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;0) {&#xA;					nameOfObject=params[1][0]; //XeviRevi(name1)&#xA;				    if(nameOfObject==params[0][0])  {//should be the class of element name1 on the X diagram&#xA;						if(conns[0][0]!=null&amp;&amp;conns[0][0].Name!=&quot; &quot;&amp;&amp;conns[0][0].ClassfierID!=null&amp;&amp;conns[0][0].ClassfierID&gt;0) &#xA;							identOfClass=conns[0][0].ClassfierID;&#xA;						else					&#xA;							nameOfClass=&quot; &quot;; //object without of the class&#xA;					} else&#xA;						if(conns[0][0]!=null&amp;&amp;conns[0][0].Type==&quot;Object&quot;&amp;&amp;conns[0][0].ClassfierID!=null&amp;&amp;conns[0][0].ClassfierID&gt;0) &#xA;							identOfClass=conns[0][0].ClassfierID;&#xA;						else	&#xA;						if(conns[0][0]!=null&amp;&amp;(conns[0][0].Type==&quot;Class&quot;||conns[0][0].Type==&quot;Event&quot;)) &#xA;							identOfClass=conns[0][0].ElementID;&#xA;						else&#xA;							nameOfClass=&quot; &quot;; //object without of the class&#xA;				} else if(params[1][0]!=null&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfObject=&quot;&quot;;&#xA;					nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				} else {&#xA;					nameOfObject=&quot;&quot;;&#xA;					if(conns[0][0]!=null&amp;&amp;conns[0][0].Name!=&quot; &quot;&amp;&amp;conns[0][0].ClassifierID!=null&amp;&amp;conns[0][0].ClassifierID&gt;0) &#xA;						identOfClass=conns[0][0].ClassifierID;		&#xA;					else&#xA;						if(correctCR.substr(correctCR.indexOf(&quot;X&quot;)+1,1)==&quot;e&quot;&amp;&amp;conns[0][0]!=null)&#xA;							nameOfClass=&quot;:&quot;+conns[0][0].Name;&#xA;						else&#xA;							nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				}&#xA;				if(params[3][0]!=&quot;&quot;&amp;&amp;params[3][0]!=&quot; &quot;)  //the state of the object must be set&#xA;					nameOfObject=nameOfObject+&quot;[&quot;+params[3][0]+&quot;]&quot;;	&#xA;				testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; );&#xA;				if(identOfClass!=null)&#xA;					testElement.ClassifierID=identOfClass;&#xA;				else&#xA;				if(nameOfClass.substr(0,1)==&quot;:&quot;) {&#xA;					//new class - can we look at the class with the same name earlier?&#xA;					nameOfClass=nameOfClass.substr(1);&#xA;					coto=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(coto==null) {&#xA;						testClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					} else {&#xA;						testClass = coto;&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					}&#xA;				} else if(nameOfClass==&quot; &quot;) {&#xA;					//without the class&#xA;					nameOfClass=&quot; &quot;;&#xA;				} else {&#xA;					if(conns[0][0]!=null&amp;&amp;conns[0][0].Name!=&quot; &quot;)&#xA;						testElement.ClassifierID=conns[0][0].ClassifierID;&#xA;				}&#xA;				testElement.Update();&#xA;				//update the state of object&#xA;				if(params[3][0]!=&quot;&quot;&amp;&amp;params[3][0]!=&quot; &quot;)  {//the state of the object must be set&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+params[3][0]+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);&#xA;				} else {&#xA;					if(conns[0][0]!=null) {&#xA;						var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][0].ElementID;&#xA;						var sqlRespond=Repository.SQLQuery(sqlCommand);&#xA;						var stateObject=null;&#xA;						var stateObject;&#xA;						if(sqlRespond!=null)&#xA;							stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;						if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;							var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;							Repository.Execute(sqlCommand);&#xA;						}							&#xA;					}							&#xA;				}	&#xA;				diagramObject1=null; //diagramObject1 is the object from the X diagram&#xA;			}&#xA;			delement1=testElement;&#xA;		} else &#xA;			delement1=conns[0][0];&#xA;	}&#xA;	if(delement2==null) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+2,1)==&quot;v&quot;) { &#xA;				var nameOfSub = &quot;&quot;;&#xA;				if(params[1][1]==null||params[1][1]==&quot; &quot;)&#xA;					if(params[0][0]==null||params[0][0]==&quot; &quot;)&#xA;						if(params[1][0]==null||params[1][0]==&quot; &quot;)&#xA;							if(conns[0][0]==null||conns[0][0].Name==&quot;&quot;||conns[0][0].Name==&quot; &quot;)&#xA;								if(conns[0][1]==null||conns[0][1].Name==&quot;&quot;||conns[0][1].Name==&quot; &quot;)&#xA;									if(conns[0][1]==null||conns[0][1].Name==&quot;&quot;||conns[0][1].Name==&quot; &quot;)&#xA;										nameOfSub = &quot; Some subprocess&quot;;&#xA;									else&#xA;										nameOfSub = conns[0][1].Name + &quot; subprocess&quot;;&#xA;								else&#xA;									nameOfSub = conns[0][0].Name + &quot; subprocess&quot;;&#xA;							else&#xA;								nameOfSub = conns[0][0].Name + &quot; subprocess&quot;;&#xA;						else&#xA;							nameOfSub = params[1][0] + &quot; subprocess&quot;;&#xA;					else&#xA;						nameOfSub = params[0][0]+ &quot; subprocess&quot;;&#xA;				else&#xA;					nameOfSub = params[1][1]; //here you can verify otherElements with nameOfSub&#xA;				var foundElement as EA.Element;&#xA;				foundElement=null;&#xA;				for(i=0; i&lt;otherElements.length;i++) {&#xA;					if((otherElements[i].Type==&quot;Activity&quot;||otherElements[i].Type==&quot;Action&quot;)&amp;&amp;otherElements[i].Name==nameOfSub) {&#xA;						foundElement=otherElements[i];&#xA;						break;&#xA;					}&#xA;				}&#xA;				if(foundElement!=null) {&#xA;					testElement=foundElement;&#xA;					var foundDiagramObject as EA.DiagramObject;&#xA;					foundDiagramObject=null;&#xA;					for(i=0;i&lt;otherDiagObjects.length;i++) {&#xA;						if(otherDiagObjects[i].ElementID==foundElement.ElementID) {&#xA;							foundDiagramObject=otherDiagObjects[i];&#xA;							break;&#xA;						}&#xA;					}&#xA;					if(foundDiagramObject!=null)&#xA;						diagramObject2=foundDiagramObject;						&#xA;				} else {&#xA;					testElement = subPackage.Elements.AddNew( nameOfSub, &quot;Activity&quot; );&#xA;					testElement.Stereotype=&quot;process&quot;;&#xA;					testElement.StereotypeEx=&quot;process&quot;;&#xA;					testElement.Update();&#xA;				}&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} else &#xA;			delement2=conns[0][1];&#xA;	}&#xA;	if(delement3==null) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null||&#xA;			diagramObject3!=null&amp;&amp;conns[0][2].ElementID==diagramObject3.ElementID|| //the target element comes from the X diagram&#xA;			params[1][2]!=null&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&gt;-1&amp;&amp;conns[0][2].ClassifierID&gt;0&amp;&amp;params[1][2].substr(params[1][2].indexOf(&quot;:&quot;)+1)!= (Repository.GetElementByID(conns[0][2].ClassfierID)).Name//inherited class is not the same as identified class&#xA;			) { &#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+3,1)==&quot;i&quot;) { &#xA;				var nameOfObject;&#xA;				var nameOfClass;&#xA;				var identOfClass = null;&#xA;				//in the one case object element does not have parent class&#xA;				if(params[1][2]!=null&amp;&amp;params[1][2]!=&quot; &quot;&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&gt;0&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&lt;params[1][2].length) {&#xA;					//XeviRevi(name1:class1)&#xA;					nameOfObject=params[1][2].substr(0,params[1][2].indexOf(&quot;:&quot;));&#xA;				    nameOfClass=params[1][2].substr(params[1][2].indexOf(&quot;:&quot;));&#xA;				} else if(params[1][2]!=null&amp;&amp;params[1][2]!=&quot; &quot;&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&lt;0) {&#xA;					nameOfObject=params[1][2]; //XeviRevi(name1)&#xA;				    if(nameOfObject==params[0][2]) { //the class of name in the params[0][2] on the X diagram&#xA;						if(conns[0][2]!=null&amp;&amp;conns[0][2].Type==&quot;Object&quot;&amp;&amp;conns[0][2].ClassfierID!=null&amp;&amp;conns[0][2].ClassfierID&gt;0)&#xA;							identOfClass=conns[0][2].ClassfierID;		&#xA;						else					&#xA;						if(conns[0][2]!=null)&#xA;							nameOfClass=&quot;:&quot;+conns[0][2].Name;&#xA;						else&#xA;							nameOfClass=&quot; &quot;; //object without of the class&#xA;					} else&#xA;						if(conns[0][2]!=null&amp;&amp;conns[0][2].Type==&quot;Object&quot;&amp;&amp;conns[0][2].ClassfierID!=null&amp;&amp;conns[0][2].ClassfierID&gt;0)&#xA;							identOfClass=conns[0][2].ClassfierID;		&#xA;						else					&#xA;						if(conns[0][2]!=null)&#xA;							nameOfClass=&quot;:&quot;+conns[0][2].Name;&#xA;						else&#xA;							nameOfClass=&quot; &quot;; //object without of the class&#xA;				} else if(params[1][2]!=null&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfObject=&quot;&quot;; //XeviRevi(:class1)&#xA;					nameOfClass=params[1][2].substr(params[1][2].indexOf(&quot;:&quot;));&#xA;				} else {&#xA;					nameOfObject=&quot;&quot;; //XeviRevi()&#xA;					if(conns[0][2]!=null&amp;&amp;conns[0][2].Name!=&quot; &quot;&amp;&amp;conns[0][2].ClassifierID!=null&amp;&amp;conns[0][2].ClassifierID&gt;0) &#xA;						identOfClass=conns[0][2].ClassifierID;						&#xA;				}&#xA;				if(params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;)  //the state of the object must be set&#xA;					nameOfObject=nameOfObject+&quot;[&quot;+params[3][2]+&quot;]&quot;;	&#xA;				testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; );&#xA;				if(identOfClass!=null)&#xA;					testElement.ClassifierID=identOfClass;&#xA;				else&#xA;				if(nameOfClass.substr(0,1)==&quot;:&quot;) {&#xA;					//new class - can we look at the class with the same name earlier?&#xA;					nameOfClass=nameOfClass.substr(1);&#xA;					coto=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(coto==null) {&#xA;						testClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					} else {&#xA;						testClass = coto;&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					}&#xA;				} else if(nameOfClass==&quot; &quot;) {&#xA;					//without the class&#xA;					nameOfClass=&quot; &quot;;&#xA;				} else {&#xA;					if(conns[0][2]!=null&amp;&amp;conns[0][2].Name!=&quot; &quot;)&#xA;						testElement.ClassifierID=conns[0][2].ClassifierID;&#xA;				}&#xA;				testElement.Update();&#xA;				if(params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;)  {//the state of the object must be set&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+params[3][2]+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);&#xA;				} else {&#xA;					if(conns[0][2]!=null) {&#xA;						var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][2].ElementID;&#xA;						var sqlRespond=Repository.SQLQuery(sqlCommand);&#xA;						var stateObject=null;&#xA;						var stateObject;&#xA;						if(sqlRespond!=null)&#xA;							stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;						if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;							var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;							Repository.Execute(sqlCommand);&#xA;						}							&#xA;					}							&#xA;				}					&#xA;				diagramObject3=null; //diagramObject3 is the object from the X diagram&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} else {&#xA;			//if(correctCR.substr(7,1)==&quot;i&quot;) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+3,1)==&quot;i&quot;) {&#xA;				if(diagramObject3!=null)&#xA;					delement3=Repository.GetElementByID(diagramObject3.ElementID);&#xA;				else &#xA;					Session.Output(&quot;Unknown case: 1890 line&quot;);&#xA;			} else&#xA;				if(conns[0][2]!=null)&#xA;					delement3=conns[0][2];			&#xA;		}&#xA;	} &#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;(conns[1][0]!=null||params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;conns[0][0]!=null&amp;&amp;params[1][0]!=conns[0][0].Name)) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	if(delement3!=null&amp;&amp;delement2!=null&amp;&amp;(conns[1][1]!=null||params[1][2]!=null&amp;&amp;params[1][2]!=&quot; &quot;&amp;&amp;conns[0][1]!=null&amp;&amp;params[1][2]!=conns[0][1].Name)) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;			connector1=delement2.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement2.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			var connector = delement2.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;			connector.SupplierID = delement3.ElementID;&#xA;			connector.Update();&#xA;			delement2.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	var newObj3=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Event&quot;) {&#xA;			var left=30;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Event&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+70;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-40;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		} else &#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Object&quot;) {&#xA;			var left=30;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+70;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-40;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;Activity&quot;) {&#xA;			var left=150;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Activity&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1.top &lt; top) &#xA;				top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-40;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element1 to the diagram&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Object&quot;) {&#xA;			var left=300;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&gt;left-50) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1.top &lt; top||diagramObject2.top &lt; top) {&#xA;				if(diagramObject1.top&lt;diagramObject2.top)&#xA;					top=diagramObject1.top;&#xA;				else&#xA;					top=diagramObject2.top;&#xA;			}&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;					diagramObject1.top=top;&#xA;					diagramObject1.bottom=top-40;&#xA;					diagramObject1.Update();&#xA;			}&#xA;			if(newObj2&amp;&amp;diagramObject2.top &gt; top) {&#xA;					diagramObject2.top=top;&#xA;					diagramObject2.bottom=top-40;&#xA;					diagramObject2.Update(); &#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+70;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-40;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in simple consistency rule from context diagram to process decomposition diagram&#xA;function createXRsimple(consistencyRule, correctCR, thePackage, parameters, currElement) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	//var otherElements = [];&#xA;	var connectorCR as EA.Connector;&#xA;	&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;PDD&quot;,&quot;&quot;);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	diagramObject=null;&#xA;	diagramObject1=null;&#xA;	if(currElement.Notes==&quot;instancja decyzji&quot;)&#xA;		Session.Output(&quot;coto&quot;);&#xA;&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var i = 0, j=0 ; i &lt; diagramObjects.Count; i++ )&#xA;	{&#xA;		var coto as EA.Element;&#xA;		var cotoParent as EA.Element;&#xA;		//Xeri, XiRi, XevRv, XivRv, XviRv, XjRj, XzRz&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID&gt;0)&#xA;			coto=Repository.GetElementByID(diagramObject.ElementID);&#xA;		else&#xA;			coto=null;&#xA;		if(coto.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;(params[1][0]==&quot;&quot;||params[1][0]==&quot; &quot;)&amp;&amp;&#xA;			currElement.Type==&quot;Event&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==&quot;&quot;&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.Name==currElement.Name) //XeRi&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XeRi(name1)&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;0&amp;&amp; //without the class1&#xA;			currElement.Type==&quot;Event&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==params[1][0]&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.Name==currElement.Name) //XeRi(name1)&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XeRi(name1:class1), XeRi(:class1)&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;params[0][0]!=&quot;&quot;&amp;&amp;params[0][0]!=&quot; &quot;&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;-1&amp;&amp; // with the class1&#xA;			currElement.Type==&quot;Event&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;))&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.Name==params[1][0].substr(params[1][0].indexOf(&quot;:&quot;)+1)) //XeRi(name1:class1), XeRi(:class1)&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XiRi&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;(params[1][0]==&quot;&quot;||params[1][0]==&quot; &quot;)&amp;&amp;&#xA;			currElement.Type==&quot;Object&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==&quot;&quot;&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.ElementID==currElement.ClassifierID)&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XiRi(name1)&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;0&amp;&amp; //without the class1&#xA;			currElement.Type==&quot;Object&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==params[1][0]&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.ElementID==currElement.ClassifierID) //XiRi(name1)&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XiRi(name1:class1), XiRi(:class1)&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;-1&amp;&amp;&#xA;			currElement.Type==&quot;Object&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;))&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.Name==params[1][0].substr(params[1][0].indexOf(&quot;:&quot;)+1))&#xA;			diagramObject1=diagramObject; &#xA;		//XevRv, XivRv, XviRv-brakuje nazwy z obiektu&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;(params[1][0]==&quot;&quot;||params[1][0]==&quot; &quot;)&amp;&amp;&#xA;			(currElement.Type==&quot;Event&quot;||currElement.Type==&quot;Activity&quot;)&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;&amp;&amp;&#xA;			coto.Type==&quot;Activity&quot;&amp;&amp;coto.Name==currElement.Name+&quot; subprocess&quot;) //XevRv&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XevRv(name1), XivRv(name1), XviRv(name1)-brakuje nazwy z obiektu&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;0&amp;&amp; //without the class1&#xA;			(currElement.Type==&quot;Event&quot;||currElement.Type==&quot;Activity&quot;)&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;&amp;&amp;&#xA;			coto.Type==&quot;Activity&quot;&amp;&amp;coto.Name==params[1][0]) //XevRv(name1)&#xA;			diagramObject1=diagramObject; &#xA;		else {&#xA;			if(coto!=null)&#xA;				otherDiagObjects.push(diagramObject);&#xA;		}&#xA;		if (diagramObject1!=null)&#xA;			break;&#xA;	}&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	delement1 = null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Name==params[1][0] || //XiRi(name1), XiRi(name1), XevRv(name)&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;params[1][0]!=null&amp;&amp;params[1][0]!=&quot;&quot;&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;currentElement.Name==params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;))&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==params[1][0].substr(params[1][0].indexOf(&quot;:&quot;)+1) || //XiRi(name1:class1)&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;currentElement.Name==&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;params[1][0]!=null&amp;&amp;params[1][0]!=&quot;&quot;&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==params[1][0].substr(1) || //XiRi(:class1), XiRi(:class1)&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;currentElement.Name==&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]==&quot;&quot;)&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==currElement.Name|| //XeRi, XiRi for the Class, Event&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;currentElement.Name==&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]==&quot;&quot;)&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0&amp;&amp;currentElement.ClassifierID==currElement.ClassifierID || //XeRi, XiRi for the instance&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;&amp;&amp;currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Type==&quot;Activity&quot;&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]==&quot;&quot;)&amp;&amp;currentElement.Name==currElement.Name+&quot; subprocess&quot; || //XevRv, XivRv&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;&amp;&amp;currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Type==&quot;Activity&quot;&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]==&quot;&quot;)&amp;&amp;currElement.Name==&quot;&quot;&amp;&amp;currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0&amp;&amp;currentElement.Name==(Repository.GetElementByID(currElement.ClassifierID)).Name+&quot; subprocess&quot; ) //XviRv&#xA;			delement1=currentElement;&#xA;		//else&#xA;		//	if(currentElement!=null)&#xA;		//		otherElements.push(currentElement);&#xA;		if(delement1!=null)&#xA;			break;&#xA;	}&#xA;	if(delement1==null) { //There is no element1 in the package, but this element could have been placed in the R diagram via a link from the package containing the X diagram&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;e&quot;) { &#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;) {&#xA;					//Xe(name1)Re(name2)&#xA;					testElement = subPackage.Elements.AddNew( params[1][0], &quot;Event&quot; ); //&quot;Event&quot; to jest &quot;Signal&quot;&#xA;					testElement.Subtype=1; //Receive&#xA;					if(currElement!=null) {&#xA;						//an aggregation to the event from diagram X should be created&#xA;						// Create a connector between the two elements&#xA;						var connector = testElement.Connectors.AddNew(&quot;&quot;, &quot;Aggregation&quot;);&#xA;						connector.SupplierID = currElement.ElementID;&#xA;						connector.Update();&#xA;						//testElement.Connectors.Refresh;&#xA;					}&#xA;					connectorCR = testElement.Connectors.AddNew(consistencyRule, &quot;Dependency&quot;);&#xA;					connectorCR.SupplierID = testElement.ElementID;&#xA;					connectorCR.ClientID = currElement.ElementID;&#xA;					connectorCR.Update();&#xA;					testElement.Update();&#xA;					diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				} else&#xA;					Session.Output(&quot;Line 2265, params, conns:&quot;+params+&quot;\n&quot;+currElement.Name);&#xA;			} else&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;) { &#xA;				var nameOfObject;&#xA;				var nameOfClass;&#xA;				var identOfClass=null;&#xA;				//in the one case object element does not have parent class&#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;params[1][0].length) { //XiRi(name1:class1)&#xA;					//what about the case &quot;Xevi(:Request)Revi(:Request)&quot; ?&#xA;					nameOfObject=params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;));&#xA;				    nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				} else if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;0) { //XiRi(:class1)&#xA;					nameOfObject=params[1][0];&#xA;				    if(nameOfObject==params[0][0]) { //should be the class of element with name in params[0][0] on the X diagram&#xA;						if(currElement.ClassfierID!=null&amp;&amp;currElement.ClassfierID&gt;0)&#xA;							identOfClass=currElement.ClassfierID;		&#xA;						else					&#xA;							nameOfClass=&quot; &quot;; //object without of the class&#xA;					} else&#xA;						if(currElement!=null&amp;&amp;currElement.Type==&quot;Object&quot;&amp;&amp;currElement.ClassfierID&gt;0) &#xA;							identOfClass=currElement.ClassfierID;&#xA;						else	&#xA;						if(currElement!=null&amp;&amp;(currElement.Type==&quot;Class&quot;||currElement.Type==&quot;Event&quot;)) &#xA;							identOfClass=currElement.ElementID;&#xA;						else&#xA;							nameOfClass=&quot; &quot;; //object without of the class&#xA;				} else if(params[1][0]!=null&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;-1) { ////XiRi(name1:class1)&#xA;					nameOfObject=&quot;&quot;;&#xA;					nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				} else {&#xA;					nameOfObject=&quot;&quot;;&#xA;					if(currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0)&#xA;						identOfClass=currElement.ClassifierID;&#xA;					else&#xA;					if(currElement.Type==&quot;Class&quot;) &#xA;						nameOfClass=&quot;:&quot;+currElement.Name;		&#xA;					else&#xA;					if(correctCR.substr(correctCR.indexOf(&quot;X&quot;)+1,1)==&quot;e&quot;)&#xA;						nameOfClass=&quot;:&quot;+currElement.Name;&#xA;					else&#xA;						nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				}&#xA;				if(params[3][0]!=&quot;&quot;&amp;&amp;params[3][0]!=&quot; &quot;)  //the state of the object must be set&#xA;					nameOfObject=nameOfObject+&quot;[&quot;+params[3][0]+&quot;]&quot;;					&#xA;				testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; );&#xA;				if(identOfClass!=null)&#xA;					testElement.ClassifierID=identOfClass;&#xA;				else&#xA;				if(nameOfClass.substr(0,1)==&quot;:&quot;) {&#xA;					//new class - can we look at the class with the same name earlier?&#xA;					nameOfClass=nameOfClass.substr(1);&#xA;					coto=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(coto==null) {&#xA;						testClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					} else {&#xA;						testClass = coto;&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					}&#xA;				} else if(nameOfClass==&quot; &quot;) {&#xA;					//without the class&#xA;					nameOfClass=&quot; &quot;;&#xA;				} else {&#xA;					if(currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0)&#xA;						testElement.ClassifierID=currElement.ClassifierID;&#xA;				}&#xA;				connectorCR = testElement.Connectors.AddNew(consistencyRule, &quot;Dependency&quot;);&#xA;				connectorCR.SupplierID = testElement.ElementID;&#xA;				connectorCR.ClientID = currElement.ElementID;&#xA;				connectorCR.Update();&#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is the object from the X diagram&#xA;			} else&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;) { //XevRv, XivRv, XviRv&#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot; || params[1][0]!=null&amp;&amp;params[1][0]==&quot; &quot;) {&#xA;					//XevRv(name2) || XevRv&#xA;					var nameOfProcess;&#xA;					if(params[1][0]!=null&amp;&amp;params[1][0]==&quot; &quot;) &#xA;						if(currElement.Name!=&quot;&quot;)&#xA;							nameOfProcess = currElement.Name +&quot; subprocess&quot;; //sprawdzi&#263; jeszcze czy currElement nie jest instancj&#261;&#xA;						else&#xA;							if(currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0)&#xA;								nameOfProcess = (Repository.GetElementByID(currElement.ClassifierID)).Name +&quot; subprocess&quot;; &#xA;							else&#xA;								nameOfProcess = &quot;Unknown subprocess&quot;;&#xA;					else&#xA;						nameOfProcess = params[1][0];						&#xA;					testElement = subPackage.Elements.AddNew( nameOfProcess, &quot;Activity&quot; );&#xA;					testElement.Stereotype=&quot;process&quot;;&#xA;					testElement.StereotypeEx=&quot;process&quot;;&#xA;					connectorCR = testElement.Connectors.AddNew(consistencyRule, &quot;Dependency&quot;);&#xA;					connectorCR.SupplierID = testElement.ElementID;&#xA;					connectorCR.ClientID = currElement.ElementID;&#xA;					connectorCR.Update();&#xA;					testElement.Update();&#xA;					diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				} else&#xA;					Session.Output(&quot;Line 2362, params, conns:&quot;+params+&quot;\n&quot;+currElement.Name);&#xA;			}			&#xA;			delement1=testElement;&#xA;		} else &#xA;			delement1=currElement;&#xA;	} else {&#xA;		var connectorsCR = delement1.Connectors;&#xA;		for(i=0;i&lt;connectorsCR.Count;i++) {&#xA;			var connCR = connectorsCR.GetAt(i);&#xA;			if(connCR.Type==&quot;Dependency&quot;&amp;&amp;connCR.Name==consistencyRule&amp;&amp;connCR.SupplierID==delement1.ElementID&amp;&amp;connCR.ClientID == currElement.ElementID)&#xA;				connectorCR=connCR;&#xA;			if(connectorCR!=null)&#xA;				break;&#xA;		}&#xA;		if(connectorCR==null) {&#xA;			connectorCR = delement1.Connectors.AddNew(consistencyRule, &quot;Dependency&quot;);&#xA;			connectorCR.SupplierID = delement1.ElementID;&#xA;			connectorCR.ClientID = currElement.ElementID;&#xA;			connectorCR.Update();&#xA;			delement1.Update();&#xA;			// Get diagram links&#xA;			currentDiagramLinks = testDiagram.DiagramLinks;	&#xA;			for(var i = 0; i&lt;testDiagram.DiagramLinks.Count; i++) {&#xA;				var currentLink as EA.DiagramLink;&#xA;				currentLink = currentDiagramLinks.GetAt( i );&#xA;				if (currentLink.ConnectorID ==  connectorCR.ConnectorID)&#xA;				{&#xA;					currentLink.IsHidden = true;&#xA;					currentLink.Update();&#xA;					break;&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	//Add elements to the diagram&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null&amp;&amp;&#xA;			(delement1.Type==&quot;Event&quot;||&#xA;		     delement1.Type==&quot;Object&quot; &amp;&amp; correctCR.substr(correctCR.indexOf(&quot;X&quot;)+1,1)==&quot;e&quot;)) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Event&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			// Get diagram links&#xA;			currentDiagramLinks = testDiagram.DiagramLinks;	&#xA;			for(var i = 0; i&lt;testDiagram.DiagramLinks.Count; i++) {&#xA;				var currentLink as EA.DiagramLink;&#xA;				currentLink = currentDiagramLinks.GetAt( i );&#xA;				if (currentLink.ConnectorID ==  connectorCR.ConnectorID)&#xA;				{&#xA;					currentLink.IsHidden = true;&#xA;					currentLink.Update();&#xA;					break;&#xA;				}&#xA;			}&#xA;		} else &#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Object&quot;) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			// Get diagram links&#xA;			currentDiagramLinks = testDiagram.DiagramLinks;	&#xA;			for(var i = 0; i&lt;testDiagram.DiagramLinks.Count; i++) {&#xA;				var currentLink as EA.DiagramLink;&#xA;				currentLink = currentDiagramLinks.GetAt( i );&#xA;				if (currentLink.ConnectorID ==  connectorCR.ConnectorID)&#xA;				{&#xA;					currentLink.IsHidden = true;&#xA;					currentLink.Update();&#xA;					break;&#xA;				}&#xA;			}&#xA;		} else&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Activity&quot;) {&#xA;			var left=400;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Activity&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			// Get diagram links&#xA;			currentDiagramLinks = testDiagram.DiagramLinks;	&#xA;			for(var i = 0; i&lt;testDiagram.DiagramLinks.Count; i++) {&#xA;				var currentLink as EA.DiagramLink;&#xA;				currentLink = currentDiagramLinks.GetAt( i );&#xA;				if (currentLink.ConnectorID ==  connectorCR.ConnectorID)&#xA;				{&#xA;					currentLink.IsHidden = true;&#xA;					currentLink.Update();&#xA;					break;&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from context diagram to business use case diagram&#xA;function createXBcomplex(correctCR, thePackage, parameters, connectors) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	&#xA;	conns = connectors;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;BUCD&quot;,&quot;&quot;);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	if(conns[0][2]!=null&amp;&amp;conns[0][2].Notes==&quot;instancja decyzji&quot;)&#xA;		Session.Output(&quot;coto&quot;);&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var i = 0, j=0 ; i &lt; diagramObjects.Count ; i++ )&#xA;	{&#xA;		var coto as EA.Element;&#xA;		var cotoParent as EA.Element;&#xA;&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID&gt;0)&#xA;			coto=Repository.GetElementByID(diagramObject.ElementID);&#xA;		else&#xA;			coto=null;&#xA;		if(coto.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(diagramObject1==null&amp;&amp;coto.Type==&quot;Actor&quot;&amp;&amp;coto.Name==params[1][0]) //verification of an existing element in the B diagram&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		if(diagramObject2==null&amp;&amp;coto.Type==&quot;UseCase&quot;&amp;&amp;coto.Name==params[1][1]) //verification of an existing element in the R diagram&#xA;			diagramObject2=diagramObject; &#xA;		else&#xA;			if(coto!=null)&#xA;				otherDiagObjects.push(diagramObject);&#xA;	}&#xA;	&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Name==params[1][0]&amp;&amp;currentElement.Type==&quot;Actor&quot; ) //XevBa()u&#xA;			delement1=currentElement;&#xA;		else 		&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Name==params[1][1]&amp;&amp;currentElement.Type==&quot;UseCase&quot;) //XevBau()&#xA;			delement2=currentElement;&#xA;		else&#xA;			if(currentElement!=null)&#xA;				otherElements.push(currentElement);&#xA;		if(delement1!=null&amp;&amp;delement2!=null)&#xA;			break;&#xA;	}&#xA;	if(delement1==null) { //There is no element1 in the package, but this element could have been placed in the R diagram via a link from the package containing the X diagram&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1,1)==&quot;a&quot;) { &#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;) {&#xA;					//XevBa(name2)u&#xA;					testElement = subPackage.Elements.AddNew( params[1][0], &quot;Actor&quot; ); &#xA;					testElement.Update();&#xA;					diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				} else {&#xA;					//XevBa()u&#xA;					if(conns[0][0]!=null&amp;&amp;conns[0][0].Name!=&quot;&quot;)&#xA;						testElement = subPackage.Elements.AddNew( conns[0][0].Name, &quot;Actor&quot; ); &#xA;					else if(conns[0][0]!=null&amp;&amp;conns[0][0].ClassifierID&gt;0)&#xA;						testElement = subPackage.Elements.AddNew((Repository.GetElementByID(conns[0][0].ClassifierID)).Name, &quot;Actor&quot; ); &#xA;					else					&#xA;						testElement = subPackage.Elements.AddNew( &quot;Actor&quot;, &quot;Actor&quot; ); 						&#xA;					testElement.Update();&#xA;					diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				} &#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement2==null) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+2,1)==&quot;u&quot;) { &#xA;				var nameOfUC = &quot;&quot;;&#xA;				if(params[1][1]==null||params[1][1]==&quot; &quot;)&#xA;					if(params[0][0]==null||params[0][0]==&quot; &quot;)&#xA;						nameOfUC = params[1][0] +&quot; service&quot;;&#xA;					else&#xA;						nameOfUC = params[0][0] + &quot; service&quot;;&#xA;				else&#xA;					nameOfUC = params[1][1] +&quot; service&quot;; //here you can verify otherElements with nameOfSub&#xA;				var foundElement as EA.Element;&#xA;				foundElement=null;&#xA;				for(i=0; i&lt;otherElements.length;i++) {&#xA;					if(otherElements[i].Type==&quot;UseCase&quot;&amp;&amp;otherElements[i].Name==nameOfUC) {&#xA;						foundElement=otherElements[i];&#xA;						break;&#xA;					}&#xA;				}&#xA;				if(foundElement!=null) {&#xA;					testElement=foundElement;&#xA;					var foundDiagramObject as EA.DiagramObject;&#xA;					foundDiagramObject=null;&#xA;					for(i=0;i&lt;otherDiagObjects.length;i++) {&#xA;						if(otherDiagObjects[i].ElementID==foundElement.ElementID) {&#xA;							foundDiagramObject=otherDiagObjects[i];&#xA;							break;&#xA;						}&#xA;					}&#xA;					if(foundDiagramObject!=null)&#xA;						diagramObject2=foundDiagramObject;						&#xA;				} else {&#xA;					testElement = subPackage.Elements.AddNew( nameOfUC, &quot;Use Case&quot; );&#xA;					testElement.Update();&#xA;				}&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} else &#xA;			delement2=conns[0][1];&#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;(conns[1][0]!=null||params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;conns[0][0]!=null&amp;&amp;params[1][0]!=conns[0][0].Name)) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	var newObj3=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Event&quot;) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Actor&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		} else &#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Object&quot;) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;UseCase&quot;) {&#xA;			var left=400;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;UseCase&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from process decomposition diagram to business use cases diagram&#xA;function createRBcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;BUCD&quot;,&quot;&quot;);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	//The first element&#xA;	if(params[1][0]==&quot;&quot;||params[1][0]==&quot; &quot;) { //empty element name &#xA;		//RevBa()u, ReviBa()ua, RviBa()u, RiviBa()ua&#xA;		if(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)  {//empty source element name&#xA;			//Re()vBa()u, Re()viBa()ua, Rv()iBa()u, Ri()viBa()ua&#xA;			if(conns[0][0]==null||conns[0][0].Name==&quot;&quot;) { //empty source diagram element name&#xA;				//Re()vBa()u/Event:(no name), Re()viBa()ua/Event:(no name), Rv()iBa()u/Action:(no name), Ri()viBa()ua/Object:(no name)&#xA;				if(conns[0][0]!=null&amp;&amp;conns[0][0].ClassifierID&gt;0)&#xA;					nameElement1=(Repository.GetElementByID(conns[0][0].ClassifierID)).Name; &#xA;				else&#xA;					if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;) //RviBau&#xA;						nameElement1=&quot;UC service&quot;;&#xA;					else&#xA;						nameElement1=&quot;Actor&quot;; //Revbau, ReviBaua, RiviBaua&#xA;			} else { //the source diagram element has a name&#xA;				//Re()vBa()u/Event:name, Re()viBa()ua/Event:name, Rv()iBa()u/Action:name, Ri()viBa()ua/Object:name&#xA;				nameElement1=conns[0][0].Name;&#xA;			}&#xA;		} else if(params[0][0].substr(0,1)==&quot;:&quot;) { //the source element name has only class type&#xA;			//Re(:class)vBa()u, Re(:class)viBa()ua, Rv(:class)iBa()u, Ri(:class)viBa()ua&#xA;			nameElement1=params[0][0];&#xA;		} else { //the source element can have a complex name&#xA;			if(params[0][0].indexOf(&quot;:&quot;)&gt;0)&#xA;				nameElement1=params[0][0].substr(0,params[0][0].indexOf(&quot;:&quot;));&#xA;			else&#xA;				nameElement1=params[0][0];&#xA;		}&#xA;	} else if(params[1][0].substr(0,1)==&quot;:&quot;) { //the element name has only class type&#xA;		//RevBa(:class)u, ReviBa(:class)ua, RviBa(:class)u, RiviBa(:class)ua&#xA;		nameElement1=params[1][0];&#xA;	} else { //the element can have a complex name&#xA;		//RevBa(name[state]:class)u, ReviBa(name[state]:class)ua, RviBa(name[state]:class)u, RiviBa(name[state]:class)ua&#xA;		if(params[1][0].indexOf(&quot;:&quot;)&gt;0)&#xA;			nameElement1=params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;));&#xA;		else&#xA;			nameElement1=params[1][0];&#xA;	}&#xA;	//the second parameter&#xA;	if(params[1][1]==&quot;&quot;||params[1][1]==&quot; &quot;) { //empty element name &#xA;		//RevBa()u, ReviBa()ua, RviBa()u, RiviBa()ua&#xA;		if(params[0][1]==&quot;&quot;||params[0][1]==&quot; &quot;)  {//empty source element name&#xA;			//Re()vBa()u, Re()viBa()ua, Rv()iBa()u, Ri()viBa()ua&#xA;			if(conns[0][1]==null||conns[0][1].Name==&quot;&quot;) { //empty source diagram element name&#xA;				//Re()vBa()u/Event:(no name), Re()viBa()ua/Event:(no name), Rv()iBa()u/Action:(no name), Ri()viBa()ua/Object:(no name)&#xA;				if(conns[0][1]!=null&amp;&amp;conns[0][1].ClassifierID&gt;0)&#xA;					nameElement2=(Repository.GetElementByID(conns[0][1].ClassifierID)).Name; &#xA;				else&#xA;					if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+2,1)==&quot;v&quot;) //Revbau, ReviBaua, RiviBaua&#xA;						nameElement1=&quot;UC service&quot;;&#xA;					else&#xA;						nameElement1=&quot;Actor&quot;; //RviBau&#xA;			} else { //the source diagram element has a name&#xA;				//Re()vBa()u/Event:name, Re()viBa()ua/Event:name, Rv()iBa()u/Action:name, Ri()viBa()ua/Object:name&#xA;				nameElement2=conns[0][1].Name;&#xA;			}&#xA;		} else if(params[0][1].substr(0,1)==&quot;:&quot;) { //the source element name has only class type&#xA;			//Re(:class)vBa()u, Re(:class)viBa()ua, Rv(:class)iBa()u, Ri(:class)viBa()ua&#xA;			nameElement2=params[0][1];&#xA;		} else { //the source element can have a complex name&#xA;			if(params[0][1].indexOf(&quot;:&quot;)&gt;0)&#xA;				nameElement2=params[0][1].substr(0,params[0][1].indexOf(&quot;:&quot;));&#xA;			else&#xA;				nameElement2=params[0][1];&#xA;		}&#xA;	} else if(params[1][1].substr(0,1)==&quot;:&quot;) { //the element name has only class type&#xA;		//RevBa(:class)u, ReviBa(:class)ua, RviBa(:class)u, RiviBa(:class)ua&#xA;		nameElement2=params[1][1];&#xA;	} else { //the element can have a complex name&#xA;		//RevBa(name[state]:class)u, ReviBa(name[state]:class)ua, RviBa(name[state]:class)u, RiviBa(name[state]:class)ua&#xA;		if(params[1][1].indexOf(&quot;:&quot;)&gt;0)&#xA;			nameElement2=params[1][1].substr(0,params[1][1].indexOf(&quot;:&quot;));&#xA;		else&#xA;			nameElement2=params[1][1];&#xA;	}&#xA;	//the third element&#xA;	if(params[1][2]==&quot;&quot;||params[1][2]==&quot; &quot;) { //empty element name &#xA;		//RevBa()u, ReviBa()ua, RviBa()u, RiviBa()ua&#xA;		if(params[0][2]==&quot;&quot;||params[0][2]==&quot; &quot;)  {//empty source element name&#xA;			//Re()vBa()u, Re()viBa()ua, Rv()iBa()u, Ri()viBa()ua&#xA;			if(conns[0][2]==null||conns[0][2].Name==&quot;&quot;) { //empty source diagram element name&#xA;				//Re()vBa()u/Event:(no name), Re()viBa()ua/Event:(no name), Rv()iBa()u/Action:(no name), Ri()viBa()ua/Object:(no name)&#xA;				if(conns[0][2]!=null&amp;&amp;conns[0][2].ClassifierID&gt;0)&#xA;					nameElement3=(Repository.GetElementByID(conns[0][2].ClassifierID)).Name; &#xA;				else&#xA;					if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+3,1)==&quot;v&quot;) //RvivBaua&#xA;						nameElement3=&quot;UC service&quot;;&#xA;					else&#xA;					if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+3,1)!=&quot;B&quot;) //not RviBau&#xA;						nameElement3=&quot;Actor&quot;; &#xA;			} else { //the source diagram element has a name&#xA;				//Re()vBa()u/Event:name, Re()viBa()ua/Event:name, Rv()iBa()u/Action:name, Ri()viBa()ua/Object:name&#xA;				nameElement3=conns[0][2].Name;&#xA;			}&#xA;		} else if(params[0][2].substr(0,1)==&quot;:&quot;) { //the source element name has only class type&#xA;			//Re(:class)vBa()u, Re(:class)viBa()ua, Rv(:class)iBa()u, Ri(:class)viBa()ua&#xA;			nameElement3=params[0][2];&#xA;		} else { //the source element can have a complex name&#xA;			if(params[0][2].indexOf(&quot;:&quot;)&gt;0)&#xA;				nameElement3=params[0][2].substr(0,params[0][2].indexOf(&quot;:&quot;));&#xA;			else&#xA;				nameElement3=params[0][2];&#xA;		}&#xA;	} else if(params[2][0].substr(0,1)==&quot;:&quot;) { //the element name has only class type&#xA;		//RevBa(:class)u, ReviBa(:class)ua, RviBa(:class)u, RiviBa(:class)ua&#xA;		nameElement3=params[1][2];&#xA;	} else { //the element can have a complex name&#xA;		//RevBa(name[state]:class)u, ReviBa(name[state]:class)ua, RviBa(name[state]:class)u, RiviBa(name[state]:class)ua&#xA;		if(params[1][2].indexOf(&quot;:&quot;)&gt;0)&#xA;			nameElement3=params[1][2].substr(0,params[1][2].indexOf(&quot;:&quot;));&#xA;		else&#xA;			nameElement3=params[1][2];&#xA;	}&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var i = 0, j=0 ; i &lt; diagramObjects.Count ; i++ )&#xA;	{&#xA;		var coto as EA.Element;&#xA;		var cotoParent as EA.Element;&#xA;&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID&gt;0)&#xA;			coto=Repository.GetElementByID(diagramObject.ElementID);&#xA;		else&#xA;			coto=null;&#xA;		if(coto.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(diagramObject1==null&amp;&amp;(coto.Name==nameElement1)) //verification of an existing element in the B diagram&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		if(diagramObject2==null&amp;&amp;(coto.Name==nameElement2)) //verification of an existing element in the B diagram&#xA;			diagramObject2=diagramObject; &#xA;		else&#xA;		if(diagramObject3==null&amp;&amp;(coto.Name==nameElement3)) //verification of an existing element in the B diagram&#xA;			diagramObject3=diagramObject; &#xA;		else&#xA;			if(coto!=null)&#xA;				otherDiagObjects.push(diagramObject);&#xA;	}&#xA;	&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;(currentElement.Name==nameElement1)) //RevBa()u&#xA;			delement1=currentElement;&#xA;		else 		&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;(currentElement.Name==nameElement2)) //RevBau()&#xA;			delement2=currentElement;&#xA;		else&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;(currentElement.Name==nameElement3)) //ReviBaua()&#xA;			delement3=currentElement;&#xA;		else&#xA;			if(currentElement!=null)&#xA;				otherElements.push(currentElement);&#xA;		if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;delement3!=null)&#xA;			break;&#xA;	}&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1,1)==&quot;a&quot;) { //RevBau, ReviBaua, RviBau&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Actor&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+2,1)==&quot;u&quot;) { //RevBau, ReviBaua, RviBau&#xA;				var nameOfUC = nameElement2; &#xA;				testElement = subPackage.Elements.AddNew( nameOfUC, &quot;Use Case&quot; );&#xA;				testElement.Update();&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	if(delement3==null&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;B&quot;)).length&gt;3&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { //ReviBaua&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+3,1)==&quot;a&quot;) { &#xA;				testElement = subPackage.Elements.AddNew( nameElement3, &quot;Actor&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject3=null; //diagramObject1 is not already a previously created element&#xA;			} &#xA;			delement3=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Association&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID||&#xA;				 connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement2.ElementID)) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement3!=null&amp;&amp;delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement3.Connectors.Count;i++) {&#xA;			connector1=delement3.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Association&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement3.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID||&#xA;				 connector1.SupplierID==delement3.ElementID&amp;&amp;connector1.ClientID==delement2.ElementID)) {				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement3.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	var newObj3=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Actor&quot;) {&#xA;			var left=50;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Actor&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		} else &#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;UseCase&quot;) {&#xA;			var left=50;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;UseCase&quot;) {&#xA;			var left=150;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;UseCase&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Actor&quot;) {&#xA;			var left=300;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Actor&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1!=null&amp;&amp;diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1!=null&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		} else &#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;UseCase&quot;) {&#xA;			var left=300;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;UseCase&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;UseCase&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1!=null&amp;&amp;diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1!=null&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from business use cases diagram to business process diagram &#xA;function createBAcomplex(correctCR, thePackage, parameters, connectors) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var subChildPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var desiredDiagObjects = [ null,null]; //[ null,null,null]&#xA;	var desiredPackElements = [ null,null]; //[ null,null,null]&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var activityPartitions = [];&#xA;&#xA;	&#xA;	//BauApv - it is the first and only rule&#xA;	//This means, that the conns array contains only the first two elements, and the params array contains only the first two elements&#xA;	conns = connectors;&#xA;	params = parameters;&#xA;	//BauApv-conns[0][1] means this parameter must contain an existing element - Use Case&#xA;	if(conns[0][1]==null||conns[0][1].Name==&quot;&quot;||conns[0][1].Name==&quot; &quot;)&#xA;		return;&#xA;	//retrieving the Business Use Case Realization package and the first diagram&#xA;	packages=getTargetPackage(thePackage,&quot;BURD&quot;, conns[0][1].Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	//the Business Use Case Realization package&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	//Setting the names of the desired elements&#xA;	//The first element&#xA;	var nameOfElement1=&quot;&quot;;&#xA;	var nameOfElement2=&quot;&quot;;&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+2,1)==&quot;u&quot;) {//BauApv&#xA;		nameOfElement1=&quot;Partition&quot;;&#xA;		nameOfElement2=&quot;UC service&quot;;&#xA;	} else { //BuaApv&#xA;		nameOfElement2=&quot;Partition&quot;;&#xA;		nameOfElement1=&quot;UC service&quot;;&#xA;	}&#xA;	//setting values ??in rule parameters&#xA;	nameElement1=setParameterValue(parameters, connectors, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, connectors, 1, nameOfElement2, 0);&#xA;	//pattern-driven rule in nameElement2 - BauApv({pattern})&#xA;	if(nameElement2.substr(0,1)==&quot;{&quot; &amp;&amp; nameElement2.substr(nameElement2.length-1,1)==&quot;}&quot;) {&#xA;		var namePattern=nameElement2.substr(1);&#xA;		namePattern=namePattern.substr(0,namePattern.length-1);		&#xA;		// Fetch XML content from URL&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;);&#xA;		////xhr.open(&quot;GET&quot;, &quot;https://drive.google.com/file/d/1OJBEgCy2wvpilXtfxcCE4_aEa9RDqwlV/view?usp=drive_link&quot;, false);&#xA;		//xhr.open(&quot;GET&quot;, &quot;https://drive.google.com/file/d/1c_UR4o6S7Wcq9QTAfM_Tk_B30vUj79Ag/view&quot;,false);&#xA;		//xhr.open(&quot;GET&quot;, &quot;https://drive.google.com/file/d/1OJBEgCy2wvpilXtfxcCE4_aEa9RDqwlV/view&quot;, false);&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		var nameOfPckg = &quot;&quot;;&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			//retrieve package name&#xA;			nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;);&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			//retrieve partition names&#xA;			activityPartitions=retrieveXMLNames(xmlContent, &quot;ActivityPartition&quot;, &quot;alias&quot;, &quot;UML:ActionState name=&quot;,0);&#xA;			activityPartitions=activityPartitions.sort();&#xA;			//var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);&#xA;			//var tempFile = fso.GetSpecialFolder(2) + &quot;\\temp.xmi&quot;;&#xA;			//var file = fso.CreateTextFile(tempFile, true);&#xA;			//file.Write(xmlContent);&#xA;			//file.Close();&#xA;			var project = Repository.GetProjectInterface();&#xA;			//Import the XMI file into the current model, download package content to subpackage&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1);&#xA;			subPackage.Packages.Refresh();&#xA;			// Clean up the temporary file&#xA;			//fso.DeleteFile(tempFile);	&#xA;			if(result==null)&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null)&#xA;				return;&#xA;			//Rename partitions according to the values ??given in the partition rule parameter&#xA;			renamePatternPartitions(nameElement1, conns[0][1], activityPartitions, subChildPackage);&#xA;			//moving elements from the changed pattern to the current package&#xA;			if(subChildPackage !=null)&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			return;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML for the pattern &lt;&quot;+namePattern+&quot; from URL: &quot; + xhr.statusText);&#xA;		}&#xA;		//var result = projectInterface.ImportPackageXMI(projectInterface.GUIDtoXML(subPackage.PackageGUID), &quot;C:\\Users\\jerzy\\Documents\\skrypty\\Patterns\\uc-ecs517.xml&quot;, 1, 1);&#xA;	}&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, null);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;	} &#xA;	&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, null);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];	&#xA;		activityPartitions = desiredPackElements[3];&#xA;	} &#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+1,1)==&quot;p&quot;) { //BauApv&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;ActivityPartition&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	var delement2new=false;&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;v&quot;) { //RevBau, ReviBaua, RviBau&#xA;				testElement = subPackage.Elements.AddNew( nameElement2, &quot;Activity&quot; ); &#xA;				testElement.ParentID=delement1.ElementID;&#xA;				testElement.Update();&#xA;				delement2new=true;&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	} else &#xA;	if(delement2!=null) {&#xA;		delement2.ParentID=delement1.ElementID;&#xA;		delement2.Update();&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;			connector=delement2.Connectors.GetAt(i);&#xA;			if(connector.Type==&quot;ObjectFlow&quot;) {&#xA;				if(connector.SupplierID!=null&amp;&amp; (Repository.GetElementByID(connector.SupplierID)).Type==&quot;Object&quot;) {&#xA;					var objectTmp = Repository.GetElementByID(connector.SupplierID);&#xA;					objectTmp.ParentID=delement1.ElementID;&#xA;					objectTmp.Update();&#xA;				} &#xA;			} else&#xA;			if(connector.Type==&quot;ControlFlow&quot;) {&#xA;				if(connector.ClientID&gt;0&amp;&amp;connector.ClientID!=delement2.ElementID) {&#xA;					var elementTmp = Repository.GetElementByID(connector.ClientID);&#xA;					if(elementTmp.Type==&quot;Event&quot;&amp;&amp;elementTmp.Subtype==1||elementTmp.Type==&quot;StateNode&quot;&amp;&amp;(elementTmp.Subtype==100||elementTmp.Subtype==3)) {&#xA;						elementTmp.ParentID=delement1.ElementID;&#xA;						elementTmp.Update();						&#xA;					}&#xA;				}&#xA;				else &#xA;				if(connector.SupplierID&gt;0&amp;&amp;connector.SupplierID!=delement2.ElementID) {&#xA;					var elementTmp = Repository.GetElementByID(connector.SupplierID);&#xA;					if(elementTmp.Type==&quot;StateNode&quot;&amp;&amp;elementTmp.Subtype==102||elementTmp.Type==&quot;StateNode&quot;&amp;&amp;elementTmp.Subtype==101||elementTmp.Type==&quot;Decision&quot;||elementTmp.Type==&quot;MergeNode&quot;||elementTmp.Type==&quot;Event&quot;&amp;&amp;elementTmp.Subtype==0) {&#xA;						elementTmp.ParentID=delement1.ElementID;&#xA;						elementTmp.Update();						&#xA;					}&#xA;				}&#xA;			}			&#xA;		}&#xA;	}&#xA;	var diagramObject1new=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;ActivityPartition&quot;) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			if(activityPartitions.length&gt;0&amp;&amp;activityPartitions[0][0]!=null)&#xA;				left=(activityPartitions[0][0]).left;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject=Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existDiagramObject.ElementID!=delement2.ElementID) {&#xA;					if(existDiagramObject.right&lt;left)&#xA;						left=existDiagramObject.right+50;&#xA;					//if(existElementObject.Type==&quot;ActivityPartition&quot;||existElementObject.ParentID==0) {&#xA;						if(existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;					//}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+350;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-100;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			diagramObject1new=true;&#xA;		} &#xA;	}&#xA;	var left=diagramObject1.left;&#xA;	var top=diagramObject1.top-(diagramObject1.top-diagramObject1.bottom)/2+23;&#xA;	if(diagramObject2==null) {&#xA;		var diagramObjects as EA.Collection;&#xA;		&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;Activity&quot;||delement2.Type==&quot;Action&quot;)) {&#xA;			if(delement2.ParentID==delement1.ElementID) {&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;		&#xA;				//if there are other elements in the partition, we should set the left edge of the action to the right of the last element of the partition&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null&amp;&amp;existElementObject.ParentID==delement1.ElementID&amp;&amp;&#xA;						(existElementObject.Type==&quot;Activity&quot;||existElementObject.Type==&quot;Action&quot;||existElementObject.Type==&quot;Object&quot;||&#xA;						 existElementObject.Type==&quot;Event&quot;||existElementObject.Type==&quot;StateNode&quot;||existElementObject.Type==&quot;Decision&quot;||existElementObject.Type==&quot;MergeNode&quot;)) {&#xA;						if(existDiagramObject.left&gt;diagramObject1.left&amp;&amp;existDiagramObject.right&lt;diagramObject1.right&amp;&amp;existDiagramObject.top&lt;diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;diagramObject1.bottom&amp;&amp;existDiagramObject.left&gt;left)&#xA;							left=existDiagramObject.right;&#xA;					}&#xA;				}				&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2new) { //new &quot;Action&quot; element&#xA;				testDiagramObject.left=left+25;&#xA;				testDiagramObject.right=left+100;&#xA;				testDiagramObject.top=top;  //-15;&#xA;				testDiagramObject.bottom=top-45;  //-60;&#xA;				testDiagramObject.Update();&#xA;			} else { //old &quot;Action&quot; element, but not in the diagram&#xA;				var left1=setLeftBorderOfPartition(diagramObjects, diagramObject1);&#xA;				if(left1&gt;left)&#xA;					left=left1;&#xA;				testDiagramObject.left=left+100;&#xA;				testDiagramObject.right=left+175;&#xA;				testDiagramObject.top=top;  //-15;&#xA;				testDiagramObject.bottom=top-45;  //-60;&#xA;				testDiagramObject.Update();&#xA;				placingElementOfAction(delement2, diagramObjects, diagramObject1, testDiagramObject,1); &#xA;			}			&#xA;			diagramObject2=testDiagramObject;&#xA;		} &#xA;	} else { &#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;Activity&quot;||delement2.Type==&quot;Action&quot;)) {&#xA;			if(delement2.ParentID==delement1.ElementID) { //if delement2 is the part of the partition&#xA;				//if delement2 is placed outside the partition&#xA;				if(diagramObject2.left&lt;diagramObject1.left||diagramObject2.right&gt;diagramObject1.right|| &#xA;					diagramObject2.top&gt;diagramObject1.top||diagramObject2.bottom&lt;diagramObject1.bottom) {&#xA;					//setting the left border inside the partition	&#xA;					var left1=setLeftBorderOfPartition(diagramObjects, diagramObject1);&#xA;					if(left1&gt;left)&#xA;						left=left1;&#xA;					diagramObject2.left=left+100;&#xA;					diagramObject2.right=left+175;&#xA;					diagramObject2.top=top;  //-15;&#xA;					diagramObject2.bottom=top-45;  //-60;&#xA;					diagramObject2.Update();&#xA;				}&#xA;				placingElementOfAction(delement2, diagramObjects, diagramObject1, diagramObject2,0); &#xA;			}&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Setting the left border inside the partition	&#xA;function setLeftBorderOfPartition(diagramObjects, diagramObject1) {&#xA;	var existDiagramObject as EA.DiagramObject;&#xA;	var existElementObject as EA.Element;	&#xA;	var left=0;&#xA;&#xA;	if(diagramObject1.right-diagramObject1.left&lt;200) { //if the partition width is less than 200 points&#xA;		diagramObject1.right=diagramObject1.left+200;&#xA;		diagramObject1.Update();&#xA;	}&#xA;	if(-diagramObject1.bottom+diagramObject1.top&lt;50) { //if the partition height is less than 50 points&#xA;		diagramObject1.bottom=diagramObject1.top-125;&#xA;		diagramObject1.Update();&#xA;	}&#xA;	//if there are other elements in the partition, we should set the left edge of the action to the right of the last element of the partition&#xA;	for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;		existDiagramObject=diagramObjects.GetAt(i);&#xA;		if(existDiagramObject.ElementID&gt;0)&#xA;			existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;		else&#xA;			existElementObject=null;&#xA;		if(existElementObject!=null&amp;&amp;existElementObject.Type!=&quot;ActivityPartition&quot;&amp;&amp;existElementObject.ParentID==diagramObject1.ElementID&amp;&amp;&#xA;			existDiagramObject.top&lt;=diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;=diagramObject1.bottom&amp;&amp;&#xA;			existDiagramObject.left&gt;=diagramObject1.left&amp;&amp;existDiagramObject.right&lt;=diagramObject1.right) {&#xA;			if(existDiagramObject.left&gt;left)&#xA;				left=existDiagramObject.right;&#xA;		}&#xA;	}	&#xA;	return left;&#xA;}&#xA;//placing elements connected to delement2 (diagramObject2) and possibly correcting the dimensions of the partition (diagramObject1)&#xA;//mode==1 for the unsaved diagramObject2&#xA;function placingElementOfAction(delement2, diagramObjects, diagramObject1, diagramObject2, mode) {&#xA;	var topObjectLeft=0;  //elements placed on the left side delement2&#xA;	var topObjectRight=0; //elements placed on the right side delement2&#xA;	var connector as EA.Connector;&#xA;	if(mode!=2) {&#xA;		topObjectLeft=diagramObject1.top;  //elements placed on the left side delement2&#xA;		topObjectRight=diagramObject1.top; //elements placed on the right side delement2&#xA;	} else {&#xA;		topObjectLeft=diagramObject2.top;  //elements placed on the left side delement2&#xA;		topObjectRight=diagramObject2.top; //elements placed on the right side delement2&#xA;	}&#xA;	connector=null;&#xA;	//placing elements to the left and right of delement2&#xA;	for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;		connector=delement2.Connectors.GetAt(i);&#xA;		if(connector.Type==&quot;ObjectFlow&quot;) { //object elements connected to delement2&#xA;			if(connector.SupplierID!=delement2.ElementID&amp;&amp; (Repository.GetElementByID(connector.SupplierID)).Type==&quot;Object&quot;) {&#xA;				var objectTmp = Repository.GetElementByID(connector.SupplierID);&#xA;				for(j=0;j&lt;diagramObjects.Count;j++) {&#xA;					var existDiagramObject=diagramObjects.GetAt(j);&#xA;					if(existDiagramObject.ElementID==objectTmp.ElementID) {&#xA;						var widthTmp=existDiagramObject.right-existDiagramObject.left;&#xA;						var heightTmp=-existDiagramObject.bottom+existDiagramObject.top;&#xA;						if(mode!=2) {&#xA;							if(topObjectRight-heightTmp&lt;diagramObject1.bottom) {&#xA;								diagramObject1.bottom=diagramObject1.bottom-heightTmp;&#xA;								diagramObject1.Update();&#xA;							}&#xA;							if(diagramObject2.right+40+widthTmp&gt;diagramObject1.right) {&#xA;								diagramObject1.right=diagramObject2.right+40+widthTmp;&#xA;								diagramObject1.Update();&#xA;							}			&#xA;						}						&#xA;						existDiagramObject.left=diagramObject2.right+40;&#xA;						existDiagramObject.right=existDiagramObject.left+widthTmp;&#xA;						existDiagramObject.top=topObjectRight-3;&#xA;						existDiagramObject.bottom=existDiagramObject.top-heightTmp;&#xA;						topObjectRight=topObjectRight-heightTmp;&#xA;						existDiagramObject.Update();&#xA;						break;&#xA;					}&#xA;				}	&#xA;			} &#xA;		} else&#xA;		if(connector.Type==&quot;ControlFlow&quot;) { //elements connected to delement2&#xA;			if(connector.ClientID!=delement2.ElementID) {&#xA;				var elementTmp = Repository.GetElementByID(connector.ClientID);&#xA;				//Event&amp;InitialNode elements&#xA;				if(elementTmp.Type==&quot;Event&quot;&amp;&amp;elementTmp.Subtype==1||elementTmp.Type==&quot;StateNode&quot;&amp;&amp;(elementTmp.Subtype==100||elementTmp.Subtype==3)) {&#xA;					for(j=0;j&lt;diagramObjects.Count;j++) {&#xA;						var existDiagramObject=diagramObjects.GetAt(j);&#xA;						if(existDiagramObject.ElementID==elementTmp.ElementID) {&#xA;							var widthTmp=existDiagramObject.right-existDiagramObject.left;&#xA;							var heightTmp=-existDiagramObject.bottom+existDiagramObject.top;&#xA;							if(mode!=2) {&#xA;								if(topObjectRight-heightTmp&lt;diagramObject1.bottom) {&#xA;									diagramObject1.bottom=diagramObject1.bottom-heightTmp;&#xA;									diagramObject1.Update();&#xA;								}&#xA;							}&#xA;							existDiagramObject.left=diagramObject2.left-70; //40;&#xA;							existDiagramObject.right=existDiagramObject.left+widthTmp;&#xA;							if(elementTmp.Type==&quot;StateNode&quot;&amp;&amp;(elementTmp.Subtype==100||elementTmp.Subtype==3)&amp;&amp;topObjectLeft-3&gt;diagramObject2.top) {&#xA;								existDiagramObject.top=diagramObject2.top-(-diagramObject2.bottom+diagramObject2.top)/2+heightTmp/2;										&#xA;							} else &#xA;								existDiagramObject.top=topObjectLeft-3;&#xA;							existDiagramObject.bottom=existDiagramObject.top-heightTmp;&#xA;							topObjectLeft=topObjectLeft-heightTmp;&#xA;							existDiagramObject.Update();&#xA;							break;&#xA;						}&#xA;					}	&#xA;				}&#xA;			}&#xA;			else &#xA;			if(connector.SupplierID&gt;0&amp;&amp;connector.SupplierID!=delement2.ElementID) {&#xA;				var elementTmp = Repository.GetElementByID(connector.SupplierID);&#xA;				//Final&amp;ActivityFinal, Decision, Merge, Signal elements&#xA;				if(elementTmp.Type==&quot;StateNode&quot;&amp;&amp;elementTmp.Subtype==101||elementTmp.Type==&quot;StateNode&quot;&amp;&amp;elementTmp.Subtype==102||elementTmp.Type==&quot;Decision&quot;||elementTmp.Type==&quot;MergeNode&quot;||elementTmp.Type==&quot;Event&quot;&amp;&amp;elementTmp.Subtype==0) {&#xA;					for(j=0;j&lt;diagramObjects.Count;j++) {&#xA;						var existDiagramObject=diagramObjects.GetAt(j);&#xA;						if(existDiagramObject.ElementID==elementTmp.ElementID) {&#xA;							var widthTmp=existDiagramObject.right-existDiagramObject.left;&#xA;							var heightTmp=-existDiagramObject.bottom+existDiagramObject.top;&#xA;							if(mode!=2) {&#xA;								if(topObjectRight-heightTmp&lt;diagramObject1.bottom) {&#xA;									diagramObject1.bottom=diagramObject1.bottom-heightTmp;&#xA;									diagramObject1.Update();&#xA;								}	&#xA;								if(diagramObject2.right+40+widthTmp&gt;diagramObject1.right) {&#xA;									diagramObject1.right=diagramObject2.right+40+widthTmp;&#xA;									diagramObject1.Update();&#xA;								}&#xA;							}							&#xA;							existDiagramObject.left=diagramObject2.right+40;&#xA;							existDiagramObject.right=existDiagramObject.left+widthTmp;&#xA;							existDiagramObject.top=topObjectRight-3;&#xA;							existDiagramObject.bottom=existDiagramObject.top-heightTmp;&#xA;							topObjectRight=topObjectRight-heightTmp;&#xA;							existDiagramObject.Update();&#xA;							break;&#xA;						}&#xA;					}	&#xA;				}&#xA;			}&#xA;		}					&#xA;	}&#xA;	if(mode!=2) {&#xA;		var left=diagramObject1.right;&#xA;&#xA;		for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;			existDiagramObject=diagramObjects.GetAt(i);&#xA;			if(existDiagramObject.top&lt;diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;diagramObject1.bottom&amp;&amp;&#xA;				existDiagramObject.left&gt;diagramObject1.left&amp;&amp;existDiagramObject.right&lt;diagramObject1.right) {&#xA;				if(existDiagramObject.left&lt;left)&#xA;					left=existDiagramObject.left;&#xA;			}&#xA;		}&#xA;		//moving elements if there is too much empty space on the left&#xA;		if(left-diagramObject1.left&gt;100) {&#xA;			left=left-diagramObject1.left-50;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.top&lt;diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;diagramObject1.bottom&amp;&amp;&#xA;					existDiagramObject.left&gt;diagramObject1.left&amp;&amp;existDiagramObject.right&lt;diagramObject1.right) {&#xA;					existDiagramObject.left=existDiagramObject.left-left;&#xA;					existDiagramObject.right=existDiagramObject.right-left;&#xA;					existDiagramObject.Update();&#xA;				}&#xA;			}&#xA;			if(mode==1) {&#xA;				diagramObject2.left=diagramObject2.left-left;&#xA;				diagramObject2.right=diagramObject2.right-left;&#xA;				diagramObject2.Update();&#xA;			}&#xA;		}&#xA;	}&#xA;}&#xA;//Rename pattern partitions according to rule parameters or according to actors connected to the use case&#xA;function renamePatternPartitions(nameElement, useCase, activityPartitions, subChildPackage) {&#xA;	var tmpAct = [];&#xA;	var delements as EA.Collection;&#xA;	var currentElement as EA.Element;&#xA;	var tmpElement = &quot;&quot;;&#xA;	var tmpPartition = activityPartitions.length;&#xA;	&#xA;	tmpAct=getActorsofUseCase(nameElement, useCase, activityPartitions.length);&#xA;	delements = subChildPackage.Elements; //imported package&#xA;	//changing the partition names of the imported package according to the names in the rule parameter&#xA;	for(i=0;i&lt;tmpPartition;i++) {&#xA;		currentElement=getByName(delements,activityPartitions[i][1]);&#xA;		if(currentElement!=null) {&#xA;			if(tmpAct.length&gt;i) {&#xA;				tmpElement = tmpAct[i];&#xA;				if(tmpElement!=null&amp;&amp;tmpElement!=&quot;&quot;&amp;&amp;tmpElement!=&quot; &quot;) {&#xA;					currentElement.Name = tmpElement;&#xA;					currentElement.Update;&#xA;				} else &#xA;					return;&#xA;			} else&#xA;				return;&#xA;		} else&#xA;			return;&#xA;	}&#xA;	return;&#xA;}&#xA;//Rename pattern partitions according to rule parameters or according to actors connected to the use case&#xA;function renamePatternObjects(nameElement, subProcess, classObjects, activityPartitions, subPackage, subChildPackage) {&#xA;	var tmpObj = [];&#xA;	var impdElements as EA.Collection;  	//the imported package elements&#xA;	var currElements as EA.Collection;		//the current package elements&#xA;	var targetElements as EA.Collection;	//the target package elements&#xA;	var currentElement as EA.Element;&#xA;	&#xA;	//The tmpObj array contains single instances resulting from the rule parameters - the first row - the input object, the last row - the output object&#xA;	tmpObj=getObjectsofSubProcess(nameElement, subProcess, classObjects);&#xA;	tmpObj=tmpObj.sort();&#xA;	currElements = subPackage.Elements; //current package&#xA;	impdElements = subChildPackage.Elements; //imported package&#xA;	var otherElements=false; //if the imported package elements are in the current package elements&#xA;	for(i=0;i&lt;impdElements.Count();i++) {&#xA;		currentElement=impdElements.GetAt(i);&#xA;		if(getByAlias(currElements,currentElement.Alias)==null) { &#xA;			otherElements=true; //at least one item from the imported package is missing in the current package&#xA;			break;&#xA;		}&#xA;	}&#xA;	//The classObject array contains all instances from the imported package&#xA;	if(otherElements) //There are not imported partitions in the current package&#xA;		targetElements=impdElements;&#xA;	else { //There are imported partitions in the current package&#xA;		targetElements=impdElements;&#xA;		renamePackageObjects(subPackage, tmpObj, classObjects, targetElements);&#xA;		targetElements=currElements;&#xA;	}&#xA;	renamePackageObjects(subPackage, tmpObj, classObjects, targetElements);&#xA;	return otherElements;&#xA;}&#xA;//Rename object package properies in partitions according to names in the tmpObj&#xA;function renamePackageObjects(subPackage, tmpObjX, classObjectsX, targetElements) {&#xA;	var currentElement as EA.Element;&#xA;	var currentObject as EA.Element;&#xA;	var tmpObjects = tmpObjX.length;&#xA;	var inElementClass;&#xA;	var inElementName;&#xA;	var inClassElement as EA.Element;&#xA;	var outElementClass;&#xA;	var outElementName;&#xA;	var outClassElement as EA.Element;&#xA;	var tmpObj=tmpObjX.slice();&#xA;	var classObjects=classObjectsX.slice();&#xA;	&#xA;	inElementName=tmpObj[0][1].substr(0,tmpObj[0][1].indexOf(&quot;:&quot;));&#xA;	inElementClass=tmpObj[0][1].substr(tmpObj[0][1].indexOf(&quot;:&quot;)+1);&#xA;	if(inElementClass!=null&amp;&amp;inElementClass!=&quot;&quot;) {&#xA;		inClassElement=searchForElement(subPackage, inElementClass, &quot;Class&quot;);&#xA;		if(inClassElement==null)&#xA;			inClassElement=subPackage.Elements.AddNew(inElementClass, &quot;Class&quot;);&#xA;	}&#xA;	outElementName=tmpObj[tmpObjects-1][1].substr(0,tmpObj[tmpObjects-1][1].indexOf(&quot;:&quot;));&#xA;	outElementClass=tmpObj[tmpObjects-1][1].substr(tmpObj[tmpObjects-1][1].indexOf(&quot;:&quot;)+1);&#xA;	if(outElementClass!=null&amp;&amp;outElementClass!=&quot;&quot;) {&#xA;		outClassElement=searchForElement(subPackage, outElementClass, &quot;Class&quot;);&#xA;		if(outClassElement==null)&#xA;			outClassElement=subPackage.Elements.AddNew(outElementClass, &quot;Class&quot;);&#xA;	}&#xA;	for(var i=0; i&lt;targetElements.Count(); i++) {&#xA;		currentElement=targetElements.GetAt(i); //the first element&#xA;		if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;			for(var j=0; j&lt;currentElement.Elements.Count(); j++) {&#xA;				currentObject=currentElement.Elements.GetAt(j);&#xA;				if(currentObject.Type==&quot;Object&quot;) { &#xA;					var execute=false;&#xA;					if(currentObject.Tag.substr(0,7)==tmpObj[0][0]) {&#xA;						if(currentObject.Tag==classObjects[0][0]) {&#xA;							if(inElementName.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;inElementName.indexOf(&quot;]&quot;)&gt;0&amp;&amp;inElementName.indexOf(&quot;]&quot;)&gt;inElementName.indexOf(&quot;[&quot;)) {&#xA;								currentObject.Name=inElementName.substr(0,inElementName.indexOf(&quot;[&quot;));&#xA;							} else&#xA;								currentObject.Name=inElementName;&#xA;							var stateObject=inElementName.substr(inElementName.indexOf(&quot;[&quot;)+1);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;								stateObject=stateObject.substr(0,stateObject.indexOf(&quot;]&quot;));&#xA;								if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;									var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+currentObject.ElementID;&#xA;									execute=true;&#xA;								}&#xA;							}&#xA;						}&#xA;						currentObject.ClassifierID=inClassElement.ElementID;&#xA;						currentObject.Update();&#xA;						if(execute) //it works&#xA;							Repository.Execute(sqlCommand);&#xA;					} else&#xA;					if(currentObject.Tag.substr(0,7)==tmpObj[tmpObjects-1][0]) {&#xA;						if(currentObject.Tag==classObjects[classObjects.length-1][0]) {&#xA;							if(outElementName.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;outElementName.indexOf(&quot;]&quot;)&gt;0&amp;&amp;outElementName.indexOf(&quot;]&quot;)&gt;outElementName.indexOf(&quot;[&quot;)) {&#xA;								currentObject.Name=outElementName.substr(0,outElementName.indexOf(&quot;[&quot;));&#xA;							} else&#xA;								currentObject.Name=outElementName;&#xA;							var stateObject=outElementName.substr(outElementName.indexOf(&quot;[&quot;)+1);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;								stateObject=stateObject.substr(0,stateObject.indexOf(&quot;]&quot;));&#xA;								if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;									var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+currentObject.ElementID;&#xA;									execute=true;&#xA;								}&#xA;							}							&#xA;						}&#xA;						currentObject.ClassifierID=outClassElement.ElementID;&#xA;						currentObject.Update();&#xA;						if(execute) //it works&#xA;							Repository.Execute(sqlCommand);&#xA;					}					&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	if(tmpObj.length&gt;2) {&#xA;		var tmpObjElement=tmpObj.shift();&#xA;		while(tmpObj.length&gt;0&amp;&amp;tmpObj[0][0]==tmpObjElement[0][0])&#xA;			tmpObj.shift();&#xA;		if(tmpObj.length&gt;0) {&#xA;			tmpObjElement=tmpObj.pop();&#xA;			var tmpObjElement1=tmpObj[tmpObj.length-1][0];&#xA;			var tmpObjElement2=tmpObjElement[0];&#xA;			while(tmpObj.length&gt;0&amp;&amp;tmpObjElement1==tmpObjElement2)&#xA;				tmpObj.pop();&#xA;		}&#xA;		while(classObjects.length&gt;0&amp;&amp;classObjects[0][0].substr(0,7)==&quot;ObjectA&quot;)&#xA;			classObjects.shift();&#xA;		while(classObjects.length&gt;0&amp;&amp;classObjects[classObjects.length-1][0].substr(0,7)==&quot;ObjectZ&quot;)&#xA;			classObjects.pop();&#xA;		if(classObjects.length&gt;0&amp;&amp;tmpObj.length&gt;0) {&#xA;			while(tmpObj.length&gt;0) {&#xA;				inElementName=tmpObj[0][1].substr(0,tmpObj[0][1].indexOf(&quot;:&quot;));&#xA;				inElementClass=tmpObj[0][1].substr(tmpObj[0][1].indexOf(&quot;:&quot;)+1);&#xA;				if(inElementClass!=null&amp;&amp;inElementClass!=&quot;&quot;) {&#xA;					inClassElement=searchForElement(subPackage, inElementClass, &quot;Class&quot;);&#xA;					if(inClassElement==null)&#xA;						inClassElement=subPackage.Elements.AddNew(inElementClass, &quot;Class&quot;);&#xA;				}				&#xA;				outElementName=classObjects[0][0].substr(0,7);&#xA;				for(var i=0; i&lt;targetElements.Count(); i++) {&#xA;					currentElement=targetElements.GetAt(i); //the first element&#xA;					if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;						for(var j=0; j&lt;currentElement.Elements.Count(); j++) {&#xA;							currentObject=currentElement.Elements.GetAt(j);&#xA;							if(currentObject.Type==&quot;Object&quot;) { &#xA;								var execute=false;&#xA;								if(currentObject.Tag.substr(0,7)==outElementName) {&#xA;									if(currentObject.Tag==classObjects[0][0]) {&#xA;										if(inElementName.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;inElementName.indexOf(&quot;]&quot;)&gt;0&amp;&amp;inElementName.indexOf(&quot;]&quot;)&gt;inElementName.indexOf(&quot;[&quot;)) {&#xA;											currentObject.Name=inElementName.substr(0,inElementName.indexOf(&quot;[&quot;));&#xA;										} else&#xA;											currentObject.Name=inElementName;&#xA;										var stateObject=inElementName.substr(inElementName.indexOf(&quot;[&quot;)+1);&#xA;										if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;											stateObject=stateObject.substr(0,stateObject.indexOf(&quot;]&quot;));&#xA;											if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;												var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+currentObject.ElementID;&#xA;												execute=true;&#xA;											}&#xA;										}&#xA;									}&#xA;									currentObject.ClassifierID=inClassElement.ElementID;&#xA;									currentObject.Update();&#xA;									if(execute) //it works&#xA;										Repository.Execute(sqlCommand);&#xA;								} 					&#xA;							}&#xA;						}&#xA;					}&#xA;				}&#xA;				tmpObjElement=tmpObj.shift();&#xA;				while(tmpObj.length&gt;0&amp;&amp;tmpObj[0][0]==tmpObjElement)&#xA;					tmpObj.shift();				&#xA;				while(classObjects.length&gt;0&amp;&amp;classObjects[0][0].substr(0,7)==outElementName)&#xA;					classObjects.shift();&#xA;				if(classObjects.length&lt;=0)&#xA;					break;&#xA;			}&#xA;		}&#xA;	}&#xA;}&#xA;//Moving pattern elements from the imported package to the current package&#xA;function movePatternPackage(subPackage, subChildPackage) {&#xA;	var subElements as EA.Collection;&#xA;	var delements as EA.Collection;&#xA;	subElements = subPackage.Elements; //current package &#xA;	delements = subChildPackage.Elements; //imported package&#xA;	var moving = true;&#xA;	&#xA;	for ( var j = 0 ; j &lt; delements.Count() &amp;&amp; moving==true; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		var subPckElement as EA.Element;&#xA;		currentElement = delements.GetAt(j);&#xA;		for ( var k = 0; k &lt; subElements.Count(); k++) {&#xA;			subPckElement=subElements.GetAt(k);&#xA;			if(subPckElement.Type==currentElement.Type &amp;&amp;&#xA;				(subPckElement.Name==currentElement.Name || subPckElement.Alias==currentElement.Alias)) {&#xA;				moving=false;&#xA;				break;&#xA;			}&#xA;		}&#xA;	}&#xA;	if(moving) {&#xA;		for ( var j = 0 ; j &lt; delements.Count(); j++ )&#xA;		{&#xA;			var currentElement as EA.Element;&#xA;			currentElement = delements.GetAt(j);&#xA;			currentElement.PackageID=subPackage.PackageID;&#xA;			currentElement.Update();&#xA;		}&#xA;		subPackage.Diagrams.Refresh();&#xA;		var testDiagram = subChildPackage.Diagrams.GetAt(0);&#xA;		if(testDiagram!=null) {&#xA;			testDiagram.PackageID = subPackage.PackageID;&#xA;			testDiagram.ParentID=0;&#xA;			testDiagram.Update;&#xA;		}&#xA;	} else {  &#xA;		//You should check if the partition names are not the same as in the import package. &#xA;		//If so, it would be useful to change the partition names in the current directory to the ones imported by aliases.&#xA;		for ( var j = 0 ; j &lt; delements.Count() ; j++ )&#xA;		{&#xA;			var currentElement as EA.Element;&#xA;			var subPckElement as EA.Element; &#xA;			var changing = false;&#xA;			currentElement = delements.GetAt(j); //imported package&#xA;			for ( var k = 0; k &lt; subElements.Count(); k++) {&#xA;				subPckElement=subElements.GetAt(k); //current package&#xA;				if(subPckElement.Alias==currentElement.Alias &amp;&amp; subPckElement.Type==currentElement.Type) {&#xA;					changing=true;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(changing&amp;&amp;subPckElement.Name!=currentElement.Name) {&#xA;				subPckElement.Name=currentElement.Name;&#xA;				subPckElement.Update();&#xA;			}&#xA;		}&#xA;	}&#xA;}&#xA;//Return all actor names from 'nameElement' or if 'nameElement' values ??are less than 'nr', return all actor names connected to 'useCase'&#xA;function getActorsofUseCase(nameElement, useCase, nr) {&#xA;	var tmpA = [];&#xA;	var tmpA1 = [];&#xA;	var elUC as EA.Element;&#xA;&#xA;	if(nameElement!=null&amp;&amp;nameElement!=&quot;&quot;&amp;&amp;nameElement!=&quot; &quot;) {&#xA;		var tmpElement = nameElement;&#xA;		while(tmpElement.indexOf(&quot;,&quot;)&gt;0) {&#xA;			tmpA.push(tmpElement.substr(0,tmpElement.indexOf(&quot;,&quot;)));&#xA;			tmpElement=tmpElement.substr(tmpElement.indexOf(&quot;,&quot;)+1);&#xA;		}&#xA;		if(tmpElement!=null&amp;&amp;tmpElement!=&quot;&quot;) {&#xA;			tmpA.push(tmpElement);&#xA;		}&#xA;	}&#xA;	//if there are fewer elements in tmpElement than in activityPartitions - you can try to identify all actors connected to the use case (in the conn[0][1] array)&#xA;	if(nameElement==null||nameElement==&quot;&quot;||nameElement==&quot; &quot;||tmpA.length&lt;nr) {&#xA;		elUC=useCase;&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;elUC.Connectors.Count;i++) {&#xA;			connector=elUC.Connectors.GetAt(i);&#xA;			if(connector.Type==&quot;Association&quot;) {&#xA;				if(connector.ClientID!=null&amp;&amp; (Repository.GetElementByID(connector.ClientID)).Type==&quot;Actor&quot;) {&#xA;					var actor = Repository.GetElementByID(connector.ClientID);&#xA;					tmpA1.push(actor.Name);&#xA;				} else &#xA;				if(connector.SupplierID!=null&amp;&amp; (Repository.GetElementByID(connector.SupplierID)).Type==&quot;Actor&quot;) {&#xA;					var actor = Repository.GetElementByID(connector.SupplierID);&#xA;					tmpA1.push(actor.Name);&#xA;				} &#xA;			}&#xA;		}&#xA;		if(tmpA1.length&lt;nr) {&#xA;			if(tmpA1.length&gt;tmpA.length)&#xA;				return tmpA1;&#xA;			return tmpA;&#xA;		}&#xA;		return tmpA1;&#xA;	}&#xA;	return tmpA;&#xA;}&#xA;//Return all object names from 'nameElement' or if 'nameElement' values ??are less than 'nr', return all object names connected to 'subProcess'&#xA;function getObjectsofSubProcess(nameElement, subProcess, classObjects) {&#xA;	var tmpA = [];&#xA;	var tmpA1 = [];&#xA;	var elsP as EA.Element;&#xA;	var nr=1;&#xA;	var objectName;&#xA;	&#xA;	objectName=&quot;ObjectA&quot;;&#xA;	if(nameElement!=null&amp;&amp;nameElement!=&quot;&quot;&amp;&amp;nameElement!=&quot; &quot;) {&#xA;		var tmpElement = nameElement;&#xA;		while(tmpElement.indexOf(&quot;,&quot;)&gt;0) {&#xA;			tmpA.push([objectName, tmpElement.substr(0,tmpElement.indexOf(&quot;,&quot;))]);&#xA;			tmpElement=tmpElement.substr(tmpElement.indexOf(&quot;,&quot;)+1);&#xA;			var strLiterka;&#xA;			if(objectName.substr(6)==&quot;A&quot;)&#xA;				strLiterka=&quot;B&quot;;&#xA;			else if(objectName.substr(6)==&quot;B&quot;)&#xA;				strLiterka=&quot;C&quot;;&#xA;			else if(objectName.substr(6)==&quot;C&quot;)&#xA;				strLiterka=&quot;D&quot;;&#xA;			else if(objectName.substr(6)==&quot;D&quot;)&#xA;				strLiterka=&quot;E&quot;;&#xA;			else &#xA;				strLiterka=&quot;F&quot;;&#xA;			objectName=objectName.substr(0,6)+strLiterka;&#xA;		}&#xA;		if(tmpElement!=null&amp;&amp;tmpElement!=&quot;&quot;) {&#xA;			tmpA.push([objectName, tmpElement]);&#xA;		}&#xA;		if(tmpA.length&gt;1)&#xA;			tmpA[tmpA.length-1][0]=&quot;ObjectZ&quot;;&#xA;	}&#xA;	//number of objects in the imported package&#xA;	var nameObject=&quot;ObjectA&quot;;&#xA;	for(i=0;i&lt;classObjects.length;i++) {&#xA;		if(classObjects[i][0].substr(0,7)!=nameObject) {&#xA;			nr=nr+1;&#xA;			nameObject=classObjects[i][0].substr(0,7);&#xA;		}&#xA;	}&#xA;	//if there are fewer elements in tmpElement than in activityPartitions - you can try to identify all actors connected to the use case (in the conn[0][1] array)&#xA;	if(nameElement==null||nameElement==&quot;&quot;||nameElement==&quot; &quot;||tmpA.length&lt;nr) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		elsP=subProcess;&#xA;		objectName=&quot;ObjectA&quot;;&#xA;		//input objects&#xA;		for(i=0;i&lt;elsP.Connectors.Count;i++) {&#xA;			connector=elsP.Connectors.GetAt(i);&#xA;			if(connector.Type==&quot;ControlFlow&quot;||connector.Type==&quot;ObjectFlow&quot;) {&#xA;				if(connector.ClientID!=null) {&#xA;					var elementX=Repository.GetElementByID(connector.ClientID);&#xA;					var classObject=&quot;Unknown&quot;;&#xA;					if(elementX.Type==&quot;Object&quot;) {&#xA;						if(elementX.ClassifierID!=null&amp;&amp; elementX.ClassifierID&gt;0)&#xA;							classObject = Repository.GetElementByID(elementX.ClassifierID);&#xA;						var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+elementX.ElementID;&#xA;						var sqlRespond=Repository.SQLQuery(sqlCommand);&#xA;						var stateObject=null;&#xA;						if(sqlRespond!=null)&#xA;							stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;						if(stateObject==null||stateObject==&quot;&quot;)&#xA;							tmpA1.push([objectName, elementX.Name+&quot;:&quot;+classObject.Name]);&#xA;						else&#xA;							tmpA1.push([objectName, elementX.Name+&quot;[&quot;+stateObject+&quot;]&quot;+&quot;:&quot;+classObject.Name]);&#xA;						if(objectName.substr(6)==&quot;A&quot;)&#xA;							strLiterka=&quot;B&quot;;&#xA;						else if(objectName.substr(6)==&quot;B&quot;)&#xA;							strLiterka=&quot;C&quot;;&#xA;						else if(objectName.substr(6)==&quot;C&quot;)&#xA;							strLiterka=&quot;D&quot;;&#xA;						else if(objectName.substr(6)==&quot;D&quot;)&#xA;							strLiterka=&quot;E&quot;;&#xA;						else &#xA;							strLiterka=&quot;F&quot;;&#xA;						objectName=objectName.substr(0,6)+strLiterka;&#xA;						&#xA;					} else&#xA;					if(elementX.Type==&quot;Event&quot;) {&#xA;						tmpA1.push([objectName, elementX.Name]);&#xA;						if(objectName.substr(6)==&quot;A&quot;)&#xA;							strLiterka=&quot;B&quot;;&#xA;						else if(objectName.substr(6)==&quot;B&quot;)&#xA;							strLiterka=&quot;C&quot;;&#xA;						else if(objectName.substr(6)==&quot;C&quot;)&#xA;							strLiterka=&quot;D&quot;;&#xA;						else if(objectName.substr(6)==&quot;D&quot;)&#xA;							strLiterka=&quot;E&quot;;&#xA;						else &#xA;							strLiterka=&quot;F&quot;;&#xA;						objectName=objectName.substr(0,6)+strLiterka;&#xA;					}&#xA;				} &#xA;			}&#xA;		}&#xA;		//output objects&#xA;		objectName=&quot;ObjectZ&quot;;&#xA;		for(i=0;i&lt;elsP.Connectors.Count;i++) {&#xA;			connector=elsP.Connectors.GetAt(i);&#xA;			if(connector.Type==&quot;ObjectFlow&quot;) {&#xA;				if(connector.ClientID!=null) {&#xA;					var elementX=Repository.GetElementByID(connector.SupplierID);&#xA;					var classObject=&quot;Unknown&quot;;&#xA;					if(elementX.Type==&quot;Object&quot;) {&#xA;						if(elementX.ClassifierID!=null&amp;&amp; elementX.ClassifierID&gt;0)&#xA;							classObject = Repository.GetElementByID(elementX.ClassifierID);&#xA;						var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+elementX.ElementID;&#xA;						var sqlRespond=Repository.SQLQuery(sqlCommand);&#xA;						var stateObject=null;&#xA;						if(sqlRespond!=null)&#xA;							stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;						if(stateObject==null||stateObject==&quot;&quot;)&#xA;							tmpA1.push([objectName, elementX.Name+&quot;:&quot;+classObject.Name]);&#xA;						else&#xA;							tmpA1.push([objectName, elementX.Name+&quot;[&quot;+stateObject+&quot;]&quot;+&quot;:&quot;+classObject.Name]);&#xA;						if(objectName.substr(6)==&quot;Z&quot;)&#xA;							strLiterka=&quot;Y&quot;;&#xA;						else if(objectName.substr(6)==&quot;Y&quot;)&#xA;							strLiterka=&quot;X&quot;;&#xA;						else if(objectName.substr(6)==&quot;X&quot;)&#xA;							strLiterka=&quot;W&quot;;&#xA;						else if(objectName.substr(6)==&quot;W&quot;)&#xA;							strLiterka=&quot;U&quot;;&#xA;						else &#xA;							strLiterka=&quot;T&quot;;&#xA;						objectName=objectName.substr(0,6)+strLiterka;&#xA;					} &#xA;				} &#xA;			}&#xA;		}&#xA;		if(tmpA1.length&lt;nr) {&#xA;			while(tmpA1.length&lt;nr) {&#xA;				tmpA1.push(tmpA1[tmpA1.length-1]);&#xA;			}&#xA;		}&#xA;		return tmpA1;&#xA;	}&#xA;	return tmpA;&#xA;}&#xA;//Return an element named 'nameElement' from the 'elements' collection&#xA;function getByName(elements,nameElement) {&#xA;	for ( var j = 0 ; j &lt; elements.Count() ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = elements.GetAt(j);&#xA;		if(currentElement.Name == nameElement) &#xA;			return currentElement;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Return an element named 'nameElement' from the 'elements' collection&#xA;function getByAlias(elements,nameElement) {&#xA;	for ( var j = 0 ; j &lt; elements.Count() ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = elements.GetAt(j);&#xA;		if(currentElement.Alias == nameElement) &#xA;			return currentElement;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Setting the parameter values ??for the rule - for mode==0 parameter nr is run (conns[0][0] is run, then conns[0][1] when the parameters are empty), otherwise for mode==1 only conns[0][0] is run, for mode==2 only conns[0][1] is run&#xA;function setParameterValue(params, conns, nr, nameElement, mode) {&#xA;	var nameElement1=&quot;&quot;;&#xA;	&#xA;	if(params[1][nr]==&quot;&quot;||params[1][nr]==&quot; &quot;) { //empty element name &#xA;		//BauAp()v&#xA;		if(params[0][nr]==&quot;&quot;||params[0][nr]==&quot; &quot;)  {//empty source element name&#xA;			//Ba()uAp()v&#xA;			if(mode==2||mode==3) { //RiviAvi&#xA;				if(mode==2&amp;&amp;(conns[0][1]!=null&amp;&amp;(conns[0][1].Type==&quot;Action&quot;||conns[0][1].Type==&quot;Activity&quot;)))&#xA;					nameElement1=conns[0][1].Name;&#xA;				else&#xA;					nameElement1=nameElement; //Revbau, ReviBaua, RiviBaua&#xA;			} else { //others&#xA;				if(conns[0][nr]==null||conns[0][nr].Name==&quot;&quot;) { //empty source diagram element name&#xA;					//Ba()uAp()v/Actor:(no name)&#xA;					if(mode==0&amp;&amp;conns[0][nr]!=null&amp;&amp;conns[0][nr].ClassifierID&gt;0) {&#xA;						nameElement1=&quot;:&quot;+(Repository.GetElementByID(conns[0][nr].ClassifierID)).Name; &#xA;						if(params[2][nr]!=null&amp;&amp;params[2][nr]!=&quot;&quot;&amp;&amp;params[2][nr]!=&quot; &quot;)&#xA;							nameElement1=&quot;[&quot;+params[2][nr]+&quot;]&quot;+nameElement1;&#xA;						else {&#xA;							var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][nr].ElementID;&#xA;							var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;							var stateObject=null;&#xA;							if(sqlRespond!=null)&#xA;								stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;								nameElement1=&quot;[&quot;+stateObject+&quot;]&quot;+nameElement1;						&#xA;						}&#xA;					}&#xA;					else &#xA;					if(mode==1&amp;&amp;conns[0][0]!=null&amp;&amp;conns[0][0].ClassifierID&gt;0) {&#xA;						nameElement1=&quot;:&quot;+(Repository.GetElementByID(conns[0][0].ClassifierID)).Name; &#xA;						if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;)&#xA;							nameElement1=&quot;[&quot;+params[2][0]+&quot;]&quot;+nameElement1;&#xA;						else {&#xA;							var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][0].ElementID;&#xA;							var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;							var stateObject=null;&#xA;							if(sqlRespond!=null)&#xA;								stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;								nameElement1=&quot;[&quot;+stateObject+&quot;]&quot;+nameElement1;									&#xA;						}&#xA;					}&#xA;					else&#xA;						nameElement1=nameElement; //Revbau, ReviBaua, RiviBaua&#xA;&#xA;				} else { //the source diagram element has a name&#xA;					//Ba()uAp()v/Actor:name&#xA;					if(mode==0)&#xA;						nameElement1=conns[0][nr].Name;&#xA;					else&#xA;					if((conns[0][0]==null||conns[0][0].Name==&quot;&quot;||conns[0][0].Name==&quot; &quot;)&amp;&amp;conns[0][0].ClassifierID&gt;0) {&#xA;						nameElement1=&quot;:&quot;+(Repository.GetElementByID(conns[0][0].ClassifierID)).Name; &#xA;						if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;)&#xA;							nameElement1=&quot;[&quot;+params[2][0]+&quot;]&quot;+nameElement1;	&#xA;						else {&#xA;							var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][0].ElementID;&#xA;							var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;							var stateObject=null;&#xA;							if(sqlRespond!=null)&#xA;								stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;								nameElement1=&quot;[&quot;+stateObject+&quot;]&quot;+nameElement1;									&#xA;						}&#xA;					}&#xA;						else&#xA;							nameElement1=nameElement; //Revbau, ReviBaua, RiviBaua&#xA;				}&#xA;			}&#xA;		} else if(params[0][nr].substr(0,1)==&quot;:&quot;) { //the source element name has only class type&#xA;			//Ba(:class)vAp()v&#xA;			//nameElement1=params[0][nr];&#xA;			nameElement1=getStateParameter(params[0][nr], params[2][nr])&#xA;		} else { //the source element can have a complex name&#xA;			nameElement1=getStateParameter(params[0][nr], params[2][nr])&#xA;			//if(params[0][nr].indexOf(&quot;:&quot;)&gt;0) //Ba(name:class)vAp()v&#xA;			//	nameElement1=params[0][nr].substr(0,params[0][nr].indexOf(&quot;:&quot;));&#xA;			//else //Ba(name[State])vAp()v&#xA;			//	nameElement1=params[0][nr];&#xA;		}&#xA;	} else if(params[1][nr].substr(0,1)==&quot;:&quot;) { //the element name has only class type&#xA;		//BavAp(:class)v&#xA;		nameElement1=getStateParameter(params[1][nr], params[3][nr]);&#xA;	} else { //the element can have a complex name&#xA;		if(params[1][nr].indexOf(&quot;:&quot;)&gt;0) //BavAp(name[state]:class)v&#xA;			nameElement1=getStateParameter(params[1][nr], params[3][nr]);&#xA;		else //BavAp(name[state])v&#xA;			nameElement1=params[1][nr];&#xA;	}&#xA;	return nameElement1;&#xA;}&#xA;//Completing instance names in the parameter with their states&#xA;function getStateParameter(nameParameter, stateParameter) {&#xA;	var stateObject;&#xA;	var nameElement1=&quot;&quot;;&#xA;	&#xA;	if(stateParameter!=null&amp;&amp;stateParameter!=&quot;&quot;&amp;&amp;stateParameter!=&quot; &quot;) {&#xA;		if(nameParameter.substr(0,1)==&quot; &quot;)&#xA;			nameParameter=nameParameter.substr(1);&#xA;		if(stateParameter.substr(0,1)==&quot; &quot;)&#xA;			stateParameter=stateParameter.substr(1);			&#xA;		while(nameParameter.indexOf(&quot;,&quot;)&gt;=0) {&#xA;			if(nameParameter.indexOf(&quot;,&quot;)&gt;nameParameter.indexOf(&quot;:&quot;))&#xA;				nameElement1=nameElement1+nameParameter.substr(0,nameParameter.indexOf(&quot;:&quot;));&#xA;			else&#xA;				nameElement1=nameElement1+nameParameter.substr(0,nameParameter.indexOf(&quot;,&quot;));&#xA;			stateObject=stateParameter.substr(0,stateParameter.indexOf(&quot;,&quot;));&#xA;			if(stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;				nameElement1=nameElement1+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;			stateParameter=stateParameter.substr(stateParameter.indexOf(&quot;,&quot;)+1);&#xA;			if(nameParameter.indexOf(&quot;,&quot;)&gt;nameParameter.indexOf(&quot;:&quot;))&#xA;				nameElement1=nameElement1+nameParameter.substr(nameParameter.indexOf(&quot;:&quot;),nameParameter.indexOf(&quot;,&quot;)-nameParameter.indexOf(&quot;:&quot;)+1);&#xA;			else&#xA;				nameElement1=nameElement1+nameParameter.substr(nameParameter.indexOf(&quot;,&quot;),1);&#xA;			nameParameter=nameParameter.substr(nameParameter.indexOf(&quot;,&quot;)+1);&#xA;		}&#xA;		if(nameParameter!=&quot;&quot;&amp;&amp;nameParameter!=&quot; &quot;&amp;&amp;stateParameter!=&quot;&quot;)&#xA;			nameElement1=nameElement1+nameParameter.substr(0,nameParameter.indexOf(&quot;:&quot;))+&quot;[&quot;+stateParameter+&quot;]&quot;+nameParameter.substr(nameParameter.indexOf(&quot;:&quot;));&#xA;		else&#xA;			nameElement1=nameElement1+nameParameter;&#xA;	} else&#xA;		nameElement1=nameParameter;&#xA;	//maybe look up the status in the EA database?&#xA;	return nameElement1;&#xA;}&#xA;&#xA;//Retrieving partition names and their aliases from 'xmlContent' based on name1 (Partition), name2 (alias) and name3 (element name)&#xA;function retrieveXMLNames(xmlContent, name1, name2, name3, mode) {&#xA;	var activityPartitions = [];&#xA;	var namePartition1=&quot;&quot;;&#xA;	var tmpAlias1;&#xA;	var namePartition = xmlContent;&#xA;	var start=namePartition.indexOf(name1); //&quot;ActivityPartition&quot;/&quot;classname&quot;-kind of element&#xA;	while(start&gt;0) {&#xA;		var start1=namePartition.indexOf(name2,start); //&quot;alias&quot;/&quot;stateflags&quot; - partition alias&#xA;		if(start1&gt;0) {&#xA;			start1=namePartition.indexOf('&quot;',start1+name2.length+1);&#xA;			var ile=namePartition.indexOf('&quot;',start1+1);&#xA;			tmpAlias1=namePartition.substr(start1+1, ile-start1-1);&#xA;		}&#xA;		if(mode==0)&#xA;			start1=namePartition.lastIndexOf(name3,start); //&quot;UML:ActionState name=&quot;-partition name&#xA;		else&#xA;			start1=namePartition.lastIndexOf(name3,start1); //&quot;keywords&quot;-partition name&#xA;		if(start1&lt;0)&#xA;			break;&#xA;		var ile=namePartition.indexOf('&quot;',start1+name3.length+1); //the first &quot; before the name of partition&#xA;		if(ile&gt;0) {&#xA;			namePartition1=namePartition.substr(start1+name3.length+1,ile-start1-name3.length-1);&#xA;			//var i = activityPartitions.length;&#xA;			if(mode==0)&#xA;				activityPartitions.push([tmpAlias1, namePartition1]);&#xA;			else&#xA;				activityPartitions.push([namePartition1, tmpAlias1]);&#xA;			//activityPartitions[i/2-1][0]=tmpAlias1;&#xA;			//activityPartitions[i/2-1][1]=namePartition1;&#xA;			namePartition1=&quot;&quot;;&#xA;		}&#xA;		namePartition = namePartition.substr(start+name3.length);&#xA;		start=namePartition.indexOf(name1);&#xA;	}&#xA;	return activityPartitions;&#xA;}&#xA;//Retrieving the value of 'elementName' from 'xmlContent'&#xA;function retrieveXMLElement(xmlContent,elementName) {&#xA;	var nameOfPckg=&quot;&quot;;&#xA;	var start=xmlContent.indexOf(elementName); //&quot;UML:Package name=&quot;&#xA;	&#xA;	if(start&gt;0) {&#xA;		nameOfPckg = xmlContent.substr(start+elementName.length,100);&#xA;		var ile=nameOfPckg.indexOf('&quot;',1); //&quot; xmi&quot;)-1;&#xA;		if(ile&gt;0)&#xA;			nameOfPckg=nameOfPckg.substr(1,ile-1);&#xA;		else &#xA;			nameOfPckg=&quot;&quot;;&#xA;	}&#xA;	return nameOfPckg;&#xA;}&#xA;//Creating a business process diagram based on the process decomposition diagram according to the 'correctCR' rule&#xA;function createRAcomplex(correctCR, thePackage, parameters, connectors, mode) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var subChildPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var desiredDiagObjects = [ null,null]; //[null,null,null]&#xA;	var desiredPackElements = [ null,null]; //[null,null,null]&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var activityPartitions = [];&#xA;	var objectClasses = [];&#xA;	&#xA;	//RiviAvi&#xA;	conns = connectors;&#xA;	params = parameters;&#xA;	//if the first element is missing&#xA;	if(conns[0][1]==null||conns[0][1].Name==&quot;&quot;||conns[0][1].Name==&quot; &quot;)&#xA;		return;&#xA;	packages=getTargetPackage(thePackage,&quot;BURD&quot;, conns[0][1].Name);&#xA;	//if the target package and diagram are missing in it&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	//the Business Use Case Realization package&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	//Setting the names of the desired elements&#xA;	//The first element&#xA;	var nameOfElement1=&quot;&quot;;&#xA;	var nameOfElement2=&quot;&quot;;&#xA;	var nameOfElement3=&quot;&quot;;&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+2,1)==&quot;v&quot;) {//RiviAvi&#xA;		nameOfElement1=&quot;Action Service&quot;;&#xA;		nameOfElement2=&quot;ObjectIn&quot;;&#xA;		nameOfElement3=&quot;ObjectOut&quot;;&#xA;	} else { //RvivAvi&#xA;		nameOfElement1=&quot;ObjectIn&quot;;&#xA;		nameOfElement2=&quot;Action service&quot;;&#xA;		nameOfElement3=&quot;ObjectOut&quot;;&#xA;	}&#xA;	//setting values ??in rule parameters&#xA;	nameElement1=setParameterValue(parameters, connectors, 0, nameOfElement1, 2);&#xA;	nameElement2=setParameterValue(parameters, connectors, 1, nameOfElement2, 1); &#xA;	nameElement3=setParameterValue(parameters, connectors, 2, nameOfElement3, 0);&#xA;	//pattern-driven rule in nameElement1 - RiviAv({pattern})i&#xA;	if(nameElement1.substr(0,1)==&quot;{&quot; &amp;&amp; nameElement1.substr(nameElement1.length-1,1)==&quot;}&quot;) {&#xA;		var namePattern=nameElement1.substr(1); //Retrieve name pattern from the first parameter&#xA;		namePattern=namePattern.substr(0,namePattern.length-1);		&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;); // Fetch XML content from URL&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			var nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;); //Retrieve package name&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			activityPartitions=retrieveXMLNames(xmlContent, &quot;ActivityPartition&quot;, &quot;alias&quot;, &quot;UML:ActionState name=&quot;,0); //Retrieve partition names&#xA;			activityPartitions=activityPartitions.sort();&#xA;			objectClasses=retrieveXMLNames(xmlContent, &quot;classname&quot;, &quot;stateflags&quot;, 'keywords&quot; value=', 1); //Retrieve objectclass names - option B: &quot;keywords&quot;, &quot;UML:ClassifierRole name=&quot;, 0&#xA;			objectClasses=objectClasses.sort();&#xA;			var project = Repository.GetProjectInterface();&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1); //the imported package&#xA;			if(result==null) //something wrong with the imported package&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null) //something wrong with the imported package&#xA;				return;&#xA;			var moving=renamePatternObjects(nameElement2, conns[0][1], objectClasses, activityPartitions, subPackage, subChildPackage); //Rename partitions according to the values ??given in the partition rule parameter&#xA;			if(subChildPackage !=null&amp;&amp;moving) //moving partitions from the changed pattern to the current package&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			return;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML from URL: &quot; + xhr.statusText);&#xA;		}&#xA;	}&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;	&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;		diagramObject3=desiredDiagObjects[2];	&#xA;	} &#xA;	&#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;	} &#xA;	var delement1new=false;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+1,1)==&quot;v&quot;) { //RevBau, ReviBaua, RviBau&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Action&quot; ); &#xA;				//if(delement2!=null)&#xA;				//	testElement.ParentID=delement2.ParentID;&#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				delement1new=true;&#xA;			} &#xA;			delement1=testElement;&#xA;		} //else it means that this element is outside of current package&#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;i&quot;) { //RevBau, ReviBaua, RviBau&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement2;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(nameOfObject.indexOf(&quot;[&quot;)&lt;nameOfObject.indexOf(&quot;]&quot;)) {&#xA;					nameOfState=nameOfObject.substr(nameOfObject.indexOf(&quot;[&quot;)+1,nameOfObject.indexOf(&quot;]&quot;)-nameOfObject.indexOf(&quot;[&quot;)-1);&#xA;					var nameOfObject1=nameOfObject.substr(0,nameOfObject.indexOf(&quot;[&quot;))+nameOfObject.substr(nameOfObject.indexOf(&quot;]&quot;)+1);&#xA;					nameOfObject=nameOfObject1;&#xA;				}&#xA;				if(params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;) {&#xA;					if(params[3][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][1].substr(0,params[3][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][1];&#xA;				} else&#xA;				if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][0].substr(0,params[2][0].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][0];&#xA;				} else &#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(conns[0][0]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][0].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				} else&#xA;				if(conns[0][2]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][0].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				}&#xA;				if(nameOfObject==&quot;Start&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype==100;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				testElement.Update();&#xA;				if(nameOfState!=null&amp;&amp;nameOfObject!=&quot;Start&quot;) {&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);					&#xA;				}&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	var delement3new=false;&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;i&quot;) { //RevBau, ReviBaua, RviBau&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement3;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(nameOfObject.indexOf(&quot;[&quot;)&lt;nameOfObject.indexOf(&quot;]&quot;)) {&#xA;					nameOfState=nameOfObject.substr(nameOfObject.indexOf(&quot;[&quot;)+1,nameOfObject.indexOf(&quot;]&quot;)-nameOfObject.indexOf(&quot;[&quot;)-1);&#xA;					var nameOfObject1=nameOfObject.substr(0,nameOfObject.indexOf(&quot;[&quot;))+nameOfObject.substr(nameOfObject.indexOf(&quot;]&quot;)+1);&#xA;					nameOfObject=nameOfObject1;&#xA;				} else&#xA;				if(params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;) {&#xA;					if(params[3][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][2].substr(0,params[3][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][2];&#xA;				} else&#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(params[2][1]!=null&amp;&amp;params[2][1]!=&quot;&quot;&amp;&amp;params[2][1]!=&quot; &quot;) {&#xA;					if(params[2][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][1].substr(0,params[2][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][1];&#xA;				} else &#xA;				if(conns[0][2]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][2].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				} else&#xA;				if(conns[0][0]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][2].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				}&#xA;				if(nameOfObject==&quot;End&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype=101;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null&amp;&amp;!delement1new)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				testElement.Update();&#xA;				if(nameOfState!=null) {&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);					&#xA;				}&#xA;				delement3new=true;&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the input element and the middle element&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+1,1)==&quot;v&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;i&quot;) { //RiviAvi&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i); //a nie delement2?&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement2.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement2.Name==&quot;Start&quot;)&#xA;					connector = delement2.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement2.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement1.ElementID;&#xA;				connector.Update();&#xA;				delement2.Update();	&#xA;			}	&#xA;			//a connection must be created between the element to which the input element is connected at the output and the middle element&#xA;			var tmpObject as EA.Element;&#xA;			tmpObject=null;&#xA;			for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;				var connector1=delement2.Connectors.GetAt(i);&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement2.ElementID&amp;&amp;connector1.ClientID!=delement1.ElementID) {&#xA;					tmpObject=Repository.GetElementByID(connector1.ClientID);&#xA;					if(tmpObject.Type==&quot;Action&quot; ||tmpObject.Type==&quot;Activity&quot;)					&#xA;						break; //The input object is connected as an output object to another action&#xA;					else&#xA;						tmpObject=null;&#xA;				}&#xA;			}&#xA;			if(tmpObject!=null) {&#xA;				//you need to check if this connection already exists&#xA;				for(i=0;i&lt;tmpObject.Connectors.Count;i++) {&#xA;					var connector1=tmpObject.Connectors.GetAt(i);&#xA;					if(connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==tmpObject.ElementID) {&#xA;						tmpObject=null;&#xA;						break;&#xA;					}&#xA;				}&#xA;				if(tmpObject!=null) {&#xA;					connector = tmpObject.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;					connector.SupplierID = delement1.ElementID;&#xA;					connector.Update();&#xA;					tmpObject.Update();		&#xA;				}					&#xA;			}&#xA;		}&#xA;	}&#xA;	//a connection must be created between the middle element and the output element&#xA;	if(delement1!=null&amp;&amp;delement3!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+1,1)==&quot;v&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;i&quot;) { //RiviAvi&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i);&#xA;				if(delement3.Name!=&quot;End&quot;&amp;&amp;connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID||&#xA;				   delement3.Name==&quot;End&quot;&amp;&amp;connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement3.Name==&quot;End&quot;)&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement3.ElementID;&#xA;				connector.Update();&#xA;				delement1.Update();	&#xA;				delement1.Connectors.Refresh();&#xA;				delement3.Connectors.Refresh();&#xA;			}	&#xA;		}&#xA;	}&#xA;	//Add elements to the diagram&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null) {&#xA;			var left=100;&#xA;			var top=-100;&#xA;			var ifPartition=false;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			if(delement3new==false&amp;&amp;delement1new==true&amp;&amp;delement3.ParentID&gt;0) {&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID==delement3.ParentID) {&#xA;						left=existDiagramObject.left+75; //25; //right=left+100&#xA;						top=existDiagramObject.top-(existDiagramObject.top-existDiagramObject.bottom)/2+23; //bottom=top-45&#xA;						ifPartition=true;&#xA;						break;&#xA;					}&#xA;				}					&#xA;			} 	&#xA;			if(!ifPartition) //true-delement3 was in the partition&#xA;				delement1new=true;&#xA;			if(delement1new) { //new element&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null) {&#xA;						if(existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;						//if(existDiagramObject.Type!=&quot;ActivityPartition&quot;)&#xA;						//	if(existDiagramObject.right&gt;left)&#xA;						//		left=existDiagramObject.right+50;&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			if(ifPartition&amp;&amp;diagramObject3!=null) {//delement3 was here in the Partition&#xA;				testDiagramObject.left=diagramObject3.left-100;//left;&#xA;				testDiagramObject.right=diagramObject3.left-20; //left+80;&#xA;				testDiagramObject.top=diagramObject3.top; //top;&#xA;				testDiagramObject.bottom=diagramObject3.bottom; //top-40;&#xA;				delement1.ParentID=delement3.ParentID;		&#xA;				delement1.Update();&#xA;			} else {&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+80;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-40;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;			&#xA;		}  else {&#xA;			Session.Output(&quot;Error at identifying element1-4836 line&quot;);&#xA;			return;&#xA;		}		&#xA;	} &#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null) {&#xA;			var left=diagramObject1.left;&#xA;			var top=diagramObject1.top;&#xA;			/*if(delement2.ParentID&gt;0) { //if the partition exist&#xA;				var partycjaTmp=Repository.GetElementByID(delement2.ParentID);&#xA;				for ( var i = 0, j=0 ; i &lt; diagramObjects.Count ; i++ )&#xA;				{&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==partycjaTmp.ElementID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}*/&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2.Name==&quot;Start&quot;) { //InitialNode&#xA;				testDiagramObject.left=left-70;&#xA;				testDiagramObject.right=left-40;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-34;&#xA;			} else {			&#xA;				testDiagramObject.left=left-90;&#xA;				testDiagramObject.right=left-20;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-37;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	} /*else {&#xA;		var left=diagramObject1.left;&#xA;		var top=diagramObject1.top;&#xA;&#xA;		if(delement2.Name==&quot;Start&quot;) { //InitialNode&#xA;			diagramObject2.left=left-70;&#xA;			diagramObject2.right=left-40;&#xA;			//diagramObject2.left=left+125;&#xA;			//diagramObject2.right=left+195;&#xA;			diagramObject2.top=top-3;&#xA;			diagramObject2.bottom=top-34;&#xA;			diagramObject2.Update();		&#xA;		}			&#xA;	}*/&#xA;	if(diagramObject3==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null) {&#xA;			var left=diagramObject1.left;&#xA;			var top=diagramObject1.top;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			if(delement3.ParentID&gt;0) {&#xA;				var partycjaTmp=Repository.GetElementByID(delement3.ParentID);&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;				{&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==partycjaTmp.ElementID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				testDiagramObject.left=left+145;&#xA;				testDiagramObject.right=left+175;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-33;&#xA;			} else {&#xA;				testDiagramObject.left=left+125;&#xA;				testDiagramObject.right=left+195;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-37;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	} else {&#xA;		var left=diagramObject1.left;&#xA;		var top=diagramObject1.top;&#xA;		if(delement3.ParentID&gt;0) {&#xA;			diagramObject=null;&#xA;			var partycjaTmp=Repository.GetElementByID(delement3.ParentID);&#xA;			for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;			{&#xA;				var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;				if(partycjaObjTmp.ElementID==partycjaTmp.ElementID) {&#xA;					diagramObject=partycjaObjTmp;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(diagramObject!=null) {&#xA;				if(diagramObject3.left&lt;diagramObject.left||diagramObject3.right&gt;diagramObject.right||diagramObject3.top&lt;diagramObject.top||diagramObject3.bottom&lt;diagramObject.bottom) {&#xA;					if(delement3.Name==&quot;End&quot;) {&#xA;						diagramObject3.left=left+145;&#xA;						diagramObject3.right=left+175;&#xA;						diagramObject3.top=top-3;&#xA;						diagramObject3.bottom=top-33;&#xA;					} else {&#xA;						diagramObject3.left=left+125;&#xA;						diagramObject3.right=left+195;&#xA;						diagramObject3.top=top;&#xA;						diagramObject3.bottom=top-37;&#xA;					}&#xA;					diagramObject3.Update();					&#xA;				}&#xA;			}&#xA;		} else {&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				diagramObject3.left=left+145;&#xA;				diagramObject3.right=left+175;&#xA;				diagramObject3.top=top-3;&#xA;				diagramObject3.bottom=top-33;&#xA;			} else {&#xA;				diagramObject3.left=left+125;&#xA;				diagramObject3.right=left+195;&#xA;				diagramObject3.top=top;&#xA;				diagramObject3.bottom=top-37;&#xA;			}&#xA;			diagramObject3.Update();				&#xA;		}&#xA;	}&#xA;	if(diagramObject3!=null&amp;&amp;mode==1) {&#xA;		diagramObjects.Refresh();&#xA;		if(delement1.ParentID&gt;0) {&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			existDiagramObject=null;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID==delement1.ParentID) &#xA;					break;&#xA;			}&#xA;			if(existDiagramObject!=null)&#xA;				placingElementOfAction(delement1, diagramObjects, existDiagramObject, diagramObject1, 0);&#xA;			else&#xA;				placingElementOfAction(delement1, diagramObjects, null, diagramObject1, 2);&#xA;		}&#xA;		else&#xA;			placingElementOfAction(delement1, diagramObjects, null, diagramObject1, 2);&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from business process diagram to system use cases diagram&#xA;function createAUcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	//ApUau&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;SUCD&quot;,thePackage.Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Actor&quot;;&#xA;	nameOfElement2=&quot;UseCase&quot;;&#xA;	//setting values ??in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, null);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, null);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;	} &#xA;	var delement1new=false;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;U&quot;)+1,1)==&quot;a&quot;) { //ApUau&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Actor&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;U&quot;)+2,1)==&quot;u&quot;) { //ApUau&#xA;				var nameOfUC = nameElement2; &#xA;				testElement = subPackage.Elements.AddNew( nameOfUC, &quot;Use Case&quot; );&#xA;				testElement.Update();&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Association&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID||&#xA;				 connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement2.ElementID)) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	var newObj3=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Actor&quot;) {&#xA;			var left=50;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Actor&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		} else &#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;UseCase&quot;) {&#xA;			var left=50;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;UseCase&quot;) {&#xA;			var left=150;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;UseCase&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;		&#xA;			if(diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from business process diagram to business class diagram&#xA;function createACcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;CLASSD&quot;,thePackage.Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Class&quot;;&#xA;	nameOfElement2=&quot;1..*&quot;;&#xA;	nameOfElement3=&quot;Class&quot;;&#xA;	//setting values ??in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	if(nameElement1.substr(0,1)==&quot;:&quot;)&#xA;		nameElement1=nameElement1.substr(1);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	if(nameElement2.substr(0,1)==&quot;:&quot;)&#xA;		nameElement2=nameElement2.substr(1);&#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0);&#xA;	if(nameElement3.substr(0,1)==&quot;:&quot;)&#xA;		nameElement3=nameElement3.substr(1);&#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;		diagramObject3=desiredDiagObjects[1];	&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;	} &#xA;	var delement1new=false;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements,	what about this element when it exists in another package&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		delement1=searchForElement(subPackage, nameElement1, &quot;Class&quot;); &#xA;		if(delement1==null&amp;&amp;diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;C&quot;)+1,1)==&quot;c&quot;) { //AiviCczc&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Class&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		delement3=searchForElement(subPackage, nameElement3, &quot;Class&quot;); &#xA;		if(delement3==null&amp;&amp;diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;C&quot;)+3,1)==&quot;c&quot;) { //AiviCczc&#xA;				var nameOfClass = nameElement3; &#xA;				testElement = subPackage.Elements.AddNew( nameOfClass, &quot;Class&quot; );&#xA;				testElement.Update();&#xA;				diagramObject3=null; //diagramObject3 is not already a previously created element&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement3!=null) {&#xA;		var connector as EA.Connector.ClientEnd.Cardinality;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			var connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Association&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID||&#xA;				 connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID)) {&#xA;				if(nameElement2.indexOf(&quot;,&quot;)&gt;-1) {&#xA;					if(connector1.ClientEnd.Cardinality==nameElement2.substr(0,nameElement2.indexOf(&quot;,&quot;))&amp;&amp;&#xA;						connector1.SupplierEnd.Cardinality==nameElement2.substr(nameElement2.indexOf(&quot;,&quot;)+1)) {&#xA;						connector=connector1;&#xA;						break;&#xA;					}&#xA;				} else {&#xA;					if(connector1.ClientEnd.Cardinality==&quot;1&quot;&amp;&amp;connector1.SupplierEnd.Cardinality==nameElement2) {&#xA;						connector=connector1;&#xA;						break;&#xA;					}&#xA;				}&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement3.ElementID;&#xA;			if(nameElement2.indexOf(&quot;,&quot;)&gt;-1) {&#xA;				connector.ClientEnd.Cardinality=nameElement2.substr(0,nameElement2.indexOf(&quot;,&quot;));&#xA;				connector.SupplierEnd.Cardinality=nameElement2.substr(nameElement2.indexOf(&quot;,&quot;)+1);&#xA;			} else {&#xA;				connector.ClientEnd.Cardinality=&quot;1&quot;;&#xA;				connector.SupplierEnd.Cardinality=nameElement2;&#xA;			}&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Class&quot;) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Class&quot;||existElementObject.Type==&quot;Object&quot;||existElementObject.Type==&quot;DataType&quot;||existElementObject.Type==&quot;Enumeration&quot;||existElementObject.Type==&quot;PrimitiveType&quot;)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		} &#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Class&quot;) {&#xA;			var left=150;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Class&quot;||existElementObject.Type==&quot;Object&quot;||existElementObject.Type==&quot;DataType&quot;||existElementObject.Type==&quot;Enumeration&quot;||existElementObject.Type==&quot;PrimitiveType&quot;)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;		&#xA;			if(diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			if(diagramObject1.right&gt;left)&#xA;				left=diagramObject1.right+100;&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Multiple calls to createAScomplex depending on multi-value parameters&#xA;function createAScomplexSrst(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=connectors[0].length; //how many use cases are there in the rule&#xA;&#xA;	parameter1[1][0]=(Repository.GetElementByID(connectors[0][0].ClassifierID)).Name;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		if(n==0) {&#xA;			parameter1[1][1]=&quot;Initial&quot;;&#xA;			parameter1[1][2]=connectors[1][0];&#xA;			if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;				parameter1[1][2]=&quot;1. State&quot;;&#xA;			createAScomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;		}&#xA;		parameter1[1][1]=connectors[1][n];&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. State&quot;;	&#xA;		if(n==2)&#xA;			parameter1[1][2]=&quot;Final&quot;;&#xA;		else {&#xA;			parameter1[1][2]=connectors[1][n+1];&#xA;			if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;				parameter1[1][2]=(n+2)+&quot;. State&quot;;&#xA;		}&#xA;		createAScomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from business process diagram to business state machine diagram&#xA;function createAScomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	//AivSrst&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	region = Repository.GetElementByID(conns[0][0].ClassifierID);&#xA;	packages=getTargetPackage(thePackage,&quot;BSTMD&quot;,region.Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Region&quot;;&#xA;	nameOfElement2=&quot;State&quot;;&#xA;	nameOfElement3=&quot;State&quot;;&#xA;	//setting values ??in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0); &#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;		diagramObject3=desiredDiagObjects[2];&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;	} &#xA;	var delement2new=false;&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;S&quot;)+2,1)==&quot;s&quot;) { //AivSrst&#xA;				if(nameElement2==&quot;Initial&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;StateNode&quot; );&#xA;					testElement.Subtype=3; //Initial&#xA;				}&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;State&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject2=null; //diagramObject1 is not already a previously created element&#xA;			} &#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;S&quot;)+2,1)==&quot;s&quot;) { //AivSrst&#xA;				var nameOfSt = nameElement3; &#xA;				if(nameOfSt==&quot;Final&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfSt, &quot;StateNode&quot; );&#xA;					testElement.Subtype=4;&#xA;				}&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfSt, &quot;State&quot; );&#xA;				testElement.Update();&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} &#xA;	}	&#xA;	//a connection must be created between the elements&#xA;	if(delement3!=null&amp;&amp;delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;			var connector1=delement2.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;StateFlow&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement2.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID)) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement2.Connectors.AddNew(&quot;&quot;, &quot;StateFlow&quot;);&#xA;			connector.SupplierID = delement3.ElementID;&#xA;			connector.Update();&#xA;			delement3.Update();	&#xA;			delement2.Update();&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;State&quot;||delement2.Type==&quot;StateNode&quot;)) {&#xA;			var left=70;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;State&quot;||existElementObject.Type==&quot;StateNode&quot;)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2.Type==&quot;StateNode&quot;) {&#xA;				testDiagramObject.left=left+25;&#xA;				testDiagramObject.right=left+55;&#xA;			}&#xA;			else {&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+80;&#xA;			}&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-30;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			diagramObjects.Refresh();&#xA;		}&#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;(delement3.Type==&quot;State&quot;||delement3.Type==&quot;StateNode&quot;)) {&#xA;			var left=70;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;State&quot;||existElementObject.Type==&quot;StateNode&quot;)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			if(delement3.Type==&quot;StateNode&quot;) {&#xA;				testDiagramObject.left=left+25;&#xA;				testDiagramObject.right=left+55;&#xA;			}&#xA;			else {&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+80;&#xA;			}&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-30;&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;			diagramObjects.Refresh();&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Multiple calls to createZYcomplex depending on multi-value parameters&#xA;function createZYcomplexYu(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=connectors[0].length-1; //how many use cases are there in the rule&#xA;&#xA;	if(connectors[0][0]!=null&amp;&amp;connectors[0][0].Type==&quot;ActivityPartition&quot;) {&#xA;		for( var n=0; n&lt;connectors[0][0].Connectors.Count; n++) {&#xA;			var connector=connectors[0][0].Connectors.GetAt(n);&#xA;			if(connector.Type==&quot;Dependency&quot;&amp;&amp;connector.Name==&quot;UauZpv&quot;) {&#xA;				connectors[2][0]=Repository.GetElementByID(connector.ClientID);&#xA;				break;&#xA;			}&#xA;		}&#xA;	}&#xA;	parameter1[1][0]=connectors[0][0].Name;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][1]=connectors[0][n+1].Name;&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. Use Case&quot;;&#xA;		createZYcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from system use case realization diagram to internal use case diagram&#xA;function createZYcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var theParentPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	//ZpvYu&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;	packages=getTargetPackage(thePackage,&quot;IUCD&quot;,theParentPackage.Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for IUCD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Use Case&quot;;&#xA;	nameOfElement2=&quot;Use Case&quot;;&#xA;	//setting values ??in rule parameters&#xA;	if(conns[2][0]!=null)&#xA;		nameElement1=setParameterValue(parameters, conns, 0, conns[2][0].Name, 0);&#xA;	else&#xA;		nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, null);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;	} &#xA;	if(conns[2][0]!=null)&#xA;		delement1=conns[2][0];&#xA;	&#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, null);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;	} &#xA;	var delement1new=false;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Y&quot;)+1,1)==&quot;u&quot;) { //ZpvYu&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Use Case&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Y&quot;)+1,1)==&quot;u&quot;) { //ZpvYu&#xA;				var nameOfUC = nameElement2; &#xA;				testElement = subPackage.Elements.AddNew( nameOfUC, &quot;Use Case&quot; );&#xA;				testElement.Update();&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(var i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			var connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;UseCase&quot;&amp;&amp;connector1.Subtype==&quot;Includes&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID||&#xA;				 connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement2.ElementID)) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;UseCase&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Subtype=&quot;Includes&quot;;&#xA;			connector.Stereotype=&quot;include&quot;;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	var newObj3=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;UseCase&quot;) {&#xA;			var left=30;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;UseCase&quot;) {&#xA;			var left=150;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;UseCase&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;		&#xA;			if(diagramObject1!=null&amp;&amp;diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1!=null&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Multiple calls to createYQcomplex depending on multi-value parameters&#xA;function createYQcomplexQlml(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many use cases are there in the rule&#xA;&#xA;	iteration=Math.floor(iteration);&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][0]=parameters[1][2*n];&#xA;		//if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;		//	parameter1[1][0]=&quot;Lifeline&quot;+(n+1);&#xA;		parameter1[1][1]=parameters[1][2*n+1];&#xA;		//if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;		//	parameter1[1][1]=&quot;Message&quot;+(n+1);		&#xA;		parameter1[1][2]=parameters[1][2*n+2];&#xA;		//if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;		//	parameter1[1][2]=&quot;Lifeline&quot;+(n+2);		&#xA;		createYQcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from internal use case diagram to sequence diagram&#xA;function createYQcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var diagramConnectors = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	//YuQlm&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	if(conns[0]==null||conns[0].length&lt;=0||conns[0][0].Type!=&quot;UseCase&quot;||conns[0][0].Name==&quot;&quot;||conns[0][0].Name==&quot; &quot;)&#xA;		return;&#xA;	packages=getTargetPackage(thePackage,&quot;SEQD&quot;,conns[0][0].Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for SEQD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;LifeLine1&quot;;&#xA;	nameOfElement2=&quot;Message&quot;;&#xA;	nameOfElement3=&quot;LifeLine2&quot;;&#xA;	//setting values ??in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 3); &#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0); &#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject3=null;&#xA;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, null, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject3=desiredDiagObjects[2];		&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Connector;&#xA;	var delement3 as EA.Element;&#xA;	var delement4 as EA.Connector;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	delement4 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackSequences(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;		delement4=desiredPackElements[3];	&#xA;	} &#xA;	if(delement1==null&amp;&amp;nameElement1!=null) {&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Q&quot;)+1,1)==&quot;l&quot;) { &#xA;			testElement = subPackage.Elements.AddNew( nameElement1, &quot;Sequence&quot; ); &#xA;			testElement.Update();&#xA;			diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;		} &#xA;		delement1=testElement;&#xA;	}&#xA;	if(delement3==null&amp;&amp;nameElement3!=null) {&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Q&quot;)+3,1)==&quot;l&quot;) { //YuQlml&#xA;			testElement = subPackage.Elements.AddNew( nameElement3, &quot;Sequence&quot; ); &#xA;			testElement.Update();&#xA;			diagramObject3=null; //diagramObject1 is not already a previously created element&#xA;		} &#xA;		delement3=testElement;&#xA;	}&#xA;	var nameConnector2=null;&#xA;	var nameConnector2Parameter=null;&#xA;	var nameConnector4=null;&#xA;	var nameConnector4Parameter=null;&#xA;	if(nameElement2.indexOf(&quot;::&quot;)&gt;-1)&#xA;		nameConnector2 = nameElement2.substr(0,nameElement2.indexOf(&quot;::&quot;));&#xA;	else&#xA;		nameConnector2 = nameElement2;&#xA;	if(nameConnector2.indexOf(&quot;&lt;&quot;)&gt;-1&amp;&amp;nameConnector2.indexOf(&quot;&gt;&quot;)&gt;nameConnector2.indexOf(&quot;&lt;&quot;)) {&#xA;		nameConnector2Parameter = nameConnector2.substr(nameConnector2.indexOf(&quot;&lt;&quot;)+1,nameConnector2.indexOf(&quot;&gt;&quot;)-nameConnector2.indexOf(&quot;&lt;&quot;)-1);&#xA;		nameConnector2 = nameElement2.substr(0,nameElement2.indexOf(&quot;&lt;&quot;));&#xA;	} else&#xA;		nameConnector2Parameter=&quot;&quot;;&#xA;	nameConnector4=&quot;&quot;;&#xA;	if(nameElement2.indexOf(&quot;::&quot;)&gt;-1)&#xA;		nameConnector4Parameter=nameElement2.substr(nameElement2.indexOf(&quot;::&quot;)+2);&#xA;	else&#xA;		nameConnector4Parameter=&quot;&quot;;&#xA;	diagramConnectors=getDesiredDiagramSequences(testDiagram);	&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameConnector2!=null) {&#xA;		var testElement as EA.Connector;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Q&quot;)+2,1)==&quot;m&quot;) { //YuQlml&#xA;			testElement=delement1.Connectors.AddNew(nameConnector2, &quot;Sequence&quot;);	&#xA;			if(delement3==null) &#xA;				testElement.SupplierID=delement1.ElementID;&#xA;			else&#xA;				testElement.SupplierID=delement3.ElementID;&#xA;			testElement.TransitionGuard=&quot;retval=void;params=;paramsDlg=&quot;+nameConnector2Parameter+&quot;;&quot;;&#xA;			if(diagramConnectors==null)	&#xA;				testElement.SequenceNo=1;&#xA;			else {&#xA;				testElement.SequenceNo=diagramConnectors.length/2+1;&#xA;				for(var m=0; m&lt;diagramConnectors.length;m++) {&#xA;					var connector as EA.Connector;&#xA;					connector=diagramConnectors[m];&#xA;					if(connector.SequenceNo&gt;diagramConnectors.length/2) {&#xA;						connector.SequenceNo=connector.SequenceNo+2;&#xA;						connector.Update();&#xA;					}&#xA;				}&#xA;			}&#xA;			testElement.Update();&#xA;			var sqlCommand=&quot;update t_connector set PDATA4 = 0 where Connector_ID = &quot;+testElement.ConnectorID;&#xA;			Repository.Execute(sqlCommand);				&#xA;		} &#xA;		delement2=testElement;&#xA;	}&#xA;	if(delement4==null&amp;&amp;nameConnector4!=null) {&#xA;		var testElement as EA.Connector;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Q&quot;)+2,1)==&quot;m&quot;) { //YuQlml&#xA;			testElement=delement3.Connectors.AddNew(nameConnector4, &quot;Sequence&quot;);	&#xA;			if(delement1==null) &#xA;				testElement.SupplierID=delement3.ElementID;&#xA;			else&#xA;				testElement.SupplierID=delement1.ElementID;&#xA;			if(nameConnector4Parameter!=null&amp;&amp;nameConnector4Parameter!=&quot;&quot;)&#xA;				testElement.TransitionGuard=&quot;retval=&quot;+nameConnector4Parameter+&quot;;&quot;;&#xA;			else&#xA;				testElement.TransitionGuard=&quot;retval=void;&quot;;&#xA;			if(diagramConnectors==null)	&#xA;				testElement.SequenceNo=2;&#xA;			else&#xA;				testElement.SequenceNo=diagramConnectors.length/2+2;&#xA;			testElement.Update();&#xA;			var sqlCommand=&quot;update t_connector set PDATA4 = 1 where Connector_ID = &quot;+testElement.ConnectorID;&#xA;			Repository.Execute(sqlCommand);				&#xA;		} &#xA;		delement4=testElement;&#xA;	}&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Sequence&quot;) {&#xA;			var left=50;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Sequence&quot;) {&#xA;					if(existDiagramObject.left&gt;=left)&#xA;						left=existDiagramObject.left+150;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=-50;&#xA;			testDiagramObject.bottom=-400;&#xA;			testDiagramObject.Update();&#xA;			diagramObjects.Refresh();&#xA;			testDiagram.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;		}&#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element3 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Sequence&quot;) {&#xA;			var left=200;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Sequence&quot;) {&#xA;					if(existDiagramObject.left&gt;=left)&#xA;						left=existDiagramObject.left+150;&#xA;				}&#xA;			}&#xA;			if(diagramObject1!=null&amp;&amp;diagramObject1.left&gt;=left)&#xA;				left=diagramObject1.left+150;&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=-50;&#xA;			testDiagramObject.bottom=-400;&#xA;			testDiagramObject.Update();&#xA;			diagramObjects.Refresh();&#xA;			testDiagram.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Multiple calls to createUZcomplex depending on multi-value parameters&#xA;function createQMcomplexMqyq(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=Math.floor(connectors[0].length/2); //how many activities are there in the rule&#xA;var lastElement as EA.Element;&#xA;	&#xA;	lastElement=null;&#xA;	if(iteration &lt;=1) {&#xA;		createQMcomplex(correctCR, thePackage, parameters, connectors,0);&#xA;	}&#xA;	else {&#xA;		for(var n=0; n&lt;iteration; n++) {&#xA;			parameter1[1][0]=connectors[0][2*n].Name; &#xA;			parameter1[1][1]=connectors[0][2*n+1].Name; &#xA;			parameter1[1][2]=connectors[0][2*n+2].Name; &#xA;			connectors[2][0]=lastElement;&#xA;			lastElement=createQMcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;		} &#xA;	}&#xA;}&#xA;//Create target elements in composite consistency rule from sequence diagram to component diagram&#xA;function createQMcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	//QlmlMqyq&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;CMPD&quot;,thePackage.Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for CMPD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Component&quot;;&#xA;	nameOfElement2=&quot;Interface&quot;;&#xA;	nameOfElement3=&quot;Component&quot;;&#xA;	//setting values ??in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0); &#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;		diagramObject3=desiredDiagObjects[2];&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Connector;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;	} &#xA;	if(delement1==null&amp;&amp;nameElement1!=null) {&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;M&quot;)+1,1)==&quot;q&quot;) { //QlmlMqyq&#xA;			if(nameElement1!=null&amp;&amp;nameElement1.substr(0,1)==&quot;:&quot;)&#xA;				nameElement1=nameElement1.substr(1);&#xA;			var testParentElement as EA.Element;&#xA;			testParentElement=null;&#xA;			if((testParentElement=searchForElement(subPackage, nameElement1, &quot;Component&quot;))==null) {&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Component&quot; ); &#xA;				testElement.Update();&#xA;			} else&#xA;				testElement=testParentElement;&#xA;			diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;		} &#xA;		delement1=testElement;&#xA;	}&#xA;	if(delement3==null&amp;&amp;nameElement3!=null) {&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;M&quot;)+3,1)==&quot;q&quot;) { //QlmlMqyq&#xA;			if(nameElement3!=null&amp;&amp;nameElement3.substr(0,1)==&quot;:&quot;)&#xA;				nameElement3=nameElement3.substr(1);&#xA;			var testParentElement as EA.Element;&#xA;			testParentElement=null;&#xA;			if((testParentElement=searchForElement(subPackage, nameElement3, &quot;Component&quot;))==null) {&#xA;				testElement = subPackage.Elements.AddNew( nameElement3, &quot;Component&quot; ); &#xA;				testElement.Update();&#xA;			} else&#xA;				testElement=testParentElement;&#xA;			diagramObject3=null; //diagramObject1 is not already a previously created element&#xA;		} &#xA;		delement3=testElement;&#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;delement1!=null&amp;&amp;delement3!=null&amp;&amp;delement1!=delement3) {&#xA;		var testElement as EA.Connector;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;M&quot;)+2,1)==&quot;y&quot;) { //QlmlMqyq&#xA;			testElement=delement1.Connectors.AddNew(nameElement2, &quot;Interface&quot;);	&#xA;			if(delement3==null) &#xA;				testElement.SupplierID=delement1.ElementID;&#xA;			else&#xA;				testElement.SupplierID=delement3.ElementID;&#xA;			testElement.Update();&#xA;		} &#xA;		delement2=testElement;&#xA;	}&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Component&quot;) {&#xA;			var left=50;&#xA;			var top=-50;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Component&quot;) {&#xA;					if(existDiagramObject.bottom&lt;=top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			testDiagram.Update();&#xA;			diagramObjects.Refresh();&#xA;			diagramObject1=testDiagramObject;&#xA;		}&#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element3 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Component&quot;) {&#xA;			var left=50;&#xA;			var top=-150;			&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			diagramObjects.Refresh();&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Component&quot;) {&#xA;					if(existDiagramObject.bottom&lt;=top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			testDiagram.Update();&#xA;			diagramObjects.Refresh();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	}&#xA;	return delement3;&#xA;}&#xA;//Multiple calls to createUZcomplex depending on multi-value parameters&#xA;function createUZcomplexZpv(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=Math.floor(parameters[1].length/2); //how many activities are there in the rule&#xA;var lastElement as EA.Element;&#xA;	&#xA;	lastElement=null;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][0]=parameters[1][2*n]; //if the partition is empty&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;				parameter1[1][0]=&quot;User&quot;;&#xA;		parameter1[1][1]=parameters[1][2*n+1]; //if the action is empty&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. Action&quot;;&#xA;		connectors[2][0]=lastElement;&#xA;		lastElement=createUZcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from system use case diagram to system use case realization diagram&#xA;function createUZcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	if(conns[0]==null||conns[0].length&lt;=0||conns[0][1].Type!=&quot;UseCase&quot;||conns[0][1].Name==&quot;&quot;||conns[0][1].Name==&quot; &quot;)&#xA;		return;&#xA;	packages=getTargetPackage(thePackage,&quot;SUCRD&quot;,conns[0][1].Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for SUCRD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;U&quot;)+2,1)==&quot;u&quot;) {//UauZpv&#xA;		nameOfElement1=&quot;ActivityPartition&quot;;&#xA;		nameOfElement2=&quot;Action&quot;;&#xA;	} else { //BuaApv&#xA;		nameOfElement2=&quot;ActivityPartition&quot;;&#xA;		nameOfElement1=&quot;Action&quot;;&#xA;	}&#xA;	//setting values ??in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0);&#xA;	//pattern-driven rule in nameElement2 - BauApv({pattern})&#xA;	if(nameElement2.substr(0,2)==&quot;{{&quot; &amp;&amp; nameElement2.substr(nameElement2.length-2,2)==&quot;}}&quot;) {&#xA;		var namePattern=nameElement2.substr(2);&#xA;		namePattern=namePattern.substr(0,namePattern.length-2);		&#xA;		// Fetch XML content from URL&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;);&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		var nameOfPckg = &quot;&quot;;&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			//retrieve package name&#xA;			nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;);&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			var project = Repository.GetProjectInterface();&#xA;			//Import the XMI file into the current model, download package content to subpackage&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1);&#xA;			subPackage.Packages.Refresh();&#xA;			if(result==null)&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null)&#xA;				return;&#xA;			//moving elements from the changed pattern to the current package&#xA;			if(subChildPackage !=null)&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			return;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML for the pattern &lt;&quot;+namePattern+&quot; from URL: &quot; + xhr.statusText);&#xA;		}&#xA;	}&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, null);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;	} &#xA;	&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = conns[2][0];&#xA;	var desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, null);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];	&#xA;		//activityPartitions = desiredPackElements[3];&#xA;	} &#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;p&quot;) { //UauZpv&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;ActivityPartition&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				if(conns[0][1]!=null) {&#xA;					var connector as EA.Connector;&#xA;					connector = conns[0][1].Connectors.AddNew(correctCR, &quot;Dependency&quot;)&#xA;					connector.SupplierID = testElement.ElementID;&#xA;					connector.Update();&#xA;					conns[0][1].Update();&#xA;				}					&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //UauZpv&#xA;				if(nameElement2==&quot;Initial&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;StateNode&quot; ); &#xA;					testElement.Subtype==100;&#xA;				} else&#xA;				if(nameElement2==&quot;Final&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;StateNode&quot; ); &#xA;					testElement.Subtype=101;&#xA;				}&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;Activity&quot; ); &#xA;				testElement.ParentID=delement1.ElementID;&#xA;				//testElement = delement1.Elements.AddNew( nameElement2, &quot;Activity&quot; );&#xA;				testElement.Update();&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	} &#xA;	if(delement3!=null) {&#xA;		var connector as EA.Connector;&#xA;		var connector1 as EA.Connector;&#xA;		connector=null;&#xA;		connector1=null;&#xA;		for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;			connector=delement2.Connectors.GetAt(i);&#xA;			if(connector.Type==&quot;ControlFlow&quot;) {&#xA;				if(connector.ClientID&gt;0&amp;&amp;connector.ClientID!=delement2.ElementID&amp;&amp;connector.ClientID==delement3.ElementID) {&#xA;					connector1=connector;&#xA;					break;&#xA;				}&#xA;			}			&#xA;		}&#xA;		if(connector1==null) {&#xA;			connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement3.Update();	&#xA;			delement2.Update();			&#xA;		}&#xA;	}&#xA;	var diagramObject1new=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;ActivityPartition&quot;) {&#xA;			if(delement1.Name==&quot;User&quot;) {&#xA;				var left=50;&#xA;				var top=-50;&#xA;			} else {&#xA;				var left=250;&#xA;				var top=-50;&#xA;			}&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject=Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existDiagramObject.ElementID!=delement2.ElementID) {&#xA;					if(existElementObject.Type==&quot;ActivityPartition&quot;) {&#xA;						if(existElementObject.Name==&quot;User&quot;) {&#xA;							left=existDiagramObject.right;&#xA;							top=existDiagramObject.top;&#xA;						} else {&#xA;							left=existDiagramObject.left-200;&#xA;							top=existDiagramObject.top;&#xA;						}&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+200;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-350;&#xA;			var textStyle=testDiagramObject.Style;&#xA;			if(textStyle.indexOf(&quot;VPartition=&quot;)&gt;-1) {&#xA;				if(textStyle.indexOf(&quot;VPartition=0&quot;)&gt;-1) {&#xA;					textStyle.replace(&quot;VPartition=0&quot;,&quot;VPartition=1&quot;);&#xA;					testDiagramObject.Style=textStyle;&#xA;				}&#xA;			} else &#xA;				testDiagramObject.Style=testDiagramObject.Style+&quot;VPartition=1;&quot;;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			diagramObject1new=true;&#xA;		} &#xA;	}&#xA;	var left=diagramObject1.left+(diagramObject1.right-diagramObject1.left)/2;&#xA;	var top=diagramObject1.top-100;&#xA;	var topOther=diagramObject1.top-100;&#xA;	if(diagramObject2==null) {&#xA;		var diagramObjects as EA.Collection;&#xA;		&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		diagramObjects.Refresh();&#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;Activity&quot;||delement2.Type==&quot;Action&quot;||delement2.Type==&quot;StateNode&quot;)) {&#xA;			if(delement2.ParentID==delement1.ElementID) {&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;		&#xA;				//if there are other elements in the partition, we should set the left edge of the action to the right of the last element of the partition&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null&amp;&amp;existElementObject.ParentID==delement1.ElementID&amp;&amp;&#xA;						(existElementObject.Type==&quot;Activity&quot;||existElementObject.Type==&quot;Action&quot;||existElementObject.Type==&quot;Object&quot;||&#xA;						 existElementObject.Type==&quot;Event&quot;||existElementObject.Type==&quot;StateNode&quot;||existElementObject.Type==&quot;Decision&quot;||existElementObject.Type==&quot;MergeNode&quot;)) {&#xA;						if(existDiagramObject.left&gt;diagramObject1.left&amp;&amp;existDiagramObject.right&lt;diagramObject1.right&amp;&amp;existDiagramObject.top&lt;diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;diagramObject1.bottom&amp;&amp;&#xA;							existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;						if(top&lt;diagramObject1.bottom+50) {&#xA;							diagramObject1.bottom=top-100;&#xA;							diagramObject1.Update();&#xA;						}&#xA;					} else&#xA;					if(existElementObject!=null&amp;&amp;delement2.ParentID&gt;0&amp;&amp;existElementObject.ParentID!=delement2.ParentID&amp;&amp;&#xA;						(existElementObject.Type==&quot;Activity&quot;||existElementObject.Type==&quot;Action&quot;)) {&#xA;						if(existDiagramObject.top&lt;=topOther)&#xA;							topOther=existDiagramObject.top;&#xA;					}&#xA;				}				&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2.Type==&quot;StateNode&quot;) {&#xA;				testDiagramObject.left=left-15;&#xA;				testDiagramObject.right=left+15;&#xA;				if(delement2.Name==&quot;Initial&quot;) {&#xA;					testDiagramObject.top=diagramObject1.top-40;  //-15;&#xA;					testDiagramObject.bottom=diagramObject1.top-70;  //-60;&#xA;				} else {&#xA;					testDiagramObject.top=top-10;  //-15;&#xA;					testDiagramObject.bottom=top-40;  //-60;&#xA;				}&#xA;			} else {&#xA;				testDiagramObject.left=left-35;&#xA;				testDiagramObject.right=left+35;&#xA;				if(topOther&lt;top) {&#xA;					testDiagramObject.top=topOther;  //-15;&#xA;					testDiagramObject.bottom=topOther-45;  //-60;&#xA;				} else {&#xA;					testDiagramObject.top=top;  //-15;&#xA;					testDiagramObject.bottom=top-45;  //-60;&#xA;				}&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;		} &#xA;	} else { &#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;Activity&quot;||delement2.Type==&quot;Action&quot;||delement2.Type==&quot;StateNode&quot;)) {&#xA;			if(delement2.ParentID==delement1.ElementID) { //if delement2 is the part of the partition&#xA;				//if delement2 is placed outside the partition&#xA;				if(diagramObject2.left&lt;diagramObject1.left||diagramObject2.right&gt;diagramObject1.right|| &#xA;					diagramObject2.top&gt;diagramObject1.top||diagramObject2.bottom&lt;diagramObject1.bottom) {&#xA;					//setting the left border inside the partition	&#xA;					var left1=setLeftBorderOfPartition(diagramObjects, diagramObject1);&#xA;					if(left1&gt;left)&#xA;						left=left1;&#xA;					diagramObject2.left=left+100;&#xA;					diagmObject2.Update();&#xA;				}&#xA;				//placingElementOfAction(delement2, diagramObjects, diagramObject1, diagramObject2,0); &#xA;			}&#xA;		}&#xA;	}&#xA;	return delement2;&#xA;}&#xA;//Multiple calls to createRAcomplex depending on multi-value parameters&#xA;function createCZcomplexAvi(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var parameter11;&#xA;var parameter31;&#xA;var parameter12;&#xA;var parameter32;&#xA;var pathToPackage;&#xA;var lastElement as EA.Element;&#xA;	&#xA;	iteration=Math.floor(iteration);&#xA;	pathToPackage=parameters.pop();&#xA;	lastElement=null;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1.push(pathToPackage);&#xA;		parameter1[1][0]=parameters[1][2*n+1];&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;			parameter1[1][0]=(n+1)+&quot;. Action&quot;;&#xA;		parameter11=parameters[1][2*n];&#xA;		if(parameter11==null||parameter11==&quot;&quot;||parameter11==&quot; &quot;)&#xA;			parameter11=&quot;:&quot;+connectors[0][0].Name;&#xA;		parameter31=parameters[3][2*n];&#xA;		parameter12=parameters[1][2*n+2];&#xA;		if(parameter12==null||parameter12==&quot;&quot;||parameter12==&quot; &quot;)&#xA;			parameter12=&quot;:&quot;+connectors[0][0].Name;&#xA;		parameter32=parameters[3][2*n+2];&#xA;		do {&#xA;			if(parameter11.indexOf(&quot;,&quot;)&gt;0) {&#xA;				parameter1[1][1]=parameter11.substr(0,parameter11.indexOf(&quot;,&quot;));&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter11=parameter11.substr(parameter11.indexOf(&quot;,&quot;)+1);&#xA;				parameter1[3][1]=parameter31.substr(0,parameter31.indexOf(&quot;,&quot;));&#xA;				parameter31=parameter31.substr(parameter31.indexOf(&quot;,&quot;)+1);&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter11.length&gt;0)&#xA;					parameter11=parameter11+&quot;,&quot;;&#xA;				if(parameter31.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter31.length&gt;0)&#xA;					parameter31=parameter31+&quot;,&quot;;&#xA;			} else {&#xA;				parameter1[1][1]=parameter11;&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter1[3][1]=parameter31;&#xA;			}&#xA;			do {&#xA;				if(parameter12.indexOf(&quot;,&quot;)&gt;0) {&#xA;					parameter1[1][2]=parameter12.substr(0,parameter12.indexOf(&quot;,&quot;));&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter12=parameter12.substr(parameter12.indexOf(&quot;,&quot;)+1);&#xA;					parameter1[3][2]=parameter32.substr(0,parameter32.indexOf(&quot;,&quot;));&#xA;					parameter32=parameter32.substr(parameter32.indexOf(&quot;,&quot;)+1);&#xA;					if(parameter12.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.length&gt;0)&#xA;						parameter12=parameter12+&quot;,&quot;;&#xA;					if(parameter32.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter32.length&gt;0)&#xA;						parameter32=parameter32+&quot;,&quot;;&#xA;				} else {&#xA;					parameter1[1][2]=parameter12;&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter1[3][2]=parameter32;&#xA;				}&#xA;				connectors[2][0]=lastElement;&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.indexOf(&quot;,&quot;)&lt;0)&#xA;					lastElement=createCZcomplex(correctCR, thePackage, parameter1, connectors,1);&#xA;				else&#xA;					lastElement=createCZcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;			} while(parameter12.indexOf(&quot;,&quot;)&gt;0);	&#xA;		} while(parameter11.indexOf(&quot;,&quot;)&gt;0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from business class diagram to system use case realization diagram&#xA;function createCZcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var targetDiagram;&#xA;	var activityPartitions = [];	&#xA;	&#xA;	targetDiagram==null;&#xA;	conns = connectors1;&#xA;	if(parameters.length&lt;=4)&#xA;		return;&#xA;	targetDiagram=parameters.pop();&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;SUCRD&quot;,targetDiagram);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for SUCRD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Action&quot;;&#xA;	nameOfElement2=&quot;Object&quot;;&#xA;	nameOfElement3=&quot;Object&quot;;&#xA;	//setting values ??in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0); &#xA;	//pattern-driven rule in nameElement1 - CchZiv({{pattern}})&#xA;	if(nameElement2.substr(0,2)==&quot;{{&quot; &amp;&amp; nameElement1.substr(nameElement1.length-2,2)==&quot;}}&quot;) {&#xA;		var namePattern=nameElement2.substr(2); //Retrieve name pattern from the first parameter&#xA;		namePattern=namePattern.substr(0,namePattern.length-2);		&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;); // Fetch XML content from URL&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			var nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;); //Retrieve package name&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			//activityPartitions=retrieveXMLNames(xmlContent, &quot;ActivityPartition&quot;, &quot;alias&quot;, &quot;UML:ActionState name=&quot;,0); //Retrieve partition names&#xA;			//activityPartitions=activityPartitions.sort();&#xA;			objectClasses=retrieveXMLNames(xmlContent, &quot;classname&quot;, &quot;stateflags&quot;, 'keywords&quot; value=', 1); //Retrieve objectclass names - option B: &quot;keywords&quot;, &quot;UML:ClassifierRole name=&quot;, 0&#xA;			objectClasses=objectClasses.sort();&#xA;			var project = Repository.GetProjectInterface();&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1); //the imported package&#xA;			if(result==null) //something wrong with the imported package&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null) //something wrong with the imported package&#xA;				return;&#xA;			var moving=renamePatternObjects(nameElement1, conns[0][1], objectClasses, null, subPackage, subChildPackage); //Rename object classes according to the values ??given in the objectClasses parameter&#xA;			if(subChildPackage !=null&amp;&amp;moving) //moving partitions from the changed pattern to the current package&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			return;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML from URL: &quot; + xhr.staxtusText);&#xA;		}&#xA;	}&#xA;	//Searching the target package&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredObjectElements(subPackage, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;		activityPartitions=desiredPackElements[3];&#xA;	} &#xA;	if(conns[2][0]!=null)&#xA;		delement3 = conns[2][0];&#xA;	//Searching the target diagram&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;	&#xA;&#xA;	if(delement1!=null)&#xA;		diagramObject1=searchedObjectinDiagram(subPackage, delement1);&#xA;	if(delement2!=null)&#xA;		diagramObject2=searchedObjectinDiagram(subPackage, delement2);	&#xA;	if(delement3!=null)&#xA;		diagramObject3=searchedObjectinDiagram(subPackage, delement3);&#xA;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //CchZiv&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Action&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				delement1new=true;&#xA;			} &#xA;			delement1=testElement;&#xA;		} //else it means that this element is outside of current package&#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //CchZiv&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement2;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;) {&#xA;					if(params[3][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][1].substr(0,params[3][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][1];&#xA;				} else&#xA;				if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][0].substr(0,params[2][0].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][0];&#xA;				} else &#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} &#xA;				if(nameOfObject==&quot;Start&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype==100;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				testElement.Update();&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //CchZiv&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement3;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;) {&#xA;					if(params[3][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][2].substr(0,params[3][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][2];&#xA;				} else&#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(params[2][1]!=null&amp;&amp;params[2][1]!=&quot;&quot;&amp;&amp;params[2][1]!=&quot; &quot;) {&#xA;					if(params[2][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][1].substr(0,params[2][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][1];&#xA;				} &#xA;				if(nameOfObject==&quot;End&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype=101;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				testElement.Update();&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the input element and the middle element&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //CchZiv&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i); //a nie delement2?&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement2.Name==&quot;Start&quot;)&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement2.ElementID;&#xA;				connector.Update();&#xA;				delement1.Update();	&#xA;				delement2.Connectors.Refresh();&#xA;				delement1.Connectors.Refresh();&#xA;			}	&#xA;			//a connection must be created between the element to which the input element is connected at the output and the middle element&#xA;			var tmpObject as EA.Element;&#xA;			tmpObject=null;&#xA;			for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;				var connector1=delement2.Connectors.GetAt(i);&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement2.ElementID&amp;&amp;connector1.ClientID!=delement1.ElementID) {&#xA;					tmpObject=Repository.GetElementByID(connector1.ClientID);&#xA;					if(tmpObject.Type==&quot;Action&quot; ||tmpObject.Type==&quot;Activity&quot;)					&#xA;						break; //The input object is connected as an output object to another action&#xA;					else&#xA;						tmpObject=null;&#xA;				}&#xA;			}&#xA;			if(tmpObject!=null) {&#xA;				//you need to check if this connection already exists&#xA;				for(i=0;i&lt;tmpObject.Connectors.Count;i++) {&#xA;					var connector1=tmpObject.Connectors.GetAt(i);&#xA;					if(connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==tmpObject.ElementID) {&#xA;						tmpObject=null;&#xA;						break;&#xA;					}&#xA;				}&#xA;				if(tmpObject!=null) {&#xA;					connector = tmpObject.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;					connector.SupplierID = delement1.ElementID;&#xA;					connector.Update();&#xA;					tmpObject.Update();		&#xA;				}					&#xA;			}&#xA;		}&#xA;	}&#xA;	//a connection must be created between the middle element and the output element&#xA;	if(delement1!=null&amp;&amp;delement3!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //CchZiv&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i);&#xA;				if(delement3.Name!=&quot;End&quot;&amp;&amp;connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID||&#xA;				   delement3.Name==&quot;End&quot;&amp;&amp;connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement3.Name==&quot;End&quot;)&#xA;					connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement1.ElementID;&#xA;				connector.Update();&#xA;				delement3.Update();	&#xA;				delement1.Connectors.Refresh();&#xA;				delement3.Connectors.Refresh();&#xA;			}	&#xA;		}&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var left=100;&#xA;	var top=-100;&#xA;	var thisActivityPartition as EA.DiagramObject;&#xA;	thisActivityPartition=null;&#xA;	if(delement1.ParentID&gt;0) {&#xA;		for( var i = 0; i &lt; testDiagram.DiagramObjects.Count; i++) {&#xA;			if((testDiagram.DiagramObjects.GetAt(i)).ElementID==delement1.ParentID) {&#xA;				thisActivityPartition=testDiagram.DiagramObjects.GetAt(i);&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(thisActivityPartition!=null) { &#xA;			left=thisActivityPartition.left+(thisActivityPartition.right-thisActivityPartition.left)/2;&#xA;			top=thisActivityPartition.top-100;&#xA;		}&#xA;	}&#xA;	if(diagramObject1==null) {&#xA;		var diagramObjects as EA.Collection;&#xA;		&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		diagramObjects.Refresh();&#xA;		if(delement1!=null&amp;&amp;(delement1.Type==&quot;Activity&quot;||delement1.Type==&quot;Action&quot;)) {&#xA;			if(thisActivityPartition!=null&amp;&amp;delement1.ParentID==thisActivityPartition.ElementID) {  //if the action is in the Activitypatition&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;		&#xA;				//if there are other elements in the partition, we should set the left edge of the action to the right of the last element of the partition&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null&amp;&amp;existElementObject.ParentID==thisActivityPartition.ElementID&amp;&amp;&#xA;						(existElementObject.Type==&quot;Activity&quot;||existElementObject.Type==&quot;Action&quot;||existElementObject.Type==&quot;Object&quot;||&#xA;						 existElementObject.Type==&quot;Event&quot;||existElementObject.Type==&quot;StateNode&quot;||existElementObject.Type==&quot;Decision&quot;||existElementObject.Type==&quot;MergeNode&quot;)) {&#xA;						if(existDiagramObject.left&gt;thisActivityPartition.left&amp;&amp;existDiagramObject.right&lt;thisActivityPartition.right&amp;&amp;&#xA;							existDiagramObject.top&lt;thisActivityPartition.top&amp;&amp;existDiagramObject.bottom&gt;thisActivityPartition.bottom&amp;&amp;existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;						if(top&lt;diagramObject1.bottom+50) {&#xA;							thisActivityPartition.bottom=top-100;&#xA;							thisActivityPartition.Update();&#xA;						}&#xA;					}&#xA;				}				&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left-35;&#xA;			testDiagramObject.right=left+35;&#xA;			testDiagramObject.top=top;  //-15;&#xA;			testDiagramObject.bottom=top-45;  //-60;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;		} &#xA;	} else { &#xA;		if(delement1!=null&amp;&amp;(delement1.Type==&quot;Activity&quot;||delement1.Type==&quot;Action&quot;)) {&#xA;			if(thisActivityPartition!=null&amp;&amp;delement1.ParentID==thisActivityPartition.ElementID) { //if delement1 is the part of the partition&#xA;				//if delement1 is placed outside the partition&#xA;				if(diagramObject1.left&lt;thisActivityPartition.left||diagramObject1.right&gt;thisActivityPartition.right|| &#xA;					diagramObject1.top&gt;thisActivityPartition.top||diagramObject1.bottom&lt;thisActivityPartition.bottom) {&#xA;					//setting the left border inside the partition	&#xA;					var left1=setLeftBorderOfPartition(diagramObjects, thisActivityPartition);&#xA;					if(left1&gt;left)&#xA;						left=left1;&#xA;					diagramObject1.left=left+100;&#xA;					diagmObject1.Update();&#xA;				}&#xA;				//placingElementOfAction(delement2, diagramObjects, diagramObject1, diagramObject2,0); &#xA;			}&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element2 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null) {&#xA;			var left=diagramObject1.right;&#xA;			var top=diagramObject1.bottom;&#xA;			if(delement2.ParentID&gt;0) {&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ ) {&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==delement2.ParentID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;						if(top-50&lt;partycjaObjTmp.bottom) {&#xA;							partycjaObjTmp.bottom=top-100;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}			&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2.Name==&quot;Start&quot;) { //InitialNode&#xA;				testDiagramObject.left=left-70;&#xA;				testDiagramObject.right=left-40;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-34;&#xA;			} else {			&#xA;				testDiagramObject.left=left+50;&#xA;				testDiagramObject.right=left+120;&#xA;				testDiagramObject.top=top-13;&#xA;				testDiagramObject.bottom=top-50;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;		}&#xA;	} &#xA;	if(diagramObject3==null) {&#xA;		// Add the element3 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null) {&#xA;			var left=diagramObject1.right;&#xA;			var top=diagramObject1.top;&#xA;			if(delement3.ParentID&gt;0) {&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ ) {&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==delement3.ParentID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				testDiagramObject.left=left+145;&#xA;				testDiagramObject.right=left+175;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-33;&#xA;			} else {&#xA;				testDiagramObject.left=left+50;&#xA;				testDiagramObject.right=left+120;&#xA;				testDiagramObject.top=top+50;&#xA;				testDiagramObject.bottom=top+13;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	} else {&#xA;		var left=diagramObject1.right;&#xA;		var top=diagramObject1.top;&#xA;		if(delement3.ParentID&gt;0) {&#xA;			diagramObject=null;&#xA;			for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;			{&#xA;				var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;				if(partycjaObjTmp.ElementID==delement3.ParentID) {&#xA;					diagramObject=partycjaObjTmp;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(diagramObject!=null) {&#xA;				if(diagramObject3.left&lt;diagramObject.left||diagramObject3.right&gt;diagramObject.right||diagramObject3.top&gt;diagramObject.top||diagramObject3.bottom&lt;diagramObject.bottom) {&#xA;					if(delement3.Name==&quot;End&quot;) {&#xA;						diagramObject3.left=left+145;&#xA;						diagramObject3.right=left+175;&#xA;						diagramObject3.top=top-3;&#xA;						diagramObject3.bottom=top-33;&#xA;					} else {&#xA;						diagramObject3.left=left+50;&#xA;						diagramObject3.right=left+120;&#xA;						diagramObject3.top=top+50;&#xA;						diagramObject3.bottom=top+13;&#xA;					}&#xA;					diagramObject3.Update();					&#xA;				}&#xA;			}&#xA;		} else {&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				diagramObject3.left=left+145;&#xA;				diagramObject3.right=left+175;&#xA;				diagramObject3.top=top-3;&#xA;				diagramObject3.bottom=top-33;&#xA;			} else {&#xA;				diagramObject3.left=left+50;&#xA;				diagramObject3.right=left+120;&#xA;				diagramObject3.top=top+50;&#xA;				diagramObject3.bottom=top+13;&#xA;			}&#xA;			diagramObject3.Update();				&#xA;		}&#xA;	}&#xA;	return delement2;&#xA;}&#xA;//Multiple calls to createRAcomplex depending on multi-value parameters&#xA;function createSZcomplexZiv(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var parameter11;&#xA;var parameter31;&#xA;var parameter12;&#xA;var parameter32;&#xA;var pathToPackage;&#xA;var lastElement as EA.Element;&#xA;	&#xA;	iteration=Math.floor(iteration);&#xA;	pathToPackage=parameters.pop();&#xA;	lastElement=null;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1.push(pathToPackage);&#xA;		parameter1[1][0]=parameters[1][2*n+1];&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;			parameter1[1][0]=(n+1)+&quot;. Action&quot;;&#xA;		parameter11=parameters[1][2*n];&#xA;		if(parameter11==null||parameter11==&quot;&quot;||parameter11==&quot; &quot;)&#xA;			parameter11=&quot;:&quot;+connectors[0][0].Name;&#xA;		parameter32=parameters[3][2*n];&#xA;		parameter12=parameters[1][2*n+2];&#xA;		if(parameter12==null||parameter12==&quot;&quot;||parameter12==&quot; &quot;)&#xA;			parameter12=&quot;:&quot;+connectors[0][0].Name;&#xA;		parameter31=parameters[3][2*n+2];&#xA;		do {&#xA;			if(parameter11.indexOf(&quot;,&quot;)&gt;0) {&#xA;				parameter1[1][1]=parameter11.substr(0,parameter11.indexOf(&quot;,&quot;));&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter11=parameter11.substr(parameter11.indexOf(&quot;,&quot;)+1);&#xA;				parameter1[3][1]=parameter31.substr(0,parameter31.indexOf(&quot;,&quot;));&#xA;				parameter31=parameter31.substr(parameter31.indexOf(&quot;,&quot;)+1);&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter11.length&gt;0)&#xA;					parameter11=parameter11+&quot;,&quot;;&#xA;				if(parameter31.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter31.length&gt;0)&#xA;					parameter31=parameter31+&quot;,&quot;;&#xA;			} else {&#xA;				parameter1[1][1]=parameter11;&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter1[3][1]=parameter31;&#xA;			}&#xA;			do {&#xA;				if(parameter12.indexOf(&quot;,&quot;)&gt;0) {&#xA;					parameter1[1][2]=parameter12.substr(0,parameter12.indexOf(&quot;,&quot;));&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter12=parameter12.substr(parameter12.indexOf(&quot;,&quot;)+1);&#xA;					parameter1[3][2]=parameter32.substr(0,parameter32.indexOf(&quot;,&quot;));&#xA;					parameter32=parameter32.substr(parameter32.indexOf(&quot;,&quot;)+1);&#xA;					if(parameter12.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.length&gt;0)&#xA;						parameter12=parameter12+&quot;,&quot;;&#xA;					if(parameter32.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter32.length&gt;0)&#xA;						parameter32=parameter32+&quot;,&quot;;&#xA;				} else {&#xA;					parameter1[1][2]=parameter12;&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter1[3][2]=parameter32;&#xA;				}&#xA;				connectors[2][0]=lastElement;&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.indexOf(&quot;,&quot;)&lt;0)&#xA;					lastElement=createSZcomplex(correctCR, thePackage, parameter1, connectors,1);&#xA;				else&#xA;					lastElement=createSZcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;			} while(parameter12.indexOf(&quot;,&quot;)&gt;0);	&#xA;		} while(parameter11.indexOf(&quot;,&quot;)&gt;0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from business state machine state diagram to system use case realization diagram&#xA;function createSZcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var targetDiagram;&#xA;	var activityPartitions = [];	&#xA;	&#xA;	targetDiagram==null;&#xA;	conns = connectors1;&#xA;	if(parameters.length&lt;=4)&#xA;		return;&#xA;	targetDiagram=parameters.pop();&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;SUCRD&quot;,targetDiagram);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for SUCRD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Action&quot;;&#xA;	nameOfElement2=&quot;Object&quot;;&#xA;	nameOfElement3=&quot;Object&quot;;&#xA;	//setting values ??in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0); &#xA;	//pattern-driven rule in nameElement1 - CchZiv({{pattern}})&#xA;	if(nameElement2.substr(0,2)==&quot;{{&quot; &amp;&amp; nameElement1.substr(nameElement1.length-2,2)==&quot;}}&quot;) {&#xA;		var namePattern=nameElement2.substr(2); //Retrieve name pattern from the first parameter&#xA;		namePattern=namePattern.substr(0,namePattern.length-2);		&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;); // Fetch XML content from URL&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			var nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;); //Retrieve package name&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			//activityPartitions=retrieveXMLNames(xmlContent, &quot;ActivityPartition&quot;, &quot;alias&quot;, &quot;UML:ActionState name=&quot;,0); //Retrieve partition names&#xA;			//activityPartitions=activityPartitions.sort();&#xA;			objectClasses=retrieveXMLNames(xmlContent, &quot;classname&quot;, &quot;stateflags&quot;, 'keywords&quot; value=', 1); //Retrieve objectclass names - option B: &quot;keywords&quot;, &quot;UML:ClassifierRole name=&quot;, 0&#xA;			objectClasses=objectClasses.sort();&#xA;			var project = Repository.GetProjectInterface();&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1); //the imported package&#xA;			if(result==null) //something wrong with the imported package&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null) //something wrong with the imported package&#xA;				return;&#xA;			var moving=renamePatternObjects(nameElement1, conns[0][1], objectClasses, null, subPackage, subChildPackage); //Rename object classes according to the values ??given in the objectClasses parameter&#xA;			if(subChildPackage !=null&amp;&amp;moving) //moving partitions from the changed pattern to the current package&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			return;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML from URL: &quot; + xhr.staxtusText);&#xA;		}&#xA;	}&#xA;	//Searching the target package&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredObjectElements(subPackage, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;		activityPartitions=desiredPackElements[3];&#xA;	} &#xA;	if(conns[2][0]!=null)&#xA;		delement3 = conns[2][0];&#xA;	//Searching the target diagram&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;	&#xA;&#xA;	if(delement1!=null)&#xA;		diagramObject1=searchedObjectinDiagram(subPackage, delement1);&#xA;	if(delement2!=null)&#xA;		diagramObject2=searchedObjectinDiagram(subPackage, delement2);	&#xA;	if(delement3!=null)&#xA;		diagramObject3=searchedObjectinDiagram(subPackage, delement3);&#xA;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //SrsZiv&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Action&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				delement1new=true;&#xA;			} &#xA;			delement1=testElement;&#xA;		} //else it means that this element is outside of current package&#xA;	}&#xA;	if(delement2!=null) {&#xA;		var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+delement2.ElementID;&#xA;		var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;		var stateObject=null;&#xA;		var nameOfState=null;&#xA;		&#xA;		if(sqlRespond!=null)&#xA;			stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;		if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;			nameOfState=stateObject;	&#xA;		if(nameOfState==null) {//set the state of the current object&#xA;			if(nameElement2.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement2.indexOf(&quot;]&quot;)&gt;nameElement2.indexOf(&quot;[&quot;))&#xA;				nameOfState=nameElement2.substr(nameElement2.indexOf(&quot;[&quot;)+1,nameElement2.indexOf(&quot;]&quot;)-nameElement2.indexOf(&quot;[&quot;)-1);&#xA;			else&#xA;			if(params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;)&#xA;				nameOfState=params[3][1];&#xA;			if(nameOfState!=null&amp;&amp;nameOfState!=&quot;&quot;&amp;&amp;nameOfState!=&quot; &quot;) {&#xA;				var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+delement2.ElementID;&#xA;				Repository.Execute(sqlCommand);					&#xA;			}&#xA;		} else {&#xA;			if(nameElement2.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement2.indexOf(&quot;]&quot;)&gt;nameElement2.indexOf(&quot;[&quot;)&amp;&amp;&#xA;				nameElement2.substr(nameElement2.indexOf(&quot;[&quot;)+1,nameElement2.indexOf(&quot;]&quot;)-nameElement2.indexOf(&quot;[&quot;)-1)!=nameOfState||&#xA;				params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;&amp;&amp;nameOfState!=params[3][1]) //the found element has the other state&#xA;				delement2=null; //a new element&#xA;		}&#xA;	}	&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //SrsZiv&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement2;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(nameOfObject.indexOf(&quot;[&quot;)&lt;nameOfObject.indexOf(&quot;]&quot;)) {&#xA;					nameOfState=nameOfObject.substr(nameOfObject.indexOf(&quot;[&quot;)+1,nameOfObject.indexOf(&quot;]&quot;)-nameOfObject.indexOf(&quot;[&quot;)-1);&#xA;					var nameOfObject1=nameOfObject.substr(0,nameOfObject.indexOf(&quot;[&quot;))+nameOfObject.substr(nameOfObject.indexOf(&quot;]&quot;)+1);&#xA;					nameOfObject=nameOfObject1;&#xA;				}&#xA;				if(params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;) {&#xA;					if(params[3][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][1].substr(0,params[3][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][1];&#xA;				} else&#xA;				if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][0].substr(0,params[2][0].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][0];&#xA;				} else &#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(conns[0][0]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][0].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				} else&#xA;				if(conns[0][2]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][0].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				}&#xA;				if(nameOfObject==&quot;Start&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype==100;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				testElement.Update();&#xA;				if(nameOfState!=null&amp;&amp;nameOfObject!=&quot;Start&quot;) {&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);					&#xA;				}&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	if(delement3!=null) {&#xA;		var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+delement3.ElementID;&#xA;		var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;		var stateObject=null;&#xA;		var nameOfState=null;&#xA;		&#xA;		if(sqlRespond!=null)&#xA;			stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;		if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;			nameOfState=stateObject;	&#xA;		if(nameOfState==null) {//set the state of the current object&#xA;			if(nameElement3.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement3.indexOf(&quot;]&quot;)&gt;nameElement3.indexOf(&quot;[&quot;))&#xA;				nameOfState=nameElement3.substr(nameElement3.indexOf(&quot;[&quot;)+1,nameElement3.indexOf(&quot;]&quot;)-nameElement3.indexOf(&quot;[&quot;)-1);&#xA;			else&#xA;			if(params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;)&#xA;				nameOfState=params[3][2];&#xA;			if(nameOfState!=null&amp;&amp;nameOfState!=&quot;&quot;&amp;&amp;nameOfState!=&quot; &quot;) {&#xA;				var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+delement3.ElementID;&#xA;				Repository.Execute(sqlCommand);					&#xA;			}&#xA;		} else {&#xA;			if(nameElement3.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement3.indexOf(&quot;]&quot;)&gt;nameElement3.indexOf(&quot;[&quot;)&amp;&amp;&#xA;				nameElement3.substr(nameElement3.indexOf(&quot;[&quot;)+1,nameElement3.indexOf(&quot;]&quot;)-nameElement3.indexOf(&quot;[&quot;)-1)!=nameOfState||&#xA;				params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;&amp;&amp;nameOfState!=params[3][2]) //the found element has the other state&#xA;				delement3=null; //a new element&#xA;		}&#xA;	}	&#xA;	var delement3new=false;&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //SrsZiv&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement3;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(nameOfObject.indexOf(&quot;[&quot;)&lt;nameOfObject.indexOf(&quot;]&quot;)) {&#xA;					nameOfState=nameOfObject.substr(nameOfObject.indexOf(&quot;[&quot;)+1,nameOfObject.indexOf(&quot;]&quot;)-nameOfObject.indexOf(&quot;[&quot;)-1);&#xA;					var nameOfObject1=nameOfObject.substr(0,nameOfObject.indexOf(&quot;[&quot;))+nameOfObject.substr(nameOfObject.indexOf(&quot;]&quot;)+1);&#xA;					nameOfObject=nameOfObject1;&#xA;				} else&#xA;				if(params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;) {&#xA;					if(params[3][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][2].substr(0,params[3][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][2];&#xA;				} else&#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(params[2][1]!=null&amp;&amp;params[2][1]!=&quot;&quot;&amp;&amp;params[2][1]!=&quot; &quot;) {&#xA;					if(params[2][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][1].substr(0,params[2][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][1];&#xA;				} else &#xA;				if(conns[0][2]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][2].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				} else&#xA;				if(conns[0][0]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][2].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				}&#xA;				if(nameOfObject==&quot;End&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype=101;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				testElement.Update();&#xA;				if(nameOfState!=null) {&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);					&#xA;				}&#xA;				delement3new=true;&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the input element and the middle element&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //SrsZvi&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i); //a nie delement2?&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement2.Name==&quot;Start&quot;)&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement2.ElementID;&#xA;				connector.Update();&#xA;				delement1.Update();	&#xA;			}	&#xA;			//a connection must be created between the element to which the input element is connected at the output and the middle element&#xA;			var tmpObject as EA.Element;&#xA;			tmpObject=null;&#xA;			for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;				var connector1=delement2.Connectors.GetAt(i);&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement2.ElementID&amp;&amp;connector1.ClientID!=delement1.ElementID) {&#xA;					tmpObject=Repository.GetElementByID(connector1.ClientID);&#xA;					if(tmpObject.Type==&quot;Action&quot; ||tmpObject.Type==&quot;Activity&quot;)					&#xA;						break; //The input object is connected as an output object to another action&#xA;					else&#xA;						tmpObject=null;&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	//a connection must be created between the middle element and the output element&#xA;	if(delement1!=null&amp;&amp;delement3!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //RiviAvi&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i);&#xA;				if(delement3.Name!=&quot;End&quot;&amp;&amp;connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID||&#xA;				   delement3.Name==&quot;End&quot;&amp;&amp;connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement3.Name==&quot;End&quot;)&#xA;					connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement1.ElementID;&#xA;				connector.Update();&#xA;				delement3.Update();	&#xA;				delement1.Connectors.Refresh();&#xA;				delement3.Connectors.Refresh();&#xA;			}	&#xA;		}&#xA;	}&#xA;	var left=100;&#xA;	var top=-100;&#xA;	var thisActivityPartition as EA.DiagramObject;&#xA;	thisActivityPartition=null;&#xA;	if(delement1.ParentID&gt;0) {&#xA;		for( var i = 0; i &lt; testDiagram.DiagramObjects.Count; i++) {&#xA;			if((testDiagram.DiagramObjects.GetAt(i)).ElementID==delement1.ParentID) {&#xA;				thisActivityPartition=testDiagram.DiagramObjects.GetAt(i);&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(thisActivityPartition!=null) { &#xA;			left=thisActivityPartition.left+(thisActivityPartition.right-thisActivityPartition.left)/2;&#xA;			top=thisActivityPartition.top-100;&#xA;		}&#xA;	}&#xA;	//Add elements to the diagram&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null) {&#xA;			var ifPartition=false;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			if(delement3new==false&amp;&amp;delement1new==true&amp;&amp;delement3.ParentID&gt;0) {&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID==delement3.ParentID) {&#xA;						left=existDiagramObject.left+75; //25; //right=left+100&#xA;						top=existDiagramObject.top-(existDiagramObject.top-existDiagramObject.bottom)/2+23; //bottom=top-45&#xA;						ifPartition=true;&#xA;						break;&#xA;					}&#xA;				}					&#xA;			} 	&#xA;			if(!ifPartition) //true-delement3 was in the partition&#xA;				delement1new=true;&#xA;			if(delement1new) { //new element&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null) {&#xA;						if(existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			if(ifPartition&amp;&amp;diagramObject3!=null) {//delement3 was here in the Partition&#xA;				testDiagramObject.left=diagramObject3.left-100;//left;&#xA;				testDiagramObject.right=diagramObject3.left-20; //left+80;&#xA;				testDiagramObject.top=diagramObject3.top; //top;&#xA;				testDiagramObject.bottom=diagramObject3.bottom; //top-40;&#xA;				delement1.ParentID=delement3.ParentID;		&#xA;				delement1.Update();&#xA;			} else {&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+80;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-40;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;			&#xA;		}  else {&#xA;			Session.Output(&quot;Error at identifying element1-7720 line&quot;);&#xA;			return;&#xA;		}		&#xA;	} &#xA;	if(diagramObject2==null) {&#xA;		// Add the element2 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null) {&#xA;			var left=diagramObject1.right;&#xA;			var top=diagramObject1.bottom;&#xA;			if(delement2.ParentID&gt;0) {&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ ) {&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==delement2.ParentID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;						if(top-50&lt;partycjaObjTmp.bottom) {&#xA;							partycjaObjTmp.bottom=top-100;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}			&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2.Name==&quot;Start&quot;) { //InitialNode&#xA;				testDiagramObject.left=left-70;&#xA;				testDiagramObject.right=left-40;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-34;&#xA;			} else {			&#xA;				testDiagramObject.left=left+50;&#xA;				testDiagramObject.right=left+120;&#xA;				testDiagramObject.top=top-13;&#xA;				testDiagramObject.bottom=top-50;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;		}&#xA;	} &#xA;	if(diagramObject3==null) {&#xA;		// Add the element3 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null) {&#xA;			var left=diagramObject1.right;&#xA;			var top=diagramObject1.top;&#xA;			if(delement3.ParentID&gt;0) {&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ ) {&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==delement3.ParentID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				testDiagramObject.left=left+145;&#xA;				testDiagramObject.right=left+175;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-33;&#xA;			} else {&#xA;				testDiagramObject.left=left+50;&#xA;				testDiagramObject.right=left+120;&#xA;				testDiagramObject.top=top+50;&#xA;				testDiagramObject.bottom=top+13;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	} else {&#xA;		var left=diagramObject1.right;&#xA;		var top=diagramObject1.top;&#xA;		if(delement3.ParentID&gt;0) {&#xA;			diagramObject=null;&#xA;			for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;			{&#xA;				var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;				if(partycjaObjTmp.ElementID==delement3.ParentID) {&#xA;					diagramObject=partycjaObjTmp;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(diagramObject!=null) {&#xA;				if(diagramObject3.left&lt;diagramObject.left||diagramObject3.right&gt;diagramObject.right||diagramObject3.top&gt;diagramObject.top||diagramObject3.bottom&lt;diagramObject.bottom) {&#xA;					if(delement3.Name==&quot;End&quot;) {&#xA;						diagramObject3.left=left+145;&#xA;						diagramObject3.right=left+175;&#xA;						diagramObject3.top=top-3;&#xA;						diagramObject3.bottom=top-33;&#xA;					} else {&#xA;						diagramObject3.left=left+50;&#xA;						diagramObject3.right=left+120;&#xA;						diagramObject3.top=top+50;&#xA;						diagramObject3.bottom=top+13;&#xA;					}&#xA;					diagramObject3.Update();					&#xA;				}&#xA;			}&#xA;		} else {&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				diagramObject3.left=left+145;&#xA;				diagramObject3.right=left+175;&#xA;				diagramObject3.top=top-3;&#xA;				diagramObject3.bottom=top-33;&#xA;			} else {&#xA;				diagramObject3.left=left+50;&#xA;				diagramObject3.right=left+120;&#xA;				diagramObject3.top=top+50;&#xA;				diagramObject3.bottom=top+13;&#xA;			}&#xA;			diagramObject3.Update();				&#xA;		}&#xA;	}&#xA;	return delement2;&#xA;}&#xA;//Searching for future package elements in the target diagram&#xA;function getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3, mode) {&#xA;	var activityPartitions = [];&#xA;	var parameters = [ null,null,null,null]&#xA;	var currentElement as EA.Element;&#xA;	var cotoParent as EA.Element;&#xA;	var nameOfElement;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	ifComponent=false;&#xA;	//activityPartitions=null;&#xA;	&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(currentElement.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(currentElement.Type==&quot;Object&quot;) {&#xA;			var nameOfState;&#xA;			nameOfElement=currentElement.Name;&#xA;			var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+currentElement.ElementID;&#xA;			var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;			var stateObject=null;&#xA;			if(sqlRespond!=null)&#xA;				stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;			if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;				nameOfElement=nameOfElement+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;			if(cotoParent!=null)&#xA;				nameOfElement=nameOfElement+&quot;:&quot;+cotoParent.Name;&#xA;		} else&#xA;			nameOfElement=currentElement.Name;&#xA;&#xA;		if(nameOfElement==nameElement1||currentElement.Type==&quot;Component&quot;&amp;&amp;(&quot;:&quot;+nameOfElement==nameElement1))&#xA;			delement1=currentElement;&#xA;		else 		&#xA;		if(nameOfElement==nameElement2)&#xA;			delement2=currentElement;&#xA;		else 		&#xA;		if(nameOfElement==nameElement3||currentElement.Type==&quot;Component&quot;&amp;&amp;(&quot;:&quot;+nameOfElement==nameElement3))&#xA;			delement3=currentElement;&#xA;		if(currentElement.Type==&quot;Component&quot;)&#xA;			ifComponent=true;&#xA;		if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;delement3!=null)&#xA;			break;&#xA;		if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;			var brakDiagObj=false;&#xA;			for(var k = 0; k&lt; activityPartitions.length; k++) {&#xA;				if((activityPartitions[k][0]!=null&amp;&amp;activityPartitions[k][0]).ElementID==currentElement.ElementID) {&#xA;					activityPartitions[k][1]=currentElement;&#xA;					brakDiagObj=true;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(!brakDiagObj)&#xA;				activityPartitions.push([null, currentElement]);&#xA;			for ( var k = 0 ; k &lt; currentElement.Elements.Count ; k++ )&#xA;			{&#xA;				var currentElement1 as EA.Element;&#xA;				var cotoParent1 as EA.Element;&#xA;				var nameOfElement1;&#xA;&#xA;				currentElement1 = currentElement.Elements.GetAt( k );&#xA;				if(currentElement1.ClassifierID&gt;0)&#xA;					cotoParent1=Repository.GetElementByID(currentElement1.ClassifierID);&#xA;				else&#xA;					cotoParent1=null;&#xA;				if(currentElement1.Type==&quot;Object&quot;) {&#xA;					var nameOfState;&#xA;					nameOfElement1=currentElement1.Name;&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+currentElement1.ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfElement1=nameOfElement1+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;					if(cotoParent1!=null)&#xA;						nameOfElement1=nameOfElement1+&quot;:&quot;+cotoParent1.Name;&#xA;				} else&#xA;					nameOfElement1=currentElement1.Name;&#xA;				&#xA;				if(nameOfElement1==nameElement1) //RevBa()u&#xA;					delement1=currentElement1;&#xA;				else 		&#xA;				if(nameOfElement1==nameElement2) //RevBau()&#xA;					delement2=currentElement1;&#xA;				else 		&#xA;				if(nameOfElement1==nameElement3) //RevBau()&#xA;					delement3=currentElement1;&#xA;				if(delement1!=null&amp;&amp;(delement2!=null||nameElement2==null)&amp;&amp;(delement3!=null||nameElement3==null))&#xA;					break;&#xA;				if(currentElement1.Type==&quot;ActivityPartition&quot;) {&#xA;					var brakDiagObj=false;&#xA;					for(var l = 0; m&lt; activityPartitions.length; l++) {&#xA;						if((activityPartitions[l][0]!=null&amp;&amp;activityPartitions[l][0]).ElementID==currentElement.ElementID) {&#xA;							activityPartitions[l][1]=currentElement1;&#xA;							brakDiagObj=true;&#xA;							break;&#xA;						}&#xA;					}&#xA;					if(!brakDiagObj)&#xA;						activityPartitions.push([null, currentElement1]);					&#xA;					for ( var l = 0 ; l &lt; currentElement1.Elements.Count ; l++ )&#xA;					{&#xA;						var currentElement2 as EA.Element;&#xA;						var cotoParent2 as EA.Element;&#xA;						var nameOfElement2;&#xA;						&#xA;						currentElement2 = currentElement1.Elements.GetAt( l );&#xA;						if(currentElement2.ClassifierID&gt;0)&#xA;							cotoParent2=Repository.GetElementByID(currentElement2.ClassifierID);&#xA;						else&#xA;							cotoParent2=null;&#xA;						if(currentElement2.Type==&quot;Object&quot;) {&#xA;							var nameOfState;&#xA;							&#xA;							nameOfElement2=currentElement2.Name;&#xA;							var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+currentElement2.ElementID;&#xA;							var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;							var stateObject=null;&#xA;							if(sqlRespond!=null)&#xA;								stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;								nameOfElement2=nameOfElement2+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;							if(cotoParent2!=null)&#xA;								nameOfElement2=nameOfElement2+&quot;:&quot;+cotoParent2.Name;&#xA;						} else&#xA;							nameOfElement2=currentElement2.Name;&#xA;						&#xA;						if(nameOfElement2==nameElement1) //RevBa()u&#xA;							delement1=currentElement2;&#xA;						else 		&#xA;						if(nameOfElement2==nameElement2) //RevBau()&#xA;							delement2=currentElement2;&#xA;						else 		&#xA;						if(nameOfElement2==nameElement3) //RevBau()&#xA;							delement3=currentElement2;&#xA;						if(delement1!=null&amp;&amp;(delement2!=null||nameElement2==null)&amp;&amp;(delement3!=null||nameElement3==null))&#xA;							break;						&#xA;					}					&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	if(ifComponent&amp;&amp;delement1!=null&amp;&amp;delement3!=null&amp;&amp;delement2==null) {&#xA;		for(var k = 0; k&lt; delement1.Connectors.Count; k++) {&#xA;			var currentElement as EA.Connector;&#xA;			currentElement=delement1.Connectors.GetAt(k);&#xA;			if(currentElement.ClientID==delement1.ElementID&amp;&amp;currentElement.SupplierID==delement3.ElementID&amp;&amp;currentElement.Name==nameElement2) {&#xA;				delement2=currentElement;&#xA;				break;&#xA;			}&#xA;		}	&#xA;	}			&#xA;	parameters[0]=delement1;&#xA;	parameters[1]=delement2;&#xA;	parameters[2]=delement3;&#xA;	parameters[3]=activityPartitions;&#xA;	return parameters;&#xA;}&#xA;//Searching for future package elements in the target diagram&#xA;function getDesiredPackSequences(delements, nameElement1, nameElement2, nameElement3, mode) {&#xA;	var parameters = [ null,null,null,null]&#xA;	var currentElement as EA.Element;&#xA;	var cotoParent as EA.Element;&#xA;	var nameConnector2;&#xA;	var nameConnector2Parameter;&#xA;	var nameConnector4;&#xA;	var nameConnector4Parameter;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Connector;&#xA;	var delement3 as EA.Element;&#xA;	var delement4 as EA.Connector;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	delement4 = null;&#xA;	&#xA;	//downLoad&lt;Requests&gt;::Request&#xA;	if(nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;) {&#xA;		if(nameElement2.indexOf(&quot;::&quot;)&gt;-1)&#xA;			nameConnector2 = nameElement2.substr(0,nameElement2.indexOf(&quot;::&quot;));&#xA;		else&#xA;			nameConnector2 = nameElement2;&#xA;		if(nameConnector2.indexOf(&quot;&lt;&quot;)&gt;-1&amp;&amp;nameConnector2.indexOf(&quot;&gt;&quot;)&gt;nameConnector2.indexOf(&quot;&lt;&quot;)) {&#xA;			nameConnector2Parameter = nameConnector2.substr(nameConnector2.indexOf(&quot;&lt;&quot;)+1,nameConnector2.indexOf(&quot;&gt;&quot;)-nameConnector2.indexOf(&quot;&lt;&quot;)-1);&#xA;			nameConnector2 = nameElement2.substr(0,nameElement2.indexOf(&quot;&lt;&quot;));&#xA;		} else&#xA;			nameConnector2Parameter=&quot;&quot;;&#xA;		if(nameElement2.indexOf(&quot;::&quot;)&gt;-1)&#xA;			nameConnector4Parameter=nameElement2.substr(nameElement2.indexOf(&quot;::&quot;)+2);&#xA;		else&#xA;			nameConnector4Parameter=&quot;&quot;;&#xA;	}&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.Type==&quot;Sequence&quot;) {&#xA;			if(currentElement.Name==nameElement1) &#xA;				delement1=currentElement;&#xA;			else 		&#xA;			if(currentElement.Name==nameElement3)&#xA;				delement3=currentElement;&#xA;		}&#xA;	}&#xA;	if(delement1!=null&amp;&amp;delement1.Connectors.Count&gt;0) {&#xA;		for(var k = 0; k&lt; delement1.Connectors.Count; k++) {&#xA;			var connector = delement1.Connectors.GetAt(k);&#xA;			var sqlCommand=&quot;select PDATA4 from t_connector where Connector_ID = &quot;+connector.ConnectorID;&#xA;			var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;			var returnObject=null;&#xA;			if(sqlRespond!=null) {&#xA;				var start = sqlRespond.indexOf(&quot;&lt;PDATA4&gt;&quot;)+8;&#xA;				var koniec= sqlRespond.indexOf(&quot;&lt;/PDATA4&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;PDATA4&gt;&quot;)-8;&#xA;				returnObject=sqlRespond.substr(start, koniec);&#xA;			}&#xA;			if(delement2==null&amp;&amp;(delement3!=null&amp;&amp;connector.Name==nameConnector2&amp;&amp;connector.ClientID==delement1.ElementID&amp;&amp;connector.SupplierID==delement3.ElementID||&#xA;				delement3==null&amp;&amp;connector.Name==nameConnector2&amp;&amp;connector.ClientID==delement1.ElementID&amp;&amp;connector.SupplierID==delement1.ElementID)) //samecall&#xA;				delement2=getDesiredPackSequencesConnectors(connector,returnObject,nameConnector2Parameter);&#xA;			else&#xA;			if(delement4==null&amp;&amp;(delement3!=null&amp;&amp;connector.Name==&quot;&quot;&amp;&amp;connector.ClientID==delement3.ElementID&amp;&amp;connector.SupplierID==delement1.ElementID||&#xA;				delement3==null&amp;&amp;connector.Name==&quot;&quot;&amp;&amp;connector.ClientID==delement1.ElementID&amp;&amp;connector.SupplierID==delement1.ElementID))&#xA;				delement4=getDesiredPackSequencesConnectors(connector,returnObject,nameConnector4Parameter);	&#xA;			if(delement2!=null&amp;&amp;delement4!=null)&#xA;				break;&#xA;		}&#xA;	}&#xA;	if(delement3!=null&amp;&amp;delement3.Connectors.Count&gt;0) {&#xA;		for(var k = 0; k&lt; delement3.Connectors.Count; k++) {&#xA;			if(delement2!=null&amp;&amp;delement4!=null)&#xA;				break;&#xA;			var connector = delement3.Connectors.GetAt(k);&#xA;			var sqlCommand=&quot;select PDATA4 from t_connector where Connector_ID = &quot;+connector.ConnectorID;&#xA;			var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;			var returnObject=null;&#xA;			if(sqlRespond!=null) {&#xA;				var start = sqlRespond.indexOf(&quot;&lt;PDATA4&gt;&quot;)+8;&#xA;				var koniec= sqlRespond.indexOf(&quot;&lt;/PDATA4&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;PDATA4&gt;&quot;)-8;&#xA;				returnObject=sqlRespond.substr(start, koniec);&#xA;			}&#xA;			if(delement2!=null&amp;&amp;(delement1!=null&amp;&amp;connector.Name==nameConnector2&amp;&amp;connector.ClientID==delement3.ElementID&amp;&amp;connector.SupplierID==delement1.ElementID||&#xA;				delement1==null&amp;&amp;connector.Name==nameConnector2&amp;&amp;connector.ClientID==delement3.ElementID&amp;&amp;connector.SupplierID==delement3.ElementID))&#xA;				delement2=getDesiredPackSequencesConnectors(connector,returnObject,nameConnector2Parameter);&#xA;			else&#xA;			if(delement4!=null&amp;&amp;(delement1!=null&amp;&amp;connector.Name==&quot;&quot;&amp;&amp;connector.ClientID==delement1.ElementID&amp;&amp;connector.SupplierID==delement3.ElementID||&#xA;				delement1==null&amp;&amp;connector.Name==&quot;&quot;&amp;&amp;connector.ClientID==delement3.ElementID&amp;&amp;connector.SupplierID==delement3.ElementID))&#xA;				delement4=getDesiredPackSequencesConnectors(connector,returnObject,nameConnector4Parameter);		&#xA;		}&#xA;	}	&#xA;	parameters[0]=delement1;&#xA;	parameters[1]=delement2;&#xA;	parameters[2]=delement3;&#xA;	parameters[3]=delement4;&#xA;	return parameters;&#xA;}&#xA;function getDesiredPackSequencesConnectors(connector,returnObject,nameConnectorParameter) {&#xA;	var connParameter=connector.TransitionGuard;&#xA;	&#xA;	if(returnObject!=null&amp;&amp;returnObject!=&quot;&quot;&amp;&amp;returnObject==&quot;0&quot;&amp;&amp;connParameter!=null&amp;&amp;connParameter.indexOf(&quot;paramsDlg=&quot;)&gt;-1) {&#xA;		connParameter=connParameter.substr(connParameter.indexOf(&quot;paramsDlg=&quot;)+10);&#xA;		if(connParameter!=null&amp;&amp;connParameter!=&quot;&quot;)&#xA;			connParameter=connParameter.substr(0,connParameter.indexOf(&quot;;&quot;));&#xA;	} else&#xA;	if(returnObject!=null&amp;&amp;returnObject!=&quot;&quot;&amp;&amp;returnObject==&quot;1&quot;&amp;&amp;connParameter!=null&amp;&amp;connParameter!=&quot;&quot;) {&#xA;		connParameter=connParameter.substr(connParameter.indexOf(&quot;retval=&quot;)+7);&#xA;		if(connParameter!=null&amp;&amp;connParameter!=&quot;&quot;)&#xA;			connParameter=connParameter.substr(0,connParameter.indexOf(&quot;;&quot;));&#xA;	} else&#xA;		connParameter=&quot;&quot;;&#xA;	if(nameConnectorParameter!=null&amp;&amp;nameConnectorParameter!=&quot;&quot;&amp;&amp;connParameter!=null&amp;&amp;connParameter!=&quot;&quot;&amp;&amp;connParameter==nameConnectorParameter||&#xA;		(nameConnectorParameter==null||nameConnectorParameter==&quot;&quot;)&amp;&amp;(connParameter==null||connParameter==&quot;&quot;||connParameter==&quot;null&quot;||connParameter==&quot;void&quot;)) {&#xA;		return connector;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Return all messages from the testDiagram&#xA;function getDesiredDiagramSequences(testDiagram) {&#xA;	var diagramConnectors = [];&#xA;	var objectDiagram as EA.DiagramObject;&#xA;	&#xA;	for( var k = 0; k&lt;testDiagram.DiagramObjects.Count; k++) {&#xA;		var objectDiagram=testDiagram.DiagramObjects.GetAt(k);&#xA;		var elementDiagram=Repository.GetElementByID(objectDiagram.ElementID);&#xA;		if(elementDiagram.Type==&quot;Sequence&quot;) {&#xA;			for( var l = 0; l&lt;elementDiagram.Connectors.Count; l++) {&#xA;				var connector=elementDiagram.Connectors.GetAt(l);&#xA;				if(connector.ClientID==elementDiagram.ElementID)&#xA;					diagramConnectors.push(connector)&#xA;			}&#xA;		}&#xA;	}&#xA;	if(diagramConnectors.length&lt;=0)&#xA;		return null;&#xA;	return diagramConnectors;&#xA;}	&#xA;//Searching for future package objects connected to nameElement1 with input as nameElement2 and output as nameElement3&#xA;function getDesiredObjectElements(subPackage, nameElement1, nameElement2, nameElement3) {&#xA;	var parameters = [ null,null,null,null]&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	var activityPartition=[];&#xA;	&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; subPackage.Elements.Count ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;&#xA;		currentElement = subPackage.Elements.GetAt( j );&#xA;		if(delement1==null&amp;&amp;currentElement.Name==nameElement1)  {//CchZiv&#xA;			delement1=currentElement;&#xA;			//break;&#xA;		}&#xA;		if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;			activityPartition.push(currentElement);&#xA;			for ( var k = 0 ; k &lt; currentElement.Elements.Count ; k++ )&#xA;			{&#xA;				var currentElement1 as EA.Element;&#xA;&#xA;				currentElement1 = currentElement.Elements.GetAt( k );&#xA;				if(delement1==null&amp;&amp;currentElement1.Name==nameElement1) {//CchZiv&#xA;					delement1=currentElement1;&#xA;					break;&#xA;				}&#xA;				if(currentElement1.Type==&quot;ActivityPartition&quot;) {&#xA;					activityPartition.push(currentElement1);&#xA;					for ( var l = 0 ; l &lt; currentElement1.Elements.Count ; l++ )&#xA;					{&#xA;						var currentElement2 as EA.Element;&#xA;						&#xA;						currentElement2 = currentElement1.Elements.GetAt( l );&#xA;						if(delement1==null&amp;&amp;currentElement2.Name==nameElement1) { //CchZiv&#xA;							delement1=currentElement2;&#xA;							break;&#xA;						}&#xA;					}					&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	if(delement1==null)&#xA;		return parameters;&#xA;	parameters[0]=delement1;&#xA;	var tmpObjectIn as EA.Element;&#xA;	var tmpObjectOut as EA.Element;&#xA;	tmpObjectIn=null;&#xA;	tmpObjectOut=null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for( var j = 0; j &lt; delement1.Connectors.Count; j++) {&#xA;		var connector = delement1.Connectors.GetAt(j);&#xA;		&#xA;		if(delement3==null&amp;&amp;connector.SupplierID==delement1.ElementID) { //input object&#xA;			tmpObjectIn=Repository.GetElementByID(connector.ClientID);&#xA;			if(tmpObjectIn.Type==&quot;Object&quot;) {&#xA;				var tmpClassObject = Repository.GetElementByID(tmpObjectIn.ClassifierID);&#xA;				if(nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;&amp;&amp;nameElement3.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement3.indexOf(&quot;[&quot;)&lt;nameElement3.indexOf(&quot;]&quot;)) {&#xA;					var nameTmpElement=nameElement3.substr(0,nameElement3.indexOf(&quot;[&quot;))+nameElement3.substr(nameElement3.indexOf(&quot;]&quot;)+1);&#xA;					if(tmpObjectIn.Name+&quot;:&quot;+tmpClassObject.Name==nameTmpElement) {&#xA;						var nameOfStateTarget=nameElement3.substr(nameElement3.indexOf(&quot;[&quot;)+1, nameElement3.indexOf(&quot;]&quot;)-nameElement3.indexOf(&quot;[&quot;)-1);&#xA;						var nameOfStateSource=null;&#xA;						var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+tmpObjectIn.ElementID;&#xA;						var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;						var stateObject=null;&#xA;						if(sqlRespond!=null)&#xA;							stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;						if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;							nameOfStateSource=stateObject;&#xA;						if(nameOfStateSource==null||nameOfStateTarget==&quot;&quot;||nameOfStateSource==nameOfStateTarget)&#xA;							delement3=tmpObjectIn;	&#xA;					}						&#xA;				} else&#xA;				if(tmpObjectIn.Name+&quot;:&quot;+tmpClassObject.Name==nameElement3)&#xA;					delement3=tmpObjectIn;&#xA;			}&#xA;		} else&#xA;		if(delement2==null&amp;&amp;connector.ClientID==delement1.ElementID) { //output object&#xA;			tmpObjectOut=Repository.GetElementByID(connector.SupplierID);&#xA;			if(tmpObjectOut.Type==&quot;Object&quot;) {&#xA;				var tmpClassObject = Repository.GetElementByID(tmpObjectOut.ClassifierID);&#xA;				if(nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;&amp;&amp;nameElement2.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement2.indexOf(&quot;[&quot;)&lt;nameElement2.indexOf(&quot;]&quot;)) {&#xA;					var nameTmpElement=nameElement2.substr(0,nameElement2.indexOf(&quot;[&quot;))+nameElement2.substr(nameElement2.indexOf(&quot;]&quot;)+1);&#xA;					if(tmpObjectOut.Name+&quot;:&quot;+tmpClassObject.Name==nameElement2) {&#xA;						var nameOfStateTarget=nameElement3.substr(nameElement2.indexOf(&quot;[&quot;)+1, nameElement2.indexOf(&quot;]&quot;)-nameElement2.indexOf(&quot;[&quot;)-1);&#xA;						var nameOfStateSource=null;&#xA;						var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+tmpObjectOut.ElementID;&#xA;						var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;						var stateObject=null;&#xA;						if(sqlRespond!=null)&#xA;							stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;						if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;							nameOfStateSource=stateObject;&#xA;						if(nameOfStateSource==null||nameOfStateTarget==&quot;&quot;||nameOfStateSource==nameOfStateTarget)&#xA;							delement2=tmpObjectOut;	&#xA;					}						&#xA;					else&#xA;					if(tmpObjectOut.Name+&quot;:&quot;+tmpClassObject.Name==nameTmpElement)&#xA;						delement2=tmpObjectOut;						&#xA;				} else&#xA;				if(tmpObjectOut.Name+&quot;:&quot;+tmpClassObject.Name==nameElement2)&#xA;					delement2=tmpObjectOut;&#xA;			}&#xA;		} &#xA;		if(delement2!=null&amp;&amp;delement3!=null)&#xA;			break;&#xA;	}&#xA;	parameters[1]=delement2;&#xA;	parameters[2]=delement3;&#xA;	parameters[3]=activityPartition;&#xA;&#xA;	return parameters;&#xA;}&#xA;//Searching for future diagram objects in the target diagram&#xA;function getDesiredDiagObjects(diagramObjects, nameElement1, nameElement2, nameElement3) {&#xA;	//var activityPartitions = [];&#xA;	var parameters = [ null,null,null,null]&#xA;	var coto as EA.Element;&#xA;	var cotoParent as EA.Element;&#xA;	var nameOfElement;	&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var i = 0, j=0 ; i &lt; diagramObjects.Count ; i++ )&#xA;	{&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID&gt;0)&#xA;			coto=Repository.GetElementByID(diagramObject.ElementID);&#xA;		else&#xA;			coto=null;&#xA;		if(coto.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(coto.Type==&quot;Object&quot;) {&#xA;			var nameOfState;&#xA;			&#xA;			nameOfElement=coto.Name;&#xA;			var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+coto.ElementID;&#xA;			var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;			var stateObject=null;&#xA;			if(sqlRespond!=null)&#xA;				stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;			if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;				nameOfElement=nameOfElement+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;			if(cotoParent!=null)&#xA;				nameOfElement=nameOfElement+&quot;:&quot;+cotoParent.Name;&#xA;		} else&#xA;			nameOfElement=coto.Name;&#xA;		&#xA;		if(diagramObject1==null&amp;&amp;(nameOfElement==nameElement1||coto.Type==&quot;Component&quot;&amp;&amp;(&quot;:&quot;+nameOfElement==nameElement1))) //verification of an existing element in the B diagram&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		if(diagramObject2==null&amp;&amp;(nameOfElement==nameElement2)) //verification of an existing element in the B diagram&#xA;			diagramObject2=diagramObject; &#xA;		else&#xA;		if(diagramObject3==null&amp;&amp;(nameOfElement==nameElement3||coto.Type==&quot;Component&quot;&amp;&amp;(&quot;:&quot;+nameOfElement==nameElement3))) //verification of an existing element in the B diagram&#xA;			diagramObject3=diagramObject; 		//else&#xA;		//if(coto.Type==&quot;ActivityPartition&quot;)&#xA;		//	activityPartitions.push([diagramObject, null]);			&#xA;	}&#xA;	parameters[0]=diagramObject1;&#xA;	parameters[1]=diagramObject2;&#xA;	parameters[2]=diagramObject3;&#xA;	//parameters[3]=activityPartitions;	&#xA;	return parameters;&#xA;}&#xA;//Get the target package and target diagram, and if they don't exist, create them&#xA;function getTargetPackage(thePackage, type, nameOfSubPack) {&#xA;	var parameters = [ null,null];&#xA;	var childPackage as EA.Package;&#xA;	var subChildPackage as EA.Package;&#xA;	var theParentPackage as EA.Package;&#xA;	var nameOfsubPackageDiagram;&#xA;	var nameOfSubPackage;&#xA;	var nameOftheParent;&#xA;	var testSMDiagram; //Business State Diagram&#xA;	var testDiagram as EA.Diagram;	&#xA;	var stateMachine as EA.Element;&#xA;	&#xA;	if(type!=null&amp;&amp;type==&quot;SUCRD&quot;&amp;&amp;nameOfSubPack!=null&amp;&amp;nameOfSubPack.indexOf(&quot;,&quot;)&gt;-1) {&#xA;		nameOfsubPackageDiagram=nameOfSubPack.substr(0,nameOfSubPack.indexOf(&quot;,&quot;));&#xA;		nameOfSubPackage=nameOfSubPack.substr(nameOfSubPack.indexOf(&quot;,&quot;)+1);&#xA;	} else {&#xA;		nameOfSubPackage=nameOfSubPack;&#xA;		nameOfsubPackageDiagram=thePackage.Name;&#xA;	}&#xA;	if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;		tmp=nameOfsubPackageDiagram;&#xA;		nameOfsubPackageDiagram=nameOfSubPackage;&#xA;		nameOfSubPackage=tmp;&#xA;	} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;		tmp=nameOfsubPackageDiagram;&#xA;		nameOfsubPackageDiagram=nameOfSubPackage;&#xA;		nameOfSubPackage=tmp;		&#xA;	}&#xA;	subChildPackage=null;	&#xA;	// Get the parent package of the currently selected package&#xA;	theParentPackage = Repository.GetPackageByID(thePackage.ParentID); //Business Process Layer&#xA;	if(type==&quot;SEQD&quot;)&#xA;		nameOftheParent=theParentPackage.Name;&#xA;	if(thePackage.Name === &quot;Decomposition Processes&quot;||thePackage.Name === &quot;Business Use Cases&quot;)	&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID);&#xA;	if(thePackage.Name === &quot;Business Use Cases&quot;||thePackage.Name === &quot;Decomposition Processes&quot;&amp;&amp;type==&quot;BURD&quot;)&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID);&#xA;	if(type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;||type==&quot;SUCRD&quot;||type==&quot;IUCD&quot;||type==&quot;SEQD&quot;)&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //Business View&#xA;	if(type==&quot;SUCRD&quot;||type==&quot;IUCD&quot;||type==&quot;SEQD&quot;) {&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //System View&#xA;		if(type==&quot;SUCRD&quot;&amp;&amp;thePackage.Name!=&quot;Business Class&quot;&amp;&amp;thePackage.Name!=&quot;Business State&quot;||type==&quot;SEQD&quot;)&#xA;			theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //Model&#xA;		if(type==&quot;SEQD&quot;)&#xA;			theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //Model&#xA;	}&#xA;	if(type!=null&amp;&amp;type==&quot;CMPD&quot;) {&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //System View&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //System View&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //System View&#xA;	}&#xA;	// Recursively process any child packages of the parent package of the currently selected package&#xA;	var childPackageEnumerator = new Enumerator( theParentPackage.Packages );&#xA;	if(type==&quot;BURD&quot;||type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;||type==&quot;SUCRD&quot;||type==&quot;IUCD&quot;||type==&quot;SEQD&quot;) {&#xA;		while ( !childPackageEnumerator.atEnd() )&#xA;		{&#xA;			childPackage = childPackageEnumerator.item();&#xA;				&#xA;			if((type==&quot;BURD&quot;)&amp;&amp;childPackage.Name === &quot;Business View&quot;||&#xA;				(type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;)&amp;&amp;childPackage.Name === &quot;Logic Layer&quot;)&#xA;				break;&#xA;			else if((type==&quot;SUCRD&quot;)&amp;&amp;childPackage.Name === &quot;System View&quot;)&#xA;				break;&#xA;			else if((type==&quot;IUCD&quot;)&amp;&amp;childPackage.Name === &quot;Internal Layer&quot;)&#xA;				break;				&#xA;			else if((type==&quot;SEQD&quot;)&amp;&amp;childPackage.Name === &quot;Deployment View&quot;)&#xA;				break;	&#xA;			childPackageEnumerator.moveNext();&#xA;		}	&#xA;		if(type==&quot;BURD&quot;&amp;&amp;childPackage.Name !== &quot;Business View&quot;||&#xA;			(type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;)&amp;&amp;childPackage.Name !== &quot;Logic Layer&quot;||&#xA;		    (type==&quot;SUCRD&quot;)&amp;&amp;childPackage.Name !== &quot;System View&quot;||(type==&quot;IUCD&quot;)&amp;&amp;childPackage.Name !== &quot;Internal Layer&quot;||&#xA;			childPackage.Name !== &quot;Deployment View&quot;&amp;&amp;type==&quot;SEQD&quot;) &#xA;		{&#xA;			var packages as EA.Collection;&#xA;			packages = theParentPackage.Packages;&#xA;			var nameOfPackage = &quot;Business View&quot;;&#xA;			&#xA;			if(type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;)&#xA;				nameOfPackage = &quot;Logic Layer&quot;;&#xA;			else if(type==&quot;SUCRD&quot;)&#xA;				nameOfPackage = &quot;System View&quot;;					&#xA;			else if(type==&quot;IUCD&quot;)&#xA;				nameOfPackage = &quot;Internal Layer&quot;;	&#xA;			else if(type==&quot;SEQD&quot;)&#xA;				nameOfPackage = &quot;Deployment View&quot;;	&#xA;			// Create package&#xA;			var subPackage as EA.Package;&#xA;			var subPackage1 as EA.Package;&#xA;			&#xA;			if(type==&quot;BURD&quot;||type==&quot;SUCRD&quot;)&#xA;				subPackage = CreatePackage(/*theParentPackage, */packages, nameOfPackage, &quot;Activity&quot;);&#xA;			else if(type==&quot;IUCD&quot;)&#xA;				subPackage = CreatePackage(/*theParentPackage, */packages, nameOfPackage, &quot;UseCase&quot;);&#xA;			else if(type==&quot;SEQD&quot;)&#xA;				subPackage = CreatePackage(/*theParentPackage, */packages, nameOfPackage, &quot;Sequence&quot;);&#xA;			else if(type==&quot;BSTMD&quot;)&#xA;				subPackage = CreatePackage(/*theParentPackage, */packages, nameOfPackage, &quot;Class&quot;); &#xA;			theParentPackage=subPackage;		&#xA;			// Create subpackage&#xA;			packages = subPackage.Packages;&#xA;		} else&#xA;			theParentPackage=childPackage;&#xA;	}&#xA;	var childPackageEnumerator = new Enumerator( theParentPackage.Packages ); //Business View&#xA;	while ( !childPackageEnumerator.atEnd() )&#xA;	{&#xA;&#xA;		childPackage = childPackageEnumerator.item();  //Business Proces Layer/Logic Layer&#xA;			&#xA;		if((type==&quot;BUCD&quot;||type==&quot;PDD&quot;)&amp;&amp;childPackage.Name === &quot;Decomposition Layer&quot;)&#xA;		{&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if((type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === &quot;Decomposition Processes&quot;) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				} else&#xA;				if(type!=null&amp;&amp;type==&quot;BUCD&quot;&amp;&amp;childPackage.Packages.GetAt(i).Name === &quot;Business Use Cases&quot;) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if((type==&quot;BURD&quot;)&amp;&amp;childPackage.Name === &quot;Business Process Layer&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;type==&quot;BURD&quot;&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOfSubPackage) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;SUCD&quot;&amp;&amp;childPackage.Name === &quot;System Use Case&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;SUCD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOfSubPackage) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(	type==&quot;BSTMD&quot;&amp;&amp;childPackage.Name === &quot;Business State&quot;) {&#xA;			for(i=0;i&lt;childPackage.Elements.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;BSTMD&quot;)&amp;&amp;childPackage.Elements.GetAt(i).Name === nameOfSubPackage) {&#xA;					stateMachine=childPackage.Elements.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;CLASSD&quot;&amp;&amp;childPackage.Name === &quot;Business Class&quot;) {&#xA;			subChildPackage=childPackage;&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;SUCRD&quot;&amp;&amp;childPackage.Name === &quot;User Layer&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;SUCRD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOfsubPackageDiagram) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;IUCD&quot;&amp;&amp;childPackage.Name === &quot;Internal Use Cases&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;IUCD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOfsubPackageDiagram) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;SEQD&quot;&amp;&amp;childPackage.Name === &quot;Sequence Layer&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;SEQD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOftheParent) { //1.Request service&#xA;					subChildPackage=childPackage.Packages.GetAt(i); //1.Request service&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;CMPD&quot;&amp;&amp;childPackage.Name === &quot;Component Layer&quot;) {&#xA;			subChildPackage=childPackage;&#xA;			break;&#xA;		}			&#xA;		childPackageEnumerator.moveNext();&#xA;	}&#xA;	if((type==null||type==&quot;&quot;||type==&quot;PDD&quot;||type==&quot;BUCD&quot;)&amp;&amp;childPackage.Name !== &quot;Decomposition Layer&quot; ||&#xA;		type==&quot;BURD&quot;&amp;&amp;childPackage.Name !== &quot;Business Process Layer&quot;||&#xA;		type==&quot;SUCD&quot;&amp;&amp;childPackage.Name !== &quot;System Use Case&quot;||&#xA;		type==&quot;BSTMD&quot;&amp;&amp;childPackage.Name !== &quot;Business State&quot;||&#xA;		type==&quot;CLASSD&quot;&amp;&amp;childPackage.Name !== &quot;Business Class&quot;||&#xA;		type==&quot;SUCRD&quot;&amp;&amp;childPackage.Name !== &quot;User Layer&quot;||&#xA;		type==&quot;IUCD&quot;&amp;&amp;childPackage.Name !== &quot;Internal Use Cases&quot;||&#xA;		type==&quot;SEQD&quot;&amp;&amp;childPackage.Name !== &quot;Sequence Layer&quot;||&#xA;		type==&quot;CMPD&quot;&amp;&amp;childPackage.Name !== &quot;Component Layer&quot;) {&#xA;		var packages as EA.Collection;&#xA;		var subPackage as EA.Package;&#xA;		var subPackage1 as EA.Package;&#xA;		var subPackage2 as EA.Package;&#xA;			&#xA;		packages = theParentPackage.Packages;&#xA;		// Create package&#xA;		if(type==&quot;BURD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Business Process Layer&quot;, &quot;Activity&quot;);&#xA;		else if(type==&quot;SUCD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;System Use Case&quot;, &quot;Class&quot;);&#xA;		else if(type==&quot;BSTMD&quot;) {&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Business State&quot;, &quot;State&quot;);&#xA;			testSMDiagram = CreateDiagram(subPackage, &quot;Business State&quot;, &quot;Statechart&quot;);&#xA;		}&#xA;		else if(type==&quot;CLASSD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Business Class&quot;, &quot;Class&quot;);&#xA;		else if(type==&quot;SUCRD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;User Layer&quot;, &quot;Activity&quot;);&#xA;		else if(type==&quot;IUCD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Internal Use Cases&quot;, &quot;UseCase&quot;);&#xA;		else if(type==&quot;SEQD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Sequence Layer&quot;, &quot;Sequence&quot;);&#xA;		else if(type==&quot;CMPD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Component Layer&quot;, &quot;Deployment&quot;);&#xA;		else&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Decomposition Layer&quot;, &quot;Activity&quot;);&#xA;		// Create subpackage&#xA;		packages = subPackage.Packages;&#xA;		if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, &quot;Decomposition Processes&quot;, &quot;Activity&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;BUCD&quot;)&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, &quot;Business Use Cases&quot;, &quot;UseCase&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;BURD&quot;)&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;Activity&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;SUCD&quot;)&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;UseCase&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;			stateMachine = subPackage.Elements.AddNew( nameOfSubPackage,&quot;StateMachine&quot;);&#xA;			stateMachine.Update();	&#xA;			subPackage.Diagrams.Refresh();&#xA;			for( var l=0; l&lt;subPackage.Diagrams.Count; l++) {&#xA;				testDiagram=subPackage.Diagrams.GetAt(l);&#xA;				if(testDiagram.Name==subPackage.Name&amp;&amp;testDiagram.Type==&quot;Statechart&quot;)&#xA;					break;&#xA;				else&#xA;					testDiagram=null;&#xA;			}&#xA;			if(testDiagram!=null) {&#xA;				var left=50;&#xA;				var top=-50;&#xA;				testDiagram.DiagramObjects.Refresh();&#xA;				for( var l=0; l&lt;testDiagram.DiagramObjects.Count; l++) {&#xA;					var diagramObject=testDiagram.DiagramObjects.GetAt(l);&#xA;					if(diagramObject.right&gt;=left)&#xA;						left = diagramObject.right+50;&#xA;				}&#xA;				var testDiagramObject = testDiagram.DiagramObjects.AddNew(&quot;&quot;, &quot;&quot; );&#xA;				testDiagramObject.ElementID( stateMachine.ElementID );&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+100;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-150;&#xA;				testDiagramObject.Update();&#xA;			}&#xA;			testDiagram=null;&#xA;		}&#xA;		else if(type!=null&amp;&amp;type==&quot;CLASSD&quot;)&#xA;			subPackage1 = subPackage;&#xA;		else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;			subPackage2 = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;Activity&quot;);&#xA;			packages=subPackage2.Packages;&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;Activity&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;			subPackage2 = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;UseCase&quot;);&#xA;			packages=subPackage2.Packages;&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;UseCase&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;			subPackage2 = CreatePackage(/*subPackage, */packages, nameOftheParent, &quot;UseCase&quot;);&#xA;			packages=subPackage2.Packages;&#xA;			subPackage2 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;UseCase&quot;);&#xA;			packages=subPackage2.Packages;&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;CMPD&quot;)&#xA;			subPackage1 = subPackage;&#xA;		else&#xA;			return parameters;&#xA;		if(type!=null&amp;&amp;type==&quot;BSTMD&quot;)&#xA;			parameters[0]=stateMachine;&#xA;		else&#xA;			parameters[0]=subPackage1;&#xA;		// Create a diagram in the package&#xA;		if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;			testDiagram = CreateDiagram(subPackage1, &quot;Decomposition Processes&quot;, &quot;EPProfile_dg::Eriksson-Penker Diagram&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;BUCD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, &quot;Business Use Cases&quot;, &quot;UseCase&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;BURD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfSubPackage, &quot;Activity&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;SUCD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfSubPackage, &quot;Use Case&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;			testDiagram = stateMachine.Diagrams.AddNew( nameOfSubPackage, &quot;Statechart&quot;);&#xA;			testDiagram.Update();&#xA;		} else if(type!=null&amp;&amp;type==&quot;CLASSD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, &quot;Business Class&quot;, &quot;Class&quot;); &#xA;		} else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfSubPackage, &quot;Activity&quot;); &#xA;		} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfSubPackage, &quot;Use Case&quot;); &#xA;		} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;CMPD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, &quot;Component Layer&quot;, &quot;Component&quot;);&#xA;		}&#xA;		parameters[1]=testDiagram;&#xA;	}&#xA;	else {&#xA;		if(type!=null&amp;&amp;type==&quot;BSTMD&quot;&amp;&amp;stateMachine==null||&#xA;			(type==null||type!=&quot;BSTMD&quot;)&amp;&amp;subChildPackage==null) {&#xA;			// Create subpackage&#xA;			var packages as EA.Collection;&#xA;			var packages1 as EA.Collection;&#xA;			//packages = theParentPackage.Packages;&#xA;			packages = childPackage.Packages;&#xA;			if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;				subChildPackage = CreatePackage(/*childPackage, */packages, &quot;Decomposition Processes&quot;, &quot;Class&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;BUCD&quot;)&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, &quot;Business Use Cases&quot;, &quot;Class&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;BURD&quot;)&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;Activity&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;SUCD&quot;)&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;Class&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;				stateMachine = childPackage.Elements.AddNew( nameOfSubPackage,&quot;StateMachine&quot;);&#xA;				stateMachine.Update();		&#xA;				childPackage.Diagrams.Refresh();				&#xA;				for( var l=0; l&lt;childPackage.Diagrams.Count; l++) {&#xA;					testDiagram=childPackage.Diagrams.GetAt(l);&#xA;					if(testDiagram.Name==childPackage.Name&amp;&amp;testDiagram.Type==&quot;Statechart&quot;)&#xA;						break;&#xA;					else&#xA;						testDiagram=null;&#xA;				}&#xA;				if(testDiagram!=null) {&#xA;					var left=50;&#xA;					var top=-50;&#xA;					testDiagram.DiagramObjects.Refresh();&#xA;					for( var l=0; l&lt;testDiagram.DiagramObjects.Count; l++) {&#xA;						var diagramObject=testDiagram.DiagramObjects.GetAt(l);&#xA;						if(diagramObject.right&gt;=left)&#xA;							left = diagramObject.right+50;&#xA;					}&#xA;					var testDiagramObject = testDiagram.DiagramObjects.AddNew(&quot;&quot;, &quot;&quot; );&#xA;					testDiagramObject.ElementID( stateMachine.ElementID );&#xA;					testDiagramObject.left=left;&#xA;					testDiagramObject.right=left+100;&#xA;					testDiagramObject.top=top;&#xA;					testDiagramObject.bottom=top-150;&#xA;					testDiagramObject.Update();&#xA;				}&#xA;				testDiagram=null;&#xA;			}&#xA;			else if(type!=null&amp;&amp;type==&quot;CLASSD&quot;)&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, &quot;Business Class&quot;, &quot;Class&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;Activity&quot;);&#xA;				packages1=subChildPackage.Packages;&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;Activity&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;UseCase&quot;);&#xA;				packages1=subChildPackage.Packages;&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;UseCase&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOftheParent, &quot;UseCase&quot;);&#xA;				packages1=subChildPackage.Packages;&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;UseCase&quot;);&#xA;				packages1=subChildPackage.Packages;&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;			} else&#xA;			if(type!=&quot;CMPD&quot;)&#xA;				return parameters; &#xA;			if(type!=null&amp;&amp;type==&quot;BSTMD&quot;)&#xA;				parameters[0]=stateMachine;&#xA;			else&#xA;				parameters[0]=subChildPackage;	 &#xA;			// Create a diagram in the package&#xA;			if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;				testDiagram = CreateDiagram(subChildPackage, &quot;Decomposition Processes&quot;, &quot;EPProfile_dg::Eriksson-Penker Diagram&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;BUCD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, &quot;Business Use Cases&quot;, &quot;UseCase&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;BURD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Activity&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;SUCD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Use Case&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;				testDiagram = stateMachine.Diagrams.AddNew( nameOfSubPackage, &quot;Statechart&quot;);&#xA;				testDiagram.Update();&#xA;			} else if(type!=null&amp;&amp;type==&quot;SUCD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, &quot;Business Class&quot;, &quot;Class&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Activity&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Use Case&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;CMPD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, &quot;Component Layer&quot;, &quot;Component&quot;);&#xA;			}&#xA;			parameters[1]=testDiagram;			&#xA;		} else { //the target package, there is Sequence Layer&#xA;			if(type==&quot;SUCRD&quot;||type==&quot;IUCD&quot;||type==&quot;SEQD&quot;) {&#xA;				var subChildPackageS as EA.Package;&#xA;				for(var i=0;i&lt;subChildPackage.Packages.Count();i++) {&#xA;					if(subChildPackage.Packages.GetAt(i).Name === nameOfSubPackage) {&#xA;						subChildPackageS=subChildPackage.Packages.GetAt(i);&#xA;						break;&#xA;					}				&#xA;				}	&#xA;				if(subChildPackageS==null) {&#xA;					var packages1 as EA.Collection;&#xA;					packages1=subChildPackage.Packages;&#xA;					if(type==&quot;SUCRD&quot;)&#xA;						subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;Activity&quot;);&#xA;					else if(type==&quot;SEQD&quot;)&#xA;						subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;Sequence&quot;);&#xA;					else&#xA;						subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;UseCase&quot;);&#xA;				} else&#xA;					subChildPackage=subChildPackageS;&#xA;				if(type==&quot;SEQD&quot;) {&#xA;					var subChildPackageS as EA.Package;&#xA;					subChildPackageS=null;&#xA;					for(var i=0;i&lt;subChildPackage.Packages.Count();i++) {&#xA;						if(subChildPackage.Packages.GetAt(i).Name === nameOfsubPackageDiagram) {&#xA;							subChildPackageS=subChildPackage.Packages.GetAt(i);&#xA;							break;&#xA;						}				&#xA;					}&#xA;					if(subChildPackageS==null) {&#xA;						var packages1 as EA.Collection;&#xA;						packages1=subChildPackage.Packages;&#xA;						subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;					} else&#xA;						subChildPackage=subChildPackageS;&#xA;				}&#xA;			}&#xA;			if(type!=null&amp;&amp;type==&quot;BSTMD&quot;)&#xA;				parameters[0]=stateMachine;&#xA;			else&#xA;				parameters[0]=subChildPackage;&#xA;			testDiagram=null;&#xA;			if(type!=null&amp;&amp;type==&quot;BSTMD&quot;&amp;&amp;stateMachine.Diagrams.Count&gt;0) {&#xA;				for(i=0;i&lt;stateMachine.Diagrams.Count&gt;0;i++) {&#xA;					var test1Diagram = stateMachine.Diagrams.GetAt(i);&#xA;					if(test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Statechart&quot;) {&#xA;						testDiagram=test1Diagram;&#xA;						break;&#xA;					}&#xA;				}&#xA;			} else &#xA;			if(type!=null&amp;&amp;type!=&quot;BSTMD&quot;&amp;&amp;subChildPackage.Diagrams.Count&gt;0) {&#xA;				for(i=0;i&lt;subChildPackage.Diagrams.Count&gt;0;i++) {&#xA;					var test1Diagram = subChildPackage.Diagrams.GetAt(i);&#xA;					if((type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&amp;&amp;test1Diagram.Name==&quot;Decomposition Processes&quot;&amp;&amp;test1Diagram.Type==&quot;Analysis&quot; ||&#xA;						type!=null&amp;&amp;type==&quot;BUCD&quot;&amp;&amp;test1Diagram.Name==&quot;Business Use Cases&quot;&amp;&amp;test1Diagram.Type==&quot;UseCase&quot; ||&#xA;						type!=null&amp;&amp;type==&quot;BURD&quot;&amp;&amp;test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Activity&quot; ||&#xA;						type!=null&amp;&amp;type==&quot;SUCD&quot;&amp;&amp;test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Use Case&quot;||&#xA;						type!=null&amp;&amp;type==&quot;CLASSD&quot;&amp;&amp;test1Diagram.Name==&quot;Business Class&quot;&amp;&amp;test1Diagram.Type==&quot;Class&quot;||&#xA;						type!=null&amp;&amp;type==&quot;SUCRD&quot;&amp;&amp;test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Activity&quot;||&#xA;						type!=null&amp;&amp;type==&quot;IUCD&quot;&amp;&amp;test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Use Case&quot;||&#xA;						type!=null&amp;&amp;type==&quot;SEQD&quot;&amp;&amp;test1Diagram.Name==nameOfsubPackageDiagram&amp;&amp;test1Diagram.Type==&quot;Sequence&quot;||&#xA;						type!=null&amp;&amp;type==&quot;CMPD&quot;&amp;&amp;test1Diagram.Name==&quot;Component Layer&quot;&amp;&amp;test1Diagram.Type==&quot;Component&quot;) {&#xA;						testDiagram=test1Diagram;&#xA;						break;&#xA;					}&#xA;				}&#xA;			}&#xA;			if(testDiagram==null) {&#xA;				if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;					testDiagram = CreateDiagram(subChildPackage, &quot;Decomposition Processes&quot;, &quot;EPProfile_dg::Eriksson-Penker Diagram&quot;);&#xA;				else if(type!=null&amp;&amp;type==&quot;BUCD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, &quot;Business Use Cases&quot;, &quot;Use Case&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;BURD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Activity&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;SUCD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Use Case&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;					testDiagram = stateMachine.Diagrams.AddNew( nameOfSubPackage, &quot;Statechart&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;CLASSD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, &quot;Business Class&quot;, &quot;Class&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Activity&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Use Case&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;CMPD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, &quot;Component Layer&quot;, &quot;Component&quot;);&#xA;				}&#xA;				else&#xA;					return parameters;&#xA;			}&#xA;			parameters[1]=testDiagram;	&#xA;		}			&#xA;	}&#xA;	return parameters;&#xA;}&#xA;//Look up the name of an element with the specified type in the current package, otherwise in the repository&#xA;function searchForElement(subPackage, nameOfElement, typeOfElement) {&#xA;	var coto as EA.Collection;&#xA;	var currentPackage as EA.Package;&#xA;	var delements as EA.Collection;&#xA;	var packageElement as EA.Element;&#xA;	&#xA;	currentPackage=subPackage;&#xA;	delements = currentPackage.Elements;&#xA;	for(i=0;i&lt;delements.Count();i++) {&#xA;		packageElement=delements.GetAt(i);&#xA;		if(packageElement.Name==nameOfElement&amp;&amp;packageElement.Type==typeOfElement)&#xA;			return packageElement;&#xA;	}&#xA;	coto=Repository.GetElementsByQuery(&quot;Simple&quot;,nameOfElement);&#xA;	for(i=0; i&lt;coto.Count(); i++) {&#xA;		var searchElement as EA.Element;&#xA;		searchElement=coto.GetAt(i);&#xA;		if(searchElement.Name==nameOfElement&amp;&amp;searchElement.Type==typeOfElement)&#xA;			return searchElement;&#xA;	} &#xA;	return null;&#xA;}&#xA;//Returning an object on the diagram corresponding to the given element&#xA;function searchedObjectinDiagram(thePackage, theElement) {&#xA;	var diagramObjects as EA.Collection;&#xA;	var diagramObject as EA.DiagramObject;&#xA;&#xA;	diagramObjects = thePackage.Diagrams.GetAt(0).DiagramObjects;&#xA;	for(i=0;i&lt;diagramObjects.Count();i++) {&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID==theElement.ElementID)&#xA;			return diagramObject;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Return next connected element(nameElementtype) back(kind=1) or forward (kind=0) to the given element (theElement) and this connection in the diagram&#xA;function searchConnectorsinElement(thePackage, theElement, type, nameElement, kind) {&#xA;	var Connectors as EA.Collection;&#xA;	var theConnector as EA.Connector;&#xA;	var coto as EA.Element;&#xA;	var cotoParent as EA.Element;&#xA;	var searchConnectors = [null, null];&#xA;	&#xA;	Connectors = theElement.Connectors;&#xA;	for(var i=0;i&lt;Connectors.Count();i++)&#xA;	{&#xA;		theConnector=Connectors.GetAt(i);&#xA;		if(kind==1&amp;&amp;theConnector.ClientID&gt;0 || kind==0&amp;&amp;theConnector.SupplierID&gt;0) {&#xA;			if(kind==1)&#xA;				coto=Repository.GetElementByID(theConnector.ClientID);&#xA;			else&#xA;				coto=Repository.GetElementByID(theConnector.SupplierID);&#xA;			cotoParent=null;&#xA;			if(coto.Type==&quot;Object&quot;)&#xA;				cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;			//here can find a propriete element&#xA;			if(type==&quot;Action&quot;||type==&quot;Activity&quot;) {&#xA;				if((coto.Type==&quot;Action&quot;||coto.Type==&quot;Activity&quot;)&amp;&amp; (nameElement!=&quot; &quot;&amp;&amp;nameElement==coto.Name||nameElement==&quot;&quot;||nameElement==&quot; &quot;)) {&#xA;					if(searchedObjectinDiagram(thePackage, coto)!=null) {&#xA;						searchConnectors[0]=coto;&#xA;						searchConnectors[1]=theConnector;&#xA;						return searchConnectors;&#xA;					}&#xA;				}&#xA;			} else {&#xA;				if(coto.Type==type &amp;&amp; (nameElement!=&quot; &quot;&amp;&amp;nameElement==coto.Name||nameElement==&quot;&quot;||nameElement==&quot; &quot;||coto.Type==&quot;Object&quot;&amp;&amp;nameElement.substr(0,1)==&quot;:&quot;&amp;&amp;nameElement.substr(1)==cotoParent.Name)) {&#xA;					if(searchedObjectinDiagram(thePackage, coto)!=null) {&#xA;						searchConnectors[0]=coto;&#xA;						searchConnectors[1]=theConnector;&#xA;						return searchConnectors;&#xA;					}&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	return searchConnectors;&#xA;}&#xA;//Importing the given package from URL&#xA;function importXMLPackageFromURL(url) {&#xA;    //var repository = EA.Repository;&#xA;	var projectInterface as EA.Project;&#xA;    var xmlContent = &quot;&quot;;&#xA;&#xA;    // Fetch XML content from URL&#xA;    var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;);&#xA;    xhr.open(&quot;GET&quot;, url, false);&#xA;    xhr.send();&#xA;    if (xhr.status == 200) {&#xA;        xmlContent = xhr.responseText;&#xA;    } else {&#xA;        Session.Output(&quot;Failed to fetch XML from URL: &quot; + xhr.statusText);&#xA;        return;&#xA;    }&#xA;&#xA;    // Import XML package into the model&#xA;    var importResult = projectInterface.ImportPackageXMI(xmlContent, 0);&#xA;    if (importResult) {&#xA;        Session.Output(&quot;XML package imported successfully.&quot;);&#xA;    } else {&#xA;        Session.Output(&quot;Failed to import XML package.&quot;);&#xA;    }&#xA;}&#xA;&#xA;main();&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="3"/>
			<Column name="ScriptCategory" value="3955A83E-9E54-4810-8053-FACC68CD4782"/>
			<Column name="ScriptName" value="{CDA41054-CD7D-49bd-9679-575ADA77266B}"/>
			<Column name="Notes" value="&lt;Group Type=&quot;CONTEXTPACKAGE&quot; Notes=&quot;Software Architecture building&quot;/&gt;&#xA;"/>
			<Column name="Script" value="CMDA"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="4"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{001F9F30-144F-4d59-A580-2E8906C9FA61}"/>
			<Column name="ScriptAuthor" value="{CDA41054-CD7D-49bd-9679-575ADA77266B}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;eCMDA&quot; Type=&quot;Internal&quot; Language=&quot;JScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="!INC Local Scripts.EAConstants-JScript&#xA;&#xA;/*&#xA; * Script Name: eCMDA&#xA; * Author: J. Niepostyn&#xA; * Purpose: Software architecture construction&#xA; * Date: 2025.06.20&#xA; */&#xA;	&#xA;function main()&#xA;{&#xA;	var thePackage as EA.Package;&#xA;	var newModelID = 0;&#xA;	var theParentPackage as EA.Package;	&#xA;	var theParentParentPackage as EA.Package;	&#xA;	var thePParentParentPackage as EA.Package;	&#xA;	var elements as EA.Collection;&#xA;&#xA;	// Get the currently selected package in the tree to work on&#xA;	thePackage = Repository.GetTreeSelectedPackage();&#xA;	elements = thePackage.Elements;&#xA;	// Show the script output window&#xA;	Repository.EnsureOutputVisible( &quot;Script&quot; );&#xA;	&#xA;	// The package was selected&#xA;	if ( thePackage != null &amp;&amp; thePackage.ParentID != 0 )&#xA;	{&#xA;		theParentPackage = Repository.GetPackageByID(thePackage.ParentID);&#xA;		if(theParentPackage.ParentID&gt;0)&#xA;			theParentParentPackage = Repository.GetPackageByID(theParentPackage.ParentID);&#xA;		else&#xA;			theParentParentPackage = null;&#xA;		if(theParentParentPackage!=null&amp;&amp;theParentParentPackage.ParentID&gt;0)&#xA;			thePParentParentPackage = Repository.GetPackageByID(theParentParentPackage.ParentID);&#xA;		else&#xA;			thePParentParentPackage = null;&#xA;		// the selected package is called &quot;Context Layer&quot; or &quot;Decomposition Processes&quot;&#xA;		if(thePackage.Name === &quot;Context Layer&quot; || thePackage.Name === &quot;Decomposition Processes&quot; || thePackage.Name === &quot;Business Use Cases&quot;||&#xA;			thePackage.Name === &quot;Business State&quot;||thePackage.Name === &quot;Business Class&quot;||&#xA;			theParentPackage.Name === &quot;Business Process Layer&quot;||theParentPackage.Name === &quot;System Use Case&quot;||&#xA;			theParentParentPackage!=null&amp;&amp;theParentParentPackage.Name === &quot;User Layer&quot;||theParentParentPackage!=null&amp;&amp;theParentParentPackage.Name === &quot;Internal Use Cases&quot;||&#xA;			thePParentParentPackage!=null&amp;&amp;thePParentParentPackage.Name === &quot;Sequence Layer&quot;)&#xA;		{&#xA;			// the selected package is not empty and it has only one diagram&#xA;			//if(elements.Count&gt;0 &amp;&amp; thePackage.Diagrams.Count==1) &#xA;			if(thePackage.Diagrams.Count==1) &#xA;			{&#xA;				Repository.EnableUIUpdates(false);&#xA;				//Repository.EnableUIUpdates(true);&#xA;				// Context diagram element verification&#xA;				var diagramObjects as EA.Collection;&#xA;				diagramObjects = thePackage.Diagrams.GetAt(0).DiagramObjects;&#xA;				var diagramObject as EA.DiagramObject;&#xA;				var testElement as EA.Element;&#xA;				Session.Output( &quot;Count of &quot; +thePackage.Diagrams.GetAt(0).Name+&quot; diagram objects:&quot; + diagramObjects.Count );&#xA;				// Navigate the elements collection of selected diagram&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;				{&#xA;					var diagramObjectOmitted = false;&#xA;					diagramObject = diagramObjects.GetAt(i);&#xA;					  &#xA;					var delements as EA.Collection;&#xA;					delements = thePackage.Elements;&#xA;					// Navigate the elements collection of selected package&#xA;					for ( var j = 0 ; j &lt; elements.Count ; j++ ) //elements can be placed inside the Activity Partition&#xA;					{&#xA;						var currentElement as EA.Element;&#xA;						currentElement = elements.GetAt( j );&#xA;						// The found element in the package is the selected diagram element&#xA;						if(currentElement.ElementID == diagramObject.ElementID) &#xA;						{&#xA;							diagramObjectOmitted = true;&#xA;							// Get value of the tag&#xA;							var stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,null); &#xA;							do {&#xA;								string4=stringLast;&#xA;								if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;									Session.Output( &quot;Element named '&quot; + currentElement.Name +&quot;' and type '&quot;+currentElement.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;									Session.Output( &quot;The index of the first occurence of ';' is: &quot; + string4.indexOf(&quot;;&quot;));&#xA;									do {&#xA;										var string5 = string4;&#xA;										if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;											string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;											string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;										} else&#xA;										string4=null;&#xA;										realizeConsistencyRule(string5,currentElement,thePackage); &#xA;									} while (string4!=null&amp;&amp;string4!=&quot;&quot;); &#xA;								} else&#xA;								if(currentElement.Name == null || currentElement.Name == &quot;&quot;) &#xA;								{&#xA;									var parentId = currentElement.ClassifierId; //ParentID;&#xA;									currentElement=Repository.GetElementByID(parentId);&#xA;									Session.Output( &quot;An instance of class ':&quot; + currentElement.Name +&quot;' has no Tag.&quot;);&#xA;								} else&#xA;									Session.Output( &quot;Element named '&quot; + currentElement.Name +&quot;' has no Tag.&quot;);&#xA;								if(currentElement.Type==&quot;Sequence&quot;) { //Lifeline&#xA;									var connector as EA.Connector;&#xA;									connector=null;&#xA;									for(i=0;i&lt;currentElement.Connectors.Count;i++) {&#xA;										var connector=currentElement.Connectors.GetAt(i);&#xA;										if(connector.Type==&quot;Sequence&quot;) { //message&#xA;											diagramObjectOmitted = true;&#xA;											// Get value of the tag&#xA;											var stringLast1 = getTagsValue(connector,&quot;Consistency rules&quot;,null); &#xA;											do {&#xA;												var string4=stringLast1;&#xA;												if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;													Session.Output( &quot;Element named '&quot; + connector.Name +&quot;' and type '&quot;+connector.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;													Session.Output( &quot;The index of the first occurence of ';' is: &quot; + string4.indexOf(&quot;;&quot;));&#xA;													do {&#xA;														var string5 = string4;&#xA;														if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;															string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;															string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;														} else&#xA;															string4=null;&#xA;														realizeConsistencyRule(string5,connector,thePackage); &#xA;													} while (string4!=null&amp;&amp;string4!=&quot;&quot;); // jedna regu&#322;a, to pomija t&#261; ostatni&#261;&#xA;												} else&#xA;													Session.Output( &quot;Element named '&quot; + connector.Name +&quot;' has no Tag.&quot;);&#xA;											} while(stringLast1!=null&amp;&amp;(stringLast1 = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast1))!=null);&#xA;										}&#xA;									}&#xA;								}&#xA;							} while(stringLast!=null&amp;&amp;(stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast))!=null);&#xA;							break;&#xA;					    } &#xA;						if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;							for(var k=0; k&lt;currentElement.Elements.Count(); k++) {&#xA;								var currentElement1 as EA.Element;&#xA;								currentElement1 = currentElement.Elements.GetAt( k );&#xA;								// The found element in the package is the selected diagram element&#xA;								if(currentElement1.ElementID == diagramObject.ElementID) &#xA;								{&#xA;									diagramObjectOmitted = true;&#xA;									// Get value of the tag&#xA;									var stringLast = getTagsValue(currentElement1,&quot;Consistency rules&quot;,null); &#xA;									do {&#xA;										var string4=stringLast;&#xA;										if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;											Session.Output( &quot;Element named '&quot; + currentElement1.Name +&quot;' and type '&quot;+currentElement1.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;											Session.Output( &quot;The index of the first occurence of ';' is: &quot; + string4.indexOf(&quot;;&quot;));&#xA;											//var co=string4.indexOf(&quot;;&quot;);&#xA;											do {&#xA;												//co=string4.indexOf(&quot;;&quot;);&#xA;												var string5 = string4;&#xA;												if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;													string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;													string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;												} else&#xA;												string4=null;&#xA;												realizeConsistencyRule(string5,currentElement1,thePackage); &#xA;											} while (string4!=null&amp;&amp;string4!=&quot;&quot;); // jedna regu&#322;a, to pomija t&#261; ostatni&#261;&#xA;										} else&#xA;										if(currentElement1.Name == null || currentElement1.Name == &quot;&quot;) &#xA;										{&#xA;											var parentId = currentElement1.ClassifierId; //ParentID;&#xA;											currentElement1=Repository.GetElementByID(parentId);&#xA;											Session.Output( &quot;An instance of class ':&quot; + currentElement1.Name +&quot;' has no Tag.&quot;);&#xA;										} else&#xA;											Session.Output( &quot;Element named '&quot; + currentElement1.Name +&quot;' has no Tag.&quot;);&#xA;									} while(stringLast!=null&amp;&amp;(stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast))!=null);&#xA;									break;&#xA;								} &#xA;								if(currentElement1.Type==&quot;ActivityPartition&quot;) {&#xA;									for(var l=0; l&lt;currentElement.Elements.Count(); l++) {&#xA;										var currentElement2 as EA.Element;&#xA;										currentElement2 = currentElement1.Elements.GetAt( l );&#xA;										// The found element in the package is the selected diagram element&#xA;										if(currentElement2.ElementID == diagramObject.ElementID) &#xA;										{&#xA;											diagramObjectOmitted = true;&#xA;											// Get value of the tag&#xA;											var stringLast = getTagsValue(currentElement2,&quot;Consistency rules&quot;,null); &#xA;											do {&#xA;												var string4=stringLast;&#xA;												if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;													Session.Output( &quot;Element named '&quot; + currentElement2.Name +&quot;' and type '&quot;+currentElement2.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;													Session.Output( &quot;The index of the first occurence of ';' is: &quot; + string4.indexOf(&quot;;&quot;));&#xA;													//var co=string4.indexOf(&quot;;&quot;);&#xA;													do {&#xA;														//co=string4.indexOf(&quot;;&quot;);&#xA;														var string5 = string4;&#xA;														if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;															string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;															string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;														} else&#xA;														string4=null;&#xA;														realizeConsistencyRule(string5,currentElement2,thePackage); &#xA;													} while (string4!=null&amp;&amp;string4!=&quot;&quot;); // jedna regu&#322;a, to pomija t&#261; ostatni&#261;&#xA;												} else&#xA;												if(currentElement2.Name == null || currentElement2.Name == &quot;&quot;) &#xA;												{&#xA;													var parentId = currentElement2.ClassifierId; //ParentID;&#xA;													currentElement2=Repository.GetElementByID(parentId);&#xA;													Session.Output( &quot;An instance of class ':&quot; + currentElement2.Name +&quot;' has no Tag.&quot;);&#xA;												} else&#xA;													Session.Output( &quot;Element named '&quot; + currentElement2.Name +&quot;' has no Tag.&quot;);&#xA;											} while(stringLast!=null&amp;&amp;(stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast))!=null);&#xA;											break;&#xA;										} 										&#xA;									}&#xA;								}&#xA;							}&#xA;						} &#xA;					}&#xA;					if(diagramObjectOmitted == false) { //elements outside the current package &#xA;						currentElement=Repository.GetElementByID(diagramObject.ElementID);&#xA;						if(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Class&quot;) {&#xA;							var stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,null); &#xA;							do {&#xA;								var string4 = stringLast;&#xA;								if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;									Session.Output( &quot;Element named '&quot; + currentElement.Name +&quot;' and type '&quot;+currentElement.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;									Session.Output( &quot;The index of the first occurence of ';' is: &quot; + string4.indexOf(&quot;;&quot;));&#xA;									do {&#xA;										var string5 = string4;&#xA;										if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;											string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;											string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;										} else&#xA;										string4=null;&#xA;										realizeConsistencyRule(string5,currentElement,thePackage); &#xA;									} while (string4!=null&amp;&amp;string4!=&quot;&quot;); &#xA;								} &#xA;							} while(stringLast!=null&amp;&amp;(stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast))!=null);&#xA;						}&#xA;					}&#xA;&#xA;				}&#xA;				Repository.EnableUIUpdates(true);&#xA;				Session.Output(&quot;Process complete&quot;);&#xA;			} else&#xA;				Session.Output( &quot;The package '&quot; +thePackage.Name+&quot;' does not include only one diagram or an element&quot; );		  &#xA;		} else&#xA;			Session.Output( &quot;Neither Package 'Context Layer' nor 'Decomposition Processes' nor 'Business Use Cases' has been selected&quot; );&#xA;	} else &#xA;		Session.Output( &quot;Nothing to do !&quot; );&#xA;}&#xA;//Create a package in thepackage with the nameOfPackage and kindOfPackage&#xA;function CreatePackage (thepackage,/*packages,*/nameOfPackage,kindOfPackage) &#xA;{&#xA;	//var thepackages as EA.Collection;&#xA;	var thepackage1 as EA.Collection;&#xA;	var subPackage as EA.Package;&#xA;	&#xA;	//thepackages = packages;&#xA;	thepackage1 = thepackage;&#xA;	subPackage = thepackage1.AddNew( nameOfPackage,kindOfPackage);&#xA;	subPackage.Update();&#xA;	Session.Output( &quot;Added new subpackage: '&quot; + subPackage.Name+&quot;' under parent package '&quot; + thepackage.Name + &quot;'&quot; );&#xA;	return subPackage;&#xA;}&#xA;//Create a diagram in the subpackage with the nameOfPackage and kindOfDiagram&#xA;function CreateDiagram(subpackage,nameOfPackage,kindOfDiagram)&#xA;{&#xA;	var subPackage as EA.Package;&#xA;&#xA;	subPackage = subpackage;&#xA;	testDiagram = subPackage.Diagrams.AddNew( nameOfPackage, kindOfDiagram );&#xA;	testDiagram.Update();&#xA;&#xA;	Session.Output( &quot;Added diagram '&quot; + testDiagram.Name + &quot;' to package &quot; + subPackage.Name );&#xA;	return testDiagram;&#xA;}&#xA;//Get the value of the tag named theName from theElement&#xA;function getTagsValue(theElement, theName, theValue)&#xA;{&#xA;	var tags as EA.Collection;&#xA;	tags = theElement.TaggedValues;&#xA;		&#xA;	var currentTag as EA.TaggedValue;&#xA;	currentTag = null;&#xA;	var occurence=false;&#xA;	&#xA;	// List all element tag&#xA;	for ( var i = 0 ; i &lt; tags.Count ; i++ )&#xA;	{&#xA;&#xA;		currentTag = tags.GetAt( i );&#xA;	&#xA;		if ( currentTag.Name == theName ) {&#xA;			if(theValue==null)&#xA;				return currentTag.Value;&#xA;			if(occurence)&#xA;				return currentTag.Value;&#xA;			if(!occurence&amp;&amp;theValue==currentTag.Value)&#xA;				occurence=true;&#xA;		}&#xA;	}&#xA;    return null;&#xA;}&#xA;//Constructing the target structure of elements based on the consistency rule&#xA;function realizeConsistencyRule(consistencyRule,currentElement,thePackage) {&#xA;var currentElement as EA.Element;&#xA;var thePackage as EA.Package;&#xA;var theParentPackage as EA.Package;&#xA;var thePParentPackage as EA.Package;&#xA;var thePPParentPackage as EA.Package;&#xA;var correctCR=null;&#xA;var parameters = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;var connectors = [ [null,null,null], [null,null],];&#xA;&#xA;	correctCR=verifyConsistencyRule(thePackage, consistencyRule, currentElement); //rule verification &#xA;	parameters=getArgumentsCR(correctCR, consistencyRule); // get arguments of Consistency rule &#xA;	if(correctCR != null) {&#xA;		switch(correctCR) {&#xA;			case &quot;ZpvYu&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				theParentPackage=Repository.GetPackageByID(theParentPackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;User Layer&quot;)&#xA;					break;		&#xA;				connectors = getConnectionA(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createZYcomplexYu(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;YuQlml&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				theParentPackage=Repository.GetPackageByID(theParentPackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;Internal Use Cases&quot;)&#xA;					break;		&#xA;				connectors = getConnectionB(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createYQcomplexQlml(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;QlmlMqyq&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				thePParentPackage=Repository.GetPackageByID(theParentPackage.ParentID);&#xA;				thePPParentPackage=Repository.GetPackageByID(thePParentPackage.ParentID);&#xA;				if(thePPParentPackage.Name!=&quot;Sequence Layer&quot;)&#xA;					break;		&#xA;				connectors = getConnectionQ(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createQMcomplexMqyq(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;CchZiv&quot;:&#xA;				if(thePackage.Name!=&quot;Business Class&quot;)&#xA;					break;&#xA;				connectors = getConnectionC(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createCZcomplexAvi(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;SrsZiv&quot;:&#xA;				if(thePackage.Name!=&quot;Business State&quot;)&#xA;					break;&#xA;				connectors = getConnectionS(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createSZcomplexZiv(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;UauZpv&quot;:&#xA;				connectors = getConnectionB(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createUZcomplexZpv(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;AivSrst&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;Business Process Layer&quot;)&#xA;					break;	&#xA;				connectors = getConnectionA(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createAScomplexSrst(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;AiviCczc&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;Business Process Layer&quot;)&#xA;					break;	&#xA;				connectors = getConnectionA(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createACcomplex(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;ApUau&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;Business Process Layer&quot;)&#xA;					break;		&#xA;				connectors = getConnectionA(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createAUcomplexUau(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;BauApvpv&quot;:&#xA;				if(thePackage.Name!=&quot;Business Use Cases&quot;)&#xA;					break;&#xA;				connectors = getConnectionB(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createBAcomplexApv(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;RiviAvivi&quot;:&#xA;				if(thePackage.Name!=&quot;Decomposition Processes&quot;)&#xA;					break;&#xA;				connectors = getConnectionR(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createRAcomplexAvi(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;RiviAvi&quot;:&#xA;				if(thePackage.Name!=&quot;Decomposition Processes&quot;)&#xA;					break;&#xA;				connectors = getConnectionR(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createRAcomplex(correctCR, thePackage, parameters, connectors,0);&#xA;				break;&#xA;			case &quot;BauApv&quot;:&#xA;				if(thePackage.Name!=&quot;Business Use Cases&quot;)&#xA;					break;&#xA;				connectors = getConnectionB(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createBAcomplex(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;RevBau&quot;:&#xA;			case &quot;ReviBaua&quot;:&#xA;			case &quot;RviBau&quot;:&#xA;			case &quot;RiviBaua&quot;:&#xA;				if(thePackage.Name!=&quot;Decomposition Processes&quot;)&#xA;					break;&#xA;				connectors = getConnectionR(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createRBcomplexBaua(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;XevBau&quot;:&#xA;			case &quot;XivBau&quot;:&#xA;			case &quot;XviBau&quot;:&#xA;				if(thePackage.Name!=&quot;Decomposition Processes&quot;)&#xA;					break;&#xA;				if(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Class&quot;)&#xA;					connectors = getConnectionX(thePackage, correctCR.substr(5), currentElement.Name, parameters[0][1], parameters[0][2]);&#xA;				else if(currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Class&quot;)&#xA;					if(parameters[0][0]!=null&amp;&amp;parameters[0][0]==&quot; &quot;&amp;&amp;parameters[1][0]!=null)&#xA;						connectors = getConnectionX(thePackage, correctCR.substr(5), parameters[1][0], currentElement.Name, parameters[0][2]);&#xA;					else&#xA;						connectors = getConnectionX(thePackage, correctCR.substr(5), parameters[0][0], currentElement.Name, parameters[0][2]);&#xA;				else if(currentElement.Type==&quot;Object&quot;) &#xA;					if(currentElement.Name!=&quot;&quot;)&#xA;						connectors = getConnectionX(thePackage, correctCR.substr(5), parameters[0][0], parameters[0][1], currentElement.Name);&#xA;					else if(currentElement.ClassifierID&gt;0)&#xA;						connectors = getConnectionX(thePackage, correctCR.substr(5), parameters[0][0], parameters[0][1], &quot;:&quot;+(Repository.GetElementByID(currentElement.ClassifierID).Name));&#xA;					else&#xA;						connectors = getConnectionX(thePackage, correctCR.substr(5), parameters[0][0], parameters[0][1], parameters[0][2]);&#xA;				createXBcomplex(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;XeRi&quot;:&#xA;			case &quot;XiRi&quot;:&#xA;			case &quot;XevRv&quot;:&#xA;			case &quot;XivRv&quot;:&#xA;			case &quot;XviRv&quot;:&#xA;				if(thePackage.Name!=&quot;Context Layer&quot;)&#xA;					break;&#xA;				createXRsimple(consistencyRule, correctCR, thePackage, parameters,currentElement);&#xA;				break;&#xA;			case &quot;XeviRevi&quot;:&#xA;			case &quot;XeviRivi&quot;:&#xA;			case &quot;XiviRivi&quot;:&#xA;				if(thePackage.Name!=&quot;Context Layer&quot;)&#xA;					break;&#xA;				connectors = getConnectionR(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); //the first element&#xA;				createXRcomplex(correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			default:&#xA;				Session.Output( &quot;Consistency rule '&quot; + consistencyRule + &quot;' is correct '&quot;+correctCR+&quot;', changes will be implemented.&quot;);&#xA;		}&#xA;	} else {&#xA;		Session.Output( &quot;Consistency rule '&quot; + consistencyRule + &quot;' is not correct - nothing to do.&quot;);&#xA;		return;&#xA;	}&#xA;}&#xA;//Multiple calls to createRAcomplex depending on multi-value parameters&#xA;function createRAcomplexAvi(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var parameter11;&#xA;var parameter31;&#xA;var parameter12;&#xA;var parameter32;&#xA;	&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][0]=parameters[1][2*n];&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;			parameter1[1][0]=(n+1)+&quot;. Action&quot;;&#xA;		if(n==0) {&#xA;			parameter11=&quot;Start&quot;;&#xA;			parameter31=&quot;&quot;;&#xA;		} else {&#xA;			parameter11=parameters[1][2*n-1];&#xA;			parameter31=parameters[3][2*n-1];&#xA;		}&#xA;		parameter12=parameters[1][2*n+1];&#xA;		parameter32=parameters[3][2*n+1];&#xA;		do {&#xA;			if(parameter11.indexOf(&quot;,&quot;)&gt;0) {&#xA;				parameter1[1][1]=parameter11.substr(0,parameter11.indexOf(&quot;,&quot;));&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter11=parameter11.substr(parameter11.indexOf(&quot;,&quot;)+1);&#xA;				parameter1[3][1]=parameter31.substr(0,parameter31.indexOf(&quot;,&quot;));&#xA;				parameter31=parameter31.substr(parameter31.indexOf(&quot;,&quot;)+1);&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter11.length&gt;0)&#xA;					parameter11=parameter11+&quot;,&quot;;&#xA;				if(parameter31.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter31.length&gt;0)&#xA;					parameter31=parameter31+&quot;,&quot;;&#xA;			} else {&#xA;				parameter1[1][1]=parameter11;&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter1[3][1]=parameter31;&#xA;			}&#xA;			do {&#xA;				if(parameter12.indexOf(&quot;,&quot;)&gt;0) {&#xA;					parameter1[1][2]=parameter12.substr(0,parameter12.indexOf(&quot;,&quot;));&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter12=parameter12.substr(parameter12.indexOf(&quot;,&quot;)+1);&#xA;					parameter1[3][2]=parameter32.substr(0,parameter32.indexOf(&quot;,&quot;));&#xA;					parameter32=parameter32.substr(parameter32.indexOf(&quot;,&quot;)+1);&#xA;					if(parameter12.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.length&gt;0)&#xA;						parameter12=parameter12+&quot;,&quot;;&#xA;					if(parameter32.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter32.length&gt;0)&#xA;						parameter32=parameter32+&quot;,&quot;;&#xA;				} else {&#xA;					parameter1[1][2]=parameter12;&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter1[3][2]=parameter32;&#xA;				}&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.indexOf(&quot;,&quot;)&lt;0)&#xA;					createRAcomplex(correctCR, thePackage, parameter1, connectors,1);&#xA;				else&#xA;					createRAcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;			} while(parameter12.indexOf(&quot;,&quot;)&gt;0);	&#xA;		} while(parameter11.indexOf(&quot;,&quot;)&gt;0);&#xA;	} &#xA;}&#xA;//Multiple calls to createAUcomplex depending on multi-value parameters&#xA;function createAUcomplexUau(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=connectors[0].length-1; //how many use cases are there in the rule&#xA;&#xA;	parameter1[1][0]=connectors[0][0].Name;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][1]=connectors[0][n+1].Name;&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. Use Case&quot;;&#xA;		createAUcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;}&#xA;//Multiple calls to createBAcomplex depending on multi-value parameters&#xA;function createBAcomplexApv(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var tmpActors = [];&#xA;	&#xA;	tmpActors=getActorsofUseCase(null, connectors[0][1], 0);&#xA;	tmpActors.reverse();&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][0]=parameters[1][2*n]; //if the partition is empty&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;			if(tmpActors.length&gt;0)&#xA;				parameter1[1][0]=tmpActors.pop();&#xA;			else&#xA;				parameter1[1][0]=&quot;Actor&quot;+(n+1);&#xA;		parameter1[1][1]=parameters[1][2*n+1]; //if the action is empty&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. Action&quot;;&#xA;		createBAcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;}&#xA;//Multiple calls to createRAcomplex depending on multi-value parameters&#xA;function createRBcomplexBaua(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var parameter11;&#xA;var parameter13;&#xA;var tmpActorL = [];	&#xA;var tmpActorR = [];	&#xA;var iterationL=0;&#xA;var iterationR=0;&#xA;//RevBau, ReviBaua, RviBau, RiviBaua&#xA;	&#xA;	parameter11=parameters[1][0];&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1)==&quot;aua&quot;)&#xA;		parameter13=parameters[1][2];&#xA;	do {&#xA;		if(parameter11.indexOf(&quot;,&quot;)&gt;-1) {&#xA;			tmpActorL.push(parameter11.substr(0,parameter11.indexOf(&quot;,&quot;)));&#xA;			iterationL=iterationL+1;&#xA;			parameter11=parameter11.substr(parameter11.indexOf(&quot;,&quot;)+1);&#xA;		}&#xA;		else {&#xA;			tmpActorL.push(parameter11);&#xA;			iterationL=iterationL+1;&#xA;			parameter11=&quot;&quot;;&#xA;		}&#xA;	} while(parameter11!=&quot;&quot;);&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1)==&quot;aua&quot;) {&#xA;		do {&#xA;			if(parameter13.indexOf(&quot;,&quot;)&gt;-1) {&#xA;				tmpActorR.push(parameter13.substr(0,parameter13.indexOf(&quot;,&quot;)));&#xA;				iterationR=iterationR+1;&#xA;				parameter13=parameter13.substr(parameter13.indexOf(&quot;,&quot;)+1);&#xA;			}&#xA;			else {&#xA;				tmpActorR.push(parameter13);&#xA;				iterationR=iterationR+1;&#xA;				parameter13=&quot;&quot;;&#xA;			}&#xA;		} while(parameter13!=&quot;&quot;);&#xA;	}&#xA;	if(iterationR==0)&#xA;		iterationR=1;&#xA;	if(iterationL==0)&#xA;		iterationL=1;&#xA;	parameter1[0]=parameters[0];&#xA;	parameter1[2]=parameters[2];	&#xA;	parameter1[3]=parameters[3];&#xA;	for(var m=0; m&lt;iterationL; m++) {&#xA;		parameter1[1][0]=tmpActorL[m];&#xA;		parameter1[1][1]=parameters[1][1];&#xA;		for(var n=0; n&lt;iterationR; n++) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1)==&quot;aua&quot;) &#xA;				parameter1[1][2]=tmpActorR[n];	&#xA;			else&#xA;				parameter1[1][2]=&quot; &quot;;	&#xA;			createRBcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;		}&#xA;	} &#xA;}&#xA;//Verification of the full consistency rule and return of the recognized shortcut&#xA;function verifyConsistencyRule(thePackage, consistencyRule, currentElement) {&#xA;	var stringCR=consistencyRule;&#xA;	var theParentPackage as EA.Package;&#xA;	var theParentParentPackage as EA.Package;&#xA;	var thePParentParentPackage as EA.Package;	&#xA;	&#xA;	theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;	if(theParentPackage.ParentID&gt;0)&#xA;		theParentParentPackage=Repository.GetPackageByID(theParentPackage.ParentID);&#xA;	else&#xA;		theParentParentPackage = null;&#xA;	if(theParentParentPackage!=null&amp;&amp;theParentParentPackage.ParentID&gt;0)&#xA;		thePParentParentPackage=Repository.GetPackageByID(theParentParentPackage.ParentID);&#xA;	else&#xA;		thePParentParentPackage = null;&#xA;	while (stringCR.indexOf(&quot;(&quot;)&gt;0)&#xA;    {&#xA;		var i= stringCR.indexOf(&quot;(&quot;);&#xA;		var string2=stringCR.substr(i);&#xA;		var j = string2.indexOf(&quot;)&quot;);&#xA;		if(j&lt;0)&#xA;			return null;&#xA;		var string1=stringCR.substr(0,i)+stringCR.substr(j+i+1);&#xA;		stringCR=string1;&#xA;    }&#xA;	if(thePackage.Name===&quot;Context Layer&quot;) {&#xA;		if(stringCR==&quot;XeRi&quot;&amp;&amp;currentElement.Type==&quot;Event&quot; || stringCR== &quot;XeRi«information»&quot;&amp;&amp;currentElement.Type==&quot;Event&quot;)&#xA;			return &quot;XeRi&quot;;&#xA;		else if((stringCR==&quot;XevRv&quot;||stringCR== &quot;XevRv«subprocess»&quot;||stringCR== &quot;Xev«process»Rv&quot;||stringCR== &quot;Xev«process»Rv«subprocess»&quot;)&amp;&amp;(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;) )&#xA;			return &quot;XevRv&quot;;&#xA;		else if((stringCR==&quot;XiRi&quot;||stringCR== &quot;Xi«product»Ri&quot;||stringCR== &quot;XiRi«subproduct»&quot;||stringCR== &quot;Xi«product»Ri«subproduct»&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Class&quot;))&#xA;			return &quot;XiRi&quot;; //tutaj zako&#324;czy&#322;em wariancje&#xA;		else if(stringCR==&quot;XivRv&quot;&amp;&amp;(currentElement.Type==&quot;Class&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;) || stringCR== &quot;Xi«rules»v«process»Rv«subprocess»&quot;&amp;&amp;(currentElement.Type==&quot;Class&quot;||currentElement.Type==&quot;Activity&quot;) )&#xA;			return &quot;XivRv&quot;;&#xA;		else if(stringCR==&quot;XviRv&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;) || stringCR==&quot;Xv«process»i«product»Rv«subprocess»&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;) )&#xA;			return &quot;XviRv&quot;;&#xA;		else if(stringCR==&quot;XiviRivi&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Class&quot;) || stringCR==&quot;Xi«product»v«process»i«product»Ri«product»v«subprocess»i«product»&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Class&quot;) )&#xA;			return &quot;XiviRivi&quot;;&#xA;		else if((stringCR==&quot;XeviRevi&quot;||  //tu juz zrobione&#xA;				 stringCR==&quot;Xev«process»iRevi&quot;||stringCR==&quot;Xevi«product»Revi&quot;||stringCR==&quot;XeviRev«subprocess»i&quot;||stringCR==&quot;XeviRevi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Revi&quot;||stringCR==&quot;XeviRev«subprocess»i«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»iRev«subprocess»i&quot;||stringCR==&quot;Xev«process»iRevi«product»&quot;||&#xA;				 stringCR==&quot;Xevi«product»Rev«subprocess»i&quot;||stringCR==&quot;Xevi«product»Revi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Rev«subprocess»i&quot;||stringCR==&quot;Xev«process»i«product»Revi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»iRev«subprocess»i«product»&quot;||stringCR==&quot;Xevi«product»Rev«subprocess»i«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Rev«subprocess»i«product»&quot;)&amp;&amp;&#xA;				 (currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;) )&#xA;			return &quot;XeviRevi&quot;;&#xA;		else if((stringCR==&quot;XeviRivi&quot;||&#xA;				 stringCR==&quot;Xev«process»iRivi&quot;||stringCR==&quot;Xevi«product»Rivi&quot;||stringCR==&quot;XeviRiv«subprocess»i&quot;||stringCR==&quot;XeviRivi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Rivi&quot;||stringCR==&quot;XeviRiv«subprocess»i«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»iRiv«subprocess»i&quot;||stringCR==&quot;Xev«process»iRivi«product»&quot;||&#xA;				 stringCR==&quot;Xevi«product»Riv«subprocess»i&quot;||stringCR==&quot;Xevi«product»Rivi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Riv«subprocess»i&quot;||stringCR==&quot;Xev«process»i«product»Rivi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»iRiv«subprocess»i«product»&quot;||stringCR==&quot;Xevi«product»Riv«subprocess»i«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Riv«subprocess»i«product»&quot;)&amp;&amp;&#xA;				 (currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;) )&#xA;			return &quot;XeviRivi&quot;;&#xA;		else if(stringCR==&quot;XevBau&quot;&amp;&amp;(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;XevBau&quot;;	&#xA;		else if(stringCR==&quot;XviBau&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;XviBau&quot;;&#xA;		else if(stringCR==&quot;XivBau&quot;&amp;&amp;(currentElement.Type==&quot;Class&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;XivBau&quot;;&#xA;	} else&#xA;	if(thePackage.Name===&quot;Decomposition Processes&quot;) {&#xA;		if((stringCR==&quot;RevBau&quot;||stringCR== &quot;Rev«subprocess»Bau&quot;)&amp;&amp;(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RevBau&quot;;&#xA;		else if((stringCR==&quot;ReviBaua&quot;||stringCR== &quot;Rev«subprocess»iBaua&quot;||stringCR== &quot;Revi«product»Baua&quot;||stringCR== &quot;Rev«subprocess»i«product»Baua&quot;)&amp;&amp;(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;))&#xA;			return &quot;ReviBaua&quot;;&#xA;		else if((stringCR==&quot;RviBau&quot;||stringCR== &quot;Rv«subprocess»i«product»Bau&quot;||stringCR== &quot;Rvi«product»Bau&quot;||stringCR== &quot;Rv«subprocess»iBau&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RviBau&quot;;&#xA;		else if((stringCR==&quot;RiviBaua&quot;|| stringCR== &quot;Riv«subprocess»iBau&quot;||stringCR== &quot;Riv«subprocess»i«product»Bau&quot;||stringCR== &quot;Ri«product»v«subprocess»i«product»Bau&quot;||stringCR== &quot;Ri«product»v«subprocess»iBau&quot;||&#xA;			                       stringCR== &quot;Rivi«product»Bau&quot;||stringCR== &quot;Ri«product»vi«product»Bau&quot;||stringCR== &quot;Ri«product»viBau&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RiviBaua&quot;;&#xA;		else if((stringCR==&quot;RiviAvi&quot;|| stringCR== &quot;Riv«subprocess»iAvi&quot;||stringCR== &quot;Riv«subprocess»i«product»Avi&quot;||stringCR== &quot;Ri«product»v«subprocess»i«product»Avi&quot;||stringCR== &quot;Ri«product»v«subprocess»iAvi&quot;||&#xA;			                       stringCR== &quot;Rivi«product»Avi&quot;||stringCR== &quot;Ri«product»vi«product»Avi&quot;||stringCR== &quot;Ri«product»viAvi&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RiviAvi&quot;;&#xA;		else if((stringCR==&quot;RiviAvivi&quot;||stringCR==&quot;RiviAvivivi&quot;||stringCR==&quot;RiviAvivivivi&quot;||stringCR==&quot;RiviAvivivivivi&quot;||stringCR==&quot;RiviAvivivivivivi&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RiviAvivi&quot;;&#xA;	} else	&#xA;	if(thePackage.Name===&quot;Business Use Cases&quot;) {&#xA;		if((stringCR==&quot;BauApv&quot;)&amp;&amp;(currentElement.Type==&quot;Actor&quot;||currentElement.Type==&quot;UseCase&quot;))&#xA;			return &quot;BauApv&quot;;&#xA;		else if((stringCR==&quot;BauApvpv&quot;||stringCR==&quot;BauApvpvpv&quot;||stringCR==&quot;BauApvpvpvpv&quot;||stringCR==&quot;BauApvpvpvpvpv&quot;||stringCR==&quot;BauApvpvpvpvpvpv&quot;)&amp;&amp;(currentElement.Type==&quot;Actor&quot;||currentElement.Type==&quot;UseCase&quot;))&#xA;			return &quot;BauApvpv&quot;;&#xA;	} else&#xA;	if(theParentPackage.Name===&quot;Business Process Layer&quot;) {&#xA;		if((stringCR==&quot;ApUau&quot;)&amp;&amp;(currentElement.Type==&quot;ActivityPartition&quot;))&#xA;			return &quot;ApUau&quot;;&#xA;		else if((stringCR==&quot;AiviCczc&quot;)&amp;&amp;(currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;))&#xA;			return &quot;AiviCczc&quot;;		&#xA;		else if((stringCR==&quot;AivSrst&quot;)&amp;&amp;(currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;))&#xA;			return &quot;AivSrst&quot;;&#xA;	} else&#xA;	if(theParentPackage.Name===&quot;System Use Case&quot;) {&#xA;		if((stringCR==&quot;UauZpv&quot;||stringCR==&quot;UauZpvpv&quot;||stringCR==&quot;UauZpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpvpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpvpvpvpvpv&quot;)&amp;&amp;(currentElement.Type==&quot;UseCase&quot;||currentElement.Type==&quot;Actor&quot;))&#xA;			return &quot;UauZpv&quot;;&#xA;	} else&#xA;	if(thePackage.Name===&quot;Business Class&quot;) {&#xA;		if((stringCR==&quot;CchZiv&quot;||stringCR==&quot;CchZivi&quot;||stringCR==&quot;CchZivivi&quot;||stringCR==&quot;CchZivivivi&quot;||stringCR==&quot;CchZivivivivi&quot;||stringCR==&quot;CchZivivivivivi&quot;||stringCR==&quot;CchZivivivivivivi&quot;)&amp;&amp;(currentElement.Type==&quot;Class&quot;||currentElement.Type==&quot;Association&quot;))&#xA;			return &quot;CchZiv&quot;;&#xA;	} else	&#xA;	if(thePackage.Name===&quot;Business State&quot;) {&#xA;		if((stringCR==&quot;SrsZiv&quot;||stringCR==&quot;SrsZivi&quot;||stringCR==&quot;SrsZivivi&quot;||stringCR==&quot;SrsZivivivi&quot;||stringCR==&quot;SrsZivivivivi&quot;||stringCR==&quot;SrsZivivivivivi&quot;||stringCR==&quot;SrsZivivivivivivi&quot;)&amp;&amp;(currentElement.Type==&quot;Region&quot;||currentElement.Type==&quot;State&quot;||currentElement.Type==&quot;StateMachine&quot;))&#xA;			return &quot;SrsZiv&quot;;&#xA;	} else	&#xA;	if(theParentParentPackage!=null&amp;&amp;theParentParentPackage.Name===&quot;User Layer&quot;) {&#xA;		if((stringCR==&quot;ZpvYu&quot;)&amp;&amp;currentElement.Type==&quot;ActivityPartition&quot;)&#xA;			return &quot;ZpvYu&quot;;&#xA;	} else&#xA;	if(theParentParentPackage!=null&amp;&amp;theParentParentPackage.Name===&quot;Internal Use Cases&quot;) {&#xA;		if((stringCR==&quot;YuQlm&quot;||stringCR==&quot;YuQlml&quot;||stringCR==&quot;YuQlmlml&quot;||stringCR==&quot;YuQlmlmlml&quot;||stringCR==&quot;YuQlmlmlml&quot;||stringCR==&quot;YuQlmlmlmlml&quot;)&amp;&amp;(currentElement.Type==&quot;UseCase&quot;||currentElement.Type==&quot;Actor&quot;))&#xA;			return &quot;YuQlml&quot;;&#xA;	} else&#xA;	if(thePParentParentPackage!=null&amp;&amp;thePParentParentPackage.Name===&quot;Sequence Layer&quot;) {&#xA;	if(stringCR==&quot;QlmlMqyq&quot;&amp;&amp;(currentElement.Type==&quot;Lifeline&quot;||currentElement.Type==&quot;Sequence&quot;))&#xA;		return &quot;QlmlMqyq&quot;;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Return of rule parameters, and in case of repeating rules, return of extended parameters in index 1 and possibly 3&#xA;function getArgumentsCR(correctCR, consistencyRule)&#xA;{&#xA;	var string0 = consistencyRule;&#xA;	var inParameters = [ null,null];&#xA;	var diagram=0;&#xA;	var parameters = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	//[0]-the first diagram's parameters,[1]-the second diagram's parameters,[2]-the first diagram's states,[3]-the second diagram's states.&#xA;&#xA;	//RiviAvivi, BauApvpv&#xA;	if(correctCR==consistencyRule)&#xA;		return parameters;&#xA;	if(string0.charAt(0)&lt;'A' &amp;&amp; string0.charAt(0)&gt;'Z')&#xA;		return parameters;&#xA;	string0=string0.substring(1);&#xA;	var index=0;&#xA;	while((string0.charAt(0)&lt;'A' || string0.charAt(0)&gt;'Z')&amp;&amp;index&lt;3) {&#xA;		if(string0.charAt(1)=='('||string0.charAt(1)=='«'&amp;&amp;   //i(,e(,v(&#xA;			(string0.charAt(0)=='i'&amp;&amp;string0.charAt(10)=='('|| //i«product»(&#xA;			 string0.charAt(0)=='v'&amp;&amp;string0.charAt(10)=='('|| //v«process»(&#xA;			 string0.charAt(0)=='i'&amp;&amp;string0.charAt(8)=='(')) //i«rules»(&#xA;		{  //there is argument for the next parameter&#xA;			string0=string0.substr(string0.indexOf(&quot;(&quot;));&#xA;			inParameters = [ null,null];&#xA;			inParameters=getInArgument(string0.substr(1,string0.indexOf(&quot;)&quot;)-1), parameters[diagram][index], parameters[diagram+2][index]);&#xA;			parameters[diagram][index]=inParameters[0];&#xA;			parameters[diagram+2][index]=inParameters[1];&#xA;			string0=string0.substr(string0.indexOf(&quot;)&quot;)+1);&#xA;		} else {&#xA;			//there is no argument for the first parameter&#xA;			if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(9)=='»') //i«product»,v«process»&#xA;				string0=string0.substr(10);&#xA;			else if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(7)=='»') //i«rules»(&#xA;				string0=string0.substr(8);&#xA;			else&#xA;				string0=string0.substr(1); //to the second letter&#xA;		}&#xA;		index=index+1;&#xA;	}&#xA;	if(string0.charAt(0)&lt;'A' || string0.charAt(0)&gt;'Z') {&#xA;		Session.Output(&quot;Interruption of parameter processing at: '&quot;+string0+&quot;'&quot;);&#xA;		return parameters;&#xA;	}&#xA;	else {&#xA;		string0=string0.substr(1); // the second diagram&#xA;		diagram=1;&#xA;	}	&#xA;	//parameters of the second diagram&#xA;	index=0;&#xA;	while(string0!=&quot;&quot;&amp;&amp;string0!=&quot; &quot;) {&#xA;		if(string0.charAt(1)=='('||string0.charAt(1)=='«'&amp;&amp;&#xA;			(string0.charAt(0)=='i'&amp;&amp;string0.charAt(13)=='('|| //i«subproduct»(&#xA;			 string0.charAt(0)=='v'&amp;&amp;string0.charAt(13)=='('|| //v«subprocess»(&#xA;			 string0.charAt(0)=='i'&amp;&amp;string0.charAt(14)=='('|| //i«information»(&#xA;			 string0.charAt(0)=='i'&amp;&amp;string0.charAt(10)=='(')) //i«product»(&#xA;		{  //there is argument for the first parameter&#xA;			string0=string0.substr(string0.indexOf(&quot;(&quot;));&#xA;			inParameters = [ null,null];&#xA;			inParameters=getInArgument(string0.substr(1,string0.indexOf(&quot;)&quot;)-1), parameters[diagram][index], parameters[diagram+2][index]);&#xA;			parameters[diagram][index]=inParameters[0];&#xA;			parameters[diagram+2][index]=inParameters[1];&#xA;			string0=string0.substr(string0.indexOf(&quot;)&quot;)+1);&#xA;		} else &#xA;		if(string0.charAt(0)=='(') {&#xA;			if(string0.indexOf(')')&lt;0)&#xA;				return parameters;&#xA;			parameters.push(string0.substr(1,string0.indexOf(')')-1));&#xA;			index=index-1;&#xA;			string0=string0.substr(string0.indexOf(')')+1);&#xA;		} else {&#xA;			//there is no argument for the first parameter&#xA;			if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(12)=='»') //i«subproduct»,v«subprocess»&#xA;				string0=string0.substr(13);&#xA;			else if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(13)=='»') //i«information»(&#xA;				string0=string0.substr(14);&#xA;			else if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(9)=='»') //i«product»(&#xA;				string0=string0.substr(10);&#xA;			else&#xA;				string0=string0.substr(1);&#xA;			if(index&gt;=3) //RiviAvivi, BauApvpv&#xA;				parameters[diagram][index]=&quot; &quot;;				&#xA;		}&#xA;		index=index+1;&#xA;	}&#xA;	return parameters;&#xA;}&#xA;//Returns the next string for processing and a list of identified states&#xA;function getInArgument(string1, parameter0, parameter2) {&#xA;	var inParameters = [ null,null];&#xA;	var string2;&#xA;	var parA = &quot;&quot;;&#xA;	var parB = &quot;&quot;;&#xA;	&#xA;	if(string1.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;string1.indexOf(&quot;]&quot;)&gt;string1.indexOf(&quot;[&quot;))&#xA;	{&#xA;		string2=string1.substr(string1.indexOf(&quot;[&quot;)+1,string1.indexOf(&quot;]&quot;)-string1.indexOf(&quot;[&quot;)-1);&#xA;		if(string2!=&quot;&quot;) {&#xA;			do {&#xA;				parB = parB +string2; //state&#xA;				parA = parA +string1.substr(0,string1.indexOf(&quot;[&quot;));&#xA;				string1=string1.substr(string1.indexOf(&quot;]&quot;)+1);&#xA;				if(string1.indexOf(&quot;,&quot;)&gt;-1) {&#xA;					parA = parA +string1.substr(0,string1.indexOf(&quot;,&quot;)+1);&#xA;					string1=string1.substr(string1.indexOf(&quot;,&quot;)+1);&#xA;					if(string1.indexOf(&quot;,&quot;)&lt;0&amp;&amp;string1.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;string1.indexOf(&quot;]&quot;)&gt;string1.indexOf(&quot;[&quot;)) {&#xA;						parB = parB + &quot;,&quot;;&#xA;						string2=string1.substr(string1.indexOf(&quot;[&quot;)+1,string1.indexOf(&quot;]&quot;)-string1.indexOf(&quot;[&quot;)-1);&#xA;					} else &#xA;					if(string1.indexOf(&quot;,&quot;)&gt;=0&amp;&amp;string1.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;string1.indexOf(&quot;]&quot;)&gt;string1.indexOf(&quot;[&quot;)&amp;&amp;string1.indexOf(&quot;[&quot;)&lt;string1.indexOf(&quot;,&quot;)) {&#xA;						parB = parB + &quot;,&quot;;&#xA;						string2=string1.substr(string1.indexOf(&quot;[&quot;)+1,string1.indexOf(&quot;]&quot;)-string1.indexOf(&quot;[&quot;)-1);&#xA;					} else &#xA;					if(string1.indexOf(&quot;,&quot;)&gt;=0&amp;&amp;string1.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;string1.indexOf(&quot;]&quot;)&gt;string1.indexOf(&quot;[&quot;)&amp;&amp;string1.indexOf(&quot;[&quot;)&gt;string1.indexOf(&quot;,&quot;)) {&#xA;						parB = parB + &quot;,&quot;;&#xA;						string2=&quot;&quot;;&#xA;					} else &#xA;					if(string1.indexOf(&quot;,&quot;)&lt;0&amp;&amp;string1.indexOf(&quot;[&quot;)&lt;0) {&#xA;						parA = parA +string1;&#xA;						string2=null;&#xA;					}&#xA;				} else {&#xA;					parA = parA +string1;&#xA;					string2=null;&#xA;				}&#xA;			} while (string2!=null);&#xA;		} else&#xA;			parA = string1;&#xA;	} else&#xA;		parA = string1;&#xA;	inParameters[0] = parA;&#xA;	inParameters[1] = parB; 	&#xA;	return inParameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the context diagram&#xA;function getConnectionX(thePackage, type, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//Checking whether the elements from the X diagram, &#xA;	//indicated by the new elements from the R diagram, &#xA;	//are connected to each other&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var otherElements = [];&#xA;	var delements as EA.Collection;&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	delements = thePackage.Elements;&#xA;	//Finding elements in the X diagram&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;	    var coto as EA.Element;&#xA;		coto=null;&#xA;	    var testElement as EA.Element;&#xA;	    testElement = delements.GetAt( j );&#xA;		if(testElement.ClassfierID!=null&amp;&amp;testElement.ClassfierID&gt;0)&#xA;			coto=Repository.GetElementByID(testElement.ClassfierID);&#xA;		if(theElement1==null &amp;&amp; //gdy nazwa zdarzenia ze strony R lub pierwsze znalezione&#xA;			(nameElement1!=&quot; &quot;&amp;&amp; nameElement1!=&quot;&quot; &amp;&amp; (testElement.Name == nameElement1 || nameElement1.substr(0,1)==&quot;:&quot; &amp;&amp; coto!=null&amp;&amp;coto.Name==nameElement1.substr(1))||&#xA;		    (nameElement1==&quot; &quot;||nameElement1==&quot;&quot;) &amp;&amp; type.substr(0,1)==&quot;e&quot; &amp;&amp; (testElement.Type == &quot;Event&quot;)||&#xA;		    (nameElement1==&quot; &quot;||nameElement1==&quot;&quot;) &amp;&amp; type.substr(0,1)==&quot;i&quot; &amp;&amp; (testElement.Type == &quot;Object&quot;)||&#xA;		    (nameElement1==&quot; &quot;||nameElement1==&quot;&quot;) &amp;&amp; type.substr(0,1)==&quot;i&quot; &amp;&amp; (testElement.Type == &quot;Class&quot;)))&#xA;			theElement1 = testElement;&#xA;		else &#xA;		if(theElement2==null &amp;&amp; //tu zawsze powinien by&#263; jeden proces&#xA;			(nameElement2!=&quot; &quot;&amp;&amp; nameElement2!=&quot;&quot; &amp;&amp; (testElement.Name == nameElement2 || nameElement2.substr(0,1)==&quot;:&quot; &amp;&amp; coto!=null&amp;&amp;coto.Name==nameElement2.substr(1))||&#xA;		    (nameElement2==&quot; &quot;||nameElement2==&quot;&quot;) &amp;&amp; type.substr(1,1)==&quot;e&quot; &amp;&amp; (testElement.Type == &quot;Event&quot;)||&#xA;		    (nameElement2==&quot; &quot;||nameElement2==&quot;&quot;) &amp;&amp; type.substr(1,1)==&quot;i&quot; &amp;&amp; (testElement.Type == &quot;Object&quot;)||&#xA;		    (nameElement2==&quot; &quot;||nameElement2==&quot;&quot;) &amp;&amp; type.substr(1,1)==&quot;v&quot; &amp;&amp; (testElement.Type == &quot;Activity&quot;)))&#xA;			theElement2 = testElement;&#xA;		else &#xA;		if(theElement3==null &amp;&amp; //gdy nazwa na obiekcie po stronie R&#xA;			(nameElement3!=&quot; &quot;&amp;&amp; nameElement3!=&quot;&quot; &amp;&amp; (testElement.Name == nameElement3 || nameElement3.substr(0,1)==&quot;:&quot; &amp;&amp; coto!=null&amp;&amp;coto.Name==nameElement3.substr(1))||&#xA;		    (nameElement3==&quot; &quot;||nameElement3==&quot;&quot;) &amp;&amp; type.substr(2,1)==&quot;e&quot; &amp;&amp; (testElement.Type == &quot;Event&quot;)||&#xA;		    (nameElement3==&quot; &quot;||nameElement3==&quot;&quot;) &amp;&amp; type.substr(2,1)==&quot;i&quot; &amp;&amp; (testElement.Type == &quot;Object&quot;)||&#xA;		    (nameElement3==&quot; &quot;||nameElement3==&quot;&quot;) &amp;&amp; type.substr(2,1)==&quot;i&quot; &amp;&amp; (testElement.Type == &quot;Class&quot;)))&#xA;			theElement3 = testElement;&#xA;		else&#xA;			otherElements.push(testElement);&#xA;		//if(theElement1!=null &amp;&amp; theElement2!=null &amp;&amp; theElement3!=null)&#xA;			//break;&#xA;	}&#xA;	parameters[0][0]=theElement1;&#xA;	parameters[0][1]=theElement2;&#xA;	parameters[0][2]=theElement3;&#xA;	if(theElement2==null || theElement1==null &amp;&amp; theElement3==null)&#xA;		return parameters;&#xA;	var theConnector as EA.Connector;&#xA;	var diagramObjects as EA.Collection;&#xA;	var diagramObject as EA.DiagramObject;	&#xA;	var diagramObject1 as EA.DiagramObject;	&#xA;	var diagramObject2 as EA.DiagramObject;	&#xA;	var diagramObject3 as EA.DiagramObject;	&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	diagramObjects = thePackage.Diagrams.GetAt(0).DiagramObjects;&#xA;	for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;	{&#xA;	    diagramObject = diagramObjects.GetAt(i);&#xA;		if(theElement1!=null&amp;&amp;theElement1.ElementID == diagramObject.ElementID) &#xA;			diagramObject1=diagramObject;&#xA;		else if(theElement2!=null&amp;&amp;theElement2.ElementID == diagramObject.ElementID)&#xA;			diagramObject2=diagramObject;&#xA;		else if(theElement3!=null&amp;&amp;theElement3.ElementID == diagramObject.ElementID)&#xA;			diagramObject3=diagramObject;&#xA;		else {&#xA;			//here it can be that theElementx==null, and it need to match element with diagramObject&#xA;			var foundElement as EA.Element;&#xA;			foundElement=null;&#xA;			for ( var j = 0 ; j &lt; otherElements.length ; j++ ) {&#xA;				if(otherElements[j].ElementID==diagramObject.ElementID) {&#xA;					foundElement=otherElements[j];&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(foundElement!=null) {&#xA;				if(type.substr(0,1)==&quot;e&quot;&amp;&amp;foundElement.Type==&quot;Event&quot;&amp;&amp;theElement1==null&amp;&amp;diagramObject1==null) {&#xA;					diagramObject1=diagramObject;&#xA;					theElement1=foundElement;&#xA;					parameters[0][0]=theElement1;&#xA;				} else &#xA;				if(type.substr(0,1)==&quot;i&quot;&amp;&amp;foundElement.Type==&quot;Object&quot;&amp;&amp;theElement1==null&amp;&amp;diagramObject1==null) {&#xA;					diagramObject1=diagramObject;&#xA;					theElement1=foundElement;&#xA;					parameters[0][0]=theElement1;&#xA;				} else &#xA;				if(type.substr(1,1)==&quot;e&quot;&amp;&amp;foundElement.Type==&quot;Event&quot;&amp;&amp;theElement2==null&amp;&amp;diagramObject2==null) {&#xA;					diagramObject1=diagramObject;&#xA;					theElement1=foundElement;&#xA;					parameters[0][0]=theElement1;&#xA;				} else &#xA;				if(type.substr(1,1)==&quot;i&quot;&amp;&amp;foundElement.Type==&quot;Object&quot;&amp;&amp;theElement2==null&amp;&amp;diagramObject2==null) {&#xA;					diagramObject2=diagramObject;&#xA;					theElement2=foundElement;&#xA;					parameters[0][1]=theElement2;&#xA;				} else &#xA;				if(type.substr(2,1)==&quot;i&quot;&amp;&amp;foundElement.Type==&quot;Object&quot;&amp;&amp;theElement3==null&amp;&amp;diagramObject3==null) {&#xA;					diagramObject3=diagramObject;&#xA;					theElement3=foundElement;&#xA;					parameters[0][2]=theElement3;				&#xA;				} else &#xA;				if(type.substr(2,1)==&quot;e&quot;&amp;&amp;foundElement.Type==&quot;Event&quot;&amp;&amp;theElement3==null&amp;&amp;diagramObject3==null) {&#xA;					diagramObject3=diagramObject;&#xA;					theElement3=foundElement;&#xA;					parameters[0][2]=theElement3;	&#xA;				}  &#xA;			}&#xA;		}&#xA;		if(diagramObject1!=null&amp;&amp;diagramObject2!=null&amp;&amp;diagramObject3!=null)&#xA;			break;			&#xA;	}&#xA;	if(diagramObject2==null || diagramObject1==null &amp;&amp; diagramObject3==null)&#xA;		return parameters;&#xA;	//Identifying connectors&#xA;	var Connectors as EA.Collection;&#xA;	Connectors = theElement1.Connectors;&#xA;	var theConnector as EA.Connector;&#xA;	var thisConnector as EA.Connector;&#xA;	thisConnector=null;&#xA;    //identifying connector element for 1,2 elements&#xA;	for(i=0;i&lt;Connectors.Count;i++)&#xA;	{&#xA;		theConnector=Connectors.GetAt(i);&#xA;		if( theConnector.SupplierID == theElement1.ElementID &amp;&amp; theConnector.ClientID == theElement2.ElementID ||&#xA;		theConnector.ClientID == theElement1.ElementID &amp;&amp; theConnector.SupplierID == theElement2.ElementID) {&#xA;			parameters[1][0] = theConnector;&#xA;			break;&#xA;		}&#xA;	}&#xA;    //identifying connector element for 2,3 elements&#xA;	Connectors = theElement3.Connectors;&#xA;	thisConnector=null;&#xA;	for(i=0;i&lt;Connectors.Count;i++)&#xA;	{&#xA;		theConnector=Connectors.GetAt(i);&#xA;		if( theConnector.SupplierID == theElement2.ElementID &amp;&amp; theConnector.ClientID == theElement3.ElementID ||&#xA;		theConnector.ClientID == theElement2.ElementID &amp;&amp; theConnector.SupplierID == theElement3.ElementID) {&#xA;			parameters[1][1] = theConnector;&#xA;			break;&#xA;		}&#xA;	}&#xA;	return parameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the process decomposition diagram&#xA;function getConnectionR(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var searchConnectors = [ null, null];&#xA;&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.Type==&quot;Event&quot;) { //RevBau, ReviBaua&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(type.substr(2,1)==&quot;v&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, nameElement2, 0);&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Object&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			if(type.substr(3,1)==&quot;i&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 0);&#xA;			else&#xA;			if(type.substr(3,1)!=&quot;B&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Activity&quot;, nameElement3, 0);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][2]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;			}&#xA;		}&#xA;	}&#xA;	else&#xA;	if((currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;)&amp;&amp;type.substr(2,1)==&quot;v&quot;) {  //RevBau, RiviBaua, ReviBaua - redundant&#xA;		theElement2=currentElement;		&#xA;		parameters[0][1]=theElement2;&#xA;		if(type.substr(1,1)==&quot;e&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Event&quot;, nameElement1, 1);	&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);	&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][0]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement1=searchConnectors[0];&#xA;		}&#xA;		if(type.substr(3,1)==&quot;i&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 0);	&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][2]= searchConnectors[0];&#xA;			parameters[1][1] = searchConnectors[1];&#xA;			theElement3=searchConnectors[0];&#xA;		}&#xA;		//if type==RiviBaua&#xA;	}&#xA;	else&#xA;	if((currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;)&amp;&amp;type.substr(1,1)==&quot;v&quot;)	{	//RviBau, RvivBuau&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(type.substr(2,1)==&quot;i&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Object&quot;, nameElement2, 0);	&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement2=searchConnectors[0];&#xA;		}&#xA;		//RvivBuau&#xA;	}&#xA;	else&#xA;	if(currentElement.Type==&quot;Object&quot;&amp;&amp;type.substr(2,1)==&quot;i&quot;) {		//RviBau, RvivBuau - redundant&#xA;		theElement2=currentElement;&#xA;		parameters[0][1]=theElement2;&#xA;		if(type.substr(1,1)==&quot;i&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);	&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Activity&quot;, nameElement1, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][0]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement1=searchConnectors[0];&#xA;		}&#xA;		//RvivBuau&#xA;	}&#xA;	else&#xA;	if(currentElement.Type==&quot;Object&quot;&amp;&amp;type.substr(3,1)==&quot;i&quot;&amp;&amp;type.substr(1,1)==&quot;i&quot;) //RiviBaua&#xA;	{		&#xA;		theElement1=currentElement;&#xA;		theElement3=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 0);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][2]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;			}&#xA;		} else {&#xA;			parameters[0][0]=null;&#xA;			parameters[0][2]=currentElement;&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, nameElement2, 1);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][1]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;				theElement2=searchConnectors[0];&#xA;				searchConnector = [ null, null];&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;				if(searchConnectors[0]!=null) {&#xA;					parameters[0][0]= searchConnectors[0];&#xA;					parameters[1][0] = searchConnectors[1];&#xA;				}&#xA;			}&#xA;		}&#xA;		//type==RiviBaua - you should look at all objects&#xA;	}&#xA;	else	&#xA;	if(currentElement.Type==&quot;Object&quot;&amp;&amp;type.substr(3,1)==&quot;i&quot;&amp;&amp;type.substr(1,1)!=&quot;i&quot;) {	//ReviBaua-redundant&#xA;		theElement3=currentElement;&#xA;		parameters[0][2]=theElement3;&#xA;		if(type.substr(2,1)==&quot;v&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, nameElement3, 1);&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Object&quot;, nameElement3, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][1] = searchConnectors[1];&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			if(type.substr(1,1)==&quot;e&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Event&quot;, nameElement1, 1);&#xA;			else&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][0]= searchConnectors[0];&#xA;				parameters[1][0] = searchConnectors[1];&#xA;			}&#xA;		}&#xA;	}&#xA;	return parameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the business use case diagram&#xA;function getConnectionB(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var searchConnectors = [ null, null];&#xA;&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.Type==&quot;Actor&quot;) { //BauApv&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(type.substr(2,1)==&quot;u&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;UseCase&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;		}&#xA;	} else&#xA;	if(currentElement.Type==&quot;UseCase&quot;&amp;&amp;type==&quot;YuQlml&quot;) { //BauApv&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(type.substr(1,1)==&quot;u&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;UseCase&quot;, nameElement2, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;		}&#xA;	} else	&#xA;	if(currentElement.Type==&quot;UseCase&quot;) { //BauApv&#xA;		theElement2=currentElement;&#xA;		parameters[0][1]=theElement2;&#xA;		if(type.substr(1,1)==&quot;a&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Actor&quot;, nameElement1, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][0]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;		}&#xA;	}	&#xA;	return parameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the business process diagram&#xA;function getConnectionA(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var searchConnectors = [ null, null];&#xA;	var index=0;&#xA;	var statesArray = [];&#xA;	var stateObject;&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(type.substr(0,4)==&quot;AivS&quot;) {&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(nameElement1==null||nameElement1==&quot;&quot;||nameElement1==&quot; &quot;||nameElement1.indexOf(&quot;:&quot;)&lt;0) &#xA;			nameElement1=&quot;:&quot;+(Repository.GetElementByID(theElement1.ClassifierID)).Name;&#xA;		statObject=getStatesOfObject(theElement1);&#xA;		if(statObject==null) &#xA;			return parameters;&#xA;		statesArray.push(statObject);&#xA;		searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, &quot;&quot;, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;			if(searchConnectors[0]!=null) {&#xA;				theElement3=searchConnectors[0];&#xA;				statObject=getStatesOfObject(theElement3);&#xA;				if(statObject==null) &#xA;					return parameters;&#xA;				statesArray.push(statObject);				&#xA;				searchConnector = [ null, null];&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, &quot;&quot;, 1);&#xA;				if(searchConnectors[0]!=null) {&#xA;					theElement2=searchConnectors[0];&#xA;					searchConnector = [ null, null];&#xA;					searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;					if(searchConnectors[0]!=null) {&#xA;						theElement3=searchConnectors[0];&#xA;						statObject=getStatesOfObject(theElement3);&#xA;						if(statObject==null) &#xA;							return parameters;&#xA;						statesArray.push(statObject);				&#xA;						searchConnector = [ null, null];&#xA;						searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, &quot;&quot;, 1);&#xA;						if(searchConnectors[0]!=null) {&#xA;							theElement2=searchConnectors[0];&#xA;							searchConnector = [ null, null];&#xA;							searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;							if(searchConnectors[0]!=null) {&#xA;								theElement3=searchConnectors[0];&#xA;								statObject=getStatesOfObject(theElement3);&#xA;								if(statObject==null) &#xA;									return parameters;&#xA;								statesArray.push(statObject);				&#xA;								searchConnector = [ null, null];&#xA;							}&#xA;						}&#xA;					}&#xA;				}&#xA;			}				&#xA;		}&#xA;		statesArray.reverse();&#xA;		searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, &quot;&quot;, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 0);&#xA;			if(searchConnectors[0]!=null) {&#xA;				theElement3=searchConnectors[0];&#xA;				statObject=getStatesOfObject(theElement3);&#xA;				if(statObject==null) &#xA;					return parameters;&#xA;				statesArray.push(statObject);				&#xA;				searchConnector = [ null, null];&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, &quot;&quot;, 0);&#xA;				if(searchConnectors[0]!=null) {&#xA;					theElement2=searchConnectors[0];&#xA;					searchConnector = [ null, null];&#xA;					searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 0);&#xA;					if(searchConnectors[0]!=null) {&#xA;						theElement3=searchConnectors[0];&#xA;						statObject=getStatesOfObject(theElement3);&#xA;						if(statObject==null) &#xA;							return parameters;&#xA;						statesArray.push(statObject);				&#xA;						searchConnector = [ null, null];&#xA;						searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, &quot;&quot;, 0);&#xA;						if(searchConnectors[0]!=null) {&#xA;							theElement2=searchConnectors[0];&#xA;							searchConnector = [ null, null];&#xA;							searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 0);&#xA;							if(searchConnectors[0]!=null) {&#xA;								theElement3=searchConnectors[0];&#xA;								statObject=getStatesOfObject(theElement3);&#xA;								if(statObject==null) &#xA;									return parameters;&#xA;								statesArray.push(statObject);				&#xA;								searchConnector = [ null, null];&#xA;							}&#xA;						}&#xA;					}&#xA;				}&#xA;			}				&#xA;		}&#xA;		statesArray.reverse();&#xA;		var index=0;&#xA;		while(statesArray.length&gt;0) {&#xA;			statObject=statesArray.pop();&#xA;			parameters[1][index]=statObject;&#xA;			index++;&#xA;		}&#xA;	} else&#xA;	if(currentElement.Type==&quot;ActivityPartition&quot;) { //ApvUau&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		for(var i=0; i&lt;currentElement.Elements.Count(); i++) {&#xA;			theElement2=currentElement.Elements.GetAt(i);&#xA;			if(theElement2.Type==&quot;Action&quot;||theElement2.Type==&quot;Activity&quot;) {&#xA;				index++;&#xA;				parameters[0][index]=theElement2;				&#xA;			}&#xA;		}&#xA;	} else&#xA;	if(currentElement.Type==&quot;Object&quot;) { //AiviCczc&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(type.substr(2,1)==&quot;v&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, nameElement2, 0);&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Object&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			if(type.substr(3,1)==&quot;i&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 0);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][2]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;			}&#xA;		}&#xA;	} else&#xA;	if(currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Activity&quot;) { //AiviCczc&#xA;		theElement2=currentElement;&#xA;		parameters[0][1]=theElement2;&#xA;		if(type.substr(2,1)==&quot;v&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;		else &#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][0]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement1=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			if(type.substr(3,1)==&quot;i&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 0);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][2]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;			}&#xA;		}&#xA;	} 	&#xA;	return parameters;&#xA;}&#xA;//Returning the state of a given element&#xA;function getStatesOfObject(theElement) {&#xA;	var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+theElement.ElementID;&#xA;	var sqlRespond=Repository.SQLQuery(sqlCommand);&#xA;	var stateObject=null;&#xA;	if(sqlRespond!=null)&#xA;		stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;	if(stateObject==null||stateObject==&quot;&quot;)&#xA;		return null;&#xA;	else&#xA;		return stateObject;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the sequence diagram&#xA;function getConnectionQ(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.ObjectType==otConnector) { //QlmlMqyq&#xA;		theElement1=Repository.GetElementByID(currentElement.ClientID);&#xA;		theElement2=currentElement;&#xA;		theElement3=Repository.GetElementByID(currentElement.SupplierID);&#xA;		parameters[0][0]=theElement1;&#xA;		parameters[0][1]=theElement2;&#xA;		parameters[0][2]=theElement3;&#xA;		if((nameElement1==null||nameElement1==&quot;&quot;||nameElement1==&quot; &quot;)&amp;&amp;(nameElement2==null||nameElement2==&quot;&quot;||nameElement2==&quot; &quot;)&amp;&amp;(nameElement3==null||nameElement3==&quot;&quot;||nameElement3==&quot; &quot;)) {&#xA;			for( var k=0; k&lt;theElement3.Connectors.Count;k++) {&#xA;				theElement2=theElement3.Connectors.GetAt(k);&#xA;				if(theElement2.ClientID==theElement3.ElementID&amp;&amp;theElement2.SupplierID!=theElement1.ElementID) {&#xA;					parameters[0][3]=theElement2;&#xA;					parameters[0][4]=Repository.GetElementByID(theElement2.SupplierID);&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(parameters[0][4]!=null&amp;&amp;parameters[0][4].Type==&quot;Sequence&quot;) {&#xA;				for( var k=0; k&lt;parameters[0][4].Connectors.Count;k++) {&#xA;					theElement2=parameters[0][4].Connectors.GetAt(k);&#xA;					if(theElement2.ClientID==parameters[0][4].ElementID&amp;&amp;theElement2.SupplierID!=parameters[0][2].ElementID) {&#xA;						parameters[0][5]=theElement2;&#xA;						parameters[0][6]=Repository.GetElementByID(theElement2.SupplierID);&#xA;						break;&#xA;					}&#xA;				}				&#xA;			}&#xA;			if(parameters[0][6]!=null&amp;&amp;parameters[0][6].Type==&quot;Sequence&quot;) {&#xA;				for( var k=0; k&lt;parameters[0][6].Connectors.Count;k++) {&#xA;					theElement2=parameters[0][6].Connectors.GetAt(k);&#xA;					if(theElement2.ClientID==parameters[0][6].ElementID&amp;&amp;theElement2.SupplierID!=parameters[0][4].ElementID) {&#xA;						parameters[0][7]=theElement2;&#xA;						parameters[0][8]=Repository.GetElementByID(theElement2.SupplierID);&#xA;						break;&#xA;					}&#xA;				}				&#xA;			}&#xA;		}&#xA;	} else&#xA;	if(currentElement.ObjectType==otElement) { //QlmlMqyq&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		for( var k=0; k&lt;theElement1.Connectors.Count;k++) {&#xA;			theElement2=theElement1.Connectors.GetAt(k);&#xA;			if(theElement2.ClientID==theElement1.ElementID) {&#xA;				parameters[0][1]=theElement2;&#xA;				parameters[0][2]=Repository.GetElementByID(theElement2.SupplierID);&#xA;				break;&#xA;			}&#xA;		}&#xA;	} 	&#xA;	return parameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the business class diagram&#xA;function getConnectionC(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.ObjectType==otConnector) { //CchZiv&#xA;		theElement1=Repository.GetElementByID(currentElement.ClientID);&#xA;		theElement2=currentElement;&#xA;		theElement3=Repository.GetElementByID(currentElement.SupplierID);&#xA;		parameters[0][0]=theElement1;&#xA;		parameters[0][1]=theElement2;&#xA;		parameters[0][2]=theElement3;&#xA;	} else&#xA;	if(currentElement.ObjectType==otElement) { //CchZiv&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;	} 	&#xA;	return parameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the business state machine diagram&#xA;function getConnectionS(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.ObjectType==otConnector) { //SrsZiv&#xA;		theElement1=Repository.GetElementByID(currentElement.ClientID);&#xA;		theElement2=currentElement;&#xA;		theElement3=Repository.GetElementByID(currentElement.SupplierID);&#xA;		parameters[0][0]=theElement1;&#xA;		parameters[0][1]=theElement2;&#xA;		parameters[0][2]=theElement3;&#xA;	} else&#xA;	if(currentElement.ObjectType==otElement) { //SrsZiv&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;	} 	&#xA;	return parameters;&#xA;}&#xA;//Create target elements in composite consistency rule from context diagram to process decomposition diagram&#xA;function createXRcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;PDD&quot;,&quot;&quot;);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	if(conns[0][2]!=null&amp;&amp;conns[0][2].Notes==&quot;instancja decyzji&quot;)&#xA;		Session.Output(&quot;coto&quot;);&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var i = 0, j=0 ; i &lt; diagramObjects.Count ; i++ )&#xA;	{&#xA;		var coto as EA.Element;&#xA;		var cotoParent as EA.Element;&#xA;&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID&gt;0)&#xA;			coto=Repository.GetElementByID(diagramObject.ElementID);&#xA;		else&#xA;			coto=null;&#xA;		if(coto.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		//Element named '' and type 'Object' has the value of the Tag:Xe(Decision1)v()iRe(Decision1)vi&#xA;        //if(params[1][2]!=null&amp;&amp;params[1][2]!=&quot;&quot;&amp;&amp;params[1][2]!=&quot; &quot;&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&gt;-1)&#xA;			//var toto=params[1][2].substr(0,params[1][2].indexOf(&quot;:&quot;));&#xA;		if(diagramObject1==null&amp;&amp;conns[0][0]!=null&amp;&amp;conns[0][0].ElementID == diagramObject.ElementID) //verification of the element linked from the X diagram &#xA;			diagramObject1=diagramObject; //The element1 from X is linked to the object diagram&#xA;		else&#xA;		if(diagramObject1==null&amp;&amp;coto.Type==&quot;Event&quot;&amp;&amp;coto.Name==params[1][0]) //verification of an existing element in the R diagram&#xA;			diagramObject1=diagramObject; //The element1 from X is not linked to the object diagram&#xA;		else&#xA;		//what about the object	as the input element? Not event could be?&#xA;		if(diagramObject2==null&amp;&amp;coto.Type==&quot;Activity&quot;&amp;&amp;coto.Name==params[1][1]) //verification of an existing element in the R diagram&#xA;			diagramObject2=diagramObject; //The element1 from X is linked to the object diagram&#xA;		else&#xA;		if(diagramObject3==null&amp;&amp;conns[0][2]!=null&amp;&amp;conns[0][2].ElementID == diagramObject.ElementID) &#xA;			diagramObject3=diagramObject; //The element3 from X is linked to the object diagram&#xA;		else&#xA;		if(diagramObject3==null&amp;&amp;coto.Type==&quot;Object&quot;&amp;&amp;&#xA;			(coto.Name==params[1][2]|| //There is only the name of the instance&#xA;			 params[1][2].indexOf(&quot;:&quot;)&gt;-1&amp;&amp;coto.Name!=&quot;&quot;&amp;&amp;coto.Name!=&quot; &quot;&amp;&amp;coto.Name==params[1][2].substr(0,params[1][2].indexOf(&quot;:&quot;))||&#xA;			 (coto.Name==&quot;&quot;||coto.Name==&quot; &quot;)&amp;&amp;coto.ClassifierID&gt;0&amp;&amp;cotoParent.Name==params[1][2].substr(1))) //verification of an existing element in the R diagram&#xA;			diagramObject3=diagramObject; //The element1 from X is linked to the object diagram&#xA;		else {&#xA;			if(coto!=null)&#xA;				otherDiagObjects.push(diagramObject);&#xA;		}&#xA;	}&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Name==params[1][0] || //XeviRe(name1)vi, XiviRi(name1)vi&#xA;			currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;params[1][0]!=null&amp;&amp;params[1][0]!=&quot;&quot;&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;currentElement.Name==params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;))&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==params[1][0].substr(params[1][0].indexOf(&quot;:&quot;)+1) || //XiviRi(name1:class1)vi&#xA;			currentElement.Name==&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==params[1][0].substr(1) ) //XiviRi(:class1)vi&#xA;			//There is already an element named name1&#xA;			delement1=currentElement;&#xA;		else 		&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Name==params[1][1] ) //XeviRev(name1)i, XiviRiv(name1)i&#xA;			delement2=currentElement;&#xA;		else 		&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Name==params[1][2] || //XeviRevi(name1), XiviRivi(name1)&#xA;			//moze warto rozwazyc równiez klas&#281; tego elementu&#xA;		    currentElement.Name!=&quot;&quot;&amp;&amp;params[1][2]!=null&amp;&amp;params[1][2]!=&quot;&quot;&amp;&amp;params[1][2]!=&quot; &quot;&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&gt;0&amp;&amp;currentElement.Name==params[1][2].substr(0,params[1][2].indexOf(&quot;:&quot;))&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==params[1][2].substr(params[1][2].indexOf(&quot;:&quot;)+1) || //XeviRevi(name1:class1), XiviRivi(name1:class1)&#xA;			currentElement.Name==&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==params[1][2].substr(1)) //XeviRevi(:class1), XiviRivi(:class1)&#xA;			delement3=currentElement;	&#xA;		else&#xA;			if(currentElement!=null)&#xA;				otherElements.push(currentElement);&#xA;		if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;delement3!=null)&#xA;			break;&#xA;	}&#xA;	if(delement1==null) { //There is no element1 in the package, but this element could have been placed in the R diagram via a link from the package containing the X diagram&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null||conns[0][0].Name!=params[1][0].Name) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;e&quot;) { &#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0]!=conns[0][0].Name) {&#xA;					testElement = subPackage.Elements.AddNew( params[1][0], &quot;Event&quot; ); //&quot;Event&quot; to jest &quot;Signal&quot;&#xA;					testElement.Subtype=1; //Receive&#xA;					if(conns[0][0]!=null) {&#xA;						//an aggregation to the event from diagram X should be created&#xA;						// Create a connector between the two elements&#xA;						var connector = testElement.Connectors.AddNew(&quot;&quot;, &quot;Aggregation&quot;);&#xA;						connector.SupplierID = conns[0][0].ElementID;&#xA;						connector.Update();&#xA;						//testElement.Connectors.Refresh;&#xA;					}&#xA;					testElement.Update();&#xA;					diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				} else&#xA;				if(params[1][0]!=null&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]!=&quot; &quot;&amp;&amp;params[1][0]==conns[0][0].Name)) {&#xA;					//XeviRe()vi||Xe(name1)viRe(name1)vi&#xA;					testElement=conns[0][0];&#xA;				} else&#xA;					Session.Output(&quot;Line 1665, params, conns:&quot;+params+&quot;\n&quot;+conns[0][0].Name+&quot;'&quot;+conns[0][1].Name+&quot;,&quot;+conns[0][2].Name);&#xA;			} else&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;) { &#xA;				var nameOfObject;&#xA;				var nameOfClass;&#xA;				var identOfClass=null;&#xA;				//in the one case object element does not have parent class&#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;params[1][0].length) {&#xA;					//XeviRevi(name1:class1)&#xA;					nameOfObject=params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;));&#xA;				    nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				} else if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;0) {&#xA;					nameOfObject=params[1][0]; //XeviRevi(name1)&#xA;				    if(nameOfObject==params[0][0])  {//should be the class of element name1 on the X diagram&#xA;						if(conns[0][0]!=null&amp;&amp;conns[0][0].Name!=&quot; &quot;&amp;&amp;conns[0][0].ClassfierID!=null&amp;&amp;conns[0][0].ClassfierID&gt;0) &#xA;							identOfClass=conns[0][0].ClassfierID;&#xA;						else					&#xA;							nameOfClass=&quot; &quot;; //object without of the class&#xA;					} else&#xA;						if(conns[0][0]!=null&amp;&amp;conns[0][0].Type==&quot;Object&quot;&amp;&amp;conns[0][0].ClassfierID!=null&amp;&amp;conns[0][0].ClassfierID&gt;0) &#xA;							identOfClass=conns[0][0].ClassfierID;&#xA;						else	&#xA;						if(conns[0][0]!=null&amp;&amp;(conns[0][0].Type==&quot;Class&quot;||conns[0][0].Type==&quot;Event&quot;)) &#xA;							identOfClass=conns[0][0].ElementID;&#xA;						else&#xA;							nameOfClass=&quot; &quot;; //object without of the class&#xA;				} else if(params[1][0]!=null&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfObject=&quot;&quot;;&#xA;					nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				} else {&#xA;					nameOfObject=&quot;&quot;;&#xA;					if(conns[0][0]!=null&amp;&amp;conns[0][0].Name!=&quot; &quot;&amp;&amp;conns[0][0].ClassifierID!=null&amp;&amp;conns[0][0].ClassifierID&gt;0) &#xA;						identOfClass=conns[0][0].ClassifierID;		&#xA;					else&#xA;						if(correctCR.substr(correctCR.indexOf(&quot;X&quot;)+1,1)==&quot;e&quot;&amp;&amp;conns[0][0]!=null)&#xA;							nameOfClass=&quot;:&quot;+conns[0][0].Name;&#xA;						else&#xA;							nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				}&#xA;				if(params[3][0]!=&quot;&quot;&amp;&amp;params[3][0]!=&quot; &quot;)  //the state of the object must be set&#xA;					nameOfObject=nameOfObject+&quot;[&quot;+params[3][0]+&quot;]&quot;;	&#xA;				testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; );&#xA;				if(identOfClass!=null)&#xA;					testElement.ClassifierID=identOfClass;&#xA;				else&#xA;				if(nameOfClass.substr(0,1)==&quot;:&quot;) {&#xA;					//new class - can we look at the class with the same name earlier?&#xA;					nameOfClass=nameOfClass.substr(1);&#xA;					coto=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(coto==null) {&#xA;						testClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					} else {&#xA;						testClass = coto;&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					}&#xA;				} else if(nameOfClass==&quot; &quot;) {&#xA;					//without the class&#xA;					nameOfClass=&quot; &quot;;&#xA;				} else {&#xA;					if(conns[0][0]!=null&amp;&amp;conns[0][0].Name!=&quot; &quot;)&#xA;						testElement.ClassifierID=conns[0][0].ClassifierID;&#xA;				}&#xA;				testElement.Update();&#xA;				//update the state of object&#xA;				if(params[3][0]!=&quot;&quot;&amp;&amp;params[3][0]!=&quot; &quot;)  {//the state of the object must be set&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+params[3][0]+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);&#xA;				} else {&#xA;					if(conns[0][0]!=null) {&#xA;						var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][0].ElementID;&#xA;						var sqlRespond=Repository.SQLQuery(sqlCommand);&#xA;						var stateObject=null;&#xA;						var stateObject;&#xA;						if(sqlRespond!=null)&#xA;							stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;						if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;							var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;							Repository.Execute(sqlCommand);&#xA;						}							&#xA;					}							&#xA;				}	&#xA;				diagramObject1=null; //diagramObject1 is the object from the X diagram&#xA;			}&#xA;			delement1=testElement;&#xA;		} else &#xA;			delement1=conns[0][0];&#xA;	}&#xA;	if(delement2==null) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+2,1)==&quot;v&quot;) { &#xA;				var nameOfSub = &quot;&quot;;&#xA;				if(params[1][1]==null||params[1][1]==&quot; &quot;)&#xA;					if(params[0][0]==null||params[0][0]==&quot; &quot;)&#xA;						if(params[1][0]==null||params[1][0]==&quot; &quot;)&#xA;							if(conns[0][0]==null||conns[0][0].Name==&quot;&quot;||conns[0][0].Name==&quot; &quot;)&#xA;								if(conns[0][1]==null||conns[0][1].Name==&quot;&quot;||conns[0][1].Name==&quot; &quot;)&#xA;									if(conns[0][1]==null||conns[0][1].Name==&quot;&quot;||conns[0][1].Name==&quot; &quot;)&#xA;										nameOfSub = &quot; Some subprocess&quot;;&#xA;									else&#xA;										nameOfSub = conns[0][1].Name + &quot; subprocess&quot;;&#xA;								else&#xA;									nameOfSub = conns[0][0].Name + &quot; subprocess&quot;;&#xA;							else&#xA;								nameOfSub = conns[0][0].Name + &quot; subprocess&quot;;&#xA;						else&#xA;							nameOfSub = params[1][0] + &quot; subprocess&quot;;&#xA;					else&#xA;						nameOfSub = params[0][0]+ &quot; subprocess&quot;;&#xA;				else&#xA;					nameOfSub = params[1][1]; //here you can verify otherElements with nameOfSub&#xA;				var foundElement as EA.Element;&#xA;				foundElement=null;&#xA;				for(i=0; i&lt;otherElements.length;i++) {&#xA;					if((otherElements[i].Type==&quot;Activity&quot;||otherElements[i].Type==&quot;Action&quot;)&amp;&amp;otherElements[i].Name==nameOfSub) {&#xA;						foundElement=otherElements[i];&#xA;						break;&#xA;					}&#xA;				}&#xA;				if(foundElement!=null) {&#xA;					testElement=foundElement;&#xA;					var foundDiagramObject as EA.DiagramObject;&#xA;					foundDiagramObject=null;&#xA;					for(i=0;i&lt;otherDiagObjects.length;i++) {&#xA;						if(otherDiagObjects[i].ElementID==foundElement.ElementID) {&#xA;							foundDiagramObject=otherDiagObjects[i];&#xA;							break;&#xA;						}&#xA;					}&#xA;					if(foundDiagramObject!=null)&#xA;						diagramObject2=foundDiagramObject;						&#xA;				} else {&#xA;					testElement = subPackage.Elements.AddNew( nameOfSub, &quot;Activity&quot; );&#xA;					testElement.Stereotype=&quot;process&quot;;&#xA;					testElement.StereotypeEx=&quot;process&quot;;&#xA;					testElement.Update();&#xA;				}&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} else &#xA;			delement2=conns[0][1];&#xA;	}&#xA;	if(delement3==null) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null||&#xA;			diagramObject3!=null&amp;&amp;conns[0][2].ElementID==diagramObject3.ElementID|| //the target element comes from the X diagram&#xA;			params[1][2]!=null&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&gt;-1&amp;&amp;conns[0][2].ClassifierID&gt;0&amp;&amp;params[1][2].substr(params[1][2].indexOf(&quot;:&quot;)+1)!= (Repository.GetElementByID(conns[0][2].ClassfierID)).Name//inherited class is not the same as identified class&#xA;			) { &#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+3,1)==&quot;i&quot;) { &#xA;				var nameOfObject;&#xA;				var nameOfClass;&#xA;				var identOfClass = null;&#xA;				//in the one case object element does not have parent class&#xA;				if(params[1][2]!=null&amp;&amp;params[1][2]!=&quot; &quot;&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&gt;0&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&lt;params[1][2].length) {&#xA;					//XeviRevi(name1:class1)&#xA;					nameOfObject=params[1][2].substr(0,params[1][2].indexOf(&quot;:&quot;));&#xA;				    nameOfClass=params[1][2].substr(params[1][2].indexOf(&quot;:&quot;));&#xA;				} else if(params[1][2]!=null&amp;&amp;params[1][2]!=&quot; &quot;&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&lt;0) {&#xA;					nameOfObject=params[1][2]; //XeviRevi(name1)&#xA;				    if(nameOfObject==params[0][2]) { //the class of name in the params[0][2] on the X diagram&#xA;						if(conns[0][2]!=null&amp;&amp;conns[0][2].Type==&quot;Object&quot;&amp;&amp;conns[0][2].ClassfierID!=null&amp;&amp;conns[0][2].ClassfierID&gt;0)&#xA;							identOfClass=conns[0][2].ClassfierID;		&#xA;						else					&#xA;						if(conns[0][2]!=null)&#xA;							nameOfClass=&quot;:&quot;+conns[0][2].Name;&#xA;						else&#xA;							nameOfClass=&quot; &quot;; //object without of the class&#xA;					} else&#xA;						if(conns[0][2]!=null&amp;&amp;conns[0][2].Type==&quot;Object&quot;&amp;&amp;conns[0][2].ClassfierID!=null&amp;&amp;conns[0][2].ClassfierID&gt;0)&#xA;							identOfClass=conns[0][2].ClassfierID;		&#xA;						else					&#xA;						if(conns[0][2]!=null)&#xA;							nameOfClass=&quot;:&quot;+conns[0][2].Name;&#xA;						else&#xA;							nameOfClass=&quot; &quot;; //object without of the class&#xA;				} else if(params[1][2]!=null&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfObject=&quot;&quot;; //XeviRevi(:class1)&#xA;					nameOfClass=params[1][2].substr(params[1][2].indexOf(&quot;:&quot;));&#xA;				} else {&#xA;					nameOfObject=&quot;&quot;; //XeviRevi()&#xA;					if(conns[0][2]!=null&amp;&amp;conns[0][2].Name!=&quot; &quot;&amp;&amp;conns[0][2].ClassifierID!=null&amp;&amp;conns[0][2].ClassifierID&gt;0) &#xA;						identOfClass=conns[0][2].ClassifierID;						&#xA;				}&#xA;				if(params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;)  //the state of the object must be set&#xA;					nameOfObject=nameOfObject+&quot;[&quot;+params[3][2]+&quot;]&quot;;	&#xA;				testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; );&#xA;				if(identOfClass!=null)&#xA;					testElement.ClassifierID=identOfClass;&#xA;				else&#xA;				if(nameOfClass.substr(0,1)==&quot;:&quot;) {&#xA;					//new class - can we look at the class with the same name earlier?&#xA;					nameOfClass=nameOfClass.substr(1);&#xA;					coto=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(coto==null) {&#xA;						testClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					} else {&#xA;						testClass = coto;&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					}&#xA;				} else if(nameOfClass==&quot; &quot;) {&#xA;					//without the class&#xA;					nameOfClass=&quot; &quot;;&#xA;				} else {&#xA;					if(conns[0][2]!=null&amp;&amp;conns[0][2].Name!=&quot; &quot;)&#xA;						testElement.ClassifierID=conns[0][2].ClassifierID;&#xA;				}&#xA;				testElement.Update();&#xA;				if(params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;)  {//the state of the object must be set&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+params[3][2]+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);&#xA;				} else {&#xA;					if(conns[0][2]!=null) {&#xA;						var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][2].ElementID;&#xA;						var sqlRespond=Repository.SQLQuery(sqlCommand);&#xA;						var stateObject=null;&#xA;						var stateObject;&#xA;						if(sqlRespond!=null)&#xA;							stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;						if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;							var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;							Repository.Execute(sqlCommand);&#xA;						}							&#xA;					}							&#xA;				}					&#xA;				diagramObject3=null; //diagramObject3 is the object from the X diagram&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} else {&#xA;			//if(correctCR.substr(7,1)==&quot;i&quot;) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+3,1)==&quot;i&quot;) {&#xA;				if(diagramObject3!=null)&#xA;					delement3=Repository.GetElementByID(diagramObject3.ElementID);&#xA;				else &#xA;					Session.Output(&quot;Unknown case: 1890 line&quot;);&#xA;			} else&#xA;				if(conns[0][2]!=null)&#xA;					delement3=conns[0][2];			&#xA;		}&#xA;	} &#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;(conns[1][0]!=null||params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;conns[0][0]!=null&amp;&amp;params[1][0]!=conns[0][0].Name)) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	if(delement3!=null&amp;&amp;delement2!=null&amp;&amp;(conns[1][1]!=null||params[1][2]!=null&amp;&amp;params[1][2]!=&quot; &quot;&amp;&amp;conns[0][1]!=null&amp;&amp;params[1][2]!=conns[0][1].Name)) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;			connector1=delement2.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement2.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			var connector = delement2.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;			connector.SupplierID = delement3.ElementID;&#xA;			connector.Update();&#xA;			delement2.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	var newObj3=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Event&quot;) {&#xA;			var left=30;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Event&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+70;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-40;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		} else &#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Object&quot;) {&#xA;			var left=30;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+70;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-40;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;Activity&quot;) {&#xA;			var left=150;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Activity&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1.top &lt; top) &#xA;				top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-40;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element1 to the diagram&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Object&quot;) {&#xA;			var left=300;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&gt;left-50) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1.top &lt; top||diagramObject2.top &lt; top) {&#xA;				if(diagramObject1.top&lt;diagramObject2.top)&#xA;					top=diagramObject1.top;&#xA;				else&#xA;					top=diagramObject2.top;&#xA;			}&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;					diagramObject1.top=top;&#xA;					diagramObject1.bottom=top-40;&#xA;					diagramObject1.Update();&#xA;			}&#xA;			if(newObj2&amp;&amp;diagramObject2.top &gt; top) {&#xA;					diagramObject2.top=top;&#xA;					diagramObject2.bottom=top-40;&#xA;					diagramObject2.Update(); &#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+70;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-40;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in simple consistency rule from context diagram to process decomposition diagram&#xA;function createXRsimple(consistencyRule, correctCR, thePackage, parameters, currElement) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	//var otherElements = [];&#xA;	var connectorCR as EA.Connector;&#xA;	&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;PDD&quot;,&quot;&quot;);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	diagramObject=null;&#xA;	diagramObject1=null;&#xA;	if(currElement.Notes==&quot;instancja decyzji&quot;)&#xA;		Session.Output(&quot;coto&quot;);&#xA;&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var i = 0, j=0 ; i &lt; diagramObjects.Count; i++ )&#xA;	{&#xA;		var coto as EA.Element;&#xA;		var cotoParent as EA.Element;&#xA;		//Xeri, XiRi, XevRv, XivRv, XviRv, XjRj, XzRz&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID&gt;0)&#xA;			coto=Repository.GetElementByID(diagramObject.ElementID);&#xA;		else&#xA;			coto=null;&#xA;		if(coto.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;(params[1][0]==&quot;&quot;||params[1][0]==&quot; &quot;)&amp;&amp;&#xA;			currElement.Type==&quot;Event&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==&quot;&quot;&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.Name==currElement.Name) //XeRi&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XeRi(name1)&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;0&amp;&amp; //without the class1&#xA;			currElement.Type==&quot;Event&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==params[1][0]&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.Name==currElement.Name) //XeRi(name1)&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XeRi(name1:class1), XeRi(:class1)&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;params[0][0]!=&quot;&quot;&amp;&amp;params[0][0]!=&quot; &quot;&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;-1&amp;&amp; // with the class1&#xA;			currElement.Type==&quot;Event&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;))&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.Name==params[1][0].substr(params[1][0].indexOf(&quot;:&quot;)+1)) //XeRi(name1:class1), XeRi(:class1)&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XiRi&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;(params[1][0]==&quot;&quot;||params[1][0]==&quot; &quot;)&amp;&amp;&#xA;			currElement.Type==&quot;Object&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==&quot;&quot;&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.ElementID==currElement.ClassifierID)&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XiRi(name1)&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;0&amp;&amp; //without the class1&#xA;			currElement.Type==&quot;Object&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==params[1][0]&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.ElementID==currElement.ClassifierID) //XiRi(name1)&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XiRi(name1:class1), XiRi(:class1)&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;-1&amp;&amp;&#xA;			currElement.Type==&quot;Object&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;))&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.Name==params[1][0].substr(params[1][0].indexOf(&quot;:&quot;)+1))&#xA;			diagramObject1=diagramObject; &#xA;		//XevRv, XivRv, XviRv-brakuje nazwy z obiektu&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;(params[1][0]==&quot;&quot;||params[1][0]==&quot; &quot;)&amp;&amp;&#xA;			(currElement.Type==&quot;Event&quot;||currElement.Type==&quot;Activity&quot;)&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;&amp;&amp;&#xA;			coto.Type==&quot;Activity&quot;&amp;&amp;coto.Name==currElement.Name+&quot; subprocess&quot;) //XevRv&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XevRv(name1), XivRv(name1), XviRv(name1)-brakuje nazwy z obiektu&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;0&amp;&amp; //without the class1&#xA;			(currElement.Type==&quot;Event&quot;||currElement.Type==&quot;Activity&quot;)&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;&amp;&amp;&#xA;			coto.Type==&quot;Activity&quot;&amp;&amp;coto.Name==params[1][0]) //XevRv(name1)&#xA;			diagramObject1=diagramObject; &#xA;		else {&#xA;			if(coto!=null)&#xA;				otherDiagObjects.push(diagramObject);&#xA;		}&#xA;		if (diagramObject1!=null)&#xA;			break;&#xA;	}&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	delement1 = null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Name==params[1][0] || //XiRi(name1), XiRi(name1), XevRv(name)&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;params[1][0]!=null&amp;&amp;params[1][0]!=&quot;&quot;&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;currentElement.Name==params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;))&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==params[1][0].substr(params[1][0].indexOf(&quot;:&quot;)+1) || //XiRi(name1:class1)&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;currentElement.Name==&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;params[1][0]!=null&amp;&amp;params[1][0]!=&quot;&quot;&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==params[1][0].substr(1) || //XiRi(:class1), XiRi(:class1)&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;currentElement.Name==&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]==&quot;&quot;)&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==currElement.Name|| //XeRi, XiRi for the Class, Event&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;currentElement.Name==&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]==&quot;&quot;)&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0&amp;&amp;currentElement.ClassifierID==currElement.ClassifierID || //XeRi, XiRi for the instance&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;&amp;&amp;currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Type==&quot;Activity&quot;&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]==&quot;&quot;)&amp;&amp;currentElement.Name==currElement.Name+&quot; subprocess&quot; || //XevRv, XivRv&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;&amp;&amp;currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Type==&quot;Activity&quot;&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]==&quot;&quot;)&amp;&amp;currElement.Name==&quot;&quot;&amp;&amp;currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0&amp;&amp;currentElement.Name==(Repository.GetElementByID(currElement.ClassifierID)).Name+&quot; subprocess&quot; ) //XviRv&#xA;			delement1=currentElement;&#xA;		//else&#xA;		//	if(currentElement!=null)&#xA;		//		otherElements.push(currentElement);&#xA;		if(delement1!=null)&#xA;			break;&#xA;	}&#xA;	if(delement1==null) { //There is no element1 in the package, but this element could have been placed in the R diagram via a link from the package containing the X diagram&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;e&quot;) { &#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;) {&#xA;					//Xe(name1)Re(name2)&#xA;					testElement = subPackage.Elements.AddNew( params[1][0], &quot;Event&quot; ); //&quot;Event&quot; to jest &quot;Signal&quot;&#xA;					testElement.Subtype=1; //Receive&#xA;					if(currElement!=null) {&#xA;						//an aggregation to the event from diagram X should be created&#xA;						// Create a connector between the two elements&#xA;						var connector = testElement.Connectors.AddNew(&quot;&quot;, &quot;Aggregation&quot;);&#xA;						connector.SupplierID = currElement.ElementID;&#xA;						connector.Update();&#xA;						//testElement.Connectors.Refresh;&#xA;					}&#xA;					connectorCR = testElement.Connectors.AddNew(consistencyRule, &quot;Dependency&quot;);&#xA;					connectorCR.SupplierID = testElement.ElementID;&#xA;					connectorCR.ClientID = currElement.ElementID;&#xA;					connectorCR.Update();&#xA;					testElement.Update();&#xA;					diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				} else&#xA;					Session.Output(&quot;Line 2265, params, conns:&quot;+params+&quot;\n&quot;+currElement.Name);&#xA;			} else&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;) { &#xA;				var nameOfObject;&#xA;				var nameOfClass;&#xA;				var identOfClass=null;&#xA;				//in the one case object element does not have parent class&#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;params[1][0].length) { //XiRi(name1:class1)&#xA;					//what about the case &quot;Xevi(:Request)Revi(:Request)&quot; ?&#xA;					nameOfObject=params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;));&#xA;				    nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				} else if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;0) { //XiRi(:class1)&#xA;					nameOfObject=params[1][0];&#xA;				    if(nameOfObject==params[0][0]) { //should be the class of element with name in params[0][0] on the X diagram&#xA;						if(currElement.ClassfierID!=null&amp;&amp;currElement.ClassfierID&gt;0)&#xA;							identOfClass=currElement.ClassfierID;		&#xA;						else					&#xA;							nameOfClass=&quot; &quot;; //object without of the class&#xA;					} else&#xA;						if(currElement!=null&amp;&amp;currElement.Type==&quot;Object&quot;&amp;&amp;currElement.ClassfierID&gt;0) &#xA;							identOfClass=currElement.ClassfierID;&#xA;						else	&#xA;						if(currElement!=null&amp;&amp;(currElement.Type==&quot;Class&quot;||currElement.Type==&quot;Event&quot;)) &#xA;							identOfClass=currElement.ElementID;&#xA;						else&#xA;							nameOfClass=&quot; &quot;; //object without of the class&#xA;				} else if(params[1][0]!=null&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;-1) { ////XiRi(name1:class1)&#xA;					nameOfObject=&quot;&quot;;&#xA;					nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				} else {&#xA;					nameOfObject=&quot;&quot;;&#xA;					if(currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0)&#xA;						identOfClass=currElement.ClassifierID;&#xA;					else&#xA;					if(currElement.Type==&quot;Class&quot;) &#xA;						nameOfClass=&quot;:&quot;+currElement.Name;		&#xA;					else&#xA;					if(correctCR.substr(correctCR.indexOf(&quot;X&quot;)+1,1)==&quot;e&quot;)&#xA;						nameOfClass=&quot;:&quot;+currElement.Name;&#xA;					else&#xA;						nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				}&#xA;				if(params[3][0]!=&quot;&quot;&amp;&amp;params[3][0]!=&quot; &quot;)  //the state of the object must be set&#xA;					nameOfObject=nameOfObject+&quot;[&quot;+params[3][0]+&quot;]&quot;;					&#xA;				testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; );&#xA;				if(identOfClass!=null)&#xA;					testElement.ClassifierID=identOfClass;&#xA;				else&#xA;				if(nameOfClass.substr(0,1)==&quot;:&quot;) {&#xA;					//new class - can we look at the class with the same name earlier?&#xA;					nameOfClass=nameOfClass.substr(1);&#xA;					coto=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(coto==null) {&#xA;						testClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					} else {&#xA;						testClass = coto;&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					}&#xA;				} else if(nameOfClass==&quot; &quot;) {&#xA;					//without the class&#xA;					nameOfClass=&quot; &quot;;&#xA;				} else {&#xA;					if(currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0)&#xA;						testElement.ClassifierID=currElement.ClassifierID;&#xA;				}&#xA;				connectorCR = testElement.Connectors.AddNew(consistencyRule, &quot;Dependency&quot;);&#xA;				connectorCR.SupplierID = testElement.ElementID;&#xA;				connectorCR.ClientID = currElement.ElementID;&#xA;				connectorCR.Update();&#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is the object from the X diagram&#xA;			} else&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;) { //XevRv, XivRv, XviRv&#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot; || params[1][0]!=null&amp;&amp;params[1][0]==&quot; &quot;) {&#xA;					//XevRv(name2) || XevRv&#xA;					var nameOfProcess;&#xA;					if(params[1][0]!=null&amp;&amp;params[1][0]==&quot; &quot;) &#xA;						if(currElement.Name!=&quot;&quot;)&#xA;							nameOfProcess = currElement.Name +&quot; subprocess&quot;; //sprawdzi&#263; jeszcze czy currElement nie jest instancj&#261;&#xA;						else&#xA;							if(currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0)&#xA;								nameOfProcess = (Repository.GetElementByID(currElement.ClassifierID)).Name +&quot; subprocess&quot;; &#xA;							else&#xA;								nameOfProcess = &quot;Unknown subprocess&quot;;&#xA;					else&#xA;						nameOfProcess = params[1][0];						&#xA;					testElement = subPackage.Elements.AddNew( nameOfProcess, &quot;Activity&quot; );&#xA;					testElement.Stereotype=&quot;process&quot;;&#xA;					testElement.StereotypeEx=&quot;process&quot;;&#xA;					connectorCR = testElement.Connectors.AddNew(consistencyRule, &quot;Dependency&quot;);&#xA;					connectorCR.SupplierID = testElement.ElementID;&#xA;					connectorCR.ClientID = currElement.ElementID;&#xA;					connectorCR.Update();&#xA;					testElement.Update();&#xA;					diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				} else&#xA;					Session.Output(&quot;Line 2362, params, conns:&quot;+params+&quot;\n&quot;+currElement.Name);&#xA;			}			&#xA;			delement1=testElement;&#xA;		} else &#xA;			delement1=currElement;&#xA;	} else {&#xA;		var connectorsCR = delement1.Connectors;&#xA;		for(i=0;i&lt;connectorsCR.Count;i++) {&#xA;			var connCR = connectorsCR.GetAt(i);&#xA;			if(connCR.Type==&quot;Dependency&quot;&amp;&amp;connCR.Name==consistencyRule&amp;&amp;connCR.SupplierID==delement1.ElementID&amp;&amp;connCR.ClientID == currElement.ElementID)&#xA;				connectorCR=connCR;&#xA;			if(connectorCR!=null)&#xA;				break;&#xA;		}&#xA;		if(connectorCR==null) {&#xA;			connectorCR = delement1.Connectors.AddNew(consistencyRule, &quot;Dependency&quot;);&#xA;			connectorCR.SupplierID = delement1.ElementID;&#xA;			connectorCR.ClientID = currElement.ElementID;&#xA;			connectorCR.Update();&#xA;			delement1.Update();&#xA;			// Get diagram links&#xA;			currentDiagramLinks = testDiagram.DiagramLinks;	&#xA;			for(var i = 0; i&lt;testDiagram.DiagramLinks.Count; i++) {&#xA;				var currentLink as EA.DiagramLink;&#xA;				currentLink = currentDiagramLinks.GetAt( i );&#xA;				if (currentLink.ConnectorID ==  connectorCR.ConnectorID)&#xA;				{&#xA;					currentLink.IsHidden = true;&#xA;					currentLink.Update();&#xA;					break;&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	//Add elements to the diagram&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null&amp;&amp;&#xA;			(delement1.Type==&quot;Event&quot;||&#xA;		     delement1.Type==&quot;Object&quot; &amp;&amp; correctCR.substr(correctCR.indexOf(&quot;X&quot;)+1,1)==&quot;e&quot;)) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Event&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			// Get diagram links&#xA;			currentDiagramLinks = testDiagram.DiagramLinks;	&#xA;			for(var i = 0; i&lt;testDiagram.DiagramLinks.Count; i++) {&#xA;				var currentLink as EA.DiagramLink;&#xA;				currentLink = currentDiagramLinks.GetAt( i );&#xA;				if (currentLink.ConnectorID ==  connectorCR.ConnectorID)&#xA;				{&#xA;					currentLink.IsHidden = true;&#xA;					currentLink.Update();&#xA;					break;&#xA;				}&#xA;			}&#xA;		} else &#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Object&quot;) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			// Get diagram links&#xA;			currentDiagramLinks = testDiagram.DiagramLinks;	&#xA;			for(var i = 0; i&lt;testDiagram.DiagramLinks.Count; i++) {&#xA;				var currentLink as EA.DiagramLink;&#xA;				currentLink = currentDiagramLinks.GetAt( i );&#xA;				if (currentLink.ConnectorID ==  connectorCR.ConnectorID)&#xA;				{&#xA;					currentLink.IsHidden = true;&#xA;					currentLink.Update();&#xA;					break;&#xA;				}&#xA;			}&#xA;		} else&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Activity&quot;) {&#xA;			var left=400;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Activity&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			// Get diagram links&#xA;			currentDiagramLinks = testDiagram.DiagramLinks;	&#xA;			for(var i = 0; i&lt;testDiagram.DiagramLinks.Count; i++) {&#xA;				var currentLink as EA.DiagramLink;&#xA;				currentLink = currentDiagramLinks.GetAt( i );&#xA;				if (currentLink.ConnectorID ==  connectorCR.ConnectorID)&#xA;				{&#xA;					currentLink.IsHidden = true;&#xA;					currentLink.Update();&#xA;					break;&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from context diagram to business use case diagram&#xA;function createXBcomplex(correctCR, thePackage, parameters, connectors) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	&#xA;	conns = connectors;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;BUCD&quot;,&quot;&quot;);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	if(conns[0][2]!=null&amp;&amp;conns[0][2].Notes==&quot;instancja decyzji&quot;)&#xA;		Session.Output(&quot;coto&quot;);&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var i = 0, j=0 ; i &lt; diagramObjects.Count ; i++ )&#xA;	{&#xA;		var coto as EA.Element;&#xA;		var cotoParent as EA.Element;&#xA;&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID&gt;0)&#xA;			coto=Repository.GetElementByID(diagramObject.ElementID);&#xA;		else&#xA;			coto=null;&#xA;		if(coto.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(diagramObject1==null&amp;&amp;coto.Type==&quot;Actor&quot;&amp;&amp;coto.Name==params[1][0]) //verification of an existing element in the B diagram&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		if(diagramObject2==null&amp;&amp;coto.Type==&quot;UseCase&quot;&amp;&amp;coto.Name==params[1][1]) //verification of an existing element in the R diagram&#xA;			diagramObject2=diagramObject; &#xA;		else&#xA;			if(coto!=null)&#xA;				otherDiagObjects.push(diagramObject);&#xA;	}&#xA;	&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Name==params[1][0]&amp;&amp;currentElement.Type==&quot;Actor&quot; ) //XevBa()u&#xA;			delement1=currentElement;&#xA;		else 		&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Name==params[1][1]&amp;&amp;currentElement.Type==&quot;UseCase&quot;) //XevBau()&#xA;			delement2=currentElement;&#xA;		else&#xA;			if(currentElement!=null)&#xA;				otherElements.push(currentElement);&#xA;		if(delement1!=null&amp;&amp;delement2!=null)&#xA;			break;&#xA;	}&#xA;	if(delement1==null) { //There is no element1 in the package, but this element could have been placed in the R diagram via a link from the package containing the X diagram&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1,1)==&quot;a&quot;) { &#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;) {&#xA;					//XevBa(name2)u&#xA;					testElement = subPackage.Elements.AddNew( params[1][0], &quot;Actor&quot; ); &#xA;					testElement.Update();&#xA;					diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				} else {&#xA;					//XevBa()u&#xA;					if(conns[0][0]!=null&amp;&amp;conns[0][0].Name!=&quot;&quot;)&#xA;						testElement = subPackage.Elements.AddNew( conns[0][0].Name, &quot;Actor&quot; ); &#xA;					else if(conns[0][0]!=null&amp;&amp;conns[0][0].ClassifierID&gt;0)&#xA;						testElement = subPackage.Elements.AddNew((Repository.GetElementByID(conns[0][0].ClassifierID)).Name, &quot;Actor&quot; ); &#xA;					else					&#xA;						testElement = subPackage.Elements.AddNew( &quot;Actor&quot;, &quot;Actor&quot; ); 						&#xA;					testElement.Update();&#xA;					diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				} &#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement2==null) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+2,1)==&quot;u&quot;) { &#xA;				var nameOfUC = &quot;&quot;;&#xA;				if(params[1][1]==null||params[1][1]==&quot; &quot;)&#xA;					if(params[0][0]==null||params[0][0]==&quot; &quot;)&#xA;						nameOfUC = params[1][0] +&quot; service&quot;;&#xA;					else&#xA;						nameOfUC = params[0][0] + &quot; service&quot;;&#xA;				else&#xA;					nameOfUC = params[1][1] +&quot; service&quot;; //here you can verify otherElements with nameOfSub&#xA;				var foundElement as EA.Element;&#xA;				foundElement=null;&#xA;				for(i=0; i&lt;otherElements.length;i++) {&#xA;					if(otherElements[i].Type==&quot;UseCase&quot;&amp;&amp;otherElements[i].Name==nameOfUC) {&#xA;						foundElement=otherElements[i];&#xA;						break;&#xA;					}&#xA;				}&#xA;				if(foundElement!=null) {&#xA;					testElement=foundElement;&#xA;					var foundDiagramObject as EA.DiagramObject;&#xA;					foundDiagramObject=null;&#xA;					for(i=0;i&lt;otherDiagObjects.length;i++) {&#xA;						if(otherDiagObjects[i].ElementID==foundElement.ElementID) {&#xA;							foundDiagramObject=otherDiagObjects[i];&#xA;							break;&#xA;						}&#xA;					}&#xA;					if(foundDiagramObject!=null)&#xA;						diagramObject2=foundDiagramObject;						&#xA;				} else {&#xA;					testElement = subPackage.Elements.AddNew( nameOfUC, &quot;Use Case&quot; );&#xA;					testElement.Update();&#xA;				}&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} else &#xA;			delement2=conns[0][1];&#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;(conns[1][0]!=null||params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;conns[0][0]!=null&amp;&amp;params[1][0]!=conns[0][0].Name)) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	var newObj3=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Event&quot;) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Actor&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		} else &#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Object&quot;) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;UseCase&quot;) {&#xA;			var left=400;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;UseCase&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from process decomposition diagram to business use cases diagram&#xA;function createRBcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;BUCD&quot;,&quot;&quot;);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	//The first element&#xA;	if(params[1][0]==&quot;&quot;||params[1][0]==&quot; &quot;) { //empty element name &#xA;		//RevBa()u, ReviBa()ua, RviBa()u, RiviBa()ua&#xA;		if(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)  {//empty source element name&#xA;			//Re()vBa()u, Re()viBa()ua, Rv()iBa()u, Ri()viBa()ua&#xA;			if(conns[0][0]==null||conns[0][0].Name==&quot;&quot;) { //empty source diagram element name&#xA;				//Re()vBa()u/Event:(no name), Re()viBa()ua/Event:(no name), Rv()iBa()u/Action:(no name), Ri()viBa()ua/Object:(no name)&#xA;				if(conns[0][0]!=null&amp;&amp;conns[0][0].ClassifierID&gt;0)&#xA;					nameElement1=(Repository.GetElementByID(conns[0][0].ClassifierID)).Name; &#xA;				else&#xA;					if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;) //RviBau&#xA;						nameElement1=&quot;UC service&quot;;&#xA;					else&#xA;						nameElement1=&quot;Actor&quot;; //Revbau, ReviBaua, RiviBaua&#xA;			} else { //the source diagram element has a name&#xA;				//Re()vBa()u/Event:name, Re()viBa()ua/Event:name, Rv()iBa()u/Action:name, Ri()viBa()ua/Object:name&#xA;				nameElement1=conns[0][0].Name;&#xA;			}&#xA;		} else if(params[0][0].substr(0,1)==&quot;:&quot;) { //the source element name has only class type&#xA;			//Re(:class)vBa()u, Re(:class)viBa()ua, Rv(:class)iBa()u, Ri(:class)viBa()ua&#xA;			nameElement1=params[0][0];&#xA;		} else { //the source element can have a complex name&#xA;			if(params[0][0].indexOf(&quot;:&quot;)&gt;0)&#xA;				nameElement1=params[0][0].substr(0,params[0][0].indexOf(&quot;:&quot;));&#xA;			else&#xA;				nameElement1=params[0][0];&#xA;		}&#xA;	} else if(params[1][0].substr(0,1)==&quot;:&quot;) { //the element name has only class type&#xA;		//RevBa(:class)u, ReviBa(:class)ua, RviBa(:class)u, RiviBa(:class)ua&#xA;		nameElement1=params[1][0];&#xA;	} else { //the element can have a complex name&#xA;		//RevBa(name[state]:class)u, ReviBa(name[state]:class)ua, RviBa(name[state]:class)u, RiviBa(name[state]:class)ua&#xA;		if(params[1][0].indexOf(&quot;:&quot;)&gt;0)&#xA;			nameElement1=params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;));&#xA;		else&#xA;			nameElement1=params[1][0];&#xA;	}&#xA;	//the second parameter&#xA;	if(params[1][1]==&quot;&quot;||params[1][1]==&quot; &quot;) { //empty element name &#xA;		//RevBa()u, ReviBa()ua, RviBa()u, RiviBa()ua&#xA;		if(params[0][1]==&quot;&quot;||params[0][1]==&quot; &quot;)  {//empty source element name&#xA;			//Re()vBa()u, Re()viBa()ua, Rv()iBa()u, Ri()viBa()ua&#xA;			if(conns[0][1]==null||conns[0][1].Name==&quot;&quot;) { //empty source diagram element name&#xA;				//Re()vBa()u/Event:(no name), Re()viBa()ua/Event:(no name), Rv()iBa()u/Action:(no name), Ri()viBa()ua/Object:(no name)&#xA;				if(conns[0][1]!=null&amp;&amp;conns[0][1].ClassifierID&gt;0)&#xA;					nameElement2=(Repository.GetElementByID(conns[0][1].ClassifierID)).Name; &#xA;				else&#xA;					if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+2,1)==&quot;v&quot;) //Revbau, ReviBaua, RiviBaua&#xA;						nameElement1=&quot;UC service&quot;;&#xA;					else&#xA;						nameElement1=&quot;Actor&quot;; //RviBau&#xA;			} else { //the source diagram element has a name&#xA;				//Re()vBa()u/Event:name, Re()viBa()ua/Event:name, Rv()iBa()u/Action:name, Ri()viBa()ua/Object:name&#xA;				nameElement2=conns[0][1].Name;&#xA;			}&#xA;		} else if(params[0][1].substr(0,1)==&quot;:&quot;) { //the source element name has only class type&#xA;			//Re(:class)vBa()u, Re(:class)viBa()ua, Rv(:class)iBa()u, Ri(:class)viBa()ua&#xA;			nameElement2=params[0][1];&#xA;		} else { //the source element can have a complex name&#xA;			if(params[0][1].indexOf(&quot;:&quot;)&gt;0)&#xA;				nameElement2=params[0][1].substr(0,params[0][1].indexOf(&quot;:&quot;));&#xA;			else&#xA;				nameElement2=params[0][1];&#xA;		}&#xA;	} else if(params[1][1].substr(0,1)==&quot;:&quot;) { //the element name has only class type&#xA;		//RevBa(:class)u, ReviBa(:class)ua, RviBa(:class)u, RiviBa(:class)ua&#xA;		nameElement2=params[1][1];&#xA;	} else { //the element can have a complex name&#xA;		//RevBa(name[state]:class)u, ReviBa(name[state]:class)ua, RviBa(name[state]:class)u, RiviBa(name[state]:class)ua&#xA;		if(params[1][1].indexOf(&quot;:&quot;)&gt;0)&#xA;			nameElement2=params[1][1].substr(0,params[1][1].indexOf(&quot;:&quot;));&#xA;		else&#xA;			nameElement2=params[1][1];&#xA;	}&#xA;	//the third element&#xA;	if(params[1][2]==&quot;&quot;||params[1][2]==&quot; &quot;) { //empty element name &#xA;		//RevBa()u, ReviBa()ua, RviBa()u, RiviBa()ua&#xA;		if(params[0][2]==&quot;&quot;||params[0][2]==&quot; &quot;)  {//empty source element name&#xA;			//Re()vBa()u, Re()viBa()ua, Rv()iBa()u, Ri()viBa()ua&#xA;			if(conns[0][2]==null||conns[0][2].Name==&quot;&quot;) { //empty source diagram element name&#xA;				//Re()vBa()u/Event:(no name), Re()viBa()ua/Event:(no name), Rv()iBa()u/Action:(no name), Ri()viBa()ua/Object:(no name)&#xA;				if(conns[0][2]!=null&amp;&amp;conns[0][2].ClassifierID&gt;0)&#xA;					nameElement3=(Repository.GetElementByID(conns[0][2].ClassifierID)).Name; &#xA;				else&#xA;					if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+3,1)==&quot;v&quot;) //RvivBaua&#xA;						nameElement3=&quot;UC service&quot;;&#xA;					else&#xA;					if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+3,1)!=&quot;B&quot;) //not RviBau&#xA;						nameElement3=&quot;Actor&quot;; &#xA;			} else { //the source diagram element has a name&#xA;				//Re()vBa()u/Event:name, Re()viBa()ua/Event:name, Rv()iBa()u/Action:name, Ri()viBa()ua/Object:name&#xA;				nameElement3=conns[0][2].Name;&#xA;			}&#xA;		} else if(params[0][2].substr(0,1)==&quot;:&quot;) { //the source element name has only class type&#xA;			//Re(:class)vBa()u, Re(:class)viBa()ua, Rv(:class)iBa()u, Ri(:class)viBa()ua&#xA;			nameElement3=params[0][2];&#xA;		} else { //the source element can have a complex name&#xA;			if(params[0][2].indexOf(&quot;:&quot;)&gt;0)&#xA;				nameElement3=params[0][2].substr(0,params[0][2].indexOf(&quot;:&quot;));&#xA;			else&#xA;				nameElement3=params[0][2];&#xA;		}&#xA;	} else if(params[2][0].substr(0,1)==&quot;:&quot;) { //the element name has only class type&#xA;		//RevBa(:class)u, ReviBa(:class)ua, RviBa(:class)u, RiviBa(:class)ua&#xA;		nameElement3=params[1][2];&#xA;	} else { //the element can have a complex name&#xA;		//RevBa(name[state]:class)u, ReviBa(name[state]:class)ua, RviBa(name[state]:class)u, RiviBa(name[state]:class)ua&#xA;		if(params[1][2].indexOf(&quot;:&quot;)&gt;0)&#xA;			nameElement3=params[1][2].substr(0,params[1][2].indexOf(&quot;:&quot;));&#xA;		else&#xA;			nameElement3=params[1][2];&#xA;	}&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var i = 0, j=0 ; i &lt; diagramObjects.Count ; i++ )&#xA;	{&#xA;		var coto as EA.Element;&#xA;		var cotoParent as EA.Element;&#xA;&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID&gt;0)&#xA;			coto=Repository.GetElementByID(diagramObject.ElementID);&#xA;		else&#xA;			coto=null;&#xA;		if(coto.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(diagramObject1==null&amp;&amp;(coto.Name==nameElement1)) //verification of an existing element in the B diagram&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		if(diagramObject2==null&amp;&amp;(coto.Name==nameElement2)) //verification of an existing element in the B diagram&#xA;			diagramObject2=diagramObject; &#xA;		else&#xA;		if(diagramObject3==null&amp;&amp;(coto.Name==nameElement3)) //verification of an existing element in the B diagram&#xA;			diagramObject3=diagramObject; &#xA;		else&#xA;			if(coto!=null)&#xA;				otherDiagObjects.push(diagramObject);&#xA;	}&#xA;	&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;(currentElement.Name==nameElement1)) //RevBa()u&#xA;			delement1=currentElement;&#xA;		else 		&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;(currentElement.Name==nameElement2)) //RevBau()&#xA;			delement2=currentElement;&#xA;		else&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;(currentElement.Name==nameElement3)) //ReviBaua()&#xA;			delement3=currentElement;&#xA;		else&#xA;			if(currentElement!=null)&#xA;				otherElements.push(currentElement);&#xA;		if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;delement3!=null)&#xA;			break;&#xA;	}&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1,1)==&quot;a&quot;) { //RevBau, ReviBaua, RviBau&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Actor&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+2,1)==&quot;u&quot;) { //RevBau, ReviBaua, RviBau&#xA;				var nameOfUC = nameElement2; &#xA;				testElement = subPackage.Elements.AddNew( nameOfUC, &quot;Use Case&quot; );&#xA;				testElement.Update();&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	if(delement3==null&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;B&quot;)).length&gt;3&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { //ReviBaua&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+3,1)==&quot;a&quot;) { &#xA;				testElement = subPackage.Elements.AddNew( nameElement3, &quot;Actor&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject3=null; //diagramObject1 is not already a previously created element&#xA;			} &#xA;			delement3=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Association&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID||&#xA;				 connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement2.ElementID)) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement3!=null&amp;&amp;delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement3.Connectors.Count;i++) {&#xA;			connector1=delement3.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Association&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement3.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID||&#xA;				 connector1.SupplierID==delement3.ElementID&amp;&amp;connector1.ClientID==delement2.ElementID)) {				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement3.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	var newObj3=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Actor&quot;) {&#xA;			var left=50;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Actor&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		} else &#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;UseCase&quot;) {&#xA;			var left=50;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;UseCase&quot;) {&#xA;			var left=150;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;UseCase&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Actor&quot;) {&#xA;			var left=300;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Actor&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1!=null&amp;&amp;diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1!=null&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		} else &#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;UseCase&quot;) {&#xA;			var left=300;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;UseCase&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;UseCase&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1!=null&amp;&amp;diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1!=null&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from business use cases diagram to business process diagram &#xA;function createBAcomplex(correctCR, thePackage, parameters, connectors) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var subChildPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var desiredDiagObjects = [ null,null]; //[ null,null,null]&#xA;	var desiredPackElements = [ null,null]; //[ null,null,null]&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var activityPartitions = [];&#xA;&#xA;	&#xA;	//BauApv - it is the first and only rule&#xA;	//This means, that the conns array contains only the first two elements, and the params array contains only the first two elements&#xA;	conns = connectors;&#xA;	params = parameters;&#xA;	//BauApv-conns[0][1] means this parameter must contain an existing element - Use Case&#xA;	if(conns[0][1]==null||conns[0][1].Name==&quot;&quot;||conns[0][1].Name==&quot; &quot;)&#xA;		return;&#xA;	//retrieving the Business Use Case Realization package and the first diagram&#xA;	packages=getTargetPackage(thePackage,&quot;BURD&quot;, conns[0][1].Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	//the Business Use Case Realization package&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	//Setting the names of the desired elements&#xA;	//The first element&#xA;	var nameOfElement1=&quot;&quot;;&#xA;	var nameOfElement2=&quot;&quot;;&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+2,1)==&quot;u&quot;) {//BauApv&#xA;		nameOfElement1=&quot;Partition&quot;;&#xA;		nameOfElement2=&quot;UC service&quot;;&#xA;	} else { //BuaApv&#xA;		nameOfElement2=&quot;Partition&quot;;&#xA;		nameOfElement1=&quot;UC service&quot;;&#xA;	}&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, connectors, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, connectors, 1, nameOfElement2, 0);&#xA;	//pattern-driven rule in nameElement2 - BauApv({pattern})&#xA;	if(nameElement2.substr(0,1)==&quot;{&quot; &amp;&amp; nameElement2.substr(nameElement2.length-1,1)==&quot;}&quot;) {&#xA;		var namePattern=nameElement2.substr(1);&#xA;		namePattern=namePattern.substr(0,namePattern.length-1);		&#xA;		// Fetch XML content from URL&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;);&#xA;		////xhr.open(&quot;GET&quot;, &quot;https://drive.google.com/file/d/1OJBEgCy2wvpilXtfxcCE4_aEa9RDqwlV/view?usp=drive_link&quot;, false);&#xA;		//xhr.open(&quot;GET&quot;, &quot;https://drive.google.com/file/d/1c_UR4o6S7Wcq9QTAfM_Tk_B30vUj79Ag/view&quot;,false);&#xA;		//xhr.open(&quot;GET&quot;, &quot;https://drive.google.com/file/d/1OJBEgCy2wvpilXtfxcCE4_aEa9RDqwlV/view&quot;, false);&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		var nameOfPckg = &quot;&quot;;&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			//retrieve package name&#xA;			nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;);&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			//retrieve partition names&#xA;			activityPartitions=retrieveXMLNames(xmlContent, &quot;ActivityPartition&quot;, &quot;alias&quot;, &quot;UML:ActionState name=&quot;,0);&#xA;			activityPartitions=activityPartitions.sort();&#xA;			//var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);&#xA;			//var tempFile = fso.GetSpecialFolder(2) + &quot;\\temp.xmi&quot;;&#xA;			//var file = fso.CreateTextFile(tempFile, true);&#xA;			//file.Write(xmlContent);&#xA;			//file.Close();&#xA;			var project = Repository.GetProjectInterface();&#xA;			//Import the XMI file into the current model, download package content to subpackage&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1);&#xA;			subPackage.Packages.Refresh();&#xA;			// Clean up the temporary file&#xA;			//fso.DeleteFile(tempFile);	&#xA;			if(result==null)&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null)&#xA;				return;&#xA;			//Rename partitions according to the values &#8203;&#8203;given in the partition rule parameter&#xA;			renamePatternPartitions(nameElement1, conns[0][1], activityPartitions, subChildPackage);&#xA;			//moving elements from the changed pattern to the current package&#xA;			if(subChildPackage !=null)&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			return;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML for the pattern &lt;&quot;+namePattern+&quot; from URL: &quot; + xhr.statusText);&#xA;		}&#xA;		//var result = projectInterface.ImportPackageXMI(projectInterface.GUIDtoXML(subPackage.PackageGUID), &quot;C:\\Users\\jerzy\\Documents\\skrypty\\Patterns\\uc-ecs517.xml&quot;, 1, 1);&#xA;	}&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, null);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;	} &#xA;	&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, null);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];	&#xA;		activityPartitions = desiredPackElements[3];&#xA;	} &#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+1,1)==&quot;p&quot;) { //BauApv&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;ActivityPartition&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	var delement2new=false;&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;v&quot;) { //RevBau, ReviBaua, RviBau&#xA;				testElement = subPackage.Elements.AddNew( nameElement2, &quot;Activity&quot; ); &#xA;				testElement.ParentID=delement1.ElementID;&#xA;				testElement.Update();&#xA;				delement2new=true;&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	} else &#xA;	if(delement2!=null) {&#xA;		delement2.ParentID=delement1.ElementID;&#xA;		delement2.Update();&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;			connector=delement2.Connectors.GetAt(i);&#xA;			if(connector.Type==&quot;ObjectFlow&quot;) {&#xA;				if(connector.SupplierID!=null&amp;&amp; (Repository.GetElementByID(connector.SupplierID)).Type==&quot;Object&quot;) {&#xA;					var objectTmp = Repository.GetElementByID(connector.SupplierID);&#xA;					objectTmp.ParentID=delement1.ElementID;&#xA;					objectTmp.Update();&#xA;				} &#xA;			} else&#xA;			if(connector.Type==&quot;ControlFlow&quot;) {&#xA;				if(connector.ClientID&gt;0&amp;&amp;connector.ClientID!=delement2.ElementID) {&#xA;					var elementTmp = Repository.GetElementByID(connector.ClientID);&#xA;					if(elementTmp.Type==&quot;Event&quot;&amp;&amp;elementTmp.Subtype==1||elementTmp.Type==&quot;StateNode&quot;&amp;&amp;(elementTmp.Subtype==100||elementTmp.Subtype==3)) {&#xA;						elementTmp.ParentID=delement1.ElementID;&#xA;						elementTmp.Update();						&#xA;					}&#xA;				}&#xA;				else &#xA;				if(connector.SupplierID&gt;0&amp;&amp;connector.SupplierID!=delement2.ElementID) {&#xA;					var elementTmp = Repository.GetElementByID(connector.SupplierID);&#xA;					if(elementTmp.Type==&quot;StateNode&quot;&amp;&amp;elementTmp.Subtype==102||elementTmp.Type==&quot;StateNode&quot;&amp;&amp;elementTmp.Subtype==101||elementTmp.Type==&quot;Decision&quot;||elementTmp.Type==&quot;MergeNode&quot;||elementTmp.Type==&quot;Event&quot;&amp;&amp;elementTmp.Subtype==0) {&#xA;						elementTmp.ParentID=delement1.ElementID;&#xA;						elementTmp.Update();						&#xA;					}&#xA;				}&#xA;			}			&#xA;		}&#xA;	}&#xA;	var diagramObject1new=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;ActivityPartition&quot;) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			if(activityPartitions.length&gt;0&amp;&amp;activityPartitions[0][0]!=null)&#xA;				left=(activityPartitions[0][0]).left;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject=Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existDiagramObject.ElementID!=delement2.ElementID) {&#xA;					if(existDiagramObject.right&lt;left)&#xA;						left=existDiagramObject.right+50;&#xA;					//if(existElementObject.Type==&quot;ActivityPartition&quot;||existElementObject.ParentID==0) {&#xA;						if(existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;					//}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+350;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-100;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			diagramObject1new=true;&#xA;		} &#xA;	}&#xA;	var left=diagramObject1.left;&#xA;	var top=diagramObject1.top-(diagramObject1.top-diagramObject1.bottom)/2+23;&#xA;	if(diagramObject2==null) {&#xA;		var diagramObjects as EA.Collection;&#xA;		&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;Activity&quot;||delement2.Type==&quot;Action&quot;)) {&#xA;			if(delement2.ParentID==delement1.ElementID) {&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;		&#xA;				//if there are other elements in the partition, we should set the left edge of the action to the right of the last element of the partition&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null&amp;&amp;existElementObject.ParentID==delement1.ElementID&amp;&amp;&#xA;						(existElementObject.Type==&quot;Activity&quot;||existElementObject.Type==&quot;Action&quot;||existElementObject.Type==&quot;Object&quot;||&#xA;						 existElementObject.Type==&quot;Event&quot;||existElementObject.Type==&quot;StateNode&quot;||existElementObject.Type==&quot;Decision&quot;||existElementObject.Type==&quot;MergeNode&quot;)) {&#xA;						if(existDiagramObject.left&gt;diagramObject1.left&amp;&amp;existDiagramObject.right&lt;diagramObject1.right&amp;&amp;existDiagramObject.top&lt;diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;diagramObject1.bottom&amp;&amp;existDiagramObject.left&gt;left)&#xA;							left=existDiagramObject.right;&#xA;					}&#xA;				}				&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2new) { //new &quot;Action&quot; element&#xA;				testDiagramObject.left=left+25;&#xA;				testDiagramObject.right=left+100;&#xA;				testDiagramObject.top=top;  //-15;&#xA;				testDiagramObject.bottom=top-45;  //-60;&#xA;				testDiagramObject.Update();&#xA;			} else { //old &quot;Action&quot; element, but not in the diagram&#xA;				var left1=setLeftBorderOfPartition(diagramObjects, diagramObject1);&#xA;				if(left1&gt;left)&#xA;					left=left1;&#xA;				testDiagramObject.left=left+100;&#xA;				testDiagramObject.right=left+175;&#xA;				testDiagramObject.top=top;  //-15;&#xA;				testDiagramObject.bottom=top-45;  //-60;&#xA;				testDiagramObject.Update();&#xA;				placingElementOfAction(delement2, diagramObjects, diagramObject1, testDiagramObject,1); &#xA;			}			&#xA;			diagramObject2=testDiagramObject;&#xA;		} &#xA;	} else { &#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;Activity&quot;||delement2.Type==&quot;Action&quot;)) {&#xA;			if(delement2.ParentID==delement1.ElementID) { //if delement2 is the part of the partition&#xA;				//if delement2 is placed outside the partition&#xA;				if(diagramObject2.left&lt;diagramObject1.left||diagramObject2.right&gt;diagramObject1.right|| &#xA;					diagramObject2.top&gt;diagramObject1.top||diagramObject2.bottom&lt;diagramObject1.bottom) {&#xA;					//setting the left border inside the partition	&#xA;					var left1=setLeftBorderOfPartition(diagramObjects, diagramObject1);&#xA;					if(left1&gt;left)&#xA;						left=left1;&#xA;					diagramObject2.left=left+100;&#xA;					diagramObject2.right=left+175;&#xA;					diagramObject2.top=top;  //-15;&#xA;					diagramObject2.bottom=top-45;  //-60;&#xA;					diagramObject2.Update();&#xA;				}&#xA;				placingElementOfAction(delement2, diagramObjects, diagramObject1, diagramObject2,0); &#xA;			}&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Setting the left border inside the partition	&#xA;function setLeftBorderOfPartition(diagramObjects, diagramObject1) {&#xA;	var existDiagramObject as EA.DiagramObject;&#xA;	var existElementObject as EA.Element;	&#xA;	var left=0;&#xA;&#xA;	if(diagramObject1.right-diagramObject1.left&lt;200) { //if the partition width is less than 200 points&#xA;		diagramObject1.right=diagramObject1.left+200;&#xA;		diagramObject1.Update();&#xA;	}&#xA;	if(-diagramObject1.bottom+diagramObject1.top&lt;50) { //if the partition height is less than 50 points&#xA;		diagramObject1.bottom=diagramObject1.top-125;&#xA;		diagramObject1.Update();&#xA;	}&#xA;	//if there are other elements in the partition, we should set the left edge of the action to the right of the last element of the partition&#xA;	for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;		existDiagramObject=diagramObjects.GetAt(i);&#xA;		if(existDiagramObject.ElementID&gt;0)&#xA;			existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;		else&#xA;			existElementObject=null;&#xA;		if(existElementObject!=null&amp;&amp;existElementObject.Type!=&quot;ActivityPartition&quot;&amp;&amp;existElementObject.ParentID==diagramObject1.ElementID&amp;&amp;&#xA;			existDiagramObject.top&lt;=diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;=diagramObject1.bottom&amp;&amp;&#xA;			existDiagramObject.left&gt;=diagramObject1.left&amp;&amp;existDiagramObject.right&lt;=diagramObject1.right) {&#xA;			if(existDiagramObject.left&gt;left)&#xA;				left=existDiagramObject.right;&#xA;		}&#xA;	}	&#xA;	return left;&#xA;}&#xA;//placing elements connected to delement2 (diagramObject2) and possibly correcting the dimensions of the partition (diagramObject1)&#xA;//mode==1 for the unsaved diagramObject2&#xA;function placingElementOfAction(delement2, diagramObjects, diagramObject1, diagramObject2, mode) {&#xA;	var topObjectLeft=0;  //elements placed on the left side delement2&#xA;	var topObjectRight=0; //elements placed on the right side delement2&#xA;	var connector as EA.Connector;&#xA;	if(mode!=2) {&#xA;		topObjectLeft=diagramObject1.top;  //elements placed on the left side delement2&#xA;		topObjectRight=diagramObject1.top; //elements placed on the right side delement2&#xA;	} else {&#xA;		topObjectLeft=diagramObject2.top;  //elements placed on the left side delement2&#xA;		topObjectRight=diagramObject2.top; //elements placed on the right side delement2&#xA;	}&#xA;	connector=null;&#xA;	//placing elements to the left and right of delement2&#xA;	for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;		connector=delement2.Connectors.GetAt(i);&#xA;		if(connector.Type==&quot;ObjectFlow&quot;) { //object elements connected to delement2&#xA;			if(connector.SupplierID!=delement2.ElementID&amp;&amp; (Repository.GetElementByID(connector.SupplierID)).Type==&quot;Object&quot;) {&#xA;				var objectTmp = Repository.GetElementByID(connector.SupplierID);&#xA;				for(j=0;j&lt;diagramObjects.Count;j++) {&#xA;					var existDiagramObject=diagramObjects.GetAt(j);&#xA;					if(existDiagramObject.ElementID==objectTmp.ElementID) {&#xA;						var widthTmp=existDiagramObject.right-existDiagramObject.left;&#xA;						var heightTmp=-existDiagramObject.bottom+existDiagramObject.top;&#xA;						if(mode!=2) {&#xA;							if(topObjectRight-heightTmp&lt;diagramObject1.bottom) {&#xA;								diagramObject1.bottom=diagramObject1.bottom-heightTmp;&#xA;								diagramObject1.Update();&#xA;							}&#xA;							if(diagramObject2.right+40+widthTmp&gt;diagramObject1.right) {&#xA;								diagramObject1.right=diagramObject2.right+40+widthTmp;&#xA;								diagramObject1.Update();&#xA;							}			&#xA;						}						&#xA;						existDiagramObject.left=diagramObject2.right+40;&#xA;						existDiagramObject.right=existDiagramObject.left+widthTmp;&#xA;						existDiagramObject.top=topObjectRight-3;&#xA;						existDiagramObject.bottom=existDiagramObject.top-heightTmp;&#xA;						topObjectRight=topObjectRight-heightTmp;&#xA;						existDiagramObject.Update();&#xA;						break;&#xA;					}&#xA;				}	&#xA;			} &#xA;		} else&#xA;		if(connector.Type==&quot;ControlFlow&quot;) { //elements connected to delement2&#xA;			if(connector.ClientID!=delement2.ElementID) {&#xA;				var elementTmp = Repository.GetElementByID(connector.ClientID);&#xA;				//Event&amp;InitialNode elements&#xA;				if(elementTmp.Type==&quot;Event&quot;&amp;&amp;elementTmp.Subtype==1||elementTmp.Type==&quot;StateNode&quot;&amp;&amp;(elementTmp.Subtype==100||elementTmp.Subtype==3)) {&#xA;					for(j=0;j&lt;diagramObjects.Count;j++) {&#xA;						var existDiagramObject=diagramObjects.GetAt(j);&#xA;						if(existDiagramObject.ElementID==elementTmp.ElementID) {&#xA;							var widthTmp=existDiagramObject.right-existDiagramObject.left;&#xA;							var heightTmp=-existDiagramObject.bottom+existDiagramObject.top;&#xA;							if(mode!=2) {&#xA;								if(topObjectRight-heightTmp&lt;diagramObject1.bottom) {&#xA;									diagramObject1.bottom=diagramObject1.bottom-heightTmp;&#xA;									diagramObject1.Update();&#xA;								}&#xA;							}&#xA;							existDiagramObject.left=diagramObject2.left-70; //40;&#xA;							existDiagramObject.right=existDiagramObject.left+widthTmp;&#xA;							if(elementTmp.Type==&quot;StateNode&quot;&amp;&amp;(elementTmp.Subtype==100||elementTmp.Subtype==3)&amp;&amp;topObjectLeft-3&gt;diagramObject2.top) {&#xA;								existDiagramObject.top=diagramObject2.top-(-diagramObject2.bottom+diagramObject2.top)/2+heightTmp/2;										&#xA;							} else &#xA;								existDiagramObject.top=topObjectLeft-3;&#xA;							existDiagramObject.bottom=existDiagramObject.top-heightTmp;&#xA;							topObjectLeft=topObjectLeft-heightTmp;&#xA;							existDiagramObject.Update();&#xA;							break;&#xA;						}&#xA;					}	&#xA;				}&#xA;			}&#xA;			else &#xA;			if(connector.SupplierID&gt;0&amp;&amp;connector.SupplierID!=delement2.ElementID) {&#xA;				var elementTmp = Repository.GetElementByID(connector.SupplierID);&#xA;				//Final&amp;ActivityFinal, Decision, Merge, Signal elements&#xA;				if(elementTmp.Type==&quot;StateNode&quot;&amp;&amp;elementTmp.Subtype==101||elementTmp.Type==&quot;StateNode&quot;&amp;&amp;elementTmp.Subtype==102||elementTmp.Type==&quot;Decision&quot;||elementTmp.Type==&quot;MergeNode&quot;||elementTmp.Type==&quot;Event&quot;&amp;&amp;elementTmp.Subtype==0) {&#xA;					for(j=0;j&lt;diagramObjects.Count;j++) {&#xA;						var existDiagramObject=diagramObjects.GetAt(j);&#xA;						if(existDiagramObject.ElementID==elementTmp.ElementID) {&#xA;							var widthTmp=existDiagramObject.right-existDiagramObject.left;&#xA;							var heightTmp=-existDiagramObject.bottom+existDiagramObject.top;&#xA;							if(mode!=2) {&#xA;								if(topObjectRight-heightTmp&lt;diagramObject1.bottom) {&#xA;									diagramObject1.bottom=diagramObject1.bottom-heightTmp;&#xA;									diagramObject1.Update();&#xA;								}	&#xA;								if(diagramObject2.right+40+widthTmp&gt;diagramObject1.right) {&#xA;									diagramObject1.right=diagramObject2.right+40+widthTmp;&#xA;									diagramObject1.Update();&#xA;								}&#xA;							}							&#xA;							existDiagramObject.left=diagramObject2.right+40;&#xA;							existDiagramObject.right=existDiagramObject.left+widthTmp;&#xA;							existDiagramObject.top=topObjectRight-3;&#xA;							existDiagramObject.bottom=existDiagramObject.top-heightTmp;&#xA;							topObjectRight=topObjectRight-heightTmp;&#xA;							existDiagramObject.Update();&#xA;							break;&#xA;						}&#xA;					}	&#xA;				}&#xA;			}&#xA;		}					&#xA;	}&#xA;	if(mode!=2) {&#xA;		var left=diagramObject1.right;&#xA;&#xA;		for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;			existDiagramObject=diagramObjects.GetAt(i);&#xA;			if(existDiagramObject.top&lt;diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;diagramObject1.bottom&amp;&amp;&#xA;				existDiagramObject.left&gt;diagramObject1.left&amp;&amp;existDiagramObject.right&lt;diagramObject1.right) {&#xA;				if(existDiagramObject.left&lt;left)&#xA;					left=existDiagramObject.left;&#xA;			}&#xA;		}&#xA;		//moving elements if there is too much empty space on the left&#xA;		if(left-diagramObject1.left&gt;100) {&#xA;			left=left-diagramObject1.left-50;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.top&lt;diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;diagramObject1.bottom&amp;&amp;&#xA;					existDiagramObject.left&gt;diagramObject1.left&amp;&amp;existDiagramObject.right&lt;diagramObject1.right) {&#xA;					existDiagramObject.left=existDiagramObject.left-left;&#xA;					existDiagramObject.right=existDiagramObject.right-left;&#xA;					existDiagramObject.Update();&#xA;				}&#xA;			}&#xA;			if(mode==1) {&#xA;				diagramObject2.left=diagramObject2.left-left;&#xA;				diagramObject2.right=diagramObject2.right-left;&#xA;				diagramObject2.Update();&#xA;			}&#xA;		}&#xA;	}&#xA;}&#xA;//Rename pattern partitions according to rule parameters or according to actors connected to the use case&#xA;function renamePatternPartitions(nameElement, useCase, activityPartitions, subChildPackage) {&#xA;	var tmpAct = [];&#xA;	var delements as EA.Collection;&#xA;	var currentElement as EA.Element;&#xA;	var tmpElement = &quot;&quot;;&#xA;	var tmpPartition = activityPartitions.length;&#xA;	&#xA;	tmpAct=getActorsofUseCase(nameElement, useCase, activityPartitions.length);&#xA;	delements = subChildPackage.Elements; //imported package&#xA;	//changing the partition names of the imported package according to the names in the rule parameter&#xA;	for(i=0;i&lt;tmpPartition;i++) {&#xA;		currentElement=getByName(delements,activityPartitions[i][1]);&#xA;		if(currentElement!=null) {&#xA;			if(tmpAct.length&gt;i) {&#xA;				tmpElement = tmpAct[i];&#xA;				if(tmpElement!=null&amp;&amp;tmpElement!=&quot;&quot;&amp;&amp;tmpElement!=&quot; &quot;) {&#xA;					currentElement.Name = tmpElement;&#xA;					currentElement.Update;&#xA;				} else &#xA;					return;&#xA;			} else&#xA;				return;&#xA;		} else&#xA;			return;&#xA;	}&#xA;	return;&#xA;}&#xA;//Rename pattern partitions according to rule parameters or according to actors connected to the use case&#xA;function renamePatternObjects(nameElement, subProcess, classObjects, activityPartitions, subPackage, subChildPackage) {&#xA;	var tmpObj = [];&#xA;	var impdElements as EA.Collection;  	//the imported package elements&#xA;	var currElements as EA.Collection;		//the current package elements&#xA;	var targetElements as EA.Collection;	//the target package elements&#xA;	var currentElement as EA.Element;&#xA;	&#xA;	//The tmpObj array contains single instances resulting from the rule parameters - the first row - the input object, the last row - the output object&#xA;	tmpObj=getObjectsofSubProcess(nameElement, subProcess, classObjects);&#xA;	tmpObj=tmpObj.sort();&#xA;	currElements = subPackage.Elements; //current package&#xA;	impdElements = subChildPackage.Elements; //imported package&#xA;	var otherElements=false; //if the imported package elements are in the current package elements&#xA;	for(i=0;i&lt;impdElements.Count();i++) {&#xA;		currentElement=impdElements.GetAt(i);&#xA;		if(getByAlias(currElements,currentElement.Alias)==null) { &#xA;			otherElements=true; //at least one item from the imported package is missing in the current package&#xA;			break;&#xA;		}&#xA;	}&#xA;	//The classObject array contains all instances from the imported package&#xA;	if(otherElements) //There are not imported partitions in the current package&#xA;		targetElements=impdElements;&#xA;	else { //There are imported partitions in the current package&#xA;		targetElements=impdElements;&#xA;		renamePackageObjects(subPackage, tmpObj, classObjects, targetElements);&#xA;		targetElements=currElements;&#xA;	}&#xA;	renamePackageObjects(subPackage, tmpObj, classObjects, targetElements);&#xA;	return otherElements;&#xA;}&#xA;//Rename object package properies in partitions according to names in the tmpObj&#xA;function renamePackageObjects(subPackage, tmpObjX, classObjectsX, targetElements) {&#xA;	var currentElement as EA.Element;&#xA;	var currentObject as EA.Element;&#xA;	var tmpObjects = tmpObjX.length;&#xA;	var inElementClass;&#xA;	var inElementName;&#xA;	var inClassElement as EA.Element;&#xA;	var outElementClass;&#xA;	var outElementName;&#xA;	var outClassElement as EA.Element;&#xA;	var tmpObj=tmpObjX.slice();&#xA;	var classObjects=classObjectsX.slice();&#xA;	&#xA;	inElementName=tmpObj[0][1].substr(0,tmpObj[0][1].indexOf(&quot;:&quot;));&#xA;	inElementClass=tmpObj[0][1].substr(tmpObj[0][1].indexOf(&quot;:&quot;)+1);&#xA;	if(inElementClass!=null&amp;&amp;inElementClass!=&quot;&quot;) {&#xA;		inClassElement=searchForElement(subPackage, inElementClass, &quot;Class&quot;);&#xA;		if(inClassElement==null)&#xA;			inClassElement=subPackage.Elements.AddNew(inElementClass, &quot;Class&quot;);&#xA;	}&#xA;	outElementName=tmpObj[tmpObjects-1][1].substr(0,tmpObj[tmpObjects-1][1].indexOf(&quot;:&quot;));&#xA;	outElementClass=tmpObj[tmpObjects-1][1].substr(tmpObj[tmpObjects-1][1].indexOf(&quot;:&quot;)+1);&#xA;	if(outElementClass!=null&amp;&amp;outElementClass!=&quot;&quot;) {&#xA;		outClassElement=searchForElement(subPackage, outElementClass, &quot;Class&quot;);&#xA;		if(outClassElement==null)&#xA;			outClassElement=subPackage.Elements.AddNew(outElementClass, &quot;Class&quot;);&#xA;	}&#xA;	for(var i=0; i&lt;targetElements.Count(); i++) {&#xA;		currentElement=targetElements.GetAt(i); //the first element&#xA;		if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;			for(var j=0; j&lt;currentElement.Elements.Count(); j++) {&#xA;				currentObject=currentElement.Elements.GetAt(j);&#xA;				if(currentObject.Type==&quot;Object&quot;) { &#xA;					var execute=false;&#xA;					if(currentObject.Tag.substr(0,7)==tmpObj[0][0]) {&#xA;						if(currentObject.Tag==classObjects[0][0]) {&#xA;							if(inElementName.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;inElementName.indexOf(&quot;]&quot;)&gt;0&amp;&amp;inElementName.indexOf(&quot;]&quot;)&gt;inElementName.indexOf(&quot;[&quot;)) {&#xA;								currentObject.Name=inElementName.substr(0,inElementName.indexOf(&quot;[&quot;));&#xA;							} else&#xA;								currentObject.Name=inElementName;&#xA;							var stateObject=inElementName.substr(inElementName.indexOf(&quot;[&quot;)+1);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;								stateObject=stateObject.substr(0,stateObject.indexOf(&quot;]&quot;));&#xA;								if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;									var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+currentObject.ElementID;&#xA;									execute=true;&#xA;								}&#xA;							}&#xA;						}&#xA;						currentObject.ClassifierID=inClassElement.ElementID;&#xA;						currentObject.Update();&#xA;						if(execute) //it works&#xA;							Repository.Execute(sqlCommand);&#xA;					} else&#xA;					if(currentObject.Tag.substr(0,7)==tmpObj[tmpObjects-1][0]) {&#xA;						if(currentObject.Tag==classObjects[classObjects.length-1][0]) {&#xA;							if(outElementName.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;outElementName.indexOf(&quot;]&quot;)&gt;0&amp;&amp;outElementName.indexOf(&quot;]&quot;)&gt;outElementName.indexOf(&quot;[&quot;)) {&#xA;								currentObject.Name=outElementName.substr(0,outElementName.indexOf(&quot;[&quot;));&#xA;							} else&#xA;								currentObject.Name=outElementName;&#xA;							var stateObject=outElementName.substr(outElementName.indexOf(&quot;[&quot;)+1);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;								stateObject=stateObject.substr(0,stateObject.indexOf(&quot;]&quot;));&#xA;								if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;									var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+currentObject.ElementID;&#xA;									execute=true;&#xA;								}&#xA;							}							&#xA;						}&#xA;						currentObject.ClassifierID=outClassElement.ElementID;&#xA;						currentObject.Update();&#xA;						if(execute) //it works&#xA;							Repository.Execute(sqlCommand);&#xA;					}					&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	if(tmpObj.length&gt;2) {&#xA;		var tmpObjElement=tmpObj.shift();&#xA;		while(tmpObj.length&gt;0&amp;&amp;tmpObj[0][0]==tmpObjElement[0][0])&#xA;			tmpObj.shift();&#xA;		if(tmpObj.length&gt;0) {&#xA;			tmpObjElement=tmpObj.pop();&#xA;			var tmpObjElement1=tmpObj[tmpObj.length-1][0];&#xA;			var tmpObjElement2=tmpObjElement[0];&#xA;			while(tmpObj.length&gt;0&amp;&amp;tmpObjElement1==tmpObjElement2)&#xA;				tmpObj.pop();&#xA;		}&#xA;		while(classObjects.length&gt;0&amp;&amp;classObjects[0][0].substr(0,7)==&quot;ObjectA&quot;)&#xA;			classObjects.shift();&#xA;		while(classObjects.length&gt;0&amp;&amp;classObjects[classObjects.length-1][0].substr(0,7)==&quot;ObjectZ&quot;)&#xA;			classObjects.pop();&#xA;		if(classObjects.length&gt;0&amp;&amp;tmpObj.length&gt;0) {&#xA;			while(tmpObj.length&gt;0) {&#xA;				inElementName=tmpObj[0][1].substr(0,tmpObj[0][1].indexOf(&quot;:&quot;));&#xA;				inElementClass=tmpObj[0][1].substr(tmpObj[0][1].indexOf(&quot;:&quot;)+1);&#xA;				if(inElementClass!=null&amp;&amp;inElementClass!=&quot;&quot;) {&#xA;					inClassElement=searchForElement(subPackage, inElementClass, &quot;Class&quot;);&#xA;					if(inClassElement==null)&#xA;						inClassElement=subPackage.Elements.AddNew(inElementClass, &quot;Class&quot;);&#xA;				}				&#xA;				outElementName=classObjects[0][0].substr(0,7);&#xA;				for(var i=0; i&lt;targetElements.Count(); i++) {&#xA;					currentElement=targetElements.GetAt(i); //the first element&#xA;					if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;						for(var j=0; j&lt;currentElement.Elements.Count(); j++) {&#xA;							currentObject=currentElement.Elements.GetAt(j);&#xA;							if(currentObject.Type==&quot;Object&quot;) { &#xA;								var execute=false;&#xA;								if(currentObject.Tag.substr(0,7)==outElementName) {&#xA;									if(currentObject.Tag==classObjects[0][0]) {&#xA;										if(inElementName.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;inElementName.indexOf(&quot;]&quot;)&gt;0&amp;&amp;inElementName.indexOf(&quot;]&quot;)&gt;inElementName.indexOf(&quot;[&quot;)) {&#xA;											currentObject.Name=inElementName.substr(0,inElementName.indexOf(&quot;[&quot;));&#xA;										} else&#xA;											currentObject.Name=inElementName;&#xA;										var stateObject=inElementName.substr(inElementName.indexOf(&quot;[&quot;)+1);&#xA;										if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;											stateObject=stateObject.substr(0,stateObject.indexOf(&quot;]&quot;));&#xA;											if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;												var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+currentObject.ElementID;&#xA;												execute=true;&#xA;											}&#xA;										}&#xA;									}&#xA;									currentObject.ClassifierID=inClassElement.ElementID;&#xA;									currentObject.Update();&#xA;									if(execute) //it works&#xA;										Repository.Execute(sqlCommand);&#xA;								} 					&#xA;							}&#xA;						}&#xA;					}&#xA;				}&#xA;				tmpObjElement=tmpObj.shift();&#xA;				while(tmpObj.length&gt;0&amp;&amp;tmpObj[0][0]==tmpObjElement)&#xA;					tmpObj.shift();				&#xA;				while(classObjects.length&gt;0&amp;&amp;classObjects[0][0].substr(0,7)==outElementName)&#xA;					classObjects.shift();&#xA;				if(classObjects.length&lt;=0)&#xA;					break;&#xA;			}&#xA;		}&#xA;	}&#xA;}&#xA;//Moving pattern elements from the imported package to the current package&#xA;function movePatternPackage(subPackage, subChildPackage) {&#xA;	var subElements as EA.Collection;&#xA;	var delements as EA.Collection;&#xA;	subElements = subPackage.Elements; //current package &#xA;	delements = subChildPackage.Elements; //imported package&#xA;	var moving = true;&#xA;	&#xA;	for ( var j = 0 ; j &lt; delements.Count() &amp;&amp; moving==true; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		var subPckElement as EA.Element;&#xA;		currentElement = delements.GetAt(j);&#xA;		for ( var k = 0; k &lt; subElements.Count(); k++) {&#xA;			subPckElement=subElements.GetAt(k);&#xA;			if(subPckElement.Type==currentElement.Type &amp;&amp;&#xA;				(subPckElement.Name==currentElement.Name || subPckElement.Alias==currentElement.Alias)) {&#xA;				moving=false;&#xA;				break;&#xA;			}&#xA;		}&#xA;	}&#xA;	if(moving) {&#xA;		for ( var j = 0 ; j &lt; delements.Count(); j++ )&#xA;		{&#xA;			var currentElement as EA.Element;&#xA;			currentElement = delements.GetAt(j);&#xA;			currentElement.PackageID=subPackage.PackageID;&#xA;			currentElement.Update();&#xA;		}&#xA;		subPackage.Diagrams.Refresh();&#xA;		var testDiagram = subChildPackage.Diagrams.GetAt(0);&#xA;		if(testDiagram!=null) {&#xA;			testDiagram.PackageID = subPackage.PackageID;&#xA;			testDiagram.ParentID=0;&#xA;			testDiagram.Update;&#xA;		}&#xA;	} else {  &#xA;		//You should check if the partition names are not the same as in the import package. &#xA;		//If so, it would be useful to change the partition names in the current directory to the ones imported by aliases.&#xA;		for ( var j = 0 ; j &lt; delements.Count() ; j++ )&#xA;		{&#xA;			var currentElement as EA.Element;&#xA;			var subPckElement as EA.Element; &#xA;			var changing = false;&#xA;			currentElement = delements.GetAt(j); //imported package&#xA;			for ( var k = 0; k &lt; subElements.Count(); k++) {&#xA;				subPckElement=subElements.GetAt(k); //current package&#xA;				if(subPckElement.Alias==currentElement.Alias &amp;&amp; subPckElement.Type==currentElement.Type) {&#xA;					changing=true;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(changing&amp;&amp;subPckElement.Name!=currentElement.Name) {&#xA;				subPckElement.Name=currentElement.Name;&#xA;				subPckElement.Update();&#xA;			}&#xA;		}&#xA;	}&#xA;}&#xA;//Return all actor names from 'nameElement' or if 'nameElement' values &#8203;&#8203;are less than 'nr', return all actor names connected to 'useCase'&#xA;function getActorsofUseCase(nameElement, useCase, nr) {&#xA;	var tmpA = [];&#xA;	var tmpA1 = [];&#xA;	var elUC as EA.Element;&#xA;&#xA;	if(nameElement!=null&amp;&amp;nameElement!=&quot;&quot;&amp;&amp;nameElement!=&quot; &quot;) {&#xA;		var tmpElement = nameElement;&#xA;		while(tmpElement.indexOf(&quot;,&quot;)&gt;0) {&#xA;			tmpA.push(tmpElement.substr(0,tmpElement.indexOf(&quot;,&quot;)));&#xA;			tmpElement=tmpElement.substr(tmpElement.indexOf(&quot;,&quot;)+1);&#xA;		}&#xA;		if(tmpElement!=null&amp;&amp;tmpElement!=&quot;&quot;) {&#xA;			tmpA.push(tmpElement);&#xA;		}&#xA;	}&#xA;	//if there are fewer elements in tmpElement than in activityPartitions - you can try to identify all actors connected to the use case (in the conn[0][1] array)&#xA;	if(nameElement==null||nameElement==&quot;&quot;||nameElement==&quot; &quot;||tmpA.length&lt;nr) {&#xA;		elUC=useCase;&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;elUC.Connectors.Count;i++) {&#xA;			connector=elUC.Connectors.GetAt(i);&#xA;			if(connector.Type==&quot;Association&quot;) {&#xA;				if(connector.ClientID!=null&amp;&amp; (Repository.GetElementByID(connector.ClientID)).Type==&quot;Actor&quot;) {&#xA;					var actor = Repository.GetElementByID(connector.ClientID);&#xA;					tmpA1.push(actor.Name);&#xA;				} else &#xA;				if(connector.SupplierID!=null&amp;&amp; (Repository.GetElementByID(connector.SupplierID)).Type==&quot;Actor&quot;) {&#xA;					var actor = Repository.GetElementByID(connector.SupplierID);&#xA;					tmpA1.push(actor.Name);&#xA;				} &#xA;			}&#xA;		}&#xA;		if(tmpA1.length&lt;nr) {&#xA;			if(tmpA1.length&gt;tmpA.length)&#xA;				return tmpA1;&#xA;			return tmpA;&#xA;		}&#xA;		return tmpA1;&#xA;	}&#xA;	return tmpA;&#xA;}&#xA;//Return all object names from 'nameElement' or if 'nameElement' values &#8203;&#8203;are less than 'nr', return all object names connected to 'subProcess'&#xA;function getObjectsofSubProcess(nameElement, subProcess, classObjects) {&#xA;	var tmpA = [];&#xA;	var tmpA1 = [];&#xA;	var elsP as EA.Element;&#xA;	var nr=1;&#xA;	var objectName;&#xA;	&#xA;	objectName=&quot;ObjectA&quot;;&#xA;	if(nameElement!=null&amp;&amp;nameElement!=&quot;&quot;&amp;&amp;nameElement!=&quot; &quot;) {&#xA;		var tmpElement = nameElement;&#xA;		while(tmpElement.indexOf(&quot;,&quot;)&gt;0) {&#xA;			tmpA.push([objectName, tmpElement.substr(0,tmpElement.indexOf(&quot;,&quot;))]);&#xA;			tmpElement=tmpElement.substr(tmpElement.indexOf(&quot;,&quot;)+1);&#xA;			var strLiterka;&#xA;			if(objectName.substr(6)==&quot;A&quot;)&#xA;				strLiterka=&quot;B&quot;;&#xA;			else if(objectName.substr(6)==&quot;B&quot;)&#xA;				strLiterka=&quot;C&quot;;&#xA;			else if(objectName.substr(6)==&quot;C&quot;)&#xA;				strLiterka=&quot;D&quot;;&#xA;			else if(objectName.substr(6)==&quot;D&quot;)&#xA;				strLiterka=&quot;E&quot;;&#xA;			else &#xA;				strLiterka=&quot;F&quot;;&#xA;			objectName=objectName.substr(0,6)+strLiterka;&#xA;		}&#xA;		if(tmpElement!=null&amp;&amp;tmpElement!=&quot;&quot;) {&#xA;			tmpA.push([objectName, tmpElement]);&#xA;		}&#xA;		if(tmpA.length&gt;1)&#xA;			tmpA[tmpA.length-1][0]=&quot;ObjectZ&quot;;&#xA;	}&#xA;	//number of objects in the imported package&#xA;	var nameObject=&quot;ObjectA&quot;;&#xA;	for(i=0;i&lt;classObjects.length;i++) {&#xA;		if(classObjects[i][0].substr(0,7)!=nameObject) {&#xA;			nr=nr+1;&#xA;			nameObject=classObjects[i][0].substr(0,7);&#xA;		}&#xA;	}&#xA;	//if there are fewer elements in tmpElement than in activityPartitions - you can try to identify all actors connected to the use case (in the conn[0][1] array)&#xA;	if(nameElement==null||nameElement==&quot;&quot;||nameElement==&quot; &quot;||tmpA.length&lt;nr) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		elsP=subProcess;&#xA;		objectName=&quot;ObjectA&quot;;&#xA;		//input objects&#xA;		for(i=0;i&lt;elsP.Connectors.Count;i++) {&#xA;			connector=elsP.Connectors.GetAt(i);&#xA;			if(connector.Type==&quot;ControlFlow&quot;||connector.Type==&quot;ObjectFlow&quot;) {&#xA;				if(connector.ClientID!=null) {&#xA;					var elementX=Repository.GetElementByID(connector.ClientID);&#xA;					var classObject=&quot;Unknown&quot;;&#xA;					if(elementX.Type==&quot;Object&quot;) {&#xA;						if(elementX.ClassifierID!=null&amp;&amp; elementX.ClassifierID&gt;0)&#xA;							classObject = Repository.GetElementByID(elementX.ClassifierID);&#xA;						var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+elementX.ElementID;&#xA;						var sqlRespond=Repository.SQLQuery(sqlCommand);&#xA;						var stateObject=null;&#xA;						if(sqlRespond!=null)&#xA;							stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;						if(stateObject==null||stateObject==&quot;&quot;)&#xA;							tmpA1.push([objectName, elementX.Name+&quot;:&quot;+classObject.Name]);&#xA;						else&#xA;							tmpA1.push([objectName, elementX.Name+&quot;[&quot;+stateObject+&quot;]&quot;+&quot;:&quot;+classObject.Name]);&#xA;						if(objectName.substr(6)==&quot;A&quot;)&#xA;							strLiterka=&quot;B&quot;;&#xA;						else if(objectName.substr(6)==&quot;B&quot;)&#xA;							strLiterka=&quot;C&quot;;&#xA;						else if(objectName.substr(6)==&quot;C&quot;)&#xA;							strLiterka=&quot;D&quot;;&#xA;						else if(objectName.substr(6)==&quot;D&quot;)&#xA;							strLiterka=&quot;E&quot;;&#xA;						else &#xA;							strLiterka=&quot;F&quot;;&#xA;						objectName=objectName.substr(0,6)+strLiterka;&#xA;						&#xA;					} else&#xA;					if(elementX.Type==&quot;Event&quot;) {&#xA;						tmpA1.push([objectName, elementX.Name]);&#xA;						if(objectName.substr(6)==&quot;A&quot;)&#xA;							strLiterka=&quot;B&quot;;&#xA;						else if(objectName.substr(6)==&quot;B&quot;)&#xA;							strLiterka=&quot;C&quot;;&#xA;						else if(objectName.substr(6)==&quot;C&quot;)&#xA;							strLiterka=&quot;D&quot;;&#xA;						else if(objectName.substr(6)==&quot;D&quot;)&#xA;							strLiterka=&quot;E&quot;;&#xA;						else &#xA;							strLiterka=&quot;F&quot;;&#xA;						objectName=objectName.substr(0,6)+strLiterka;&#xA;					}&#xA;				} &#xA;			}&#xA;		}&#xA;		//output objects&#xA;		objectName=&quot;ObjectZ&quot;;&#xA;		for(i=0;i&lt;elsP.Connectors.Count;i++) {&#xA;			connector=elsP.Connectors.GetAt(i);&#xA;			if(connector.Type==&quot;ObjectFlow&quot;) {&#xA;				if(connector.ClientID!=null) {&#xA;					var elementX=Repository.GetElementByID(connector.SupplierID);&#xA;					var classObject=&quot;Unknown&quot;;&#xA;					if(elementX.Type==&quot;Object&quot;) {&#xA;						if(elementX.ClassifierID!=null&amp;&amp; elementX.ClassifierID&gt;0)&#xA;							classObject = Repository.GetElementByID(elementX.ClassifierID);&#xA;						var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+elementX.ElementID;&#xA;						var sqlRespond=Repository.SQLQuery(sqlCommand);&#xA;						var stateObject=null;&#xA;						if(sqlRespond!=null)&#xA;							stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;						if(stateObject==null||stateObject==&quot;&quot;)&#xA;							tmpA1.push([objectName, elementX.Name+&quot;:&quot;+classObject.Name]);&#xA;						else&#xA;							tmpA1.push([objectName, elementX.Name+&quot;[&quot;+stateObject+&quot;]&quot;+&quot;:&quot;+classObject.Name]);&#xA;						if(objectName.substr(6)==&quot;Z&quot;)&#xA;							strLiterka=&quot;Y&quot;;&#xA;						else if(objectName.substr(6)==&quot;Y&quot;)&#xA;							strLiterka=&quot;X&quot;;&#xA;						else if(objectName.substr(6)==&quot;X&quot;)&#xA;							strLiterka=&quot;W&quot;;&#xA;						else if(objectName.substr(6)==&quot;W&quot;)&#xA;							strLiterka=&quot;U&quot;;&#xA;						else &#xA;							strLiterka=&quot;T&quot;;&#xA;						objectName=objectName.substr(0,6)+strLiterka;&#xA;					} &#xA;				} &#xA;			}&#xA;		}&#xA;		if(tmpA1.length&lt;nr) {&#xA;			while(tmpA1.length&lt;nr) {&#xA;				tmpA1.push(tmpA1[tmpA1.length-1]);&#xA;			}&#xA;		}&#xA;		return tmpA1;&#xA;	}&#xA;	return tmpA;&#xA;}&#xA;//Return an element named 'nameElement' from the 'elements' collection&#xA;function getByName(elements,nameElement) {&#xA;	for ( var j = 0 ; j &lt; elements.Count() ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = elements.GetAt(j);&#xA;		if(currentElement.Name == nameElement) &#xA;			return currentElement;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Return an element named 'nameElement' from the 'elements' collection&#xA;function getByAlias(elements,nameElement) {&#xA;	for ( var j = 0 ; j &lt; elements.Count() ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = elements.GetAt(j);&#xA;		if(currentElement.Alias == nameElement) &#xA;			return currentElement;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Setting the parameter values &#8203;&#8203;for the rule - for mode==0 parameter nr is run (conns[0][0] is run, then conns[0][1] when the parameters are empty), otherwise for mode==1 only conns[0][0] is run, for mode==2 only conns[0][1] is run&#xA;function setParameterValue(params, conns, nr, nameElement, mode) {&#xA;	var nameElement1=&quot;&quot;;&#xA;	&#xA;	if(params[1][nr]==&quot;&quot;||params[1][nr]==&quot; &quot;) { //empty element name &#xA;		//BauAp()v&#xA;		if(params[0][nr]==&quot;&quot;||params[0][nr]==&quot; &quot;)  {//empty source element name&#xA;			//Ba()uAp()v&#xA;			if(mode==2||mode==3) { //RiviAvi&#xA;				if(mode==2&amp;&amp;(conns[0][1]!=null&amp;&amp;(conns[0][1].Type==&quot;Action&quot;||conns[0][1].Type==&quot;Activity&quot;)))&#xA;					nameElement1=conns[0][1].Name;&#xA;				else&#xA;					nameElement1=nameElement; //Revbau, ReviBaua, RiviBaua&#xA;			} else { //others&#xA;				if(conns[0][nr]==null||conns[0][nr].Name==&quot;&quot;) { //empty source diagram element name&#xA;					//Ba()uAp()v/Actor:(no name)&#xA;					if(mode==0&amp;&amp;conns[0][nr]!=null&amp;&amp;conns[0][nr].ClassifierID&gt;0) {&#xA;						nameElement1=&quot;:&quot;+(Repository.GetElementByID(conns[0][nr].ClassifierID)).Name; &#xA;						if(params[2][nr]!=null&amp;&amp;params[2][nr]!=&quot;&quot;&amp;&amp;params[2][nr]!=&quot; &quot;)&#xA;							nameElement1=&quot;[&quot;+params[2][nr]+&quot;]&quot;+nameElement1;&#xA;						else {&#xA;							var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][nr].ElementID;&#xA;							var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;							var stateObject=null;&#xA;							if(sqlRespond!=null)&#xA;								stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;								nameElement1=&quot;[&quot;+stateObject+&quot;]&quot;+nameElement1;						&#xA;						}&#xA;					}&#xA;					else &#xA;					if(mode==1&amp;&amp;conns[0][0]!=null&amp;&amp;conns[0][0].ClassifierID&gt;0) {&#xA;						nameElement1=&quot;:&quot;+(Repository.GetElementByID(conns[0][0].ClassifierID)).Name; &#xA;						if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;)&#xA;							nameElement1=&quot;[&quot;+params[2][0]+&quot;]&quot;+nameElement1;&#xA;						else {&#xA;							var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][0].ElementID;&#xA;							var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;							var stateObject=null;&#xA;							if(sqlRespond!=null)&#xA;								stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;								nameElement1=&quot;[&quot;+stateObject+&quot;]&quot;+nameElement1;									&#xA;						}&#xA;					}&#xA;					else&#xA;						nameElement1=nameElement; //Revbau, ReviBaua, RiviBaua&#xA;&#xA;				} else { //the source diagram element has a name&#xA;					//Ba()uAp()v/Actor:name&#xA;					if(mode==0)&#xA;						nameElement1=conns[0][nr].Name;&#xA;					else&#xA;					if((conns[0][0]==null||conns[0][0].Name==&quot;&quot;||conns[0][0].Name==&quot; &quot;)&amp;&amp;conns[0][0].ClassifierID&gt;0) {&#xA;						nameElement1=&quot;:&quot;+(Repository.GetElementByID(conns[0][0].ClassifierID)).Name; &#xA;						if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;)&#xA;							nameElement1=&quot;[&quot;+params[2][0]+&quot;]&quot;+nameElement1;	&#xA;						else {&#xA;							var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][0].ElementID;&#xA;							var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;							var stateObject=null;&#xA;							if(sqlRespond!=null)&#xA;								stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;								nameElement1=&quot;[&quot;+stateObject+&quot;]&quot;+nameElement1;									&#xA;						}&#xA;					}&#xA;						else&#xA;							nameElement1=nameElement; //Revbau, ReviBaua, RiviBaua&#xA;				}&#xA;			}&#xA;		} else if(params[0][nr].substr(0,1)==&quot;:&quot;) { //the source element name has only class type&#xA;			//Ba(:class)vAp()v&#xA;			//nameElement1=params[0][nr];&#xA;			nameElement1=getStateParameter(params[0][nr], params[2][nr])&#xA;		} else { //the source element can have a complex name&#xA;			nameElement1=getStateParameter(params[0][nr], params[2][nr])&#xA;			//if(params[0][nr].indexOf(&quot;:&quot;)&gt;0) //Ba(name:class)vAp()v&#xA;			//	nameElement1=params[0][nr].substr(0,params[0][nr].indexOf(&quot;:&quot;));&#xA;			//else //Ba(name[State])vAp()v&#xA;			//	nameElement1=params[0][nr];&#xA;		}&#xA;	} else if(params[1][nr].substr(0,1)==&quot;:&quot;) { //the element name has only class type&#xA;		//BavAp(:class)v&#xA;		nameElement1=getStateParameter(params[1][nr], params[3][nr]);&#xA;	} else { //the element can have a complex name&#xA;		if(params[1][nr].indexOf(&quot;:&quot;)&gt;0) //BavAp(name[state]:class)v&#xA;			nameElement1=getStateParameter(params[1][nr], params[3][nr]);&#xA;		else //BavAp(name[state])v&#xA;			nameElement1=params[1][nr];&#xA;	}&#xA;	return nameElement1;&#xA;}&#xA;//Completing instance names in the parameter with their states&#xA;function getStateParameter(nameParameter, stateParameter) {&#xA;	var stateObject;&#xA;	var nameElement1=&quot;&quot;;&#xA;	&#xA;	if(stateParameter!=null&amp;&amp;stateParameter!=&quot;&quot;&amp;&amp;stateParameter!=&quot; &quot;) {&#xA;		if(nameParameter.substr(0,1)==&quot; &quot;)&#xA;			nameParameter=nameParameter.substr(1);&#xA;		if(stateParameter.substr(0,1)==&quot; &quot;)&#xA;			stateParameter=stateParameter.substr(1);			&#xA;		while(nameParameter.indexOf(&quot;,&quot;)&gt;=0) {&#xA;			if(nameParameter.indexOf(&quot;,&quot;)&gt;nameParameter.indexOf(&quot;:&quot;))&#xA;				nameElement1=nameElement1+nameParameter.substr(0,nameParameter.indexOf(&quot;:&quot;));&#xA;			else&#xA;				nameElement1=nameElement1+nameParameter.substr(0,nameParameter.indexOf(&quot;,&quot;));&#xA;			stateObject=stateParameter.substr(0,stateParameter.indexOf(&quot;,&quot;));&#xA;			if(stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;				nameElement1=nameElement1+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;			stateParameter=stateParameter.substr(stateParameter.indexOf(&quot;,&quot;)+1);&#xA;			if(nameParameter.indexOf(&quot;,&quot;)&gt;nameParameter.indexOf(&quot;:&quot;))&#xA;				nameElement1=nameElement1+nameParameter.substr(nameParameter.indexOf(&quot;:&quot;),nameParameter.indexOf(&quot;,&quot;)-nameParameter.indexOf(&quot;:&quot;)+1);&#xA;			else&#xA;				nameElement1=nameElement1+nameParameter.substr(nameParameter.indexOf(&quot;,&quot;),1);&#xA;			nameParameter=nameParameter.substr(nameParameter.indexOf(&quot;,&quot;)+1);&#xA;		}&#xA;		if(nameParameter!=&quot;&quot;&amp;&amp;nameParameter!=&quot; &quot;&amp;&amp;stateParameter!=&quot;&quot;)&#xA;			nameElement1=nameElement1+nameParameter.substr(0,nameParameter.indexOf(&quot;:&quot;))+&quot;[&quot;+stateParameter+&quot;]&quot;+nameParameter.substr(nameParameter.indexOf(&quot;:&quot;));&#xA;		else&#xA;			nameElement1=nameElement1+nameParameter;&#xA;	} else&#xA;		nameElement1=nameParameter;&#xA;	//maybe look up the status in the EA database?&#xA;	return nameElement1;&#xA;}&#xA;&#xA;//Retrieving partition names and their aliases from 'xmlContent' based on name1 (Partition), name2 (alias) and name3 (element name)&#xA;function retrieveXMLNames(xmlContent, name1, name2, name3, mode) {&#xA;	var activityPartitions = [];&#xA;	var namePartition1=&quot;&quot;;&#xA;	var tmpAlias1;&#xA;	var namePartition = xmlContent;&#xA;	var start=namePartition.indexOf(name1); //&quot;ActivityPartition&quot;/&quot;classname&quot;-kind of element&#xA;	while(start&gt;0) {&#xA;		var start1=namePartition.indexOf(name2,start); //&quot;alias&quot;/&quot;stateflags&quot; - partition alias&#xA;		if(start1&gt;0) {&#xA;			start1=namePartition.indexOf('&quot;',start1+name2.length+1);&#xA;			var ile=namePartition.indexOf('&quot;',start1+1);&#xA;			tmpAlias1=namePartition.substr(start1+1, ile-start1-1);&#xA;		}&#xA;		if(mode==0)&#xA;			start1=namePartition.lastIndexOf(name3,start); //&quot;UML:ActionState name=&quot;-partition name&#xA;		else&#xA;			start1=namePartition.lastIndexOf(name3,start1); //&quot;keywords&quot;-partition name&#xA;		if(start1&lt;0)&#xA;			break;&#xA;		var ile=namePartition.indexOf('&quot;',start1+name3.length+1); //the first &quot; before the name of partition&#xA;		if(ile&gt;0) {&#xA;			namePartition1=namePartition.substr(start1+name3.length+1,ile-start1-name3.length-1);&#xA;			//var i = activityPartitions.length;&#xA;			if(mode==0)&#xA;				activityPartitions.push([tmpAlias1, namePartition1]);&#xA;			else&#xA;				activityPartitions.push([namePartition1, tmpAlias1]);&#xA;			//activityPartitions[i/2-1][0]=tmpAlias1;&#xA;			//activityPartitions[i/2-1][1]=namePartition1;&#xA;			namePartition1=&quot;&quot;;&#xA;		}&#xA;		namePartition = namePartition.substr(start+name3.length);&#xA;		start=namePartition.indexOf(name1);&#xA;	}&#xA;	return activityPartitions;&#xA;}&#xA;//Retrieving the value of 'elementName' from 'xmlContent'&#xA;function retrieveXMLElement(xmlContent,elementName) {&#xA;	var nameOfPckg=&quot;&quot;;&#xA;	var start=xmlContent.indexOf(elementName); //&quot;UML:Package name=&quot;&#xA;	&#xA;	if(start&gt;0) {&#xA;		nameOfPckg = xmlContent.substr(start+elementName.length,100);&#xA;		var ile=nameOfPckg.indexOf('&quot;',1); //&quot; xmi&quot;)-1;&#xA;		if(ile&gt;0)&#xA;			nameOfPckg=nameOfPckg.substr(1,ile-1);&#xA;		else &#xA;			nameOfPckg=&quot;&quot;;&#xA;	}&#xA;	return nameOfPckg;&#xA;}&#xA;//Creating a business process diagram based on the process decomposition diagram according to the 'correctCR' rule&#xA;function createRAcomplex(correctCR, thePackage, parameters, connectors, mode) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var subChildPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var desiredDiagObjects = [ null,null]; //[null,null,null]&#xA;	var desiredPackElements = [ null,null]; //[null,null,null]&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var activityPartitions = [];&#xA;	var objectClasses = [];&#xA;	&#xA;	//RiviAvi&#xA;	conns = connectors;&#xA;	params = parameters;&#xA;	//if the first element is missing&#xA;	if(conns[0][1]==null||conns[0][1].Name==&quot;&quot;||conns[0][1].Name==&quot; &quot;)&#xA;		return;&#xA;	packages=getTargetPackage(thePackage,&quot;BURD&quot;, conns[0][1].Name);&#xA;	//if the target package and diagram are missing in it&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	//the Business Use Case Realization package&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	//Setting the names of the desired elements&#xA;	//The first element&#xA;	var nameOfElement1=&quot;&quot;;&#xA;	var nameOfElement2=&quot;&quot;;&#xA;	var nameOfElement3=&quot;&quot;;&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+2,1)==&quot;v&quot;) {//RiviAvi&#xA;		nameOfElement1=&quot;Action Service&quot;;&#xA;		nameOfElement2=&quot;ObjectIn&quot;;&#xA;		nameOfElement3=&quot;ObjectOut&quot;;&#xA;	} else { //RvivAvi&#xA;		nameOfElement1=&quot;ObjectIn&quot;;&#xA;		nameOfElement2=&quot;Action service&quot;;&#xA;		nameOfElement3=&quot;ObjectOut&quot;;&#xA;	}&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, connectors, 0, nameOfElement1, 2);&#xA;	nameElement2=setParameterValue(parameters, connectors, 1, nameOfElement2, 1); &#xA;	nameElement3=setParameterValue(parameters, connectors, 2, nameOfElement3, 0);&#xA;	//pattern-driven rule in nameElement1 - RiviAv({pattern})i&#xA;	if(nameElement1.substr(0,1)==&quot;{&quot; &amp;&amp; nameElement1.substr(nameElement1.length-1,1)==&quot;}&quot;) {&#xA;		var namePattern=nameElement1.substr(1); //Retrieve name pattern from the first parameter&#xA;		namePattern=namePattern.substr(0,namePattern.length-1);		&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;); // Fetch XML content from URL&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			var nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;); //Retrieve package name&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			activityPartitions=retrieveXMLNames(xmlContent, &quot;ActivityPartition&quot;, &quot;alias&quot;, &quot;UML:ActionState name=&quot;,0); //Retrieve partition names&#xA;			activityPartitions=activityPartitions.sort();&#xA;			objectClasses=retrieveXMLNames(xmlContent, &quot;classname&quot;, &quot;stateflags&quot;, 'keywords&quot; value=', 1); //Retrieve objectclass names - option B: &quot;keywords&quot;, &quot;UML:ClassifierRole name=&quot;, 0&#xA;			objectClasses=objectClasses.sort();&#xA;			var project = Repository.GetProjectInterface();&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1); //the imported package&#xA;			if(result==null) //something wrong with the imported package&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null) //something wrong with the imported package&#xA;				return;&#xA;			var moving=renamePatternObjects(nameElement2, conns[0][1], objectClasses, activityPartitions, subPackage, subChildPackage); //Rename partitions according to the values &#8203;&#8203;given in the partition rule parameter&#xA;			if(subChildPackage !=null&amp;&amp;moving) //moving partitions from the changed pattern to the current package&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			return;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML from URL: &quot; + xhr.statusText);&#xA;		}&#xA;	}&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;	&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;		diagramObject3=desiredDiagObjects[2];	&#xA;	} &#xA;	&#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;	} &#xA;	var delement1new=false;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+1,1)==&quot;v&quot;) { //RevBau, ReviBaua, RviBau&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Action&quot; ); &#xA;				//if(delement2!=null)&#xA;				//	testElement.ParentID=delement2.ParentID;&#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				delement1new=true;&#xA;			} &#xA;			delement1=testElement;&#xA;		} //else it means that this element is outside of current package&#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;i&quot;) { //RevBau, ReviBaua, RviBau&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement2;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(nameOfObject.indexOf(&quot;[&quot;)&lt;nameOfObject.indexOf(&quot;]&quot;)) {&#xA;					nameOfState=nameOfObject.substr(nameOfObject.indexOf(&quot;[&quot;)+1,nameOfObject.indexOf(&quot;]&quot;)-nameOfObject.indexOf(&quot;[&quot;)-1);&#xA;					var nameOfObject1=nameOfObject.substr(0,nameOfObject.indexOf(&quot;[&quot;))+nameOfObject.substr(nameOfObject.indexOf(&quot;]&quot;)+1);&#xA;					nameOfObject=nameOfObject1;&#xA;				}&#xA;				if(params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;) {&#xA;					if(params[3][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][1].substr(0,params[3][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][1];&#xA;				} else&#xA;				if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][0].substr(0,params[2][0].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][0];&#xA;				} else &#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(conns[0][0]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][0].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				} else&#xA;				if(conns[0][2]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][0].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				}&#xA;				if(nameOfObject==&quot;Start&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype==100;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				testElement.Update();&#xA;				if(nameOfState!=null&amp;&amp;nameOfObject!=&quot;Start&quot;) {&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);					&#xA;				}&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	var delement3new=false;&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;i&quot;) { //RevBau, ReviBaua, RviBau&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement3;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(nameOfObject.indexOf(&quot;[&quot;)&lt;nameOfObject.indexOf(&quot;]&quot;)) {&#xA;					nameOfState=nameOfObject.substr(nameOfObject.indexOf(&quot;[&quot;)+1,nameOfObject.indexOf(&quot;]&quot;)-nameOfObject.indexOf(&quot;[&quot;)-1);&#xA;					var nameOfObject1=nameOfObject.substr(0,nameOfObject.indexOf(&quot;[&quot;))+nameOfObject.substr(nameOfObject.indexOf(&quot;]&quot;)+1);&#xA;					nameOfObject=nameOfObject1;&#xA;				} else&#xA;				if(params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;) {&#xA;					if(params[3][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][2].substr(0,params[3][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][2];&#xA;				} else&#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(params[2][1]!=null&amp;&amp;params[2][1]!=&quot;&quot;&amp;&amp;params[2][1]!=&quot; &quot;) {&#xA;					if(params[2][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][1].substr(0,params[2][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][1];&#xA;				} else &#xA;				if(conns[0][2]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][2].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				} else&#xA;				if(conns[0][0]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][2].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				}&#xA;				if(nameOfObject==&quot;End&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype=101;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null&amp;&amp;!delement1new)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				testElement.Update();&#xA;				if(nameOfState!=null) {&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);					&#xA;				}&#xA;				delement3new=true;&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the input element and the middle element&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+1,1)==&quot;v&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;i&quot;) { //RiviAvi&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i); //a nie delement2?&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement2.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement2.Name==&quot;Start&quot;)&#xA;					connector = delement2.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement2.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement1.ElementID;&#xA;				connector.Update();&#xA;				delement2.Update();	&#xA;			}	&#xA;			//a connection must be created between the element to which the input element is connected at the output and the middle element&#xA;			var tmpObject as EA.Element;&#xA;			tmpObject=null;&#xA;			for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;				var connector1=delement2.Connectors.GetAt(i);&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement2.ElementID&amp;&amp;connector1.ClientID!=delement1.ElementID) {&#xA;					tmpObject=Repository.GetElementByID(connector1.ClientID);&#xA;					if(tmpObject.Type==&quot;Action&quot; ||tmpObject.Type==&quot;Activity&quot;)					&#xA;						break; //The input object is connected as an output object to another action&#xA;					else&#xA;						tmpObject=null;&#xA;				}&#xA;			}&#xA;			if(tmpObject!=null) {&#xA;				//you need to check if this connection already exists&#xA;				for(i=0;i&lt;tmpObject.Connectors.Count;i++) {&#xA;					var connector1=tmpObject.Connectors.GetAt(i);&#xA;					if(connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==tmpObject.ElementID) {&#xA;						tmpObject=null;&#xA;						break;&#xA;					}&#xA;				}&#xA;				if(tmpObject!=null) {&#xA;					connector = tmpObject.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;					connector.SupplierID = delement1.ElementID;&#xA;					connector.Update();&#xA;					tmpObject.Update();		&#xA;				}					&#xA;			}&#xA;		}&#xA;	}&#xA;	//a connection must be created between the middle element and the output element&#xA;	if(delement1!=null&amp;&amp;delement3!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+1,1)==&quot;v&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;i&quot;) { //RiviAvi&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i);&#xA;				if(delement3.Name!=&quot;End&quot;&amp;&amp;connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID||&#xA;				   delement3.Name==&quot;End&quot;&amp;&amp;connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement3.Name==&quot;End&quot;)&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement3.ElementID;&#xA;				connector.Update();&#xA;				delement1.Update();	&#xA;				delement1.Connectors.Refresh();&#xA;				delement3.Connectors.Refresh();&#xA;			}	&#xA;		}&#xA;	}&#xA;	//Add elements to the diagram&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null) {&#xA;			var left=100;&#xA;			var top=-100;&#xA;			var ifPartition=false;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			if(delement3new==false&amp;&amp;delement1new==true&amp;&amp;delement3.ParentID&gt;0) {&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID==delement3.ParentID) {&#xA;						left=existDiagramObject.left+75; //25; //right=left+100&#xA;						top=existDiagramObject.top-(existDiagramObject.top-existDiagramObject.bottom)/2+23; //bottom=top-45&#xA;						ifPartition=true;&#xA;						break;&#xA;					}&#xA;				}					&#xA;			} 	&#xA;			if(!ifPartition) //true-delement3 was in the partition&#xA;				delement1new=true;&#xA;			if(delement1new) { //new element&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null) {&#xA;						if(existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;						//if(existDiagramObject.Type!=&quot;ActivityPartition&quot;)&#xA;						//	if(existDiagramObject.right&gt;left)&#xA;						//		left=existDiagramObject.right+50;&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			if(ifPartition&amp;&amp;diagramObject3!=null) {//delement3 was here in the Partition&#xA;				testDiagramObject.left=diagramObject3.left-100;//left;&#xA;				testDiagramObject.right=diagramObject3.left-20; //left+80;&#xA;				testDiagramObject.top=diagramObject3.top; //top;&#xA;				testDiagramObject.bottom=diagramObject3.bottom; //top-40;&#xA;				delement1.ParentID=delement3.ParentID;		&#xA;				delement1.Update();&#xA;			} else {&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+80;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-40;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;			&#xA;		}  else {&#xA;			Session.Output(&quot;Error at identifying element1-4836 line&quot;);&#xA;			return;&#xA;		}		&#xA;	} &#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null) {&#xA;			var left=diagramObject1.left;&#xA;			var top=diagramObject1.top;&#xA;			/*if(delement2.ParentID&gt;0) { //if the partition exist&#xA;				var partycjaTmp=Repository.GetElementByID(delement2.ParentID);&#xA;				for ( var i = 0, j=0 ; i &lt; diagramObjects.Count ; i++ )&#xA;				{&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==partycjaTmp.ElementID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}*/&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2.Name==&quot;Start&quot;) { //InitialNode&#xA;				testDiagramObject.left=left-70;&#xA;				testDiagramObject.right=left-40;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-34;&#xA;			} else {			&#xA;				testDiagramObject.left=left-90;&#xA;				testDiagramObject.right=left-20;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-37;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	} /*else {&#xA;		var left=diagramObject1.left;&#xA;		var top=diagramObject1.top;&#xA;&#xA;		if(delement2.Name==&quot;Start&quot;) { //InitialNode&#xA;			diagramObject2.left=left-70;&#xA;			diagramObject2.right=left-40;&#xA;			//diagramObject2.left=left+125;&#xA;			//diagramObject2.right=left+195;&#xA;			diagramObject2.top=top-3;&#xA;			diagramObject2.bottom=top-34;&#xA;			diagramObject2.Update();		&#xA;		}			&#xA;	}*/&#xA;	if(diagramObject3==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null) {&#xA;			var left=diagramObject1.left;&#xA;			var top=diagramObject1.top;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			if(delement3.ParentID&gt;0) {&#xA;				var partycjaTmp=Repository.GetElementByID(delement3.ParentID);&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;				{&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==partycjaTmp.ElementID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				testDiagramObject.left=left+145;&#xA;				testDiagramObject.right=left+175;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-33;&#xA;			} else {&#xA;				testDiagramObject.left=left+125;&#xA;				testDiagramObject.right=left+195;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-37;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	} else {&#xA;		var left=diagramObject1.left;&#xA;		var top=diagramObject1.top;&#xA;		if(delement3.ParentID&gt;0) {&#xA;			diagramObject=null;&#xA;			var partycjaTmp=Repository.GetElementByID(delement3.ParentID);&#xA;			for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;			{&#xA;				var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;				if(partycjaObjTmp.ElementID==partycjaTmp.ElementID) {&#xA;					diagramObject=partycjaObjTmp;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(diagramObject!=null) {&#xA;				if(diagramObject3.left&lt;diagramObject.left||diagramObject3.right&gt;diagramObject.right||diagramObject3.top&lt;diagramObject.top||diagramObject3.bottom&lt;diagramObject.bottom) {&#xA;					if(delement3.Name==&quot;End&quot;) {&#xA;						diagramObject3.left=left+145;&#xA;						diagramObject3.right=left+175;&#xA;						diagramObject3.top=top-3;&#xA;						diagramObject3.bottom=top-33;&#xA;					} else {&#xA;						diagramObject3.left=left+125;&#xA;						diagramObject3.right=left+195;&#xA;						diagramObject3.top=top;&#xA;						diagramObject3.bottom=top-37;&#xA;					}&#xA;					diagramObject3.Update();					&#xA;				}&#xA;			}&#xA;		} else {&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				diagramObject3.left=left+145;&#xA;				diagramObject3.right=left+175;&#xA;				diagramObject3.top=top-3;&#xA;				diagramObject3.bottom=top-33;&#xA;			} else {&#xA;				diagramObject3.left=left+125;&#xA;				diagramObject3.right=left+195;&#xA;				diagramObject3.top=top;&#xA;				diagramObject3.bottom=top-37;&#xA;			}&#xA;			diagramObject3.Update();				&#xA;		}&#xA;	}&#xA;	if(diagramObject3!=null&amp;&amp;mode==1) {&#xA;		diagramObjects.Refresh();&#xA;		if(delement1.ParentID&gt;0) {&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			existDiagramObject=null;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID==delement1.ParentID) &#xA;					break;&#xA;			}&#xA;			if(existDiagramObject!=null)&#xA;				placingElementOfAction(delement1, diagramObjects, existDiagramObject, diagramObject1, 0);&#xA;			else&#xA;				placingElementOfAction(delement1, diagramObjects, null, diagramObject1, 2);&#xA;		}&#xA;		else&#xA;			placingElementOfAction(delement1, diagramObjects, null, diagramObject1, 2);&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from business process diagram to system use cases diagram&#xA;function createAUcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	//ApUau&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;SUCD&quot;,thePackage.Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Actor&quot;;&#xA;	nameOfElement2=&quot;UseCase&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, null);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, null);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;	} &#xA;	var delement1new=false;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;U&quot;)+1,1)==&quot;a&quot;) { //ApUau&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Actor&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;U&quot;)+2,1)==&quot;u&quot;) { //ApUau&#xA;				var nameOfUC = nameElement2; &#xA;				testElement = subPackage.Elements.AddNew( nameOfUC, &quot;Use Case&quot; );&#xA;				testElement.Update();&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Association&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID||&#xA;				 connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement2.ElementID)) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	var newObj3=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Actor&quot;) {&#xA;			var left=50;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Actor&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		} else &#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;UseCase&quot;) {&#xA;			var left=50;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;UseCase&quot;) {&#xA;			var left=150;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;UseCase&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;		&#xA;			if(diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from business process diagram to business class diagram&#xA;function createACcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;CLASSD&quot;,thePackage.Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Class&quot;;&#xA;	nameOfElement2=&quot;1..*&quot;;&#xA;	nameOfElement3=&quot;Class&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	if(nameElement1.substr(0,1)==&quot;:&quot;)&#xA;		nameElement1=nameElement1.substr(1);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	if(nameElement2.substr(0,1)==&quot;:&quot;)&#xA;		nameElement2=nameElement2.substr(1);&#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0);&#xA;	if(nameElement3.substr(0,1)==&quot;:&quot;)&#xA;		nameElement3=nameElement3.substr(1);&#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;		diagramObject3=desiredDiagObjects[1];	&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;	} &#xA;	var delement1new=false;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements,	what about this element when it exists in another package&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		delement1=searchForElement(subPackage, nameElement1, &quot;Class&quot;); &#xA;		if(delement1==null&amp;&amp;diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;C&quot;)+1,1)==&quot;c&quot;) { //AiviCczc&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Class&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		delement3=searchForElement(subPackage, nameElement3, &quot;Class&quot;); &#xA;		if(delement3==null&amp;&amp;diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;C&quot;)+3,1)==&quot;c&quot;) { //AiviCczc&#xA;				var nameOfClass = nameElement3; &#xA;				testElement = subPackage.Elements.AddNew( nameOfClass, &quot;Class&quot; );&#xA;				testElement.Update();&#xA;				diagramObject3=null; //diagramObject3 is not already a previously created element&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement3!=null) {&#xA;		var connector as EA.Connector.ClientEnd.Cardinality;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			var connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Association&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID||&#xA;				 connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID)) {&#xA;				if(nameElement2.indexOf(&quot;,&quot;)&gt;-1) {&#xA;					if(connector1.ClientEnd.Cardinality==nameElement2.substr(0,nameElement2.indexOf(&quot;,&quot;))&amp;&amp;&#xA;						connector1.SupplierEnd.Cardinality==nameElement2.substr(nameElement2.indexOf(&quot;,&quot;)+1)) {&#xA;						connector=connector1;&#xA;						break;&#xA;					}&#xA;				} else {&#xA;					if(connector1.ClientEnd.Cardinality==&quot;1&quot;&amp;&amp;connector1.SupplierEnd.Cardinality==nameElement2) {&#xA;						connector=connector1;&#xA;						break;&#xA;					}&#xA;				}&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement3.ElementID;&#xA;			if(nameElement2.indexOf(&quot;,&quot;)&gt;-1) {&#xA;				connector.ClientEnd.Cardinality=nameElement2.substr(0,nameElement2.indexOf(&quot;,&quot;));&#xA;				connector.SupplierEnd.Cardinality=nameElement2.substr(nameElement2.indexOf(&quot;,&quot;)+1);&#xA;			} else {&#xA;				connector.ClientEnd.Cardinality=&quot;1&quot;;&#xA;				connector.SupplierEnd.Cardinality=nameElement2;&#xA;			}&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Class&quot;) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Class&quot;||existElementObject.Type==&quot;Object&quot;||existElementObject.Type==&quot;DataType&quot;||existElementObject.Type==&quot;Enumeration&quot;||existElementObject.Type==&quot;PrimitiveType&quot;)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		} &#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Class&quot;) {&#xA;			var left=150;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Class&quot;||existElementObject.Type==&quot;Object&quot;||existElementObject.Type==&quot;DataType&quot;||existElementObject.Type==&quot;Enumeration&quot;||existElementObject.Type==&quot;PrimitiveType&quot;)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;		&#xA;			if(diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			if(diagramObject1.right&gt;left)&#xA;				left=diagramObject1.right+100;&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Multiple calls to createAScomplex depending on multi-value parameters&#xA;function createAScomplexSrst(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=connectors[0].length; //how many use cases are there in the rule&#xA;&#xA;	parameter1[1][0]=(Repository.GetElementByID(connectors[0][0].ClassifierID)).Name;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		if(n==0) {&#xA;			parameter1[1][1]=&quot;Initial&quot;;&#xA;			parameter1[1][2]=connectors[1][0];&#xA;			if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;				parameter1[1][2]=&quot;1. State&quot;;&#xA;			createAScomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;		}&#xA;		parameter1[1][1]=connectors[1][n];&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. State&quot;;	&#xA;		if(n==2)&#xA;			parameter1[1][2]=&quot;Final&quot;;&#xA;		else {&#xA;			parameter1[1][2]=connectors[1][n+1];&#xA;			if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;				parameter1[1][2]=(n+2)+&quot;. State&quot;;&#xA;		}&#xA;		createAScomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from business process diagram to business state machine diagram&#xA;function createAScomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	//AivSrst&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	region = Repository.GetElementByID(conns[0][0].ClassifierID);&#xA;	packages=getTargetPackage(thePackage,&quot;BSTMD&quot;,region.Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Region&quot;;&#xA;	nameOfElement2=&quot;State&quot;;&#xA;	nameOfElement3=&quot;State&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0); &#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;		diagramObject3=desiredDiagObjects[2];&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;	} &#xA;	var delement2new=false;&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;S&quot;)+2,1)==&quot;s&quot;) { //AivSrst&#xA;				if(nameElement2==&quot;Initial&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;StateNode&quot; );&#xA;					testElement.Subtype=3; //Initial&#xA;				}&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;State&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject2=null; //diagramObject1 is not already a previously created element&#xA;			} &#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;S&quot;)+2,1)==&quot;s&quot;) { //AivSrst&#xA;				var nameOfSt = nameElement3; &#xA;				if(nameOfSt==&quot;Final&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfSt, &quot;StateNode&quot; );&#xA;					testElement.Subtype=4;&#xA;				}&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfSt, &quot;State&quot; );&#xA;				testElement.Update();&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} &#xA;	}	&#xA;	//a connection must be created between the elements&#xA;	if(delement3!=null&amp;&amp;delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;			var connector1=delement2.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;StateFlow&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement2.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID)) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement2.Connectors.AddNew(&quot;&quot;, &quot;StateFlow&quot;);&#xA;			connector.SupplierID = delement3.ElementID;&#xA;			connector.Update();&#xA;			delement3.Update();	&#xA;			delement2.Update();&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;State&quot;||delement2.Type==&quot;StateNode&quot;)) {&#xA;			var left=70;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;State&quot;||existElementObject.Type==&quot;StateNode&quot;)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2.Type==&quot;StateNode&quot;) {&#xA;				testDiagramObject.left=left+25;&#xA;				testDiagramObject.right=left+55;&#xA;			}&#xA;			else {&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+80;&#xA;			}&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-30;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			diagramObjects.Refresh();&#xA;		}&#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;(delement3.Type==&quot;State&quot;||delement3.Type==&quot;StateNode&quot;)) {&#xA;			var left=70;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;State&quot;||existElementObject.Type==&quot;StateNode&quot;)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			if(delement3.Type==&quot;StateNode&quot;) {&#xA;				testDiagramObject.left=left+25;&#xA;				testDiagramObject.right=left+55;&#xA;			}&#xA;			else {&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+80;&#xA;			}&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-30;&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;			diagramObjects.Refresh();&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Multiple calls to createZYcomplex depending on multi-value parameters&#xA;function createZYcomplexYu(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=connectors[0].length-1; //how many use cases are there in the rule&#xA;&#xA;	if(connectors[0][0]!=null&amp;&amp;connectors[0][0].Type==&quot;ActivityPartition&quot;) {&#xA;		for( var n=0; n&lt;connectors[0][0].Connectors.Count; n++) {&#xA;			var connector=connectors[0][0].Connectors.GetAt(n);&#xA;			if(connector.Type==&quot;Dependency&quot;&amp;&amp;connector.Name==&quot;UauZpv&quot;) {&#xA;				connectors[2][0]=Repository.GetElementByID(connector.ClientID);&#xA;				break;&#xA;			}&#xA;		}&#xA;	}&#xA;	parameter1[1][0]=connectors[0][0].Name;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][1]=connectors[0][n+1].Name;&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. Use Case&quot;;&#xA;		createZYcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from system use case realization diagram to internal use case diagram&#xA;function createZYcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var theParentPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	//ZpvYu&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;	packages=getTargetPackage(thePackage,&quot;IUCD&quot;,theParentPackage.Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for IUCD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Use Case&quot;;&#xA;	nameOfElement2=&quot;Use Case&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	if(conns[2][0]!=null)&#xA;		nameElement1=setParameterValue(parameters, conns, 0, conns[2][0].Name, 0);&#xA;	else&#xA;		nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, null);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;	} &#xA;	if(conns[2][0]!=null)&#xA;		delement1=conns[2][0];&#xA;	&#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, null);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;	} &#xA;	var delement1new=false;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Y&quot;)+1,1)==&quot;u&quot;) { //ZpvYu&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Use Case&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Y&quot;)+1,1)==&quot;u&quot;) { //ZpvYu&#xA;				var nameOfUC = nameElement2; &#xA;				testElement = subPackage.Elements.AddNew( nameOfUC, &quot;Use Case&quot; );&#xA;				testElement.Update();&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(var i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			var connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;UseCase&quot;&amp;&amp;connector1.Subtype==&quot;Includes&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID||&#xA;				 connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement2.ElementID)) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;UseCase&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Subtype=&quot;Includes&quot;;&#xA;			connector.Stereotype=&quot;include&quot;;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	var newObj3=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;UseCase&quot;) {&#xA;			var left=30;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;UseCase&quot;) {&#xA;			var left=150;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;UseCase&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;		&#xA;			if(diagramObject1!=null&amp;&amp;diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1!=null&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Multiple calls to createYQcomplex depending on multi-value parameters&#xA;function createYQcomplexQlml(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many use cases are there in the rule&#xA;&#xA;	iteration=Math.floor(iteration);&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][0]=parameters[1][2*n];&#xA;		//if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;		//	parameter1[1][0]=&quot;Lifeline&quot;+(n+1);&#xA;		parameter1[1][1]=parameters[1][2*n+1];&#xA;		//if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;		//	parameter1[1][1]=&quot;Message&quot;+(n+1);		&#xA;		parameter1[1][2]=parameters[1][2*n+2];&#xA;		//if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;		//	parameter1[1][2]=&quot;Lifeline&quot;+(n+2);		&#xA;		createYQcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from internal use case diagram to sequence diagram&#xA;function createYQcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var diagramConnectors = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	//YuQlm&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	if(conns[0]==null||conns[0].length&lt;=0||conns[0][0].Type!=&quot;UseCase&quot;||conns[0][0].Name==&quot;&quot;||conns[0][0].Name==&quot; &quot;)&#xA;		return;&#xA;	packages=getTargetPackage(thePackage,&quot;SEQD&quot;,conns[0][0].Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for SEQD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;LifeLine1&quot;;&#xA;	nameOfElement2=&quot;Message&quot;;&#xA;	nameOfElement3=&quot;LifeLine2&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 3); &#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0); &#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject3=null;&#xA;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, null, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject3=desiredDiagObjects[2];		&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Connector;&#xA;	var delement3 as EA.Element;&#xA;	var delement4 as EA.Connector;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	delement4 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackSequences(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;		delement4=desiredPackElements[3];	&#xA;	} &#xA;	if(delement1==null&amp;&amp;nameElement1!=null) {&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Q&quot;)+1,1)==&quot;l&quot;) { &#xA;			testElement = subPackage.Elements.AddNew( nameElement1, &quot;Sequence&quot; ); &#xA;			testElement.Update();&#xA;			diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;		} &#xA;		delement1=testElement;&#xA;	}&#xA;	if(delement3==null&amp;&amp;nameElement3!=null) {&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Q&quot;)+3,1)==&quot;l&quot;) { //YuQlml&#xA;			testElement = subPackage.Elements.AddNew( nameElement3, &quot;Sequence&quot; ); &#xA;			testElement.Update();&#xA;			diagramObject3=null; //diagramObject1 is not already a previously created element&#xA;		} &#xA;		delement3=testElement;&#xA;	}&#xA;	var nameConnector2=null;&#xA;	var nameConnector2Parameter=null;&#xA;	var nameConnector4=null;&#xA;	var nameConnector4Parameter=null;&#xA;	if(nameElement2.indexOf(&quot;::&quot;)&gt;-1)&#xA;		nameConnector2 = nameElement2.substr(0,nameElement2.indexOf(&quot;::&quot;));&#xA;	else&#xA;		nameConnector2 = nameElement2;&#xA;	if(nameConnector2.indexOf(&quot;&lt;&quot;)&gt;-1&amp;&amp;nameConnector2.indexOf(&quot;&gt;&quot;)&gt;nameConnector2.indexOf(&quot;&lt;&quot;)) {&#xA;		nameConnector2Parameter = nameConnector2.substr(nameConnector2.indexOf(&quot;&lt;&quot;)+1,nameConnector2.indexOf(&quot;&gt;&quot;)-nameConnector2.indexOf(&quot;&lt;&quot;)-1);&#xA;		nameConnector2 = nameElement2.substr(0,nameElement2.indexOf(&quot;&lt;&quot;));&#xA;	} else&#xA;		nameConnector2Parameter=&quot;&quot;;&#xA;	nameConnector4=&quot;&quot;;&#xA;	if(nameElement2.indexOf(&quot;::&quot;)&gt;-1)&#xA;		nameConnector4Parameter=nameElement2.substr(nameElement2.indexOf(&quot;::&quot;)+2);&#xA;	else&#xA;		nameConnector4Parameter=&quot;&quot;;&#xA;	diagramConnectors=getDesiredDiagramSequences(testDiagram);	&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameConnector2!=null) {&#xA;		var testElement as EA.Connector;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Q&quot;)+2,1)==&quot;m&quot;) { //YuQlml&#xA;			testElement=delement1.Connectors.AddNew(nameConnector2, &quot;Sequence&quot;);	&#xA;			if(delement3==null) &#xA;				testElement.SupplierID=delement1.ElementID;&#xA;			else&#xA;				testElement.SupplierID=delement3.ElementID;&#xA;			testElement.TransitionGuard=&quot;retval=void;params=;paramsDlg=&quot;+nameConnector2Parameter+&quot;;&quot;;&#xA;			if(diagramConnectors==null)	&#xA;				testElement.SequenceNo=1;&#xA;			else {&#xA;				testElement.SequenceNo=diagramConnectors.length/2+1;&#xA;				for(var m=0; m&lt;diagramConnectors.length;m++) {&#xA;					var connector as EA.Connector;&#xA;					connector=diagramConnectors[m];&#xA;					if(connector.SequenceNo&gt;diagramConnectors.length/2) {&#xA;						connector.SequenceNo=connector.SequenceNo+2;&#xA;						connector.Update();&#xA;					}&#xA;				}&#xA;			}&#xA;			testElement.Update();&#xA;			var sqlCommand=&quot;update t_connector set PDATA4 = 0 where Connector_ID = &quot;+testElement.ConnectorID;&#xA;			Repository.Execute(sqlCommand);				&#xA;		} &#xA;		delement2=testElement;&#xA;	}&#xA;	if(delement4==null&amp;&amp;nameConnector4!=null) {&#xA;		var testElement as EA.Connector;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Q&quot;)+2,1)==&quot;m&quot;) { //YuQlml&#xA;			testElement=delement3.Connectors.AddNew(nameConnector4, &quot;Sequence&quot;);	&#xA;			if(delement1==null) &#xA;				testElement.SupplierID=delement3.ElementID;&#xA;			else&#xA;				testElement.SupplierID=delement1.ElementID;&#xA;			if(nameConnector4Parameter!=null&amp;&amp;nameConnector4Parameter!=&quot;&quot;)&#xA;				testElement.TransitionGuard=&quot;retval=&quot;+nameConnector4Parameter+&quot;;&quot;;&#xA;			else&#xA;				testElement.TransitionGuard=&quot;retval=void;&quot;;&#xA;			if(diagramConnectors==null)	&#xA;				testElement.SequenceNo=2;&#xA;			else&#xA;				testElement.SequenceNo=diagramConnectors.length/2+2;&#xA;			testElement.Update();&#xA;			var sqlCommand=&quot;update t_connector set PDATA4 = 1 where Connector_ID = &quot;+testElement.ConnectorID;&#xA;			Repository.Execute(sqlCommand);				&#xA;		} &#xA;		delement4=testElement;&#xA;	}&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Sequence&quot;) {&#xA;			var left=50;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Sequence&quot;) {&#xA;					if(existDiagramObject.left&gt;=left)&#xA;						left=existDiagramObject.left+150;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=-50;&#xA;			testDiagramObject.bottom=-400;&#xA;			testDiagramObject.Update();&#xA;			diagramObjects.Refresh();&#xA;			testDiagram.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;		}&#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element3 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Sequence&quot;) {&#xA;			var left=200;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Sequence&quot;) {&#xA;					if(existDiagramObject.left&gt;=left)&#xA;						left=existDiagramObject.left+150;&#xA;				}&#xA;			}&#xA;			if(diagramObject1!=null&amp;&amp;diagramObject1.left&gt;=left)&#xA;				left=diagramObject1.left+150;&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=-50;&#xA;			testDiagramObject.bottom=-400;&#xA;			testDiagramObject.Update();&#xA;			diagramObjects.Refresh();&#xA;			testDiagram.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Multiple calls to createUZcomplex depending on multi-value parameters&#xA;function createQMcomplexMqyq(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=Math.floor(connectors[0].length/2); //how many activities are there in the rule&#xA;var lastElement as EA.Element;&#xA;	&#xA;	lastElement=null;&#xA;	if(iteration &lt;=1) {&#xA;		createQMcomplex(correctCR, thePackage, parameters, connectors,0);&#xA;	}&#xA;	else {&#xA;		for(var n=0; n&lt;iteration; n++) {&#xA;			parameter1[1][0]=connectors[0][2*n].Name; &#xA;			parameter1[1][1]=connectors[0][2*n+1].Name; &#xA;			parameter1[1][2]=connectors[0][2*n+2].Name; &#xA;			connectors[2][0]=lastElement;&#xA;			lastElement=createQMcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;		} &#xA;	}&#xA;}&#xA;//Create target elements in composite consistency rule from sequence diagram to component diagram&#xA;function createQMcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	//QlmlMqyq&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;CMPD&quot;,thePackage.Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for CMPD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Component&quot;;&#xA;	nameOfElement2=&quot;Interface&quot;;&#xA;	nameOfElement3=&quot;Component&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0); &#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;		diagramObject3=desiredDiagObjects[2];&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Connector;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;	} &#xA;	if(delement1==null&amp;&amp;nameElement1!=null) {&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;M&quot;)+1,1)==&quot;q&quot;) { //QlmlMqyq&#xA;			if(nameElement1!=null&amp;&amp;nameElement1.substr(0,1)==&quot;:&quot;)&#xA;				nameElement1=nameElement1.substr(1);&#xA;			var testParentElement as EA.Element;&#xA;			testParentElement=null;&#xA;			if((testParentElement=searchForElement(subPackage, nameElement1, &quot;Component&quot;))==null) {&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Component&quot; ); &#xA;				testElement.Update();&#xA;			} else&#xA;				testElement=testParentElement;&#xA;			diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;		} &#xA;		delement1=testElement;&#xA;	}&#xA;	if(delement3==null&amp;&amp;nameElement3!=null) {&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;M&quot;)+3,1)==&quot;q&quot;) { //QlmlMqyq&#xA;			if(nameElement3!=null&amp;&amp;nameElement3.substr(0,1)==&quot;:&quot;)&#xA;				nameElement3=nameElement3.substr(1);&#xA;			var testParentElement as EA.Element;&#xA;			testParentElement=null;&#xA;			if((testParentElement=searchForElement(subPackage, nameElement3, &quot;Component&quot;))==null) {&#xA;				testElement = subPackage.Elements.AddNew( nameElement3, &quot;Component&quot; ); &#xA;				testElement.Update();&#xA;			} else&#xA;				testElement=testParentElement;&#xA;			diagramObject3=null; //diagramObject1 is not already a previously created element&#xA;		} &#xA;		delement3=testElement;&#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;delement1!=null&amp;&amp;delement3!=null&amp;&amp;delement1!=delement3) {&#xA;		var testElement as EA.Connector;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;M&quot;)+2,1)==&quot;y&quot;) { //QlmlMqyq&#xA;			testElement=delement1.Connectors.AddNew(nameElement2, &quot;Interface&quot;);	&#xA;			if(delement3==null) &#xA;				testElement.SupplierID=delement1.ElementID;&#xA;			else&#xA;				testElement.SupplierID=delement3.ElementID;&#xA;			testElement.Update();&#xA;		} &#xA;		delement2=testElement;&#xA;	}&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Component&quot;) {&#xA;			var left=50;&#xA;			var top=-50;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Component&quot;) {&#xA;					if(existDiagramObject.bottom&lt;=top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			testDiagram.Update();&#xA;			diagramObjects.Refresh();&#xA;			diagramObject1=testDiagramObject;&#xA;		}&#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element3 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Component&quot;) {&#xA;			var left=50;&#xA;			var top=-150;			&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			diagramObjects.Refresh();&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Component&quot;) {&#xA;					if(existDiagramObject.bottom&lt;=top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			testDiagram.Update();&#xA;			diagramObjects.Refresh();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	}&#xA;	return delement3;&#xA;}&#xA;//Multiple calls to createUZcomplex depending on multi-value parameters&#xA;function createUZcomplexZpv(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=Math.floor(parameters[1].length/2); //how many activities are there in the rule&#xA;var lastElement as EA.Element;&#xA;	&#xA;	lastElement=null;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][0]=parameters[1][2*n]; //if the partition is empty&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;				parameter1[1][0]=&quot;User&quot;;&#xA;		parameter1[1][1]=parameters[1][2*n+1]; //if the action is empty&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. Action&quot;;&#xA;		connectors[2][0]=lastElement;&#xA;		lastElement=createUZcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from system use case diagram to system use case realization diagram&#xA;function createUZcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	if(conns[0]==null||conns[0].length&lt;=0||conns[0][1].Type!=&quot;UseCase&quot;||conns[0][1].Name==&quot;&quot;||conns[0][1].Name==&quot; &quot;)&#xA;		return;&#xA;	packages=getTargetPackage(thePackage,&quot;SUCRD&quot;,conns[0][1].Name);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for SUCRD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;U&quot;)+2,1)==&quot;u&quot;) {//UauZpv&#xA;		nameOfElement1=&quot;ActivityPartition&quot;;&#xA;		nameOfElement2=&quot;Action&quot;;&#xA;	} else { //BuaApv&#xA;		nameOfElement2=&quot;ActivityPartition&quot;;&#xA;		nameOfElement1=&quot;Action&quot;;&#xA;	}&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0);&#xA;	//pattern-driven rule in nameElement2 - BauApv({pattern})&#xA;	if(nameElement2.substr(0,2)==&quot;{{&quot; &amp;&amp; nameElement2.substr(nameElement2.length-2,2)==&quot;}}&quot;) {&#xA;		var namePattern=nameElement2.substr(2);&#xA;		namePattern=namePattern.substr(0,namePattern.length-2);		&#xA;		// Fetch XML content from URL&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;);&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		var nameOfPckg = &quot;&quot;;&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			//retrieve package name&#xA;			nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;);&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			var project = Repository.GetProjectInterface();&#xA;			//Import the XMI file into the current model, download package content to subpackage&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1);&#xA;			subPackage.Packages.Refresh();&#xA;			if(result==null)&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null)&#xA;				return;&#xA;			//moving elements from the changed pattern to the current package&#xA;			if(subChildPackage !=null)&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			return;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML for the pattern &lt;&quot;+namePattern+&quot; from URL: &quot; + xhr.statusText);&#xA;		}&#xA;	}&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, null);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;	} &#xA;	&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = conns[2][0];&#xA;	var desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, null);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];	&#xA;		//activityPartitions = desiredPackElements[3];&#xA;	} &#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;p&quot;) { //UauZpv&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;ActivityPartition&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				if(conns[0][1]!=null) {&#xA;					var connector as EA.Connector;&#xA;					connector = conns[0][1].Connectors.AddNew(correctCR, &quot;Dependency&quot;)&#xA;					connector.SupplierID = testElement.ElementID;&#xA;					connector.Update();&#xA;					conns[0][1].Update();&#xA;				}					&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //UauZpv&#xA;				if(nameElement2==&quot;Initial&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;StateNode&quot; ); &#xA;					testElement.Subtype==100;&#xA;				} else&#xA;				if(nameElement2==&quot;Final&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;StateNode&quot; ); &#xA;					testElement.Subtype=101;&#xA;				}&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;Activity&quot; ); &#xA;				testElement.ParentID=delement1.ElementID;&#xA;				//testElement = delement1.Elements.AddNew( nameElement2, &quot;Activity&quot; );&#xA;				testElement.Update();&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	} &#xA;	if(delement3!=null) {&#xA;		var connector as EA.Connector;&#xA;		var connector1 as EA.Connector;&#xA;		connector=null;&#xA;		connector1=null;&#xA;		for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;			connector=delement2.Connectors.GetAt(i);&#xA;			if(connector.Type==&quot;ControlFlow&quot;) {&#xA;				if(connector.ClientID&gt;0&amp;&amp;connector.ClientID!=delement2.ElementID&amp;&amp;connector.ClientID==delement3.ElementID) {&#xA;					connector1=connector;&#xA;					break;&#xA;				}&#xA;			}			&#xA;		}&#xA;		if(connector1==null) {&#xA;			connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement3.Update();	&#xA;			delement2.Update();			&#xA;		}&#xA;	}&#xA;	var diagramObject1new=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;ActivityPartition&quot;) {&#xA;			if(delement1.Name==&quot;User&quot;) {&#xA;				var left=50;&#xA;				var top=-50;&#xA;			} else {&#xA;				var left=250;&#xA;				var top=-50;&#xA;			}&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject=Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existDiagramObject.ElementID!=delement2.ElementID) {&#xA;					if(existElementObject.Type==&quot;ActivityPartition&quot;) {&#xA;						if(existElementObject.Name==&quot;User&quot;) {&#xA;							left=existDiagramObject.right;&#xA;							top=existDiagramObject.top;&#xA;						} else {&#xA;							left=existDiagramObject.left-200;&#xA;							top=existDiagramObject.top;&#xA;						}&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+200;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-350;&#xA;			var textStyle=testDiagramObject.Style;&#xA;			if(textStyle.indexOf(&quot;VPartition=&quot;)&gt;-1) {&#xA;				if(textStyle.indexOf(&quot;VPartition=0&quot;)&gt;-1) {&#xA;					textStyle.replace(&quot;VPartition=0&quot;,&quot;VPartition=1&quot;);&#xA;					testDiagramObject.Style=textStyle;&#xA;				}&#xA;			} else &#xA;				testDiagramObject.Style=testDiagramObject.Style+&quot;VPartition=1;&quot;;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			diagramObject1new=true;&#xA;		} &#xA;	}&#xA;	var left=diagramObject1.left+(diagramObject1.right-diagramObject1.left)/2;&#xA;	var top=diagramObject1.top-100;&#xA;	var topOther=diagramObject1.top-100;&#xA;	if(diagramObject2==null) {&#xA;		var diagramObjects as EA.Collection;&#xA;		&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		diagramObjects.Refresh();&#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;Activity&quot;||delement2.Type==&quot;Action&quot;||delement2.Type==&quot;StateNode&quot;)) {&#xA;			if(delement2.ParentID==delement1.ElementID) {&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;		&#xA;				//if there are other elements in the partition, we should set the left edge of the action to the right of the last element of the partition&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null&amp;&amp;existElementObject.ParentID==delement1.ElementID&amp;&amp;&#xA;						(existElementObject.Type==&quot;Activity&quot;||existElementObject.Type==&quot;Action&quot;||existElementObject.Type==&quot;Object&quot;||&#xA;						 existElementObject.Type==&quot;Event&quot;||existElementObject.Type==&quot;StateNode&quot;||existElementObject.Type==&quot;Decision&quot;||existElementObject.Type==&quot;MergeNode&quot;)) {&#xA;						if(existDiagramObject.left&gt;diagramObject1.left&amp;&amp;existDiagramObject.right&lt;diagramObject1.right&amp;&amp;existDiagramObject.top&lt;diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;diagramObject1.bottom&amp;&amp;&#xA;							existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;						if(top&lt;diagramObject1.bottom+50) {&#xA;							diagramObject1.bottom=top-100;&#xA;							diagramObject1.Update();&#xA;						}&#xA;					} else&#xA;					if(existElementObject!=null&amp;&amp;delement2.ParentID&gt;0&amp;&amp;existElementObject.ParentID!=delement2.ParentID&amp;&amp;&#xA;						(existElementObject.Type==&quot;Activity&quot;||existElementObject.Type==&quot;Action&quot;)) {&#xA;						if(existDiagramObject.top&lt;=topOther)&#xA;							topOther=existDiagramObject.top;&#xA;					}&#xA;				}				&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2.Type==&quot;StateNode&quot;) {&#xA;				testDiagramObject.left=left-15;&#xA;				testDiagramObject.right=left+15;&#xA;				if(delement2.Name==&quot;Initial&quot;) {&#xA;					testDiagramObject.top=diagramObject1.top-40;  //-15;&#xA;					testDiagramObject.bottom=diagramObject1.top-70;  //-60;&#xA;				} else {&#xA;					testDiagramObject.top=top-10;  //-15;&#xA;					testDiagramObject.bottom=top-40;  //-60;&#xA;				}&#xA;			} else {&#xA;				testDiagramObject.left=left-35;&#xA;				testDiagramObject.right=left+35;&#xA;				if(topOther&lt;top) {&#xA;					testDiagramObject.top=topOther;  //-15;&#xA;					testDiagramObject.bottom=topOther-45;  //-60;&#xA;				} else {&#xA;					testDiagramObject.top=top;  //-15;&#xA;					testDiagramObject.bottom=top-45;  //-60;&#xA;				}&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;		} &#xA;	} else { &#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;Activity&quot;||delement2.Type==&quot;Action&quot;||delement2.Type==&quot;StateNode&quot;)) {&#xA;			if(delement2.ParentID==delement1.ElementID) { //if delement2 is the part of the partition&#xA;				//if delement2 is placed outside the partition&#xA;				if(diagramObject2.left&lt;diagramObject1.left||diagramObject2.right&gt;diagramObject1.right|| &#xA;					diagramObject2.top&gt;diagramObject1.top||diagramObject2.bottom&lt;diagramObject1.bottom) {&#xA;					//setting the left border inside the partition	&#xA;					var left1=setLeftBorderOfPartition(diagramObjects, diagramObject1);&#xA;					if(left1&gt;left)&#xA;						left=left1;&#xA;					diagramObject2.left=left+100;&#xA;					diagmObject2.Update();&#xA;				}&#xA;				//placingElementOfAction(delement2, diagramObjects, diagramObject1, diagramObject2,0); &#xA;			}&#xA;		}&#xA;	}&#xA;	return delement2;&#xA;}&#xA;//Multiple calls to createRAcomplex depending on multi-value parameters&#xA;function createCZcomplexAvi(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var parameter11;&#xA;var parameter31;&#xA;var parameter12;&#xA;var parameter32;&#xA;var pathToPackage;&#xA;var lastElement as EA.Element;&#xA;	&#xA;	iteration=Math.floor(iteration);&#xA;	pathToPackage=parameters.pop();&#xA;	lastElement=null;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1.push(pathToPackage);&#xA;		parameter1[1][0]=parameters[1][2*n+1];&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;			parameter1[1][0]=(n+1)+&quot;. Action&quot;;&#xA;		parameter11=parameters[1][2*n];&#xA;		if(parameter11==null||parameter11==&quot;&quot;||parameter11==&quot; &quot;)&#xA;			parameter11=&quot;:&quot;+connectors[0][0].Name;&#xA;		parameter31=parameters[3][2*n];&#xA;		parameter12=parameters[1][2*n+2];&#xA;		if(parameter12==null||parameter12==&quot;&quot;||parameter12==&quot; &quot;)&#xA;			parameter12=&quot;:&quot;+connectors[0][0].Name;&#xA;		parameter32=parameters[3][2*n+2];&#xA;		do {&#xA;			if(parameter11.indexOf(&quot;,&quot;)&gt;0) {&#xA;				parameter1[1][1]=parameter11.substr(0,parameter11.indexOf(&quot;,&quot;));&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter11=parameter11.substr(parameter11.indexOf(&quot;,&quot;)+1);&#xA;				parameter1[3][1]=parameter31.substr(0,parameter31.indexOf(&quot;,&quot;));&#xA;				parameter31=parameter31.substr(parameter31.indexOf(&quot;,&quot;)+1);&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter11.length&gt;0)&#xA;					parameter11=parameter11+&quot;,&quot;;&#xA;				if(parameter31.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter31.length&gt;0)&#xA;					parameter31=parameter31+&quot;,&quot;;&#xA;			} else {&#xA;				parameter1[1][1]=parameter11;&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter1[3][1]=parameter31;&#xA;			}&#xA;			do {&#xA;				if(parameter12.indexOf(&quot;,&quot;)&gt;0) {&#xA;					parameter1[1][2]=parameter12.substr(0,parameter12.indexOf(&quot;,&quot;));&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter12=parameter12.substr(parameter12.indexOf(&quot;,&quot;)+1);&#xA;					parameter1[3][2]=parameter32.substr(0,parameter32.indexOf(&quot;,&quot;));&#xA;					parameter32=parameter32.substr(parameter32.indexOf(&quot;,&quot;)+1);&#xA;					if(parameter12.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.length&gt;0)&#xA;						parameter12=parameter12+&quot;,&quot;;&#xA;					if(parameter32.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter32.length&gt;0)&#xA;						parameter32=parameter32+&quot;,&quot;;&#xA;				} else {&#xA;					parameter1[1][2]=parameter12;&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter1[3][2]=parameter32;&#xA;				}&#xA;				connectors[2][0]=lastElement;&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.indexOf(&quot;,&quot;)&lt;0)&#xA;					lastElement=createCZcomplex(correctCR, thePackage, parameter1, connectors,1);&#xA;				else&#xA;					lastElement=createCZcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;			} while(parameter12.indexOf(&quot;,&quot;)&gt;0);	&#xA;		} while(parameter11.indexOf(&quot;,&quot;)&gt;0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from business class diagram to system use case realization diagram&#xA;function createCZcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var targetDiagram;&#xA;	var activityPartitions = [];	&#xA;	&#xA;	targetDiagram==null;&#xA;	conns = connectors1;&#xA;	if(parameters.length&lt;=4)&#xA;		return;&#xA;	targetDiagram=parameters.pop();&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;SUCRD&quot;,targetDiagram);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for SUCRD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Action&quot;;&#xA;	nameOfElement2=&quot;Object&quot;;&#xA;	nameOfElement3=&quot;Object&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0); &#xA;	//pattern-driven rule in nameElement1 - CchZiv({{pattern}})&#xA;	if(nameElement2.substr(0,2)==&quot;{{&quot; &amp;&amp; nameElement1.substr(nameElement1.length-2,2)==&quot;}}&quot;) {&#xA;		var namePattern=nameElement2.substr(2); //Retrieve name pattern from the first parameter&#xA;		namePattern=namePattern.substr(0,namePattern.length-2);		&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;); // Fetch XML content from URL&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			var nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;); //Retrieve package name&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			//activityPartitions=retrieveXMLNames(xmlContent, &quot;ActivityPartition&quot;, &quot;alias&quot;, &quot;UML:ActionState name=&quot;,0); //Retrieve partition names&#xA;			//activityPartitions=activityPartitions.sort();&#xA;			objectClasses=retrieveXMLNames(xmlContent, &quot;classname&quot;, &quot;stateflags&quot;, 'keywords&quot; value=', 1); //Retrieve objectclass names - option B: &quot;keywords&quot;, &quot;UML:ClassifierRole name=&quot;, 0&#xA;			objectClasses=objectClasses.sort();&#xA;			var project = Repository.GetProjectInterface();&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1); //the imported package&#xA;			if(result==null) //something wrong with the imported package&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null) //something wrong with the imported package&#xA;				return;&#xA;			var moving=renamePatternObjects(nameElement1, conns[0][1], objectClasses, null, subPackage, subChildPackage); //Rename object classes according to the values &#8203;&#8203;given in the objectClasses parameter&#xA;			if(subChildPackage !=null&amp;&amp;moving) //moving partitions from the changed pattern to the current package&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			return;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML from URL: &quot; + xhr.staxtusText);&#xA;		}&#xA;	}&#xA;	//Searching the target package&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredObjectElements(subPackage, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;		activityPartitions=desiredPackElements[3];&#xA;	} &#xA;	if(conns[2][0]!=null)&#xA;		delement3 = conns[2][0];&#xA;	//Searching the target diagram&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;	&#xA;&#xA;	if(delement1!=null)&#xA;		diagramObject1=searchedObjectinDiagram(subPackage, delement1);&#xA;	if(delement2!=null)&#xA;		diagramObject2=searchedObjectinDiagram(subPackage, delement2);	&#xA;	if(delement3!=null)&#xA;		diagramObject3=searchedObjectinDiagram(subPackage, delement3);&#xA;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //CchZiv&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Action&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				delement1new=true;&#xA;			} &#xA;			delement1=testElement;&#xA;		} //else it means that this element is outside of current package&#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //CchZiv&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement2;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;) {&#xA;					if(params[3][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][1].substr(0,params[3][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][1];&#xA;				} else&#xA;				if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][0].substr(0,params[2][0].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][0];&#xA;				} else &#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} &#xA;				if(nameOfObject==&quot;Start&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype==100;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				testElement.Update();&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //CchZiv&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement3;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;) {&#xA;					if(params[3][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][2].substr(0,params[3][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][2];&#xA;				} else&#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(params[2][1]!=null&amp;&amp;params[2][1]!=&quot;&quot;&amp;&amp;params[2][1]!=&quot; &quot;) {&#xA;					if(params[2][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][1].substr(0,params[2][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][1];&#xA;				} &#xA;				if(nameOfObject==&quot;End&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype=101;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				testElement.Update();&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the input element and the middle element&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //CchZiv&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i); //a nie delement2?&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement2.Name==&quot;Start&quot;)&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement2.ElementID;&#xA;				connector.Update();&#xA;				delement1.Update();	&#xA;				delement2.Connectors.Refresh();&#xA;				delement1.Connectors.Refresh();&#xA;			}	&#xA;			//a connection must be created between the element to which the input element is connected at the output and the middle element&#xA;			var tmpObject as EA.Element;&#xA;			tmpObject=null;&#xA;			for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;				var connector1=delement2.Connectors.GetAt(i);&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement2.ElementID&amp;&amp;connector1.ClientID!=delement1.ElementID) {&#xA;					tmpObject=Repository.GetElementByID(connector1.ClientID);&#xA;					if(tmpObject.Type==&quot;Action&quot; ||tmpObject.Type==&quot;Activity&quot;)					&#xA;						break; //The input object is connected as an output object to another action&#xA;					else&#xA;						tmpObject=null;&#xA;				}&#xA;			}&#xA;			if(tmpObject!=null) {&#xA;				//you need to check if this connection already exists&#xA;				for(i=0;i&lt;tmpObject.Connectors.Count;i++) {&#xA;					var connector1=tmpObject.Connectors.GetAt(i);&#xA;					if(connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==tmpObject.ElementID) {&#xA;						tmpObject=null;&#xA;						break;&#xA;					}&#xA;				}&#xA;				if(tmpObject!=null) {&#xA;					connector = tmpObject.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;					connector.SupplierID = delement1.ElementID;&#xA;					connector.Update();&#xA;					tmpObject.Update();		&#xA;				}					&#xA;			}&#xA;		}&#xA;	}&#xA;	//a connection must be created between the middle element and the output element&#xA;	if(delement1!=null&amp;&amp;delement3!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //CchZiv&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i);&#xA;				if(delement3.Name!=&quot;End&quot;&amp;&amp;connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID||&#xA;				   delement3.Name==&quot;End&quot;&amp;&amp;connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement3.Name==&quot;End&quot;)&#xA;					connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement1.ElementID;&#xA;				connector.Update();&#xA;				delement3.Update();	&#xA;				delement1.Connectors.Refresh();&#xA;				delement3.Connectors.Refresh();&#xA;			}	&#xA;		}&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var left=100;&#xA;	var top=-100;&#xA;	var thisActivityPartition as EA.DiagramObject;&#xA;	thisActivityPartition=null;&#xA;	if(delement1.ParentID&gt;0) {&#xA;		for( var i = 0; i &lt; testDiagram.DiagramObjects.Count; i++) {&#xA;			if((testDiagram.DiagramObjects.GetAt(i)).ElementID==delement1.ParentID) {&#xA;				thisActivityPartition=testDiagram.DiagramObjects.GetAt(i);&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(thisActivityPartition!=null) { &#xA;			left=thisActivityPartition.left+(thisActivityPartition.right-thisActivityPartition.left)/2;&#xA;			top=thisActivityPartition.top-100;&#xA;		}&#xA;	}&#xA;	if(diagramObject1==null) {&#xA;		var diagramObjects as EA.Collection;&#xA;		&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		diagramObjects.Refresh();&#xA;		if(delement1!=null&amp;&amp;(delement1.Type==&quot;Activity&quot;||delement1.Type==&quot;Action&quot;)) {&#xA;			if(thisActivityPartition!=null&amp;&amp;delement1.ParentID==thisActivityPartition.ElementID) {  //if the action is in the Activitypatition&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;		&#xA;				//if there are other elements in the partition, we should set the left edge of the action to the right of the last element of the partition&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null&amp;&amp;existElementObject.ParentID==thisActivityPartition.ElementID&amp;&amp;&#xA;						(existElementObject.Type==&quot;Activity&quot;||existElementObject.Type==&quot;Action&quot;||existElementObject.Type==&quot;Object&quot;||&#xA;						 existElementObject.Type==&quot;Event&quot;||existElementObject.Type==&quot;StateNode&quot;||existElementObject.Type==&quot;Decision&quot;||existElementObject.Type==&quot;MergeNode&quot;)) {&#xA;						if(existDiagramObject.left&gt;thisActivityPartition.left&amp;&amp;existDiagramObject.right&lt;thisActivityPartition.right&amp;&amp;&#xA;							existDiagramObject.top&lt;thisActivityPartition.top&amp;&amp;existDiagramObject.bottom&gt;thisActivityPartition.bottom&amp;&amp;existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;						if(top&lt;diagramObject1.bottom+50) {&#xA;							thisActivityPartition.bottom=top-100;&#xA;							thisActivityPartition.Update();&#xA;						}&#xA;					}&#xA;				}				&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left-35;&#xA;			testDiagramObject.right=left+35;&#xA;			testDiagramObject.top=top;  //-15;&#xA;			testDiagramObject.bottom=top-45;  //-60;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;		} &#xA;	} else { &#xA;		if(delement1!=null&amp;&amp;(delement1.Type==&quot;Activity&quot;||delement1.Type==&quot;Action&quot;)) {&#xA;			if(thisActivityPartition!=null&amp;&amp;delement1.ParentID==thisActivityPartition.ElementID) { //if delement1 is the part of the partition&#xA;				//if delement1 is placed outside the partition&#xA;				if(diagramObject1.left&lt;thisActivityPartition.left||diagramObject1.right&gt;thisActivityPartition.right|| &#xA;					diagramObject1.top&gt;thisActivityPartition.top||diagramObject1.bottom&lt;thisActivityPartition.bottom) {&#xA;					//setting the left border inside the partition	&#xA;					var left1=setLeftBorderOfPartition(diagramObjects, thisActivityPartition);&#xA;					if(left1&gt;left)&#xA;						left=left1;&#xA;					diagramObject1.left=left+100;&#xA;					diagmObject1.Update();&#xA;				}&#xA;				//placingElementOfAction(delement2, diagramObjects, diagramObject1, diagramObject2,0); &#xA;			}&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element2 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null) {&#xA;			var left=diagramObject1.right;&#xA;			var top=diagramObject1.bottom;&#xA;			if(delement2.ParentID&gt;0) {&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ ) {&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==delement2.ParentID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;						if(top-50&lt;partycjaObjTmp.bottom) {&#xA;							partycjaObjTmp.bottom=top-100;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}			&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2.Name==&quot;Start&quot;) { //InitialNode&#xA;				testDiagramObject.left=left-70;&#xA;				testDiagramObject.right=left-40;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-34;&#xA;			} else {			&#xA;				testDiagramObject.left=left+50;&#xA;				testDiagramObject.right=left+120;&#xA;				testDiagramObject.top=top-13;&#xA;				testDiagramObject.bottom=top-50;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;		}&#xA;	} &#xA;	if(diagramObject3==null) {&#xA;		// Add the element3 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null) {&#xA;			var left=diagramObject1.right;&#xA;			var top=diagramObject1.top;&#xA;			if(delement3.ParentID&gt;0) {&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ ) {&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==delement3.ParentID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				testDiagramObject.left=left+145;&#xA;				testDiagramObject.right=left+175;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-33;&#xA;			} else {&#xA;				testDiagramObject.left=left+50;&#xA;				testDiagramObject.right=left+120;&#xA;				testDiagramObject.top=top+50;&#xA;				testDiagramObject.bottom=top+13;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	} else {&#xA;		var left=diagramObject1.right;&#xA;		var top=diagramObject1.top;&#xA;		if(delement3.ParentID&gt;0) {&#xA;			diagramObject=null;&#xA;			for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;			{&#xA;				var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;				if(partycjaObjTmp.ElementID==delement3.ParentID) {&#xA;					diagramObject=partycjaObjTmp;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(diagramObject!=null) {&#xA;				if(diagramObject3.left&lt;diagramObject.left||diagramObject3.right&gt;diagramObject.right||diagramObject3.top&gt;diagramObject.top||diagramObject3.bottom&lt;diagramObject.bottom) {&#xA;					if(delement3.Name==&quot;End&quot;) {&#xA;						diagramObject3.left=left+145;&#xA;						diagramObject3.right=left+175;&#xA;						diagramObject3.top=top-3;&#xA;						diagramObject3.bottom=top-33;&#xA;					} else {&#xA;						diagramObject3.left=left+50;&#xA;						diagramObject3.right=left+120;&#xA;						diagramObject3.top=top+50;&#xA;						diagramObject3.bottom=top+13;&#xA;					}&#xA;					diagramObject3.Update();					&#xA;				}&#xA;			}&#xA;		} else {&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				diagramObject3.left=left+145;&#xA;				diagramObject3.right=left+175;&#xA;				diagramObject3.top=top-3;&#xA;				diagramObject3.bottom=top-33;&#xA;			} else {&#xA;				diagramObject3.left=left+50;&#xA;				diagramObject3.right=left+120;&#xA;				diagramObject3.top=top+50;&#xA;				diagramObject3.bottom=top+13;&#xA;			}&#xA;			diagramObject3.Update();				&#xA;		}&#xA;	}&#xA;	return delement2;&#xA;}&#xA;//Multiple calls to createRAcomplex depending on multi-value parameters&#xA;function createSZcomplexZiv(correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var parameter11;&#xA;var parameter31;&#xA;var parameter12;&#xA;var parameter32;&#xA;var pathToPackage;&#xA;var lastElement as EA.Element;&#xA;	&#xA;	iteration=Math.floor(iteration);&#xA;	pathToPackage=parameters.pop();&#xA;	lastElement=null;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1.push(pathToPackage);&#xA;		parameter1[1][0]=parameters[1][2*n+1];&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;			parameter1[1][0]=(n+1)+&quot;. Action&quot;;&#xA;		parameter11=parameters[1][2*n];&#xA;		if(parameter11==null||parameter11==&quot;&quot;||parameter11==&quot; &quot;)&#xA;			parameter11=&quot;:&quot;+connectors[0][0].Name;&#xA;		parameter32=parameters[3][2*n];&#xA;		parameter12=parameters[1][2*n+2];&#xA;		if(parameter12==null||parameter12==&quot;&quot;||parameter12==&quot; &quot;)&#xA;			parameter12=&quot;:&quot;+connectors[0][0].Name;&#xA;		parameter31=parameters[3][2*n+2];&#xA;		do {&#xA;			if(parameter11.indexOf(&quot;,&quot;)&gt;0) {&#xA;				parameter1[1][1]=parameter11.substr(0,parameter11.indexOf(&quot;,&quot;));&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter11=parameter11.substr(parameter11.indexOf(&quot;,&quot;)+1);&#xA;				parameter1[3][1]=parameter31.substr(0,parameter31.indexOf(&quot;,&quot;));&#xA;				parameter31=parameter31.substr(parameter31.indexOf(&quot;,&quot;)+1);&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter11.length&gt;0)&#xA;					parameter11=parameter11+&quot;,&quot;;&#xA;				if(parameter31.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter31.length&gt;0)&#xA;					parameter31=parameter31+&quot;,&quot;;&#xA;			} else {&#xA;				parameter1[1][1]=parameter11;&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter1[3][1]=parameter31;&#xA;			}&#xA;			do {&#xA;				if(parameter12.indexOf(&quot;,&quot;)&gt;0) {&#xA;					parameter1[1][2]=parameter12.substr(0,parameter12.indexOf(&quot;,&quot;));&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter12=parameter12.substr(parameter12.indexOf(&quot;,&quot;)+1);&#xA;					parameter1[3][2]=parameter32.substr(0,parameter32.indexOf(&quot;,&quot;));&#xA;					parameter32=parameter32.substr(parameter32.indexOf(&quot;,&quot;)+1);&#xA;					if(parameter12.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.length&gt;0)&#xA;						parameter12=parameter12+&quot;,&quot;;&#xA;					if(parameter32.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter32.length&gt;0)&#xA;						parameter32=parameter32+&quot;,&quot;;&#xA;				} else {&#xA;					parameter1[1][2]=parameter12;&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter1[3][2]=parameter32;&#xA;				}&#xA;				connectors[2][0]=lastElement;&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.indexOf(&quot;,&quot;)&lt;0)&#xA;					lastElement=createSZcomplex(correctCR, thePackage, parameter1, connectors,1);&#xA;				else&#xA;					lastElement=createSZcomplex(correctCR, thePackage, parameter1, connectors,0);&#xA;			} while(parameter12.indexOf(&quot;,&quot;)&gt;0);	&#xA;		} while(parameter11.indexOf(&quot;,&quot;)&gt;0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from business state machine state diagram to system use case realization diagram&#xA;function createSZcomplex(correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var targetDiagram;&#xA;	var activityPartitions = [];	&#xA;	&#xA;	targetDiagram==null;&#xA;	conns = connectors1;&#xA;	if(parameters.length&lt;=4)&#xA;		return;&#xA;	targetDiagram=parameters.pop();&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;SUCRD&quot;,targetDiagram);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for SUCRD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Action&quot;;&#xA;	nameOfElement2=&quot;Object&quot;;&#xA;	nameOfElement3=&quot;Object&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0); &#xA;	//pattern-driven rule in nameElement1 - CchZiv({{pattern}})&#xA;	if(nameElement2.substr(0,2)==&quot;{{&quot; &amp;&amp; nameElement1.substr(nameElement1.length-2,2)==&quot;}}&quot;) {&#xA;		var namePattern=nameElement2.substr(2); //Retrieve name pattern from the first parameter&#xA;		namePattern=namePattern.substr(0,namePattern.length-2);		&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;); // Fetch XML content from URL&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			var nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;); //Retrieve package name&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			//activityPartitions=retrieveXMLNames(xmlContent, &quot;ActivityPartition&quot;, &quot;alias&quot;, &quot;UML:ActionState name=&quot;,0); //Retrieve partition names&#xA;			//activityPartitions=activityPartitions.sort();&#xA;			objectClasses=retrieveXMLNames(xmlContent, &quot;classname&quot;, &quot;stateflags&quot;, 'keywords&quot; value=', 1); //Retrieve objectclass names - option B: &quot;keywords&quot;, &quot;UML:ClassifierRole name=&quot;, 0&#xA;			objectClasses=objectClasses.sort();&#xA;			var project = Repository.GetProjectInterface();&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1); //the imported package&#xA;			if(result==null) //something wrong with the imported package&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null) //something wrong with the imported package&#xA;				return;&#xA;			var moving=renamePatternObjects(nameElement1, conns[0][1], objectClasses, null, subPackage, subChildPackage); //Rename object classes according to the values &#8203;&#8203;given in the objectClasses parameter&#xA;			if(subChildPackage !=null&amp;&amp;moving) //moving partitions from the changed pattern to the current package&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			return;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML from URL: &quot; + xhr.staxtusText);&#xA;		}&#xA;	}&#xA;	//Searching the target package&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredObjectElements(subPackage, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;		activityPartitions=desiredPackElements[3];&#xA;	} &#xA;	if(conns[2][0]!=null)&#xA;		delement3 = conns[2][0];&#xA;	//Searching the target diagram&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;	&#xA;&#xA;	if(delement1!=null)&#xA;		diagramObject1=searchedObjectinDiagram(subPackage, delement1);&#xA;	if(delement2!=null)&#xA;		diagramObject2=searchedObjectinDiagram(subPackage, delement2);	&#xA;	if(delement3!=null)&#xA;		diagramObject3=searchedObjectinDiagram(subPackage, delement3);&#xA;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //SrsZiv&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Action&quot; ); &#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				delement1new=true;&#xA;			} &#xA;			delement1=testElement;&#xA;		} //else it means that this element is outside of current package&#xA;	}&#xA;	if(delement2!=null) {&#xA;		var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+delement2.ElementID;&#xA;		var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;		var stateObject=null;&#xA;		var nameOfState=null;&#xA;		&#xA;		if(sqlRespond!=null)&#xA;			stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;		if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;			nameOfState=stateObject;	&#xA;		if(nameOfState==null) {//set the state of the current object&#xA;			if(nameElement2.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement2.indexOf(&quot;]&quot;)&gt;nameElement2.indexOf(&quot;[&quot;))&#xA;				nameOfState=nameElement2.substr(nameElement2.indexOf(&quot;[&quot;)+1,nameElement2.indexOf(&quot;]&quot;)-nameElement2.indexOf(&quot;[&quot;)-1);&#xA;			else&#xA;			if(params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;)&#xA;				nameOfState=params[3][1];&#xA;			if(nameOfState!=null&amp;&amp;nameOfState!=&quot;&quot;&amp;&amp;nameOfState!=&quot; &quot;) {&#xA;				var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+delement2.ElementID;&#xA;				Repository.Execute(sqlCommand);					&#xA;			}&#xA;		} else {&#xA;			if(nameElement2.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement2.indexOf(&quot;]&quot;)&gt;nameElement2.indexOf(&quot;[&quot;)&amp;&amp;&#xA;				nameElement2.substr(nameElement2.indexOf(&quot;[&quot;)+1,nameElement2.indexOf(&quot;]&quot;)-nameElement2.indexOf(&quot;[&quot;)-1)!=nameOfState||&#xA;				params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;&amp;&amp;nameOfState!=params[3][1]) //the found element has the other state&#xA;				delement2=null; //a new element&#xA;		}&#xA;	}	&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //SrsZiv&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement2;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(nameOfObject.indexOf(&quot;[&quot;)&lt;nameOfObject.indexOf(&quot;]&quot;)) {&#xA;					nameOfState=nameOfObject.substr(nameOfObject.indexOf(&quot;[&quot;)+1,nameOfObject.indexOf(&quot;]&quot;)-nameOfObject.indexOf(&quot;[&quot;)-1);&#xA;					var nameOfObject1=nameOfObject.substr(0,nameOfObject.indexOf(&quot;[&quot;))+nameOfObject.substr(nameOfObject.indexOf(&quot;]&quot;)+1);&#xA;					nameOfObject=nameOfObject1;&#xA;				}&#xA;				if(params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;) {&#xA;					if(params[3][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][1].substr(0,params[3][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][1];&#xA;				} else&#xA;				if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][0].substr(0,params[2][0].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][0];&#xA;				} else &#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(conns[0][0]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][0].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				} else&#xA;				if(conns[0][2]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][0].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				}&#xA;				if(nameOfObject==&quot;Start&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype==100;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				testElement.Update();&#xA;				if(nameOfState!=null&amp;&amp;nameOfObject!=&quot;Start&quot;) {&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);					&#xA;				}&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	if(delement3!=null) {&#xA;		var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+delement3.ElementID;&#xA;		var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;		var stateObject=null;&#xA;		var nameOfState=null;&#xA;		&#xA;		if(sqlRespond!=null)&#xA;			stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;		if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;			nameOfState=stateObject;	&#xA;		if(nameOfState==null) {//set the state of the current object&#xA;			if(nameElement3.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement3.indexOf(&quot;]&quot;)&gt;nameElement3.indexOf(&quot;[&quot;))&#xA;				nameOfState=nameElement3.substr(nameElement3.indexOf(&quot;[&quot;)+1,nameElement3.indexOf(&quot;]&quot;)-nameElement3.indexOf(&quot;[&quot;)-1);&#xA;			else&#xA;			if(params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;)&#xA;				nameOfState=params[3][2];&#xA;			if(nameOfState!=null&amp;&amp;nameOfState!=&quot;&quot;&amp;&amp;nameOfState!=&quot; &quot;) {&#xA;				var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+delement3.ElementID;&#xA;				Repository.Execute(sqlCommand);					&#xA;			}&#xA;		} else {&#xA;			if(nameElement3.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement3.indexOf(&quot;]&quot;)&gt;nameElement3.indexOf(&quot;[&quot;)&amp;&amp;&#xA;				nameElement3.substr(nameElement3.indexOf(&quot;[&quot;)+1,nameElement3.indexOf(&quot;]&quot;)-nameElement3.indexOf(&quot;[&quot;)-1)!=nameOfState||&#xA;				params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;&amp;&amp;nameOfState!=params[3][2]) //the found element has the other state&#xA;				delement3=null; //a new element&#xA;		}&#xA;	}	&#xA;	var delement3new=false;&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //SrsZiv&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement3;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(nameOfObject.indexOf(&quot;[&quot;)&lt;nameOfObject.indexOf(&quot;]&quot;)) {&#xA;					nameOfState=nameOfObject.substr(nameOfObject.indexOf(&quot;[&quot;)+1,nameOfObject.indexOf(&quot;]&quot;)-nameOfObject.indexOf(&quot;[&quot;)-1);&#xA;					var nameOfObject1=nameOfObject.substr(0,nameOfObject.indexOf(&quot;[&quot;))+nameOfObject.substr(nameOfObject.indexOf(&quot;]&quot;)+1);&#xA;					nameOfObject=nameOfObject1;&#xA;				} else&#xA;				if(params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;) {&#xA;					if(params[3][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][2].substr(0,params[3][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][2];&#xA;				} else&#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(params[2][1]!=null&amp;&amp;params[2][1]!=&quot;&quot;&amp;&amp;params[2][1]!=&quot; &quot;) {&#xA;					if(params[2][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][1].substr(0,params[2][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][1];&#xA;				} else &#xA;				if(conns[0][2]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][2].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				} else&#xA;				if(conns[0][0]!=null) {&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+conns[0][2].ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				}&#xA;				if(nameOfObject==&quot;End&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype=101;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				testElement.Update();&#xA;				if(nameOfState!=null) {&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);					&#xA;				}&#xA;				delement3new=true;&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the input element and the middle element&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //SrsZvi&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i); //a nie delement2?&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement2.Name==&quot;Start&quot;)&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement2.ElementID;&#xA;				connector.Update();&#xA;				delement1.Update();	&#xA;			}	&#xA;			//a connection must be created between the element to which the input element is connected at the output and the middle element&#xA;			var tmpObject as EA.Element;&#xA;			tmpObject=null;&#xA;			for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;				var connector1=delement2.Connectors.GetAt(i);&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement2.ElementID&amp;&amp;connector1.ClientID!=delement1.ElementID) {&#xA;					tmpObject=Repository.GetElementByID(connector1.ClientID);&#xA;					if(tmpObject.Type==&quot;Action&quot; ||tmpObject.Type==&quot;Activity&quot;)					&#xA;						break; //The input object is connected as an output object to another action&#xA;					else&#xA;						tmpObject=null;&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	//a connection must be created between the middle element and the output element&#xA;	if(delement1!=null&amp;&amp;delement3!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //RiviAvi&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i);&#xA;				if(delement3.Name!=&quot;End&quot;&amp;&amp;connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID||&#xA;				   delement3.Name==&quot;End&quot;&amp;&amp;connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement3.Name==&quot;End&quot;)&#xA;					connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement1.ElementID;&#xA;				connector.Update();&#xA;				delement3.Update();	&#xA;				delement1.Connectors.Refresh();&#xA;				delement3.Connectors.Refresh();&#xA;			}	&#xA;		}&#xA;	}&#xA;	var left=100;&#xA;	var top=-100;&#xA;	var thisActivityPartition as EA.DiagramObject;&#xA;	thisActivityPartition=null;&#xA;	if(delement1.ParentID&gt;0) {&#xA;		for( var i = 0; i &lt; testDiagram.DiagramObjects.Count; i++) {&#xA;			if((testDiagram.DiagramObjects.GetAt(i)).ElementID==delement1.ParentID) {&#xA;				thisActivityPartition=testDiagram.DiagramObjects.GetAt(i);&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(thisActivityPartition!=null) { &#xA;			left=thisActivityPartition.left+(thisActivityPartition.right-thisActivityPartition.left)/2;&#xA;			top=thisActivityPartition.top-100;&#xA;		}&#xA;	}&#xA;	//Add elements to the diagram&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null) {&#xA;			var ifPartition=false;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			if(delement3new==false&amp;&amp;delement1new==true&amp;&amp;delement3.ParentID&gt;0) {&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID==delement3.ParentID) {&#xA;						left=existDiagramObject.left+75; //25; //right=left+100&#xA;						top=existDiagramObject.top-(existDiagramObject.top-existDiagramObject.bottom)/2+23; //bottom=top-45&#xA;						ifPartition=true;&#xA;						break;&#xA;					}&#xA;				}					&#xA;			} 	&#xA;			if(!ifPartition) //true-delement3 was in the partition&#xA;				delement1new=true;&#xA;			if(delement1new) { //new element&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null) {&#xA;						if(existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			if(ifPartition&amp;&amp;diagramObject3!=null) {//delement3 was here in the Partition&#xA;				testDiagramObject.left=diagramObject3.left-100;//left;&#xA;				testDiagramObject.right=diagramObject3.left-20; //left+80;&#xA;				testDiagramObject.top=diagramObject3.top; //top;&#xA;				testDiagramObject.bottom=diagramObject3.bottom; //top-40;&#xA;				delement1.ParentID=delement3.ParentID;		&#xA;				delement1.Update();&#xA;			} else {&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+80;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-40;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;			&#xA;		}  else {&#xA;			Session.Output(&quot;Error at identifying element1-7720 line&quot;);&#xA;			return;&#xA;		}		&#xA;	} &#xA;	if(diagramObject2==null) {&#xA;		// Add the element2 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null) {&#xA;			var left=diagramObject1.right;&#xA;			var top=diagramObject1.bottom;&#xA;			if(delement2.ParentID&gt;0) {&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ ) {&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==delement2.ParentID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;						if(top-50&lt;partycjaObjTmp.bottom) {&#xA;							partycjaObjTmp.bottom=top-100;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}			&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2.Name==&quot;Start&quot;) { //InitialNode&#xA;				testDiagramObject.left=left-70;&#xA;				testDiagramObject.right=left-40;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-34;&#xA;			} else {			&#xA;				testDiagramObject.left=left+50;&#xA;				testDiagramObject.right=left+120;&#xA;				testDiagramObject.top=top-13;&#xA;				testDiagramObject.bottom=top-50;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;		}&#xA;	} &#xA;	if(diagramObject3==null) {&#xA;		// Add the element3 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null) {&#xA;			var left=diagramObject1.right;&#xA;			var top=diagramObject1.top;&#xA;			if(delement3.ParentID&gt;0) {&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ ) {&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==delement3.ParentID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				testDiagramObject.left=left+145;&#xA;				testDiagramObject.right=left+175;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-33;&#xA;			} else {&#xA;				testDiagramObject.left=left+50;&#xA;				testDiagramObject.right=left+120;&#xA;				testDiagramObject.top=top+50;&#xA;				testDiagramObject.bottom=top+13;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	} else {&#xA;		var left=diagramObject1.right;&#xA;		var top=diagramObject1.top;&#xA;		if(delement3.ParentID&gt;0) {&#xA;			diagramObject=null;&#xA;			for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;			{&#xA;				var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;				if(partycjaObjTmp.ElementID==delement3.ParentID) {&#xA;					diagramObject=partycjaObjTmp;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(diagramObject!=null) {&#xA;				if(diagramObject3.left&lt;diagramObject.left||diagramObject3.right&gt;diagramObject.right||diagramObject3.top&gt;diagramObject.top||diagramObject3.bottom&lt;diagramObject.bottom) {&#xA;					if(delement3.Name==&quot;End&quot;) {&#xA;						diagramObject3.left=left+145;&#xA;						diagramObject3.right=left+175;&#xA;						diagramObject3.top=top-3;&#xA;						diagramObject3.bottom=top-33;&#xA;					} else {&#xA;						diagramObject3.left=left+50;&#xA;						diagramObject3.right=left+120;&#xA;						diagramObject3.top=top+50;&#xA;						diagramObject3.bottom=top+13;&#xA;					}&#xA;					diagramObject3.Update();					&#xA;				}&#xA;			}&#xA;		} else {&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				diagramObject3.left=left+145;&#xA;				diagramObject3.right=left+175;&#xA;				diagramObject3.top=top-3;&#xA;				diagramObject3.bottom=top-33;&#xA;			} else {&#xA;				diagramObject3.left=left+50;&#xA;				diagramObject3.right=left+120;&#xA;				diagramObject3.top=top+50;&#xA;				diagramObject3.bottom=top+13;&#xA;			}&#xA;			diagramObject3.Update();				&#xA;		}&#xA;	}&#xA;	return delement2;&#xA;}&#xA;//Searching for future package elements in the target diagram&#xA;function getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3, mode) {&#xA;	var activityPartitions = [];&#xA;	var parameters = [ null,null,null,null]&#xA;	var currentElement as EA.Element;&#xA;	var cotoParent as EA.Element;&#xA;	var nameOfElement;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	ifComponent=false;&#xA;	//activityPartitions=null;&#xA;	&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(currentElement.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(currentElement.Type==&quot;Object&quot;) {&#xA;			var nameOfState;&#xA;			nameOfElement=currentElement.Name;&#xA;			var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+currentElement.ElementID;&#xA;			var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;			var stateObject=null;&#xA;			if(sqlRespond!=null)&#xA;				stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;			if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;				nameOfElement=nameOfElement+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;			if(cotoParent!=null)&#xA;				nameOfElement=nameOfElement+&quot;:&quot;+cotoParent.Name;&#xA;		} else&#xA;			nameOfElement=currentElement.Name;&#xA;&#xA;		if(nameOfElement==nameElement1||currentElement.Type==&quot;Component&quot;&amp;&amp;(&quot;:&quot;+nameOfElement==nameElement1))&#xA;			delement1=currentElement;&#xA;		else 		&#xA;		if(nameOfElement==nameElement2)&#xA;			delement2=currentElement;&#xA;		else 		&#xA;		if(nameOfElement==nameElement3||currentElement.Type==&quot;Component&quot;&amp;&amp;(&quot;:&quot;+nameOfElement==nameElement3))&#xA;			delement3=currentElement;&#xA;		if(currentElement.Type==&quot;Component&quot;)&#xA;			ifComponent=true;&#xA;		if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;delement3!=null)&#xA;			break;&#xA;		if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;			var brakDiagObj=false;&#xA;			for(var k = 0; k&lt; activityPartitions.length; k++) {&#xA;				if((activityPartitions[k][0]!=null&amp;&amp;activityPartitions[k][0]).ElementID==currentElement.ElementID) {&#xA;					activityPartitions[k][1]=currentElement;&#xA;					brakDiagObj=true;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(!brakDiagObj)&#xA;				activityPartitions.push([null, currentElement]);&#xA;			for ( var k = 0 ; k &lt; currentElement.Elements.Count ; k++ )&#xA;			{&#xA;				var currentElement1 as EA.Element;&#xA;				var cotoParent1 as EA.Element;&#xA;				var nameOfElement1;&#xA;&#xA;				currentElement1 = currentElement.Elements.GetAt( k );&#xA;				if(currentElement1.ClassifierID&gt;0)&#xA;					cotoParent1=Repository.GetElementByID(currentElement1.ClassifierID);&#xA;				else&#xA;					cotoParent1=null;&#xA;				if(currentElement1.Type==&quot;Object&quot;) {&#xA;					var nameOfState;&#xA;					nameOfElement1=currentElement1.Name;&#xA;					var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+currentElement1.ElementID;&#xA;					var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;					var stateObject=null;&#xA;					if(sqlRespond!=null)&#xA;						stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfElement1=nameOfElement1+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;					if(cotoParent1!=null)&#xA;						nameOfElement1=nameOfElement1+&quot;:&quot;+cotoParent1.Name;&#xA;				} else&#xA;					nameOfElement1=currentElement1.Name;&#xA;				&#xA;				if(nameOfElement1==nameElement1) //RevBa()u&#xA;					delement1=currentElement1;&#xA;				else 		&#xA;				if(nameOfElement1==nameElement2) //RevBau()&#xA;					delement2=currentElement1;&#xA;				else 		&#xA;				if(nameOfElement1==nameElement3) //RevBau()&#xA;					delement3=currentElement1;&#xA;				if(delement1!=null&amp;&amp;(delement2!=null||nameElement2==null)&amp;&amp;(delement3!=null||nameElement3==null))&#xA;					break;&#xA;				if(currentElement1.Type==&quot;ActivityPartition&quot;) {&#xA;					var brakDiagObj=false;&#xA;					for(var l = 0; m&lt; activityPartitions.length; l++) {&#xA;						if((activityPartitions[l][0]!=null&amp;&amp;activityPartitions[l][0]).ElementID==currentElement.ElementID) {&#xA;							activityPartitions[l][1]=currentElement1;&#xA;							brakDiagObj=true;&#xA;							break;&#xA;						}&#xA;					}&#xA;					if(!brakDiagObj)&#xA;						activityPartitions.push([null, currentElement1]);					&#xA;					for ( var l = 0 ; l &lt; currentElement1.Elements.Count ; l++ )&#xA;					{&#xA;						var currentElement2 as EA.Element;&#xA;						var cotoParent2 as EA.Element;&#xA;						var nameOfElement2;&#xA;						&#xA;						currentElement2 = currentElement1.Elements.GetAt( l );&#xA;						if(currentElement2.ClassifierID&gt;0)&#xA;							cotoParent2=Repository.GetElementByID(currentElement2.ClassifierID);&#xA;						else&#xA;							cotoParent2=null;&#xA;						if(currentElement2.Type==&quot;Object&quot;) {&#xA;							var nameOfState;&#xA;							&#xA;							nameOfElement2=currentElement2.Name;&#xA;							var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+currentElement2.ElementID;&#xA;							var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;							var stateObject=null;&#xA;							if(sqlRespond!=null)&#xA;								stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;								nameOfElement2=nameOfElement2+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;							if(cotoParent2!=null)&#xA;								nameOfElement2=nameOfElement2+&quot;:&quot;+cotoParent2.Name;&#xA;						} else&#xA;							nameOfElement2=currentElement2.Name;&#xA;						&#xA;						if(nameOfElement2==nameElement1) //RevBa()u&#xA;							delement1=currentElement2;&#xA;						else 		&#xA;						if(nameOfElement2==nameElement2) //RevBau()&#xA;							delement2=currentElement2;&#xA;						else 		&#xA;						if(nameOfElement2==nameElement3) //RevBau()&#xA;							delement3=currentElement2;&#xA;						if(delement1!=null&amp;&amp;(delement2!=null||nameElement2==null)&amp;&amp;(delement3!=null||nameElement3==null))&#xA;							break;						&#xA;					}					&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	if(ifComponent&amp;&amp;delement1!=null&amp;&amp;delement3!=null&amp;&amp;delement2==null) {&#xA;		for(var k = 0; k&lt; delement1.Connectors.Count; k++) {&#xA;			var currentElement as EA.Connector;&#xA;			currentElement=delement1.Connectors.GetAt(k);&#xA;			if(currentElement.ClientID==delement1.ElementID&amp;&amp;currentElement.SupplierID==delement3.ElementID&amp;&amp;currentElement.Name==nameElement2) {&#xA;				delement2=currentElement;&#xA;				break;&#xA;			}&#xA;		}	&#xA;	}			&#xA;	parameters[0]=delement1;&#xA;	parameters[1]=delement2;&#xA;	parameters[2]=delement3;&#xA;	parameters[3]=activityPartitions;&#xA;	return parameters;&#xA;}&#xA;//Searching for future package elements in the target diagram&#xA;function getDesiredPackSequences(delements, nameElement1, nameElement2, nameElement3, mode) {&#xA;	var parameters = [ null,null,null,null]&#xA;	var currentElement as EA.Element;&#xA;	var cotoParent as EA.Element;&#xA;	var nameConnector2;&#xA;	var nameConnector2Parameter;&#xA;	var nameConnector4;&#xA;	var nameConnector4Parameter;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Connector;&#xA;	var delement3 as EA.Element;&#xA;	var delement4 as EA.Connector;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	delement4 = null;&#xA;	&#xA;	//downLoad&lt;Requests&gt;::Request&#xA;	if(nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;) {&#xA;		if(nameElement2.indexOf(&quot;::&quot;)&gt;-1)&#xA;			nameConnector2 = nameElement2.substr(0,nameElement2.indexOf(&quot;::&quot;));&#xA;		else&#xA;			nameConnector2 = nameElement2;&#xA;		if(nameConnector2.indexOf(&quot;&lt;&quot;)&gt;-1&amp;&amp;nameConnector2.indexOf(&quot;&gt;&quot;)&gt;nameConnector2.indexOf(&quot;&lt;&quot;)) {&#xA;			nameConnector2Parameter = nameConnector2.substr(nameConnector2.indexOf(&quot;&lt;&quot;)+1,nameConnector2.indexOf(&quot;&gt;&quot;)-nameConnector2.indexOf(&quot;&lt;&quot;)-1);&#xA;			nameConnector2 = nameElement2.substr(0,nameElement2.indexOf(&quot;&lt;&quot;));&#xA;		} else&#xA;			nameConnector2Parameter=&quot;&quot;;&#xA;		if(nameElement2.indexOf(&quot;::&quot;)&gt;-1)&#xA;			nameConnector4Parameter=nameElement2.substr(nameElement2.indexOf(&quot;::&quot;)+2);&#xA;		else&#xA;			nameConnector4Parameter=&quot;&quot;;&#xA;	}&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.Type==&quot;Sequence&quot;) {&#xA;			if(currentElement.Name==nameElement1) &#xA;				delement1=currentElement;&#xA;			else 		&#xA;			if(currentElement.Name==nameElement3)&#xA;				delement3=currentElement;&#xA;		}&#xA;	}&#xA;	if(delement1!=null&amp;&amp;delement1.Connectors.Count&gt;0) {&#xA;		for(var k = 0; k&lt; delement1.Connectors.Count; k++) {&#xA;			var connector = delement1.Connectors.GetAt(k);&#xA;			var sqlCommand=&quot;select PDATA4 from t_connector where Connector_ID = &quot;+connector.ConnectorID;&#xA;			var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;			var returnObject=null;&#xA;			if(sqlRespond!=null) {&#xA;				var start = sqlRespond.indexOf(&quot;&lt;PDATA4&gt;&quot;)+8;&#xA;				var koniec= sqlRespond.indexOf(&quot;&lt;/PDATA4&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;PDATA4&gt;&quot;)-8;&#xA;				returnObject=sqlRespond.substr(start, koniec);&#xA;			}&#xA;			if(delement2==null&amp;&amp;(delement3!=null&amp;&amp;connector.Name==nameConnector2&amp;&amp;connector.ClientID==delement1.ElementID&amp;&amp;connector.SupplierID==delement3.ElementID||&#xA;				delement3==null&amp;&amp;connector.Name==nameConnector2&amp;&amp;connector.ClientID==delement1.ElementID&amp;&amp;connector.SupplierID==delement1.ElementID)) //samecall&#xA;				delement2=getDesiredPackSequencesConnectors(connector,returnObject,nameConnector2Parameter);&#xA;			else&#xA;			if(delement4==null&amp;&amp;(delement3!=null&amp;&amp;connector.Name==&quot;&quot;&amp;&amp;connector.ClientID==delement3.ElementID&amp;&amp;connector.SupplierID==delement1.ElementID||&#xA;				delement3==null&amp;&amp;connector.Name==&quot;&quot;&amp;&amp;connector.ClientID==delement1.ElementID&amp;&amp;connector.SupplierID==delement1.ElementID))&#xA;				delement4=getDesiredPackSequencesConnectors(connector,returnObject,nameConnector4Parameter);	&#xA;			if(delement2!=null&amp;&amp;delement4!=null)&#xA;				break;&#xA;		}&#xA;	}&#xA;	if(delement3!=null&amp;&amp;delement3.Connectors.Count&gt;0) {&#xA;		for(var k = 0; k&lt; delement3.Connectors.Count; k++) {&#xA;			if(delement2!=null&amp;&amp;delement4!=null)&#xA;				break;&#xA;			var connector = delement3.Connectors.GetAt(k);&#xA;			var sqlCommand=&quot;select PDATA4 from t_connector where Connector_ID = &quot;+connector.ConnectorID;&#xA;			var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;			var returnObject=null;&#xA;			if(sqlRespond!=null) {&#xA;				var start = sqlRespond.indexOf(&quot;&lt;PDATA4&gt;&quot;)+8;&#xA;				var koniec= sqlRespond.indexOf(&quot;&lt;/PDATA4&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;PDATA4&gt;&quot;)-8;&#xA;				returnObject=sqlRespond.substr(start, koniec);&#xA;			}&#xA;			if(delement2!=null&amp;&amp;(delement1!=null&amp;&amp;connector.Name==nameConnector2&amp;&amp;connector.ClientID==delement3.ElementID&amp;&amp;connector.SupplierID==delement1.ElementID||&#xA;				delement1==null&amp;&amp;connector.Name==nameConnector2&amp;&amp;connector.ClientID==delement3.ElementID&amp;&amp;connector.SupplierID==delement3.ElementID))&#xA;				delement2=getDesiredPackSequencesConnectors(connector,returnObject,nameConnector2Parameter);&#xA;			else&#xA;			if(delement4!=null&amp;&amp;(delement1!=null&amp;&amp;connector.Name==&quot;&quot;&amp;&amp;connector.ClientID==delement1.ElementID&amp;&amp;connector.SupplierID==delement3.ElementID||&#xA;				delement1==null&amp;&amp;connector.Name==&quot;&quot;&amp;&amp;connector.ClientID==delement3.ElementID&amp;&amp;connector.SupplierID==delement3.ElementID))&#xA;				delement4=getDesiredPackSequencesConnectors(connector,returnObject,nameConnector4Parameter);		&#xA;		}&#xA;	}	&#xA;	parameters[0]=delement1;&#xA;	parameters[1]=delement2;&#xA;	parameters[2]=delement3;&#xA;	parameters[3]=delement4;&#xA;	return parameters;&#xA;}&#xA;function getDesiredPackSequencesConnectors(connector,returnObject,nameConnectorParameter) {&#xA;	var connParameter=connector.TransitionGuard;&#xA;	&#xA;	if(returnObject!=null&amp;&amp;returnObject!=&quot;&quot;&amp;&amp;returnObject==&quot;0&quot;&amp;&amp;connParameter!=null&amp;&amp;connParameter.indexOf(&quot;paramsDlg=&quot;)&gt;-1) {&#xA;		connParameter=connParameter.substr(connParameter.indexOf(&quot;paramsDlg=&quot;)+10);&#xA;		if(connParameter!=null&amp;&amp;connParameter!=&quot;&quot;)&#xA;			connParameter=connParameter.substr(0,connParameter.indexOf(&quot;;&quot;));&#xA;	} else&#xA;	if(returnObject!=null&amp;&amp;returnObject!=&quot;&quot;&amp;&amp;returnObject==&quot;1&quot;&amp;&amp;connParameter!=null&amp;&amp;connParameter!=&quot;&quot;) {&#xA;		connParameter=connParameter.substr(connParameter.indexOf(&quot;retval=&quot;)+7);&#xA;		if(connParameter!=null&amp;&amp;connParameter!=&quot;&quot;)&#xA;			connParameter=connParameter.substr(0,connParameter.indexOf(&quot;;&quot;));&#xA;	} else&#xA;		connParameter=&quot;&quot;;&#xA;	if(nameConnectorParameter!=null&amp;&amp;nameConnectorParameter!=&quot;&quot;&amp;&amp;connParameter!=null&amp;&amp;connParameter!=&quot;&quot;&amp;&amp;connParameter==nameConnectorParameter||&#xA;		(nameConnectorParameter==null||nameConnectorParameter==&quot;&quot;)&amp;&amp;(connParameter==null||connParameter==&quot;&quot;||connParameter==&quot;null&quot;||connParameter==&quot;void&quot;)) {&#xA;		return connector;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Return all messages from the testDiagram&#xA;function getDesiredDiagramSequences(testDiagram) {&#xA;	var diagramConnectors = [];&#xA;	var objectDiagram as EA.DiagramObject;&#xA;	&#xA;	for( var k = 0; k&lt;testDiagram.DiagramObjects.Count; k++) {&#xA;		var objectDiagram=testDiagram.DiagramObjects.GetAt(k);&#xA;		var elementDiagram=Repository.GetElementByID(objectDiagram.ElementID);&#xA;		if(elementDiagram.Type==&quot;Sequence&quot;) {&#xA;			for( var l = 0; l&lt;elementDiagram.Connectors.Count; l++) {&#xA;				var connector=elementDiagram.Connectors.GetAt(l);&#xA;				if(connector.ClientID==elementDiagram.ElementID)&#xA;					diagramConnectors.push(connector)&#xA;			}&#xA;		}&#xA;	}&#xA;	if(diagramConnectors.length&lt;=0)&#xA;		return null;&#xA;	return diagramConnectors;&#xA;}	&#xA;//Searching for future package objects connected to nameElement1 with input as nameElement2 and output as nameElement3&#xA;function getDesiredObjectElements(subPackage, nameElement1, nameElement2, nameElement3) {&#xA;	var parameters = [ null,null,null,null]&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	var activityPartition=[];&#xA;	&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; subPackage.Elements.Count ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;&#xA;		currentElement = subPackage.Elements.GetAt( j );&#xA;		if(delement1==null&amp;&amp;currentElement.Name==nameElement1)  {//CchZiv&#xA;			delement1=currentElement;&#xA;			//break;&#xA;		}&#xA;		if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;			activityPartition.push(currentElement);&#xA;			for ( var k = 0 ; k &lt; currentElement.Elements.Count ; k++ )&#xA;			{&#xA;				var currentElement1 as EA.Element;&#xA;&#xA;				currentElement1 = currentElement.Elements.GetAt( k );&#xA;				if(delement1==null&amp;&amp;currentElement1.Name==nameElement1) {//CchZiv&#xA;					delement1=currentElement1;&#xA;					break;&#xA;				}&#xA;				if(currentElement1.Type==&quot;ActivityPartition&quot;) {&#xA;					activityPartition.push(currentElement1);&#xA;					for ( var l = 0 ; l &lt; currentElement1.Elements.Count ; l++ )&#xA;					{&#xA;						var currentElement2 as EA.Element;&#xA;						&#xA;						currentElement2 = currentElement1.Elements.GetAt( l );&#xA;						if(delement1==null&amp;&amp;currentElement2.Name==nameElement1) { //CchZiv&#xA;							delement1=currentElement2;&#xA;							break;&#xA;						}&#xA;					}					&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	if(delement1==null)&#xA;		return parameters;&#xA;	parameters[0]=delement1;&#xA;	var tmpObjectIn as EA.Element;&#xA;	var tmpObjectOut as EA.Element;&#xA;	tmpObjectIn=null;&#xA;	tmpObjectOut=null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for( var j = 0; j &lt; delement1.Connectors.Count; j++) {&#xA;		var connector = delement1.Connectors.GetAt(j);&#xA;		&#xA;		if(delement3==null&amp;&amp;connector.SupplierID==delement1.ElementID) { //input object&#xA;			tmpObjectIn=Repository.GetElementByID(connector.ClientID);&#xA;			if(tmpObjectIn.Type==&quot;Object&quot;) {&#xA;				var tmpClassObject = Repository.GetElementByID(tmpObjectIn.ClassifierID);&#xA;				if(nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;&amp;&amp;nameElement3.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement3.indexOf(&quot;[&quot;)&lt;nameElement3.indexOf(&quot;]&quot;)) {&#xA;					var nameTmpElement=nameElement3.substr(0,nameElement3.indexOf(&quot;[&quot;))+nameElement3.substr(nameElement3.indexOf(&quot;]&quot;)+1);&#xA;					if(tmpObjectIn.Name+&quot;:&quot;+tmpClassObject.Name==nameTmpElement) {&#xA;						var nameOfStateTarget=nameElement3.substr(nameElement3.indexOf(&quot;[&quot;)+1, nameElement3.indexOf(&quot;]&quot;)-nameElement3.indexOf(&quot;[&quot;)-1);&#xA;						var nameOfStateSource=null;&#xA;						var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+tmpObjectIn.ElementID;&#xA;						var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;						var stateObject=null;&#xA;						if(sqlRespond!=null)&#xA;							stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;						if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;							nameOfStateSource=stateObject;&#xA;						if(nameOfStateSource==null||nameOfStateTarget==&quot;&quot;||nameOfStateSource==nameOfStateTarget)&#xA;							delement3=tmpObjectIn;	&#xA;					}						&#xA;				} else&#xA;				if(tmpObjectIn.Name+&quot;:&quot;+tmpClassObject.Name==nameElement3)&#xA;					delement3=tmpObjectIn;&#xA;			}&#xA;		} else&#xA;		if(delement2==null&amp;&amp;connector.ClientID==delement1.ElementID) { //output object&#xA;			tmpObjectOut=Repository.GetElementByID(connector.SupplierID);&#xA;			if(tmpObjectOut.Type==&quot;Object&quot;) {&#xA;				var tmpClassObject = Repository.GetElementByID(tmpObjectOut.ClassifierID);&#xA;				if(nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;&amp;&amp;nameElement2.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement2.indexOf(&quot;[&quot;)&lt;nameElement2.indexOf(&quot;]&quot;)) {&#xA;					var nameTmpElement=nameElement2.substr(0,nameElement2.indexOf(&quot;[&quot;))+nameElement2.substr(nameElement2.indexOf(&quot;]&quot;)+1);&#xA;					if(tmpObjectOut.Name+&quot;:&quot;+tmpClassObject.Name==nameElement2) {&#xA;						var nameOfStateTarget=nameElement3.substr(nameElement2.indexOf(&quot;[&quot;)+1, nameElement2.indexOf(&quot;]&quot;)-nameElement2.indexOf(&quot;[&quot;)-1);&#xA;						var nameOfStateSource=null;&#xA;						var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+tmpObjectOut.ElementID;&#xA;						var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;						var stateObject=null;&#xA;						if(sqlRespond!=null)&#xA;							stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;						if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;							nameOfStateSource=stateObject;&#xA;						if(nameOfStateSource==null||nameOfStateTarget==&quot;&quot;||nameOfStateSource==nameOfStateTarget)&#xA;							delement2=tmpObjectOut;	&#xA;					}						&#xA;					else&#xA;					if(tmpObjectOut.Name+&quot;:&quot;+tmpClassObject.Name==nameTmpElement)&#xA;						delement2=tmpObjectOut;						&#xA;				} else&#xA;				if(tmpObjectOut.Name+&quot;:&quot;+tmpClassObject.Name==nameElement2)&#xA;					delement2=tmpObjectOut;&#xA;			}&#xA;		} &#xA;		if(delement2!=null&amp;&amp;delement3!=null)&#xA;			break;&#xA;	}&#xA;	parameters[1]=delement2;&#xA;	parameters[2]=delement3;&#xA;	parameters[3]=activityPartition;&#xA;&#xA;	return parameters;&#xA;}&#xA;//Searching for future diagram objects in the target diagram&#xA;function getDesiredDiagObjects(diagramObjects, nameElement1, nameElement2, nameElement3) {&#xA;	//var activityPartitions = [];&#xA;	var parameters = [ null,null,null,null]&#xA;	var coto as EA.Element;&#xA;	var cotoParent as EA.Element;&#xA;	var nameOfElement;	&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var i = 0, j=0 ; i &lt; diagramObjects.Count ; i++ )&#xA;	{&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID&gt;0)&#xA;			coto=Repository.GetElementByID(diagramObject.ElementID);&#xA;		else&#xA;			coto=null;&#xA;		if(coto.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(coto.Type==&quot;Object&quot;) {&#xA;			var nameOfState;&#xA;			&#xA;			nameOfElement=coto.Name;&#xA;			var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+coto.ElementID;&#xA;			var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;			var stateObject=null;&#xA;			if(sqlRespond!=null)&#xA;				stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;			if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;				nameOfElement=nameOfElement+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;			if(cotoParent!=null)&#xA;				nameOfElement=nameOfElement+&quot;:&quot;+cotoParent.Name;&#xA;		} else&#xA;			nameOfElement=coto.Name;&#xA;		&#xA;		if(diagramObject1==null&amp;&amp;(nameOfElement==nameElement1||coto.Type==&quot;Component&quot;&amp;&amp;(&quot;:&quot;+nameOfElement==nameElement1))) //verification of an existing element in the B diagram&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		if(diagramObject2==null&amp;&amp;(nameOfElement==nameElement2)) //verification of an existing element in the B diagram&#xA;			diagramObject2=diagramObject; &#xA;		else&#xA;		if(diagramObject3==null&amp;&amp;(nameOfElement==nameElement3||coto.Type==&quot;Component&quot;&amp;&amp;(&quot;:&quot;+nameOfElement==nameElement3))) //verification of an existing element in the B diagram&#xA;			diagramObject3=diagramObject; 		//else&#xA;		//if(coto.Type==&quot;ActivityPartition&quot;)&#xA;		//	activityPartitions.push([diagramObject, null]);			&#xA;	}&#xA;	parameters[0]=diagramObject1;&#xA;	parameters[1]=diagramObject2;&#xA;	parameters[2]=diagramObject3;&#xA;	//parameters[3]=activityPartitions;	&#xA;	return parameters;&#xA;}&#xA;//Get the target package and target diagram, and if they don't exist, create them&#xA;function getTargetPackage(thePackage, type, nameOfSubPack) {&#xA;	var parameters = [ null,null];&#xA;	var childPackage as EA.Package;&#xA;	var subChildPackage as EA.Package;&#xA;	var theParentPackage as EA.Package;&#xA;	var nameOfsubPackageDiagram;&#xA;	var nameOfSubPackage;&#xA;	var nameOftheParent;&#xA;	var testSMDiagram; //Business State Diagram&#xA;	var testDiagram as EA.Diagram;	&#xA;	var stateMachine as EA.Element;&#xA;	&#xA;	if(type!=null&amp;&amp;type==&quot;SUCRD&quot;&amp;&amp;nameOfSubPack!=null&amp;&amp;nameOfSubPack.indexOf(&quot;,&quot;)&gt;-1) {&#xA;		nameOfsubPackageDiagram=nameOfSubPack.substr(0,nameOfSubPack.indexOf(&quot;,&quot;));&#xA;		nameOfSubPackage=nameOfSubPack.substr(nameOfSubPack.indexOf(&quot;,&quot;)+1);&#xA;	} else {&#xA;		nameOfSubPackage=nameOfSubPack;&#xA;		nameOfsubPackageDiagram=thePackage.Name;&#xA;	}&#xA;	if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;		tmp=nameOfsubPackageDiagram;&#xA;		nameOfsubPackageDiagram=nameOfSubPackage;&#xA;		nameOfSubPackage=tmp;&#xA;	} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;		tmp=nameOfsubPackageDiagram;&#xA;		nameOfsubPackageDiagram=nameOfSubPackage;&#xA;		nameOfSubPackage=tmp;		&#xA;	}&#xA;	subChildPackage=null;	&#xA;	// Get the parent package of the currently selected package&#xA;	theParentPackage = Repository.GetPackageByID(thePackage.ParentID); //Business Process Layer&#xA;	if(type==&quot;SEQD&quot;)&#xA;		nameOftheParent=theParentPackage.Name;&#xA;	if(thePackage.Name === &quot;Decomposition Processes&quot;||thePackage.Name === &quot;Business Use Cases&quot;)	&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID);&#xA;	if(thePackage.Name === &quot;Business Use Cases&quot;||thePackage.Name === &quot;Decomposition Processes&quot;&amp;&amp;type==&quot;BURD&quot;)&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID);&#xA;	if(type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;||type==&quot;SUCRD&quot;||type==&quot;IUCD&quot;||type==&quot;SEQD&quot;)&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //Business View&#xA;	if(type==&quot;SUCRD&quot;||type==&quot;IUCD&quot;||type==&quot;SEQD&quot;) {&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //System View&#xA;		if(type==&quot;SUCRD&quot;&amp;&amp;thePackage.Name!=&quot;Business Class&quot;&amp;&amp;thePackage.Name!=&quot;Business State&quot;||type==&quot;SEQD&quot;)&#xA;			theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //Model&#xA;		if(type==&quot;SEQD&quot;)&#xA;			theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //Model&#xA;	}&#xA;	if(type!=null&amp;&amp;type==&quot;CMPD&quot;) {&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //System View&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //System View&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //System View&#xA;	}&#xA;	// Recursively process any child packages of the parent package of the currently selected package&#xA;	var childPackageEnumerator = new Enumerator( theParentPackage.Packages );&#xA;	if(type==&quot;BURD&quot;||type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;||type==&quot;SUCRD&quot;||type==&quot;IUCD&quot;||type==&quot;SEQD&quot;) {&#xA;		while ( !childPackageEnumerator.atEnd() )&#xA;		{&#xA;			childPackage = childPackageEnumerator.item();&#xA;				&#xA;			if((type==&quot;BURD&quot;)&amp;&amp;childPackage.Name === &quot;Business View&quot;||&#xA;				(type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;)&amp;&amp;childPackage.Name === &quot;Logic Layer&quot;)&#xA;				break;&#xA;			else if((type==&quot;SUCRD&quot;)&amp;&amp;childPackage.Name === &quot;System View&quot;)&#xA;				break;&#xA;			else if((type==&quot;IUCD&quot;)&amp;&amp;childPackage.Name === &quot;Internal Layer&quot;)&#xA;				break;				&#xA;			else if((type==&quot;SEQD&quot;)&amp;&amp;childPackage.Name === &quot;Deployment View&quot;)&#xA;				break;	&#xA;			childPackageEnumerator.moveNext();&#xA;		}	&#xA;		if(type==&quot;BURD&quot;&amp;&amp;childPackage.Name !== &quot;Business View&quot;||&#xA;			(type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;)&amp;&amp;childPackage.Name !== &quot;Logic Layer&quot;||&#xA;		    (type==&quot;SUCRD&quot;)&amp;&amp;childPackage.Name !== &quot;System View&quot;||(type==&quot;IUCD&quot;)&amp;&amp;childPackage.Name !== &quot;Internal Layer&quot;||&#xA;			childPackage.Name !== &quot;Deployment View&quot;&amp;&amp;type==&quot;SEQD&quot;) &#xA;		{&#xA;			var packages as EA.Collection;&#xA;			packages = theParentPackage.Packages;&#xA;			var nameOfPackage = &quot;Business View&quot;;&#xA;			&#xA;			if(type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;)&#xA;				nameOfPackage = &quot;Logic Layer&quot;;&#xA;			else if(type==&quot;SUCRD&quot;)&#xA;				nameOfPackage = &quot;System View&quot;;					&#xA;			else if(type==&quot;IUCD&quot;)&#xA;				nameOfPackage = &quot;Internal Layer&quot;;	&#xA;			else if(type==&quot;SEQD&quot;)&#xA;				nameOfPackage = &quot;Deployment View&quot;;	&#xA;			// Create package&#xA;			var subPackage as EA.Package;&#xA;			var subPackage1 as EA.Package;&#xA;			&#xA;			if(type==&quot;BURD&quot;||type==&quot;SUCRD&quot;)&#xA;				subPackage = CreatePackage(/*theParentPackage, */packages, nameOfPackage, &quot;Activity&quot;);&#xA;			else if(type==&quot;IUCD&quot;)&#xA;				subPackage = CreatePackage(/*theParentPackage, */packages, nameOfPackage, &quot;UseCase&quot;);&#xA;			else if(type==&quot;SEQD&quot;)&#xA;				subPackage = CreatePackage(/*theParentPackage, */packages, nameOfPackage, &quot;Sequence&quot;);&#xA;			else if(type==&quot;BSTMD&quot;)&#xA;				subPackage = CreatePackage(/*theParentPackage, */packages, nameOfPackage, &quot;Class&quot;); &#xA;			theParentPackage=subPackage;		&#xA;			// Create subpackage&#xA;			packages = subPackage.Packages;&#xA;		} else&#xA;			theParentPackage=childPackage;&#xA;	}&#xA;	var childPackageEnumerator = new Enumerator( theParentPackage.Packages ); //Business View&#xA;	while ( !childPackageEnumerator.atEnd() )&#xA;	{&#xA;&#xA;		childPackage = childPackageEnumerator.item();  //Business Proces Layer/Logic Layer&#xA;			&#xA;		if((type==&quot;BUCD&quot;||type==&quot;PDD&quot;)&amp;&amp;childPackage.Name === &quot;Decomposition Layer&quot;)&#xA;		{&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if((type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === &quot;Decomposition Processes&quot;) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				} else&#xA;				if(type!=null&amp;&amp;type==&quot;BUCD&quot;&amp;&amp;childPackage.Packages.GetAt(i).Name === &quot;Business Use Cases&quot;) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if((type==&quot;BURD&quot;)&amp;&amp;childPackage.Name === &quot;Business Process Layer&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;type==&quot;BURD&quot;&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOfSubPackage) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;SUCD&quot;&amp;&amp;childPackage.Name === &quot;System Use Case&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;SUCD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOfSubPackage) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(	type==&quot;BSTMD&quot;&amp;&amp;childPackage.Name === &quot;Business State&quot;) {&#xA;			for(i=0;i&lt;childPackage.Elements.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;BSTMD&quot;)&amp;&amp;childPackage.Elements.GetAt(i).Name === nameOfSubPackage) {&#xA;					stateMachine=childPackage.Elements.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;CLASSD&quot;&amp;&amp;childPackage.Name === &quot;Business Class&quot;) {&#xA;			subChildPackage=childPackage;&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;SUCRD&quot;&amp;&amp;childPackage.Name === &quot;User Layer&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;SUCRD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOfsubPackageDiagram) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;IUCD&quot;&amp;&amp;childPackage.Name === &quot;Internal Use Cases&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;IUCD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOfsubPackageDiagram) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;SEQD&quot;&amp;&amp;childPackage.Name === &quot;Sequence Layer&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;SEQD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOftheParent) { //1.Request service&#xA;					subChildPackage=childPackage.Packages.GetAt(i); //1.Request service&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;CMPD&quot;&amp;&amp;childPackage.Name === &quot;Component Layer&quot;) {&#xA;			subChildPackage=childPackage;&#xA;			break;&#xA;		}			&#xA;		childPackageEnumerator.moveNext();&#xA;	}&#xA;	if((type==null||type==&quot;&quot;||type==&quot;PDD&quot;||type==&quot;BUCD&quot;)&amp;&amp;childPackage.Name !== &quot;Decomposition Layer&quot; ||&#xA;		type==&quot;BURD&quot;&amp;&amp;childPackage.Name !== &quot;Business Process Layer&quot;||&#xA;		type==&quot;SUCD&quot;&amp;&amp;childPackage.Name !== &quot;System Use Case&quot;||&#xA;		type==&quot;BSTMD&quot;&amp;&amp;childPackage.Name !== &quot;Business State&quot;||&#xA;		type==&quot;CLASSD&quot;&amp;&amp;childPackage.Name !== &quot;Business Class&quot;||&#xA;		type==&quot;SUCRD&quot;&amp;&amp;childPackage.Name !== &quot;User Layer&quot;||&#xA;		type==&quot;IUCD&quot;&amp;&amp;childPackage.Name !== &quot;Internal Use Cases&quot;||&#xA;		type==&quot;SEQD&quot;&amp;&amp;childPackage.Name !== &quot;Sequence Layer&quot;||&#xA;		type==&quot;CMPD&quot;&amp;&amp;childPackage.Name !== &quot;Component Layer&quot;) {&#xA;		var packages as EA.Collection;&#xA;		var subPackage as EA.Package;&#xA;		var subPackage1 as EA.Package;&#xA;		var subPackage2 as EA.Package;&#xA;			&#xA;		packages = theParentPackage.Packages;&#xA;		// Create package&#xA;		if(type==&quot;BURD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Business Process Layer&quot;, &quot;Activity&quot;);&#xA;		else if(type==&quot;SUCD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;System Use Case&quot;, &quot;Class&quot;);&#xA;		else if(type==&quot;BSTMD&quot;) {&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Business State&quot;, &quot;State&quot;);&#xA;			testSMDiagram = CreateDiagram(subPackage, &quot;Business State&quot;, &quot;Statechart&quot;);&#xA;		}&#xA;		else if(type==&quot;CLASSD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Business Class&quot;, &quot;Class&quot;);&#xA;		else if(type==&quot;SUCRD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;User Layer&quot;, &quot;Activity&quot;);&#xA;		else if(type==&quot;IUCD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Internal Use Cases&quot;, &quot;UseCase&quot;);&#xA;		else if(type==&quot;SEQD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Sequence Layer&quot;, &quot;Sequence&quot;);&#xA;		else if(type==&quot;CMPD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Component Layer&quot;, &quot;Deployment&quot;);&#xA;		else&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Decomposition Layer&quot;, &quot;Activity&quot;);&#xA;		// Create subpackage&#xA;		packages = subPackage.Packages;&#xA;		if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, &quot;Decomposition Processes&quot;, &quot;Activity&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;BUCD&quot;)&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, &quot;Business Use Cases&quot;, &quot;UseCase&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;BURD&quot;)&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;Activity&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;SUCD&quot;)&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;UseCase&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;			stateMachine = subPackage.Elements.AddNew( nameOfSubPackage,&quot;StateMachine&quot;);&#xA;			stateMachine.Update();	&#xA;			subPackage.Diagrams.Refresh();&#xA;			for( var l=0; l&lt;subPackage.Diagrams.Count; l++) {&#xA;				testDiagram=subPackage.Diagrams.GetAt(l);&#xA;				if(testDiagram.Name==subPackage.Name&amp;&amp;testDiagram.Type==&quot;Statechart&quot;)&#xA;					break;&#xA;				else&#xA;					testDiagram=null;&#xA;			}&#xA;			if(testDiagram!=null) {&#xA;				var left=50;&#xA;				var top=-50;&#xA;				testDiagram.DiagramObjects.Refresh();&#xA;				for( var l=0; l&lt;testDiagram.DiagramObjects.Count; l++) {&#xA;					var diagramObject=testDiagram.DiagramObjects.GetAt(l);&#xA;					if(diagramObject.right&gt;=left)&#xA;						left = diagramObject.right+50;&#xA;				}&#xA;				var testDiagramObject = testDiagram.DiagramObjects.AddNew(&quot;&quot;, &quot;&quot; );&#xA;				testDiagramObject.ElementID( stateMachine.ElementID );&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+100;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-150;&#xA;				testDiagramObject.Update();&#xA;			}&#xA;			testDiagram=null;&#xA;		}&#xA;		else if(type!=null&amp;&amp;type==&quot;CLASSD&quot;)&#xA;			subPackage1 = subPackage;&#xA;		else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;			subPackage2 = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;Activity&quot;);&#xA;			packages=subPackage2.Packages;&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;Activity&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;			subPackage2 = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;UseCase&quot;);&#xA;			packages=subPackage2.Packages;&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;UseCase&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;			subPackage2 = CreatePackage(/*subPackage, */packages, nameOftheParent, &quot;UseCase&quot;);&#xA;			packages=subPackage2.Packages;&#xA;			subPackage2 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;UseCase&quot;);&#xA;			packages=subPackage2.Packages;&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;CMPD&quot;)&#xA;			subPackage1 = subPackage;&#xA;		else&#xA;			return parameters;&#xA;		if(type!=null&amp;&amp;type==&quot;BSTMD&quot;)&#xA;			parameters[0]=stateMachine;&#xA;		else&#xA;			parameters[0]=subPackage1;&#xA;		// Create a diagram in the package&#xA;		if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;			testDiagram = CreateDiagram(subPackage1, &quot;Decomposition Processes&quot;, &quot;EPProfile_dg::Eriksson-Penker Diagram&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;BUCD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, &quot;Business Use Cases&quot;, &quot;UseCase&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;BURD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfSubPackage, &quot;Activity&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;SUCD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfSubPackage, &quot;Use Case&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;			testDiagram = stateMachine.Diagrams.AddNew( nameOfSubPackage, &quot;Statechart&quot;);&#xA;			testDiagram.Update();&#xA;		} else if(type!=null&amp;&amp;type==&quot;CLASSD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, &quot;Business Class&quot;, &quot;Class&quot;); &#xA;		} else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfSubPackage, &quot;Activity&quot;); &#xA;		} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfSubPackage, &quot;Use Case&quot;); &#xA;		} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;CMPD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, &quot;Component Layer&quot;, &quot;Component&quot;);&#xA;		}&#xA;		parameters[1]=testDiagram;&#xA;	}&#xA;	else {&#xA;		if(type!=null&amp;&amp;type==&quot;BSTMD&quot;&amp;&amp;stateMachine==null||&#xA;			(type==null||type!=&quot;BSTMD&quot;)&amp;&amp;subChildPackage==null) {&#xA;			// Create subpackage&#xA;			var packages as EA.Collection;&#xA;			var packages1 as EA.Collection;&#xA;			//packages = theParentPackage.Packages;&#xA;			packages = childPackage.Packages;&#xA;			if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;				subChildPackage = CreatePackage(/*childPackage, */packages, &quot;Decomposition Processes&quot;, &quot;Class&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;BUCD&quot;)&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, &quot;Business Use Cases&quot;, &quot;Class&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;BURD&quot;)&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;Activity&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;SUCD&quot;)&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;Class&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;				stateMachine = childPackage.Elements.AddNew( nameOfSubPackage,&quot;StateMachine&quot;);&#xA;				stateMachine.Update();		&#xA;				childPackage.Diagrams.Refresh();				&#xA;				for( var l=0; l&lt;childPackage.Diagrams.Count; l++) {&#xA;					testDiagram=childPackage.Diagrams.GetAt(l);&#xA;					if(testDiagram.Name==childPackage.Name&amp;&amp;testDiagram.Type==&quot;Statechart&quot;)&#xA;						break;&#xA;					else&#xA;						testDiagram=null;&#xA;				}&#xA;				if(testDiagram!=null) {&#xA;					var left=50;&#xA;					var top=-50;&#xA;					testDiagram.DiagramObjects.Refresh();&#xA;					for( var l=0; l&lt;testDiagram.DiagramObjects.Count; l++) {&#xA;						var diagramObject=testDiagram.DiagramObjects.GetAt(l);&#xA;						if(diagramObject.right&gt;=left)&#xA;							left = diagramObject.right+50;&#xA;					}&#xA;					var testDiagramObject = testDiagram.DiagramObjects.AddNew(&quot;&quot;, &quot;&quot; );&#xA;					testDiagramObject.ElementID( stateMachine.ElementID );&#xA;					testDiagramObject.left=left;&#xA;					testDiagramObject.right=left+100;&#xA;					testDiagramObject.top=top;&#xA;					testDiagramObject.bottom=top-150;&#xA;					testDiagramObject.Update();&#xA;				}&#xA;				testDiagram=null;&#xA;			}&#xA;			else if(type!=null&amp;&amp;type==&quot;CLASSD&quot;)&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, &quot;Business Class&quot;, &quot;Class&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;Activity&quot;);&#xA;				packages1=subChildPackage.Packages;&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;Activity&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;UseCase&quot;);&#xA;				packages1=subChildPackage.Packages;&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;UseCase&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOftheParent, &quot;UseCase&quot;);&#xA;				packages1=subChildPackage.Packages;&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;UseCase&quot;);&#xA;				packages1=subChildPackage.Packages;&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;			} else&#xA;			if(type!=&quot;CMPD&quot;)&#xA;				return parameters; &#xA;			if(type!=null&amp;&amp;type==&quot;BSTMD&quot;)&#xA;				parameters[0]=stateMachine;&#xA;			else&#xA;				parameters[0]=subChildPackage;	 &#xA;			// Create a diagram in the package&#xA;			if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;				testDiagram = CreateDiagram(subChildPackage, &quot;Decomposition Processes&quot;, &quot;EPProfile_dg::Eriksson-Penker Diagram&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;BUCD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, &quot;Business Use Cases&quot;, &quot;UseCase&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;BURD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Activity&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;SUCD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Use Case&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;				testDiagram = stateMachine.Diagrams.AddNew( nameOfSubPackage, &quot;Statechart&quot;);&#xA;				testDiagram.Update();&#xA;			} else if(type!=null&amp;&amp;type==&quot;SUCD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, &quot;Business Class&quot;, &quot;Class&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Activity&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Use Case&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;CMPD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, &quot;Component Layer&quot;, &quot;Component&quot;);&#xA;			}&#xA;			parameters[1]=testDiagram;			&#xA;		} else { //the target package, there is Sequence Layer&#xA;			if(type==&quot;SUCRD&quot;||type==&quot;IUCD&quot;||type==&quot;SEQD&quot;) {&#xA;				var subChildPackageS as EA.Package;&#xA;				for(var i=0;i&lt;subChildPackage.Packages.Count();i++) {&#xA;					if(subChildPackage.Packages.GetAt(i).Name === nameOfSubPackage) {&#xA;						subChildPackageS=subChildPackage.Packages.GetAt(i);&#xA;						break;&#xA;					}				&#xA;				}	&#xA;				if(subChildPackageS==null) {&#xA;					var packages1 as EA.Collection;&#xA;					packages1=subChildPackage.Packages;&#xA;					if(type==&quot;SUCRD&quot;)&#xA;						subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;Activity&quot;);&#xA;					else if(type==&quot;SEQD&quot;)&#xA;						subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;Sequence&quot;);&#xA;					else&#xA;						subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;UseCase&quot;);&#xA;				} else&#xA;					subChildPackage=subChildPackageS;&#xA;				if(type==&quot;SEQD&quot;) {&#xA;					var subChildPackageS as EA.Package;&#xA;					subChildPackageS=null;&#xA;					for(var i=0;i&lt;subChildPackage.Packages.Count();i++) {&#xA;						if(subChildPackage.Packages.GetAt(i).Name === nameOfsubPackageDiagram) {&#xA;							subChildPackageS=subChildPackage.Packages.GetAt(i);&#xA;							break;&#xA;						}				&#xA;					}&#xA;					if(subChildPackageS==null) {&#xA;						var packages1 as EA.Collection;&#xA;						packages1=subChildPackage.Packages;&#xA;						subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;					} else&#xA;						subChildPackage=subChildPackageS;&#xA;				}&#xA;			}&#xA;			if(type!=null&amp;&amp;type==&quot;BSTMD&quot;)&#xA;				parameters[0]=stateMachine;&#xA;			else&#xA;				parameters[0]=subChildPackage;&#xA;			testDiagram=null;&#xA;			if(type!=null&amp;&amp;type==&quot;BSTMD&quot;&amp;&amp;stateMachine.Diagrams.Count&gt;0) {&#xA;				for(i=0;i&lt;stateMachine.Diagrams.Count&gt;0;i++) {&#xA;					var test1Diagram = stateMachine.Diagrams.GetAt(i);&#xA;					if(test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Statechart&quot;) {&#xA;						testDiagram=test1Diagram;&#xA;						break;&#xA;					}&#xA;				}&#xA;			} else &#xA;			if(type!=null&amp;&amp;type!=&quot;BSTMD&quot;&amp;&amp;subChildPackage.Diagrams.Count&gt;0) {&#xA;				for(i=0;i&lt;subChildPackage.Diagrams.Count&gt;0;i++) {&#xA;					var test1Diagram = subChildPackage.Diagrams.GetAt(i);&#xA;					if((type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&amp;&amp;test1Diagram.Name==&quot;Decomposition Processes&quot;&amp;&amp;test1Diagram.Type==&quot;Analysis&quot; ||&#xA;						type!=null&amp;&amp;type==&quot;BUCD&quot;&amp;&amp;test1Diagram.Name==&quot;Business Use Cases&quot;&amp;&amp;test1Diagram.Type==&quot;UseCase&quot; ||&#xA;						type!=null&amp;&amp;type==&quot;BURD&quot;&amp;&amp;test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Activity&quot; ||&#xA;						type!=null&amp;&amp;type==&quot;SUCD&quot;&amp;&amp;test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Use Case&quot;||&#xA;						type!=null&amp;&amp;type==&quot;CLASSD&quot;&amp;&amp;test1Diagram.Name==&quot;Business Class&quot;&amp;&amp;test1Diagram.Type==&quot;Class&quot;||&#xA;						type!=null&amp;&amp;type==&quot;SUCRD&quot;&amp;&amp;test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Activity&quot;||&#xA;						type!=null&amp;&amp;type==&quot;IUCD&quot;&amp;&amp;test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Use Case&quot;||&#xA;						type!=null&amp;&amp;type==&quot;SEQD&quot;&amp;&amp;test1Diagram.Name==nameOfsubPackageDiagram&amp;&amp;test1Diagram.Type==&quot;Sequence&quot;||&#xA;						type!=null&amp;&amp;type==&quot;CMPD&quot;&amp;&amp;test1Diagram.Name==&quot;Component Layer&quot;&amp;&amp;test1Diagram.Type==&quot;Component&quot;) {&#xA;						testDiagram=test1Diagram;&#xA;						break;&#xA;					}&#xA;				}&#xA;			}&#xA;			if(testDiagram==null) {&#xA;				if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;					testDiagram = CreateDiagram(subChildPackage, &quot;Decomposition Processes&quot;, &quot;EPProfile_dg::Eriksson-Penker Diagram&quot;);&#xA;				else if(type!=null&amp;&amp;type==&quot;BUCD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, &quot;Business Use Cases&quot;, &quot;Use Case&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;BURD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Activity&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;SUCD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Use Case&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;					testDiagram = stateMachine.Diagrams.AddNew( nameOfSubPackage, &quot;Statechart&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;CLASSD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, &quot;Business Class&quot;, &quot;Class&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Activity&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Use Case&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;CMPD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, &quot;Component Layer&quot;, &quot;Component&quot;);&#xA;				}&#xA;				else&#xA;					return parameters;&#xA;			}&#xA;			parameters[1]=testDiagram;	&#xA;		}			&#xA;	}&#xA;	return parameters;&#xA;}&#xA;//Look up the name of an element with the specified type in the current package, otherwise in the repository&#xA;function searchForElement(subPackage, nameOfElement, typeOfElement) {&#xA;	var coto as EA.Collection;&#xA;	var currentPackage as EA.Package;&#xA;	var delements as EA.Collection;&#xA;	var packageElement as EA.Element;&#xA;	&#xA;	currentPackage=subPackage;&#xA;	delements = currentPackage.Elements;&#xA;	for(i=0;i&lt;delements.Count();i++) {&#xA;		packageElement=delements.GetAt(i);&#xA;		if(packageElement.Name==nameOfElement&amp;&amp;packageElement.Type==typeOfElement)&#xA;			return packageElement;&#xA;	}&#xA;	coto=Repository.GetElementsByQuery(&quot;Simple&quot;,nameOfElement);&#xA;	for(i=0; i&lt;coto.Count(); i++) {&#xA;		var searchElement as EA.Element;&#xA;		searchElement=coto.GetAt(i);&#xA;		if(searchElement.Name==nameOfElement&amp;&amp;searchElement.Type==typeOfElement)&#xA;			return searchElement;&#xA;	} &#xA;	return null;&#xA;}&#xA;//Returning an object on the diagram corresponding to the given element&#xA;function searchedObjectinDiagram(thePackage, theElement) {&#xA;	var diagramObjects as EA.Collection;&#xA;	var diagramObject as EA.DiagramObject;&#xA;&#xA;	diagramObjects = thePackage.Diagrams.GetAt(0).DiagramObjects;&#xA;	for(i=0;i&lt;diagramObjects.Count();i++) {&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID==theElement.ElementID)&#xA;			return diagramObject;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Return next connected element(nameElementtype) back(kind=1) or forward (kind=0) to the given element (theElement) and this connection in the diagram&#xA;function searchConnectorsinElement(thePackage, theElement, type, nameElement, kind) {&#xA;	var Connectors as EA.Collection;&#xA;	var theConnector as EA.Connector;&#xA;	var coto as EA.Element;&#xA;	var cotoParent as EA.Element;&#xA;	var searchConnectors = [null, null];&#xA;	&#xA;	Connectors = theElement.Connectors;&#xA;	for(var i=0;i&lt;Connectors.Count();i++)&#xA;	{&#xA;		theConnector=Connectors.GetAt(i);&#xA;		if(kind==1&amp;&amp;theConnector.ClientID&gt;0 || kind==0&amp;&amp;theConnector.SupplierID&gt;0) {&#xA;			if(kind==1)&#xA;				coto=Repository.GetElementByID(theConnector.ClientID);&#xA;			else&#xA;				coto=Repository.GetElementByID(theConnector.SupplierID);&#xA;			cotoParent=null;&#xA;			if(coto.Type==&quot;Object&quot;)&#xA;				cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;			//here can find a propriete element&#xA;			if(type==&quot;Action&quot;||type==&quot;Activity&quot;) {&#xA;				if((coto.Type==&quot;Action&quot;||coto.Type==&quot;Activity&quot;)&amp;&amp; (nameElement!=&quot; &quot;&amp;&amp;nameElement==coto.Name||nameElement==&quot;&quot;||nameElement==&quot; &quot;)) {&#xA;					if(searchedObjectinDiagram(thePackage, coto)!=null) {&#xA;						searchConnectors[0]=coto;&#xA;						searchConnectors[1]=theConnector;&#xA;						return searchConnectors;&#xA;					}&#xA;				}&#xA;			} else {&#xA;				if(coto.Type==type &amp;&amp; (nameElement!=&quot; &quot;&amp;&amp;nameElement==coto.Name||nameElement==&quot;&quot;||nameElement==&quot; &quot;||coto.Type==&quot;Object&quot;&amp;&amp;nameElement.substr(0,1)==&quot;:&quot;&amp;&amp;nameElement.substr(1)==cotoParent.Name)) {&#xA;					if(searchedObjectinDiagram(thePackage, coto)!=null) {&#xA;						searchConnectors[0]=coto;&#xA;						searchConnectors[1]=theConnector;&#xA;						return searchConnectors;&#xA;					}&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	return searchConnectors;&#xA;}&#xA;//Importing the given package from URL&#xA;function importXMLPackageFromURL(url) {&#xA;    //var repository = EA.Repository;&#xA;	var projectInterface as EA.Project;&#xA;    var xmlContent = &quot;&quot;;&#xA;&#xA;    // Fetch XML content from URL&#xA;    var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;);&#xA;    xhr.open(&quot;GET&quot;, url, false);&#xA;    xhr.send();&#xA;    if (xhr.status == 200) {&#xA;        xmlContent = xhr.responseText;&#xA;    } else {&#xA;        Session.Output(&quot;Failed to fetch XML from URL: &quot; + xhr.statusText);&#xA;        return;&#xA;    }&#xA;&#xA;    // Import XML package into the model&#xA;    var importResult = projectInterface.ImportPackageXMI(xmlContent, 0);&#xA;    if (importResult) {&#xA;        Session.Output(&quot;XML package imported successfully.&quot;);&#xA;    } else {&#xA;        Session.Output(&quot;Failed to import XML package.&quot;);&#xA;    }&#xA;}&#xA;&#xA;main();&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="5"/>
			<Column name="ScriptCategory" value="ScriptDebugging"/>
			<Column name="ScriptName" value="ScriptDebugging"/>
			<Column name="ScriptAuthor" value="ScriptDebugging"/>
			<Column name="Notes" value="&lt;?xml version=&quot;1.0&quot;?&gt;&#xA;&lt;DATA&gt;&lt;Debugger value=&quot;Scripting&quot;/&gt;&lt;/DATA&gt;&#xA;"/>
			<Column name="Script" value=" "/>
		</DataRow>
	</DataSet>
</RefData>
