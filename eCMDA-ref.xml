<?xml version="1.0" encoding="windows-1252"?>
<RefData version="1.0" exporter="EA.25">
	<DataSet name="Automation Scripts" table="t_script" filter="ScriptName='#ScriptName#' and ScriptCategory='#ScriptCategory#'" stoplist=";ScriptID;">
		<DataRow>
			<Column name="ScriptID" value="1"/>
			<Column name="ScriptCategory" value="ScriptDebugging"/>
			<Column name="ScriptName" value="ScriptDebugging"/>
			<Column name="ScriptAuthor" value="ScriptDebugging"/>
			<Column name="Notes" value="&lt;?xml version=&quot;1.0&quot;?&gt;&#xA;&lt;DATA&gt;&lt;Debugger value=&quot;Scripting&quot;/&gt;&lt;/DATA&gt;&#xA;"/>
			<Column name="Script" value=" "/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="2"/>
			<Column name="ScriptCategory" value="3955A83E-9E54-4810-8053-FACC68CD4782"/>
			<Column name="ScriptName" value="{CDA41054-CD7D-49bd-9679-575ADA77266B}"/>
			<Column name="Notes" value="&lt;Group Type=&quot;CONTEXTPACKAGE&quot; Notes=&quot;Software Architecture building&quot;/&gt;&#xA;"/>
			<Column name="Script" value="CMDA"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="3"/>
			<Column name="ScriptCategory" value="605A62F7-BCD0-4845-A8D0-7DC45B4D2E3F"/>
			<Column name="ScriptName" value="{001F9F30-144F-4d59-A580-2E8906C9FA61}"/>
			<Column name="ScriptAuthor" value="{CDA41054-CD7D-49bd-9679-575ADA77266B}"/>
			<Column name="Notes" value="&lt;Script Name=&quot;eCMDA&quot; Type=&quot;Internal&quot; Language=&quot;JScript&quot;/&gt;&#xA;"/>
			<Column name="Script" value="!INC Local Scripts.EAConstants-JScript&#xA;&#xA;/*&#xA; * Script Name: eCMDA&#xA; * Author: &#xA; * Purpose: Software architecture construction&#xA; * Date: 2025.10.14&#xA; */&#xA;var fileeCMDA=null;&#xA;function main()&#xA;{&#xA;	var thePackage as EA.Package;&#xA;	var newModelID = 0;&#xA;	var theParentPackage as EA.Package;	&#xA;	var theParentParentPackage as EA.Package;	&#xA;	var thePParentParentPackage as EA.Package;	&#xA;	var elements as EA.Collection;&#xA;&#xA;	// Get the currently selected package in the tree to work on&#xA;	thePackage = Repository.GetTreeSelectedPackage();&#xA;	elements = thePackage.Elements;&#xA;	// Show the script output window&#xA;	Repository.EnsureOutputVisible( &quot;Script&quot; );&#xA;	&#xA;	// The package was selected&#xA;	if ( thePackage != null &amp;&amp; thePackage.ParentID != 0 ) {&#xA;		theParentPackage = Repository.GetPackageByID(thePackage.ParentID);&#xA;		if(theParentPackage.ParentID&gt;0)&#xA;			theParentParentPackage = Repository.GetPackageByID(theParentPackage.ParentID);&#xA;		else&#xA;			theParentParentPackage = null;&#xA;		if(theParentParentPackage!=null&amp;&amp;theParentParentPackage.ParentID&gt;0)&#xA;			thePParentParentPackage = Repository.GetPackageByID(theParentParentPackage.ParentID);&#xA;		else&#xA;			thePParentParentPackage = null;&#xA;		// the selected package is called &quot;Context Layer&quot; or &quot;Decomposition Processes&quot;&#xA;		if(thePackage.Name === &quot;Context Layer&quot; || thePackage.Name === &quot;Decomposition Processes&quot; || thePackage.Name === &quot;Business Use Cases&quot;||&#xA;			thePackage.Name === &quot;Business State&quot;||thePackage.Name === &quot;Business Class&quot;||&#xA;			theParentPackage.Name === &quot;Business Process Layer&quot;||theParentPackage.Name === &quot;System Use Case&quot;||&#xA;			theParentParentPackage!=null&amp;&amp;theParentParentPackage.Name === &quot;User Layer&quot;||theParentParentPackage!=null&amp;&amp;theParentParentPackage.Name === &quot;Internal Use Cases&quot;||&#xA;			thePParentParentPackage!=null&amp;&amp;thePParentParentPackage.Name === &quot;Sequence Layer&quot;)&#xA;		{&#xA;			// the selected package is not empty and it has only one diagram&#xA;			//if(elements.Count&gt;0 &amp;&amp; thePackage.Diagrams.Count==1) &#xA;			if(thePackage.Diagrams.Count==1) &#xA;			{&#xA;				Repository.EnableUIUpdates(false);&#xA;				//Repository.EnableUIUpdates(true);&#xA;				// Context diagram element verification&#xA;				var diagramObjects as EA.Collection;&#xA;				diagramObjects = thePackage.Diagrams.GetAt(0).DiagramObjects;&#xA;				var diagramObject as EA.DiagramObject;&#xA;				var testElement as EA.Element;&#xA;				//Session.Output( &quot;Count of &quot; +thePackage.Diagrams.GetAt(0).Name+&quot; diagram objects:&quot; + diagramObjects.Count );&#xA;				// Navigate the elements collection of selected diagram&#xA;				for ( var ii = 0 ; ii &lt; diagramObjects.Count ; ii++ )&#xA;				{&#xA;					var diagramObjectOmitted = false;&#xA;					diagramObject = diagramObjects.GetAt(ii);&#xA;					  &#xA;					//Session.Output(&quot;Diagram object(&quot;+ii+&quot;):&quot;+diagramObject.ElementID);&#xA;					var delements as EA.Collection;&#xA;					delements = thePackage.Elements;&#xA;					var continueLoop=true;&#xA;					// Navigate the elements collection of selected package&#xA;					for ( var jj = 0 ; jj &lt; elements.Count &amp;&amp; continueLoop; jj++ ) //elements can be placed inside the Activity Partition&#xA;					{&#xA;						var currentElement as EA.Element;&#xA;						currentElement = elements.GetAt( jj );&#xA;						// The found element in the package is the selected diagram element&#xA;						//Session.Output(&quot;Package element(&quot;+jj+&quot;):&quot;+currentElement.ElementID);&#xA;						if(currentElement.ElementID == diagramObject.ElementID) &#xA;						{&#xA;							//Session.Output(&quot;Selected package element(&quot;+jj+&quot;):&quot;+currentElement.ElementID);&#xA;							diagramObjectOmitted = true;&#xA;							// Get value of the tag&#xA;							var stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,null); &#xA;							do {&#xA;								string4=stringLast;&#xA;								if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;									Session.Output( &quot;Element named '&quot; + currentElement.Name +&quot;' and type '&quot;+currentElement.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;									//Session.Output( &quot;The index of the first occurence of ';' is: &quot; + string4.indexOf(&quot;;&quot;));&#xA;									do {&#xA;										var string5 = string4;&#xA;										if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;											string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;											string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;										} else&#xA;										string4=null;&#xA;										realizeConsistencyRule(string5,currentElement,thePackage); &#xA;									} while (string4!=null&amp;&amp;string4!=&quot;&quot;); &#xA;								} else&#xA;								if(currentElement.Name == null || currentElement.Name == &quot;&quot;) &#xA;								{&#xA;									var parentId = currentElement.ClassifierId; //ParentID;&#xA;									currentElement=Repository.GetElementByID(parentId);&#xA;									Session.Output( &quot;An instance of class ':&quot; + currentElement.Name +&quot;' has no Tag.&quot;);&#xA;								} else&#xA;									Session.Output( &quot;Element named '&quot; + currentElement.Name +&quot;' has no Tag.&quot;);&#xA;							} while(stringLast!=null&amp;&amp;(stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast))!=null);&#xA;							//Session.Output(&quot;Element name:&quot;+currentElement.Name+&quot;; type:&quot;+currentElement.Type+&quot;; diagram.type:&quot;+thePackage.Diagrams.GetAt(0).Type+&quot;; InstanceGUID=&quot;+diagramObject.InstanceGUID+&quot;; InstanceID=&quot;+diagramObject.InstanceID+&quot;; Sequence=&quot;+diagramObject.Sequence);&#xA;							if(currentElement.Type==&quot;Sequence&quot;||currentElement.Type==&quot;Component&quot;&amp;&amp;thePackage.Diagrams.GetAt(0).Type==&quot;Sequence&quot;) { //Lifeline&#xA;								var connector as EA.Connector;&#xA;								connector=null;&#xA;								//Session.Output(&quot;Selected element1: ID=&quot;+diagramObject.ElementID+&quot;\\&quot;+currentElement.ElementID+&quot;; name=&quot;+currentElement.Name+&quot;; type=&quot;+currentElement.Type+&quot;; currentElement.Connectors.Count=&quot;+currentElement.Connectors.Count+&quot;; currentElement.Elements.Count=&quot;+currentElement.Elements.Count);&#xA;								if(currentElement.Type==&quot;Component&quot;)&#xA;									currentElement=Repository.GetElementByID(diagramObject.ElementID);&#xA;								//Session.Output(&quot;Selected element2: ID=&quot;+diagramObject.ElementID+&quot;\\&quot;+currentElement.ElementID+&quot;; name=&quot;+currentElement.Name+&quot;; type=&quot;+currentElement.Type+&quot;; currentElement.Connectors.Count=&quot;+currentElement.Connectors.Count+&quot;; currentElement.Elements.Count=&quot;+currentElement.Elements.Count);&#xA;								for(var k=0;k&lt;currentElement.Connectors.Count;k++) {&#xA;									var connector=currentElement.Connectors.GetAt(k);&#xA;									//Session.Output(&quot;Connector name:&quot;+connector.Name+&quot;; type:&quot;+connector.Type);&#xA;									if(connector.Type==&quot;Sequence&quot;) { //message&#xA;										diagramObjectOmitted = true;&#xA;										// Get value of the tag&#xA;										var stringLast1 = getTagsValue(connector,&quot;Consistency rules&quot;,null); &#xA;										do {&#xA;											var string4=stringLast1;&#xA;											if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;												Session.Output( &quot;Element named '&quot; + connector.Name +&quot;' and type '&quot;+connector.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;												do {&#xA;													var string5 = string4;&#xA;													if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;														string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;														string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;													} else&#xA;														string4=null;&#xA;													realizeConsistencyRule(string5,connector,thePackage); &#xA;												} while (string4!=null&amp;&amp;string4!=&quot;&quot;); // jedna regu&#322;a, to pomija t&#261; ostatni&#261;&#xA;											} else&#xA;												Session.Output( &quot;Element named '&quot; + connector.Name +&quot;' has no Tag.&quot;);&#xA;										} while(stringLast1!=null&amp;&amp;(stringLast1 = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast1))!=null);&#xA;									}&#xA;								}&#xA;							}&#xA;							continueLoop=false;&#xA;					    } &#xA;						if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;							for(var k=0; k&lt;currentElement.Elements.Count(); k++) {&#xA;								var currentElement1 as EA.Element;&#xA;								currentElement1 = currentElement.Elements.GetAt( k );&#xA;								// The found element in the package is the selected diagram element&#xA;								if(currentElement1.ElementID == diagramObject.ElementID) &#xA;								{&#xA;									diagramObjectOmitted = true;&#xA;									// Get value of the tag&#xA;									var stringLast = getTagsValue(currentElement1,&quot;Consistency rules&quot;,null); &#xA;									do {&#xA;										var string4=stringLast;&#xA;										if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;											Session.Output( &quot;Element named '&quot; + currentElement1.Name +&quot;' and type '&quot;+currentElement1.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;											//Session.Output( &quot;The index of the first occurence of ';' is: &quot; + string4.indexOf(&quot;;&quot;));&#xA;											//var co=string4.indexOf(&quot;;&quot;);&#xA;											do {&#xA;												//co=string4.indexOf(&quot;;&quot;);&#xA;												var string5 = string4;&#xA;												if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;													string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;													string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;												} else&#xA;												string4=null;&#xA;												realizeConsistencyRule(string5,currentElement1,thePackage); &#xA;											} while (string4!=null&amp;&amp;string4!=&quot;&quot;); // jedna regu&#322;a, to pomija t&#261; ostatni&#261;&#xA;										} else&#xA;										if(currentElement1.Name == null || currentElement1.Name == &quot;&quot;) &#xA;										{&#xA;											var parentId = currentElement1.ClassifierID; //ParentID;&#xA;											if(parentId!=null&amp;&amp;parentId&gt;0)&#xA;												currentElement1=Repository.GetElementByID(parentId);&#xA;											Session.Output( &quot;An instance of class ':&quot; + currentElement1.Name +&quot;' has no Tag.&quot;);&#xA;										} else&#xA;											Session.Output( &quot;Element named '&quot; + currentElement1.Name +&quot;' has no Tag.&quot;);&#xA;									} while(stringLast!=null&amp;&amp;(stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast))!=null);&#xA;									break;&#xA;								} &#xA;								if(currentElement1.Type==&quot;ActivityPartition&quot;) {&#xA;									for(var l=0; l&lt;currentElement.Elements.Count(); l++) {&#xA;										var currentElement2 as EA.Element;&#xA;										currentElement2 = currentElement1.Elements.GetAt( l );&#xA;										// The found element in the package is the selected diagram element&#xA;										if(currentElement2.ElementID == diagramObject.ElementID) &#xA;										{&#xA;											diagramObjectOmitted = true;&#xA;											// Get value of the tag&#xA;											var stringLast = getTagsValue(currentElement2,&quot;Consistency rules&quot;,null); &#xA;											do {&#xA;												var string4=stringLast;&#xA;												if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;													Session.Output( &quot;Element named '&quot; + currentElement2.Name +&quot;' and type '&quot;+currentElement2.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;													//Session.Output( &quot;The index of the first occurence of ';' is: &quot; + string4.indexOf(&quot;;&quot;));&#xA;													//var co=string4.indexOf(&quot;;&quot;);&#xA;													do {&#xA;														//co=string4.indexOf(&quot;;&quot;);&#xA;														var string5 = string4;&#xA;														if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;															string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;															string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;														} else&#xA;														string4=null;&#xA;														realizeConsistencyRule(string5,currentElement2,thePackage); &#xA;													} while (string4!=null&amp;&amp;string4!=&quot;&quot;); // jedna regu&#322;a, to pomija t&#261; ostatni&#261;&#xA;												} else&#xA;												if(currentElement2.Name == null || currentElement2.Name == &quot;&quot;) &#xA;												{&#xA;													var parentId = currentElement2.ClassifierId; //ParentID;&#xA;													currentElement2=Repository.GetElementByID(parentId);&#xA;													Session.Output( &quot;An instance of class ':&quot; + currentElement2.Name +&quot;' has no Tag.&quot;);&#xA;												} else&#xA;													Session.Output( &quot;Element named '&quot; + currentElement2.Name +&quot;' has no Tag.&quot;);&#xA;											} while(stringLast!=null&amp;&amp;(stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast))!=null);&#xA;											break;&#xA;										} 										&#xA;									}&#xA;								}&#xA;							}&#xA;						} &#xA;					}&#xA;					if(diagramObjectOmitted == false) { //elements outside the current package &#xA;						currentElement=Repository.GetElementByID(diagramObject.ElementID);&#xA;						if(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Class&quot;) {&#xA;							var stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,null); &#xA;							do {&#xA;								var string4 = stringLast;&#xA;								if(string4 != null &amp;&amp; string4 !=&quot;&quot;) { //The found tag value&#xA;									Session.Output( &quot;Element named '&quot; + currentElement.Name +&quot;' and type '&quot;+currentElement.Type+&quot;' has the value of the Tag:&quot;+string4);&#xA;									//Session.Output( &quot;The index of the first occurence of ';' is: &quot; + string4.indexOf(&quot;;&quot;));&#xA;									do {&#xA;										var string5 = string4;&#xA;										if(string4.indexOf(&quot;;&quot;)&gt;0) {&#xA;											string5 = string4.substr(0,string4.indexOf(&quot;;&quot;));&#xA;											string4 = string4.substr(string4.indexOf(&quot;;&quot;)+1);&#xA;										} else&#xA;										string4=null;&#xA;										realizeConsistencyRule(string5,currentElement,thePackage); &#xA;									} while (string4!=null&amp;&amp;string4!=&quot;&quot;); &#xA;								} &#xA;							} while(stringLast!=null&amp;&amp;(stringLast = getTagsValue(currentElement,&quot;Consistency rules&quot;,stringLast))!=null);&#xA;						}&#xA;					}&#xA;&#xA;				}&#xA;				Repository.EnableUIUpdates(true);&#xA;				Session.Output(&quot;Process complete&quot;);&#xA;			} else&#xA;				Session.Output( &quot;The package '&quot; +thePackage.Name+&quot;' does not include only one diagram or an element&quot; );		  &#xA;		} else&#xA;		if(thePackage.Name === &quot;Context View&quot;&amp;&amp;thePackage.Diagrams.Count==0&amp;&amp;thePackage.Elements.Count==0&amp;&amp;thePackage.Packages.Count==0&amp;&amp;thePackage.Element.TaggedValues.Count&gt;0) {&#xA;			var currentTag as EA.TaggedValue;&#xA;			currentTag=thePackage.Element.TaggedValues.GetAt(0);&#xA;			var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;);&#xA;			xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+currentTag.Value+&quot;.xml&quot;, false);&#xA;			xhr.send();&#xA;			if (xhr.status == 200) {&#xA;				var xmlContent = xhr.responseText;&#xA;				var project = Repository.GetProjectInterface();&#xA;				var result = project.ImportPackageXMI(thePackage.PackageGUID, xmlContent, 1, 1);&#xA;				thePackage.Packages.Refresh();&#xA;				Session.Output(&quot;Process complete&quot;);&#xA;			} else&#xA;			    Session.Output(&quot;Failed to fetch XML from URL: &quot; + xhr.statusText);&#xA;		} else&#xA;			Session.Output( &quot;Neither Package 'Context View' nor 'Context Layer' nor 'Decomposition Processes' nor 'Business Use Cases' has been selected&quot; );&#xA;	} else &#xA;		Session.Output( &quot;Nothing to do !&quot; );&#xA;}&#xA;//Create a package in thepackage with the nameOfPackage and kindOfPackage&#xA;function CreatePackage (thepackage,/*packages,*/nameOfPackage,kindOfPackage) &#xA;{&#xA;	//var thepackages as EA.Collection;&#xA;	var thepackage1 as EA.Collection;&#xA;	var subPackage as EA.Package;&#xA;	&#xA;	//thepackages = packages;&#xA;	thepackage1 = thepackage;&#xA;	subPackage = thepackage1.AddNew( nameOfPackage,kindOfPackage);&#xA;	subPackage.Update();&#xA;	Session.Output( &quot;Added new subpackage: '&quot; + subPackage.Name+&quot;' under parent package '&quot; + thepackage.Name + &quot;'&quot; );&#xA;	return subPackage;&#xA;}&#xA;//Create a diagram in the subpackage with the nameOfPackage and kindOfDiagram&#xA;function CreateDiagram(subpackage,nameOfPackage,kindOfDiagram)&#xA;{&#xA;	var subPackage as EA.Package;&#xA;&#xA;	subPackage = subpackage;&#xA;	testDiagram = subPackage.Diagrams.AddNew( nameOfPackage, kindOfDiagram );&#xA;	testDiagram.Update();&#xA;&#xA;	Session.Output( &quot;Added diagram '&quot; + testDiagram.Name + &quot;' to package &quot; + subPackage.Name );&#xA;	return testDiagram;&#xA;}&#xA;//Get the value of the tag named theName from theElement&#xA;function getTagsValue(theElement, theName, theValue)&#xA;{&#xA;	var tags as EA.Collection;&#xA;	tags = theElement.TaggedValues;&#xA;		&#xA;	var currentTag as EA.TaggedValue;&#xA;	currentTag = null;&#xA;	var occurence=false;&#xA;	&#xA;	// List all element tag&#xA;	for ( var i = 0 ; i &lt; tags.Count ; i++ )&#xA;	{&#xA;&#xA;		currentTag = tags.GetAt( i );&#xA;	&#xA;		if ( currentTag.Name == theName ) {&#xA;			if(theValue==null)&#xA;				return currentTag.Value;&#xA;			if(occurence)&#xA;				return currentTag.Value;&#xA;			if(!occurence&amp;&amp;theValue==currentTag.Value)&#xA;				occurence=true;&#xA;		}&#xA;	}&#xA;    return null;&#xA;}&#xA;//Constructing the target structure of elements based on the consistency rule&#xA;function realizeConsistencyRule(consistencyRule,currentElement,thePackage) {&#xA;var currentElement as EA.Element;&#xA;var thePackage as EA.Package;&#xA;var theParentPackage as EA.Package;&#xA;var thePParentPackage as EA.Package;&#xA;var thePPParentPackage as EA.Package;&#xA;var correctCR=null;&#xA;var parameters = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;var connectors = [ [null,null,null], [null,null],];&#xA;&#xA;	correctCR=verifyConsistencyRule(thePackage, consistencyRule, currentElement); //rule verification &#xA;	parameters=getArgumentsCR(correctCR, consistencyRule); // get arguments of Consistency rule &#xA;	//Session.Output(&quot;correctCR:&quot;+correctCR);&#xA;	if(correctCR != null) {&#xA;		switch(correctCR) {&#xA;			case &quot;ZpvYu&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				theParentPackage=Repository.GetPackageByID(theParentPackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;User Layer&quot;)&#xA;					break;		&#xA;				connectors = getConnectionA(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				//Session.Output(&quot;ZpvYu:&lt;&quot;+connectors+&quot;&gt;; currentElement:&quot;+currentElement.Type+&quot;;&quot;+currentElement.Name);&#xA;				createZYcomplexYu(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;YuQlml&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				theParentPackage=Repository.GetPackageByID(theParentPackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;Internal Use Cases&quot;)&#xA;					break;		&#xA;				connectors = getConnectionB(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createYQcomplexQlml(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;QlmlMqyq&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				thePParentPackage=Repository.GetPackageByID(theParentPackage.ParentID);&#xA;				thePPParentPackage=Repository.GetPackageByID(thePParentPackage.ParentID);&#xA;				if(thePPParentPackage.Name!=&quot;Sequence Layer&quot;)&#xA;					break;		&#xA;				connectors = getConnectionQ(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				//Session.Output(&quot;QlmlMqyq:connectors[0].length=&quot;+connectors[0].length+&quot;; connectors[0][0]=&quot;+connectors[0][0].Name+&quot;;&quot;+connectors[0][0].Type);&#xA;				createQMcomplexMqyq(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;CchZiv&quot;:&#xA;				if(thePackage.Name!=&quot;Business Class&quot;)&#xA;					break;&#xA;				connectors = getConnectionC(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createCZcomplexZvi(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;SrsZiv&quot;:&#xA;				if(thePackage.Name!=&quot;Business State&quot;)&#xA;					break;&#xA;				connectors = getConnectionS(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createSZcomplexZiv(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;UauZpv&quot;:&#xA;				connectors = getConnectionB(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createUZcomplexZpv(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;AivSrst&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;Business Process Layer&quot;)&#xA;					break;	&#xA;				connectors = getConnectionA(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				//Session.Output(&quot;AivSrst:&lt;&quot;+connectors+&quot;&gt;&quot;);&#xA;				createAScomplexSrst(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;AiviCczc&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;Business Process Layer&quot;)&#xA;					break;	&#xA;				connectors = getConnectionA(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				//Session.Output(&quot;AiviCczc: conns[0][0]=&quot;+connectors[0][0].Name+&quot;(&quot;+connectors[0][0].ElementID+&quot;); conns[0][1]=&quot;+connectors[0][1].Name+&quot;(&quot;+connectors[0][1].ElementID+&quot;); conns[0][2]=&quot;+connectors[0][2].Name+&quot;(&quot;+connectors[0][2].ElementID+&quot;)&quot;);&#xA;				createACcomplex(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;ApUau&quot;:&#xA;				theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;				if(theParentPackage.Name!=&quot;Business Process Layer&quot;)&#xA;					break;		&#xA;				connectors = getConnectionA(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createAUcomplexUau(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;BauApvpv&quot;:&#xA;				if(thePackage.Name!=&quot;Business Use Cases&quot;)&#xA;					break;&#xA;				connectors = getConnectionB(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createBAcomplexApv(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;RiviAvivi&quot;:&#xA;				if(thePackage.Name!=&quot;Decomposition Processes&quot;)&#xA;					break;&#xA;				connectors = getConnectionR(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createRAcomplexAvi(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;RiviAvi&quot;:&#xA;				if(thePackage.Name!=&quot;Decomposition Processes&quot;)&#xA;					break;&#xA;				connectors = getConnectionR(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createRAcomplex(consistencyRule, correctCR, thePackage, parameters, connectors,0);&#xA;				break;&#xA;			case &quot;BauApv&quot;:&#xA;				if(thePackage.Name!=&quot;Business Use Cases&quot;)&#xA;					break;&#xA;				connectors = getConnectionB(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createBAcomplex(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;RevBau&quot;:&#xA;			case &quot;ReviBaua&quot;:&#xA;			case &quot;RviBau&quot;:&#xA;			case &quot;RiviBaua&quot;:&#xA;				if(thePackage.Name!=&quot;Decomposition Processes&quot;)&#xA;					break;&#xA;				connectors = getConnectionR(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); &#xA;				createRBcomplexBaua(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;XevBau&quot;:&#xA;			case &quot;XeviBaua&quot;:&#xA;			case &quot;XivBau&quot;:&#xA;			case &quot;XviBau&quot;:&#xA;			case &quot;XiviBaua&quot;:&#xA;				if(thePackage.Name!=&quot;Context Layer&quot;)&#xA;					break;&#xA;				connectors = getConnectionR(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]);&#xA;				//Session.Output(&quot;I.1 &quot;+connectors[0][0].ElementID);//.Name+&quot;;&quot;+connectors[0][0].ElementID+&quot;;&quot;+connectors[0][0].ClassifierID+&quot;;&quot;+connectors[3][0]);&#xA;				//Session.Output(&quot;I.2 &quot;+connectors[0][1].Name+&quot;;&quot;+connectors[0][1].ElementID+&quot;;&quot;+connectors[0][1].ClassifierID+&quot;;&quot;+connectors[3][1]);&#xA;				//Session.Output(&quot;I.3 &quot;+connectors[0][2].ElementID);&#xA;				//Session.Output(&quot;II. &quot;+currentElement.Name+&quot;;&quot;+currentElement.Type+&quot;;&quot;+currentElement.ClassifierID);&#xA;				//Session.Output(&quot;III. &lt;&quot;+parameters[0][0]+&quot;&gt;;&lt;&quot;+parameters[1][0]+&quot;&gt;&quot;);&#xA;				createRBcomplexBaua(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				//createXBcomplex(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			case &quot;XeRi&quot;:&#xA;			case &quot;XiRi&quot;:&#xA;			case &quot;XevRv&quot;:&#xA;			case &quot;XivRv&quot;:&#xA;			case &quot;XviRv&quot;:&#xA;				if(thePackage.Name!=&quot;Context Layer&quot;)&#xA;					break;&#xA;				createXRsimple(consistencyRule, correctCR, thePackage, parameters,currentElement);&#xA;				break;&#xA;			case &quot;XeviRevi&quot;:&#xA;			case &quot;XeviRivi&quot;:&#xA;			case &quot;XiviRivi&quot;:&#xA;				if(thePackage.Name!=&quot;Context Layer&quot;)&#xA;					break;&#xA;				connectors = getConnectionR(thePackage, correctCR, currentElement, parameters[0][0], parameters[0][1], parameters[0][2]); //the first element&#xA;				//Session.Output(&quot;I.1 &quot;+connectors[0][0].Name+&quot;;&quot;+connectors[0][0].ElementID+&quot;;&quot;+connectors[0][0].ClassifierID+&quot;;&quot;+connectors[3][0]);&#xA;				//Session.Output(&quot;I.2 &quot;+connectors[0][1].Name+&quot;;&quot;+connectors[0][1].ElementID+&quot;;&quot;+connectors[0][1].ClassifierID+&quot;;&quot;+connectors[3][1]);&#xA;				//Session.Output(&quot;I.3 &quot;+connectors[0][2].Name+&quot;;&quot;+connectors[0][2].ElementID+&quot;;&quot;+connectors[0][2].ClassifierID+&quot;;&quot;+connectors[3][2]);&#xA;				//Session.Output(&quot;II. &quot;+connectors[1][0].Name+&quot;;&quot;+connectors[1][0].Type);&#xA;				//Session.Output(&quot;III. &quot;+connectors[2][0].Name+&quot;;&quot;+connectors[2][0].Type);&#xA;				//Session.Output(&quot;IV. &quot;+connectors[3][0]+&quot;;&quot;+connectors[3][1]+&quot;;&quot;+connectors[3][2]);&#xA;				createXRcomplex(consistencyRule, correctCR, thePackage, parameters, connectors);&#xA;				break;&#xA;			default:&#xA;				Session.Output( &quot;Consistency rule '&quot; + consistencyRule + &quot;' is correct '&quot;+correctCR+&quot;', changes will be implemented.&quot;);&#xA;		}&#xA;	} else {&#xA;		Session.Output( &quot;Consistency rule '&quot; + consistencyRule + &quot;' is not correct - nothing to do.&quot;);&#xA;		return;&#xA;	}&#xA;}&#xA;//Multiple calls to createRAcomplex depending on multi-value parameters&#xA;function createRAcomplexAvi(consistencyRule, correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var parameter11;&#xA;var parameter31;&#xA;var parameter12;&#xA;var parameter32;&#xA;	&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][0]=parameters[1][2*n];&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;			parameter1[1][0]=(n+1)+&quot;. Action&quot;;&#xA;		if(n==0) {&#xA;			parameter11=&quot;Start&quot;;&#xA;			parameter31=&quot;&quot;;&#xA;		} else {&#xA;			parameter11=parameters[1][2*n-1];&#xA;			parameter31=parameters[3][2*n-1];&#xA;		}&#xA;		parameter12=parameters[1][2*n+1];&#xA;		parameter32=parameters[3][2*n+1];&#xA;		do {&#xA;			if(parameter11.indexOf(&quot;,&quot;)&gt;0) {&#xA;				parameter1[1][1]=parameter11.substr(0,parameter11.indexOf(&quot;,&quot;));&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter11=parameter11.substr(parameter11.indexOf(&quot;,&quot;)+1);&#xA;				parameter1[3][1]=parameter31.substr(0,parameter31.indexOf(&quot;,&quot;));&#xA;				parameter31=parameter31.substr(parameter31.indexOf(&quot;,&quot;)+1);&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter11.length&gt;0)&#xA;					parameter11=parameter11+&quot;,&quot;;&#xA;				if(parameter31.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter31.length&gt;0)&#xA;					parameter31=parameter31+&quot;,&quot;;&#xA;			} else {&#xA;				parameter1[1][1]=parameter11;&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter1[3][1]=parameter31;&#xA;			}&#xA;			do {&#xA;				if(parameter12.indexOf(&quot;,&quot;)&gt;0) {&#xA;					parameter1[1][2]=parameter12.substr(0,parameter12.indexOf(&quot;,&quot;));&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter12=parameter12.substr(parameter12.indexOf(&quot;,&quot;)+1);&#xA;					parameter1[3][2]=parameter32.substr(0,parameter32.indexOf(&quot;,&quot;));&#xA;					parameter32=parameter32.substr(parameter32.indexOf(&quot;,&quot;)+1);&#xA;					if(parameter12.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.length&gt;0)&#xA;						parameter12=parameter12+&quot;,&quot;;&#xA;					if(parameter32.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter32.length&gt;0)&#xA;						parameter32=parameter32+&quot;,&quot;;&#xA;				} else {&#xA;					parameter1[1][2]=parameter12;&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter1[3][2]=parameter32;&#xA;				}&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.indexOf(&quot;,&quot;)&lt;0)&#xA;					createRAcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,1);&#xA;				else&#xA;					createRAcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,0);&#xA;			} while(parameter12.indexOf(&quot;,&quot;)&gt;0);	&#xA;		} while(parameter11.indexOf(&quot;,&quot;)&gt;0);&#xA;	} &#xA;}&#xA;//Multiple calls to createAUcomplex depending on multi-value parameters&#xA;function createAUcomplexUau(consistencyRule, correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=connectors[0].length-1; //how many use cases are there in the rule&#xA;&#xA;	parameter1[1][0]=connectors[0][0].Name;&#xA;	//Session.Output(&quot;Iteration(0)=&quot;+iteration);&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		//Session.Output(&quot;Iteration(1)=&quot;+n+&quot;connector[0][n+1]=&quot;+connectors[0][n+1]);&#xA;		parameter1[1][1]=connectors[0][n+1].Name;&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. Use Case&quot;;&#xA;		createAUcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,n);&#xA;	} &#xA;}&#xA;//Multiple calls to createBAcomplex depending on multi-value parameters&#xA;function createBAcomplexApv(consistencyRule, correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var tmpActors = [];&#xA;	&#xA;	tmpActors=getActorsofUseCase(null, connectors[0][1], 0);&#xA;	tmpActors.reverse();&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][0]=parameters[1][2*n]; //if the partition is empty&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;			if(tmpActors.length&gt;0)&#xA;				parameter1[1][0]=tmpActors.pop();&#xA;			else&#xA;				parameter1[1][0]=&quot;Actor&quot;+(n+1);&#xA;		parameter1[1][1]=parameters[1][2*n+1]; //if the action is empty&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. Action&quot;;&#xA;		if(n+1&gt;=iteration)&#xA;			createBAcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,1);&#xA;		else&#xA;			createBAcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;}&#xA;//Multiple calls to createRBcomplex depending on multi-value parameters&#xA;function createRBcomplexBaua(consistencyRule, correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var parameter11;&#xA;var parameter13;&#xA;var tmpActorL = [];	&#xA;var tmpActorR = [];	&#xA;var iterationL=0;&#xA;var iterationR=0;&#xA;//RevBau, ReviBaua, RviBau, RiviBaua&#xA;	&#xA;	parameter11=parameters[1][0];&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1)==&quot;aua&quot;)&#xA;		parameter13=parameters[1][2];&#xA;	do {&#xA;		if(parameter11.indexOf(&quot;,&quot;)&gt;-1) {&#xA;			tmpActorL.push(parameter11.substr(0,parameter11.indexOf(&quot;,&quot;)));&#xA;			iterationL=iterationL+1;&#xA;			parameter11=parameter11.substr(parameter11.indexOf(&quot;,&quot;)+1);&#xA;		}&#xA;		else {&#xA;			tmpActorL.push(parameter11);&#xA;			iterationL=iterationL+1;&#xA;			parameter11=&quot;&quot;;&#xA;		}&#xA;	} while(parameter11!=&quot;&quot;);&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1)==&quot;aua&quot;) {&#xA;		do {&#xA;			if(parameter13.indexOf(&quot;,&quot;)&gt;-1) {&#xA;				tmpActorR.push(parameter13.substr(0,parameter13.indexOf(&quot;,&quot;)));&#xA;				iterationR=iterationR+1;&#xA;				parameter13=parameter13.substr(parameter13.indexOf(&quot;,&quot;)+1);&#xA;			}&#xA;			else {&#xA;				tmpActorR.push(parameter13);&#xA;				iterationR=iterationR+1;&#xA;				parameter13=&quot;&quot;;&#xA;			}&#xA;		} while(parameter13!=&quot;&quot;);&#xA;	}&#xA;	if(iterationR==0)&#xA;		iterationR=1;&#xA;	if(iterationL==0)&#xA;		iterationL=1;&#xA;	parameter1[0]=parameters[0];&#xA;	parameter1[2]=parameters[2];	&#xA;	parameter1[3]=parameters[3];&#xA;	for(var m=0; m&lt;iterationL; m++) {&#xA;		parameter1[1][0]=tmpActorL[m];&#xA;		parameter1[1][1]=parameters[1][1];&#xA;		for(var n=0; n&lt;iterationR; n++) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1)==&quot;aua&quot;) &#xA;				parameter1[1][2]=tmpActorR[n];	&#xA;			else&#xA;				parameter1[1][2]=&quot; &quot;;	&#xA;			createXBcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors);&#xA;			//createRBcomplex(correctCR, thePackage, parameter1, connectors);&#xA;		}&#xA;	} &#xA;}&#xA;//Verification of the full consistency rule and return of the recognized shortcut&#xA;function verifyConsistencyRule(thePackage, consistencyRule, currentElement) {&#xA;	var stringCR=consistencyRule;&#xA;	var theParentPackage as EA.Package;&#xA;	var theParentParentPackage as EA.Package;&#xA;	var thePParentParentPackage as EA.Package;	&#xA;	&#xA;	theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;	if(theParentPackage.ParentID&gt;0)&#xA;		theParentParentPackage=Repository.GetPackageByID(theParentPackage.ParentID);&#xA;	else&#xA;		theParentParentPackage = null;&#xA;	if(theParentParentPackage!=null&amp;&amp;theParentParentPackage.ParentID&gt;0)&#xA;		thePParentParentPackage=Repository.GetPackageByID(theParentParentPackage.ParentID);&#xA;	else&#xA;		thePParentParentPackage = null;&#xA;	while (stringCR.indexOf(&quot;(&quot;)&gt;0)&#xA;    {&#xA;		var i= stringCR.indexOf(&quot;(&quot;);&#xA;		var string2=stringCR.substr(i);&#xA;		var j = string2.indexOf(&quot;)&quot;);&#xA;		if(j&lt;0)&#xA;			return null;&#xA;		var string1=stringCR.substr(0,i)+stringCR.substr(j+i+1);&#xA;		stringCR=string1;&#xA;    }&#xA;	if(thePackage.Name===&quot;Context Layer&quot;) {&#xA;		if(stringCR==&quot;XeRi&quot;&amp;&amp;currentElement.Type==&quot;Event&quot; || stringCR== &quot;XeRi«information»&quot;&amp;&amp;currentElement.Type==&quot;Event&quot;)&#xA;			return &quot;XeRi&quot;;&#xA;		else if((stringCR==&quot;XevRv&quot;||stringCR== &quot;XevRv«subprocess»&quot;||stringCR== &quot;Xev«process»Rv&quot;||stringCR== &quot;Xev«process»Rv«subprocess»&quot;)&amp;&amp;(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;) )&#xA;			return &quot;XevRv&quot;;&#xA;		else if((stringCR==&quot;XiRi&quot;||stringCR== &quot;Xi«product»Ri&quot;||stringCR== &quot;XiRi«subproduct»&quot;||stringCR== &quot;Xi«product»Ri«subproduct»&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Class&quot;))&#xA;			return &quot;XiRi&quot;; //tutaj zako&#324;czy&#322;em wariancje&#xA;		else if(stringCR==&quot;XivRv&quot;&amp;&amp;(currentElement.Type==&quot;Class&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;) || stringCR== &quot;Xi«rules»v«process»Rv«subprocess»&quot;&amp;&amp;(currentElement.Type==&quot;Class&quot;||currentElement.Type==&quot;Activity&quot;) )&#xA;			return &quot;XivRv&quot;;&#xA;		else if(stringCR==&quot;XviRv&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;) || stringCR==&quot;Xv«process»i«product»Rv«subprocess»&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;) )&#xA;			return &quot;XviRv&quot;;&#xA;		else if(stringCR==&quot;XiviRivi&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Class&quot;) || stringCR==&quot;Xi«product»v«process»i«product»Ri«product»v«subprocess»i«product»&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Class&quot;) )&#xA;			return &quot;XiviRivi&quot;;&#xA;		else if((stringCR==&quot;XeviRevi&quot;||  //tu juz zrobione&#xA;				 stringCR==&quot;Xev«process»iRevi&quot;||stringCR==&quot;Xevi«product»Revi&quot;||stringCR==&quot;XeviRev«subprocess»i&quot;||stringCR==&quot;XeviRevi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Revi&quot;||stringCR==&quot;XeviRev«subprocess»i«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»iRev«subprocess»i&quot;||stringCR==&quot;Xev«process»iRevi«product»&quot;||&#xA;				 stringCR==&quot;Xevi«product»Rev«subprocess»i&quot;||stringCR==&quot;Xevi«product»Revi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Rev«subprocess»i&quot;||stringCR==&quot;Xev«process»i«product»Revi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»iRev«subprocess»i«product»&quot;||stringCR==&quot;Xevi«product»Rev«subprocess»i«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Rev«subprocess»i«product»&quot;)&amp;&amp;&#xA;				 (currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;) )&#xA;			return &quot;XeviRevi&quot;;&#xA;		else if((stringCR==&quot;XeviRivi&quot;||&#xA;				 stringCR==&quot;Xev«process»iRivi&quot;||stringCR==&quot;Xevi«product»Rivi&quot;||stringCR==&quot;XeviRiv«subprocess»i&quot;||stringCR==&quot;XeviRivi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Rivi&quot;||stringCR==&quot;XeviRiv«subprocess»i«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»iRiv«subprocess»i&quot;||stringCR==&quot;Xev«process»iRivi«product»&quot;||&#xA;				 stringCR==&quot;Xevi«product»Riv«subprocess»i&quot;||stringCR==&quot;Xevi«product»Rivi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Riv«subprocess»i&quot;||stringCR==&quot;Xev«process»i«product»Rivi«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»iRiv«subprocess»i«product»&quot;||stringCR==&quot;Xevi«product»Riv«subprocess»i«product»&quot;||&#xA;				 stringCR==&quot;Xev«process»i«product»Riv«subprocess»i«product»&quot;)&amp;&amp;&#xA;				 (currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;) )&#xA;			return &quot;XeviRivi&quot;;&#xA;		else if(stringCR==&quot;XevBau&quot;&amp;&amp;(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;XevBau&quot;;	&#xA;		else if(stringCR==&quot;XviBau&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;XviBau&quot;;&#xA;		else if(stringCR==&quot;XivBau&quot;&amp;&amp;(currentElement.Type==&quot;Class&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;XivBau&quot;;&#xA;		else if(stringCR==&quot;XeviBaua&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;XeviBaua&quot;;	&#xA;		else if(stringCR==&quot;XiviBaua&quot;&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;XiviBaua&quot;;	&#xA;	} else&#xA;	if(thePackage.Name===&quot;Decomposition Processes&quot;) {&#xA;		if((stringCR==&quot;RevBau&quot;||stringCR== &quot;Rev«subprocess»Bau&quot;)&amp;&amp;(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RevBau&quot;;&#xA;		else if((stringCR==&quot;ReviBaua&quot;||stringCR== &quot;Rev«subprocess»iBaua&quot;||stringCR== &quot;Revi«product»Baua&quot;||stringCR== &quot;Rev«subprocess»i«product»Baua&quot;)&amp;&amp;(currentElement.Type==&quot;Event&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;))&#xA;			return &quot;ReviBaua&quot;;&#xA;		else if((stringCR==&quot;RviBau&quot;||stringCR== &quot;Rv«subprocess»i«product»Bau&quot;||stringCR== &quot;Rvi«product»Bau&quot;||stringCR== &quot;Rv«subprocess»iBau&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RviBau&quot;;&#xA;		else if((stringCR==&quot;RiviBaua&quot;|| stringCR== &quot;Riv«subprocess»iBau&quot;||stringCR== &quot;Riv«subprocess»i«product»Bau&quot;||stringCR== &quot;Ri«product»v«subprocess»i«product»Bau&quot;||stringCR== &quot;Ri«product»v«subprocess»iBau&quot;||&#xA;			                       stringCR== &quot;Rivi«product»Bau&quot;||stringCR== &quot;Ri«product»vi«product»Bau&quot;||stringCR== &quot;Ri«product»viBau&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RiviBaua&quot;;&#xA;		else if((stringCR==&quot;RiviAvi&quot;|| stringCR== &quot;Riv«subprocess»iAvi&quot;||stringCR== &quot;Riv«subprocess»i«product»Avi&quot;||stringCR== &quot;Ri«product»v«subprocess»i«product»Avi&quot;||stringCR== &quot;Ri«product»v«subprocess»iAvi&quot;||&#xA;			                       stringCR== &quot;Rivi«product»Avi&quot;||stringCR== &quot;Ri«product»vi«product»Avi&quot;||stringCR== &quot;Ri«product»viAvi&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RiviAvi&quot;;&#xA;		else if((stringCR==&quot;RiviAvivi&quot;||stringCR==&quot;RiviAvivivi&quot;||stringCR==&quot;RiviAvivivivi&quot;||stringCR==&quot;RiviAvivivivivi&quot;||stringCR==&quot;RiviAvivivivivivi&quot;)&amp;&amp;(currentElement.Type==&quot;Object&quot;||currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;))&#xA;			return &quot;RiviAvivi&quot;;&#xA;	} else	&#xA;	if(thePackage.Name===&quot;Business Use Cases&quot;) {&#xA;		if((stringCR==&quot;BauApv&quot;)&amp;&amp;(currentElement.Type==&quot;Actor&quot;||currentElement.Type==&quot;UseCase&quot;))&#xA;			return &quot;BauApv&quot;;&#xA;		else if((stringCR==&quot;BauApvpv&quot;||stringCR==&quot;BauApvpvpv&quot;||stringCR==&quot;BauApvpvpvpv&quot;||stringCR==&quot;BauApvpvpvpvpv&quot;||stringCR==&quot;BauApvpvpvpvpvpv&quot;)&amp;&amp;(currentElement.Type==&quot;Actor&quot;||currentElement.Type==&quot;UseCase&quot;))&#xA;			return &quot;BauApvpv&quot;;&#xA;	} else&#xA;	if(theParentPackage.Name===&quot;Business Process Layer&quot;) {&#xA;		if((stringCR==&quot;ApUau&quot;)&amp;&amp;(currentElement.Type==&quot;ActivityPartition&quot;))&#xA;			return &quot;ApUau&quot;;&#xA;		else if((stringCR==&quot;AiviCczc&quot;)&amp;&amp;(currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;))&#xA;			return &quot;AiviCczc&quot;;		&#xA;		else if((stringCR==&quot;AivSrst&quot;)&amp;&amp;(currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Object&quot;))&#xA;			return &quot;AivSrst&quot;;&#xA;	} else&#xA;	if(theParentPackage.Name===&quot;System Use Case&quot;) {&#xA;		if((stringCR==&quot;UauZpv&quot;||stringCR==&quot;UauZpvpv&quot;||stringCR==&quot;UauZpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpvpvpvpv&quot;||stringCR==&quot;UauZpvpvpvpvpvpvpvpv&quot;)&amp;&amp;(currentElement.Type==&quot;UseCase&quot;||currentElement.Type==&quot;Actor&quot;))&#xA;			return &quot;UauZpv&quot;;&#xA;	} else&#xA;	if(thePackage.Name===&quot;Business Class&quot;) {&#xA;		if((stringCR==&quot;CchZiv&quot;||stringCR==&quot;CchZivi&quot;||stringCR==&quot;CchZivivi&quot;||stringCR==&quot;CchZivivivi&quot;||stringCR==&quot;CchZivivivivi&quot;||stringCR==&quot;CchZivivivivivi&quot;||stringCR==&quot;CchZivivivivivivi&quot;)&amp;&amp;(currentElement.Type==&quot;Class&quot;||currentElement.Type==&quot;Association&quot;))&#xA;			return &quot;CchZiv&quot;;&#xA;	} else	&#xA;	if(thePackage.Name===&quot;Business State&quot;) {&#xA;		if((stringCR==&quot;SrsZiv&quot;||stringCR==&quot;SrsZivi&quot;||stringCR==&quot;SrsZivivi&quot;||stringCR==&quot;SrsZivivivi&quot;||stringCR==&quot;SrsZivivivivi&quot;||stringCR==&quot;SrsZivivivivivi&quot;||stringCR==&quot;SrsZivivivivivivi&quot;)&amp;&amp;(currentElement.Type==&quot;Region&quot;||currentElement.Type==&quot;State&quot;||currentElement.Type==&quot;StateMachine&quot;))&#xA;			return &quot;SrsZiv&quot;;&#xA;	} else	&#xA;	if(theParentParentPackage!=null&amp;&amp;theParentParentPackage.Name===&quot;User Layer&quot;) {&#xA;		if((stringCR==&quot;ZpvYu&quot;)&amp;&amp;currentElement.Type==&quot;ActivityPartition&quot;)&#xA;			return &quot;ZpvYu&quot;;&#xA;	} else&#xA;	if(theParentParentPackage!=null&amp;&amp;theParentParentPackage.Name===&quot;Internal Use Cases&quot;) {&#xA;		if((stringCR==&quot;YuQlm&quot;||stringCR==&quot;YuQlml&quot;||stringCR==&quot;YuQlmlml&quot;||stringCR==&quot;YuQlmlmlml&quot;||stringCR==&quot;YuQlmlmlml&quot;||stringCR==&quot;YuQlmlmlmlml&quot;)&amp;&amp;(currentElement.Type==&quot;UseCase&quot;||currentElement.Type==&quot;Actor&quot;))&#xA;			return &quot;YuQlml&quot;;&#xA;	} else&#xA;	if(thePParentParentPackage!=null&amp;&amp;thePParentParentPackage.Name===&quot;Sequence Layer&quot;) {&#xA;	if(stringCR==&quot;QlmlMqyq&quot;&amp;&amp;(currentElement.Type==&quot;Lifeline&quot;||currentElement.Type==&quot;Sequence&quot;))&#xA;		return &quot;QlmlMqyq&quot;;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Return of rule parameters, and in case of repeating rules, return of extended parameters in index 1 and possibly 3&#xA;function getArgumentsCR(correctCR, consistencyRule)&#xA;{&#xA;	var string0 = consistencyRule;&#xA;	var inParameters = [ null,null];&#xA;	var diagram=0;&#xA;	var parameters = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	//[0]-the first diagram's parameters,[1]-the second diagram's parameters,[2]-the first diagram's states,[3]-the second diagram's states.&#xA;&#xA;	//RiviAvivi, BauApvpv&#xA;	if(correctCR==consistencyRule)&#xA;		return parameters;&#xA;	if(string0.charAt(0)&lt;'A' &amp;&amp; string0.charAt(0)&gt;'Z')&#xA;		return parameters;&#xA;	string0=string0.substring(1);&#xA;	var index=0;&#xA;	while((string0.charAt(0)&lt;'A' || string0.charAt(0)&gt;'Z')&amp;&amp;index&lt;3) {&#xA;		if(string0.charAt(1)=='('||string0.charAt(1)=='«'&amp;&amp;   //i(,e(,v(&#xA;			(string0.charAt(0)=='i'&amp;&amp;string0.charAt(10)=='('|| //i«product»(&#xA;			 string0.charAt(0)=='v'&amp;&amp;string0.charAt(10)=='('|| //v«process»(&#xA;			 string0.charAt(0)=='i'&amp;&amp;string0.charAt(8)=='(')) //i«rules»(&#xA;		{  //there is argument for the next parameter&#xA;			string0=string0.substr(string0.indexOf(&quot;(&quot;));&#xA;			inParameters = [ null,null];&#xA;			inParameters=getInArgument(string0.substr(1,string0.indexOf(&quot;)&quot;)-1), parameters[diagram][index], parameters[diagram+2][index]);&#xA;			parameters[diagram][index]=inParameters[0];&#xA;			parameters[diagram+2][index]=inParameters[1];&#xA;			string0=string0.substr(string0.indexOf(&quot;)&quot;)+1);&#xA;		} else {&#xA;			//there is no argument for the first parameter&#xA;			if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(9)=='»') //i«product»,v«process»&#xA;				string0=string0.substr(10);&#xA;			else if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(7)=='»') //i«rules»(&#xA;				string0=string0.substr(8);&#xA;			else&#xA;				string0=string0.substr(1); //to the second letter&#xA;		}&#xA;		index=index+1;&#xA;	}&#xA;	if(string0.charAt(0)&lt;'A' || string0.charAt(0)&gt;'Z') {&#xA;		//Session.Output(&quot;Interruption of parameter processing at: '&quot;+string0+&quot;'&quot;);&#xA;		return parameters;&#xA;	}&#xA;	else {&#xA;		string0=string0.substr(1); // the second diagram&#xA;		diagram=1;&#xA;	}	&#xA;	//parameters of the second diagram&#xA;	index=0;&#xA;	while(string0!=&quot;&quot;&amp;&amp;string0!=&quot; &quot;) {&#xA;		if(string0.charAt(1)=='('||string0.charAt(1)=='«'&amp;&amp;&#xA;			(string0.charAt(0)=='i'&amp;&amp;string0.charAt(13)=='('|| //i«subproduct»(&#xA;			 string0.charAt(0)=='v'&amp;&amp;string0.charAt(13)=='('|| //v«subprocess»(&#xA;			 string0.charAt(0)=='i'&amp;&amp;string0.charAt(14)=='('|| //i«information»(&#xA;			 string0.charAt(0)=='i'&amp;&amp;string0.charAt(10)=='(')) //i«product»(&#xA;		{  //there is argument for the first parameter&#xA;			string0=string0.substr(string0.indexOf(&quot;(&quot;));&#xA;			inParameters = [ null,null];&#xA;			inParameters=getInArgument(string0.substr(1,string0.indexOf(&quot;)&quot;)-1), parameters[diagram][index], parameters[diagram+2][index]);&#xA;			parameters[diagram][index]=inParameters[0];&#xA;			parameters[diagram+2][index]=inParameters[1];&#xA;			string0=string0.substr(string0.indexOf(&quot;)&quot;)+1);&#xA;		} else &#xA;		if(string0.charAt(0)=='(') {&#xA;			if(string0.indexOf(')')&lt;0)&#xA;				return parameters;&#xA;			parameters.push(string0.substr(1,string0.indexOf(')')-1));&#xA;			index=index-1;&#xA;			string0=string0.substr(string0.indexOf(')')+1);&#xA;		} else {&#xA;			//there is no argument for the first parameter&#xA;			if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(12)=='»') //i«subproduct»,v«subprocess»&#xA;				string0=string0.substr(13);&#xA;			else if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(13)=='»') //i«information»(&#xA;				string0=string0.substr(14);&#xA;			else if(string0.charAt(1)=='«'&amp;&amp;string0.charAt(9)=='»') //i«product»(&#xA;				string0=string0.substr(10);&#xA;			else&#xA;				string0=string0.substr(1);&#xA;			if(index&gt;=3) //RiviAvivi, BauApvpv&#xA;				parameters[diagram][index]=&quot; &quot;;				&#xA;		}&#xA;		index=index+1;&#xA;	}&#xA;	return parameters;&#xA;}&#xA;//Returns the next string for processing and a list of identified states&#xA;function getInArgument(string1, parameter0, parameter2) {&#xA;	var inParameters = [ null,null];&#xA;	var string2;&#xA;	var parA = &quot;&quot;;&#xA;	var parB = &quot;&quot;;&#xA;	&#xA;	if(string1.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;string1.indexOf(&quot;]&quot;)&gt;string1.indexOf(&quot;[&quot;))&#xA;	{&#xA;		string2=string1.substr(string1.indexOf(&quot;[&quot;)+1,string1.indexOf(&quot;]&quot;)-string1.indexOf(&quot;[&quot;)-1);&#xA;		if(string2!=&quot;&quot;) {&#xA;			do {&#xA;				parB = parB +string2; //state&#xA;				parA = parA +string1.substr(0,string1.indexOf(&quot;[&quot;));&#xA;				string1=string1.substr(string1.indexOf(&quot;]&quot;)+1);&#xA;				if(string1.indexOf(&quot;,&quot;)&gt;-1) {&#xA;					parA = parA +string1.substr(0,string1.indexOf(&quot;,&quot;)+1);&#xA;					string1=string1.substr(string1.indexOf(&quot;,&quot;)+1);&#xA;					if(string1.indexOf(&quot;,&quot;)&lt;0&amp;&amp;string1.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;string1.indexOf(&quot;]&quot;)&gt;string1.indexOf(&quot;[&quot;)) {&#xA;						parB = parB + &quot;,&quot;;&#xA;						string2=string1.substr(string1.indexOf(&quot;[&quot;)+1,string1.indexOf(&quot;]&quot;)-string1.indexOf(&quot;[&quot;)-1);&#xA;					} else &#xA;					if(string1.indexOf(&quot;,&quot;)&gt;=0&amp;&amp;string1.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;string1.indexOf(&quot;]&quot;)&gt;string1.indexOf(&quot;[&quot;)&amp;&amp;string1.indexOf(&quot;[&quot;)&lt;string1.indexOf(&quot;,&quot;)) {&#xA;						parB = parB + &quot;,&quot;;&#xA;						string2=string1.substr(string1.indexOf(&quot;[&quot;)+1,string1.indexOf(&quot;]&quot;)-string1.indexOf(&quot;[&quot;)-1);&#xA;					} else &#xA;					if(string1.indexOf(&quot;,&quot;)&gt;=0&amp;&amp;string1.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;string1.indexOf(&quot;]&quot;)&gt;string1.indexOf(&quot;[&quot;)&amp;&amp;string1.indexOf(&quot;[&quot;)&gt;string1.indexOf(&quot;,&quot;)) {&#xA;						parB = parB + &quot;,&quot;;&#xA;						string2=&quot;&quot;;&#xA;					} else &#xA;					if(string1.indexOf(&quot;,&quot;)&lt;0&amp;&amp;string1.indexOf(&quot;[&quot;)&lt;0) {&#xA;						parA = parA +string1;&#xA;						string2=null;&#xA;					}&#xA;				} else {&#xA;					parA = parA +string1;&#xA;					string2=null;&#xA;				}&#xA;			} while (string2!=null);&#xA;		} else&#xA;			parA = string1;&#xA;	} else&#xA;		parA = string1;&#xA;	inParameters[0] = parA;&#xA;	inParameters[1] = parB; 	&#xA;	return inParameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the process decomposition diagram&#xA;function getConnectionR(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var searchConnectors = [ null, null];&#xA;&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.Type==&quot;Event&quot;) { //RevBau, ReviBaua&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		parameters[3][0]=null;&#xA;		if(type.substr(2,1)==&quot;v&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, nameElement2, 0);&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Object&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			parameters[3][1] = searchConnectors[2]; //state od object&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			if(type.substr(3,1)==&quot;i&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 0);&#xA;			else&#xA;			if(type.substr(3,1)!=&quot;B&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Activity&quot;, nameElement3, 0);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][2]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;			    parameters[3][2] = searchConnectors[2]; //state od object				&#xA;			}&#xA;		}&#xA;	}&#xA;	else&#xA;	if((currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;)&amp;&amp;type.substr(2,1)==&quot;v&quot;) {  //RevBau, RiviBaua, ReviBaua, RiviBaua&#xA;		theElement2=currentElement;		&#xA;		parameters[0][1]=theElement2;&#xA;		parameters[3][1]=null;&#xA;		//Session.Output(&quot;gCR-Activity-v&quot;);&#xA;		if(type.substr(1,1)==&quot;e&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Event&quot;, nameElement1, 1);	&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);	&#xA;		//Session.Output(&quot;gCR-Activity-v:searchConn(0)=&quot;+searchConnectors[0]);&#xA;		if(searchConnectors[0]==null&amp;&amp;type.substr(3,1)==&quot;i&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 0);	&#xA;		else&#xA;		if(searchConnectors[0]==null)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 3);	&#xA;		//Session.Output(&quot;gCR-Activity-v:searchConn(1)=&quot;+searchConnectors[0].ElementID);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][0]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			parameters[3][0] = searchConnectors[2]; //state of object&#xA;			theElement1=searchConnectors[0];&#xA;		} &#xA;		if(type.substr(3,1)==&quot;i&quot;) {&#xA;			if(theElement1!=null) {&#xA;				//Session.Output(&quot;gCR-Activity-v:searchConn(2)=&quot;+theElement1.ElementID);&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 4, theElement1);	&#xA;				//Session.Output(&quot;gCR-Activity-v:searchConn(3)=&quot;+searchConnectors[0].ElementID);&#xA;				if(searchConnectors[0]!=null) {&#xA;					parameters[0][2]= searchConnectors[0];&#xA;					parameters[1][1] = searchConnectors[1];&#xA;					parameters[3][2] = searchConnectors[2]; //state of object&#xA;					theElement3=searchConnectors[0];&#xA;				}&#xA;			}&#xA;		}&#xA;		//if type==RiviBaua&#xA;	}&#xA;	else&#xA;	if((currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;)&amp;&amp;type.substr(1,1)==&quot;v&quot;)	{	//RviBau, RvivBuau&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		parameters[3][0] = null; //state od object&#xA;		if(type.substr(2,1)==&quot;i&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Object&quot;, nameElement2, 0);	&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			parameters[3][1] = searchConnectors[2]; //state od object&#xA;			theElement2=searchConnectors[0];&#xA;		}&#xA;		//RvivBuau&#xA;	}&#xA;	else&#xA;	if(currentElement.Type==&quot;Object&quot;&amp;&amp;type.substr(2,1)==&quot;i&quot;) {		//RviBau, RvivBuau - redundant&#xA;		theElement2=currentElement;&#xA;		parameters[0][1]=theElement2;&#xA;		parameters[3][1]=getStatesOfObject(theElement2);&#xA;		if(type.substr(1,1)==&quot;i&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);	&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Activity&quot;, nameElement1, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][0]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			parameters[3][0] = searchConnectors[2]; //state od object&#xA;			theElement1=searchConnectors[0];&#xA;		}&#xA;		//RvivBuau&#xA;	}&#xA;	else&#xA;	if(currentElement.Type==&quot;Object&quot;&amp;&amp;type.substr(3,1)==&quot;i&quot;&amp;&amp;type.substr(1,1)==&quot;i&quot;) //RiviBaua,XiviRivi&#xA;	{		&#xA;		theElement1=currentElement;&#xA;		theElement3=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		parameters[3][0]=getStatesOfObject(theElement1);&#xA;		searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			parameters[3][1] = searchConnectors[2]; //state od object&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 0);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][2]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;				parameters[3][2] = searchConnectors[2]; //state od object&#xA;			}&#xA;		} else {&#xA;			parameters[0][0]=null;&#xA;			parameters[0][2]=currentElement;&#xA;			parameters[3][2]=getStatesOfObject(currentElement);&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, nameElement2, 1);&#xA;			//Session.Output(&quot;R1.&quot;+searchConnectors[0].ElementID);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][1]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;				parameters[3][1] = searchConnectors[2]; //state od object&#xA;				theElement2=searchConnectors[0];&#xA;				searchConnector = [ null, null, null];&#xA;				//Session.Output(&quot;R2.&quot;+theElement2.ElementID+&quot;;&quot;+nameElement1);&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;				//Session.Output(&quot;R3.&quot;+searchConnectors[0]);&#xA;				if(searchConnectors[0]==null) //pointing to an object other than the current one, but in a relationship derived from the activity&#xA;					searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 2, currentElement);&#xA;				//Session.Output(&quot;R4.&quot;+searchConnectors[0].ElementID);&#xA;				if(searchConnectors[0]!=null) {&#xA;					parameters[0][0]= searchConnectors[0];&#xA;					parameters[1][0] = searchConnectors[1];&#xA;					parameters[3][0] = searchConnectors[2]; //state od object&#xA;				}&#xA;			}&#xA;		}&#xA;		//type==RiviBaua - you should look at all objects&#xA;	}&#xA;	else	&#xA;	if(currentElement.Type==&quot;Object&quot;&amp;&amp;type.substr(3,1)==&quot;i&quot;&amp;&amp;type.substr(1,1)!=&quot;i&quot;) {	//ReviBaua-redundant&#xA;		theElement3=currentElement;&#xA;		parameters[0][2]=theElement3;&#xA;		parameters[3][2]=getStatesOfObject(theElement3);&#xA;		if(type.substr(2,1)==&quot;v&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, nameElement3, 1);&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Object&quot;, nameElement3, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][1] = searchConnectors[1];&#xA;			parameters[3][1] = searchConnectors[2]; //state od object&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null, null];&#xA;			if(type.substr(1,1)==&quot;e&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Event&quot;, nameElement1, 1);&#xA;			else&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][0]= searchConnectors[0];&#xA;				parameters[1][0] = searchConnectors[1];&#xA;				parameters[3][0] = searchConnectors[2]; //state od object&#xA;			}&#xA;		}&#xA;	} 	&#xA;	else&#xA;	if(currentElement.Type==&quot;Class&quot;&amp;&amp;type.substr(1,1)==&quot;i&quot;) {	//XivBau&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(type.substr(2,1)==&quot;v&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement2=searchConnectors[0];&#xA;		}&#xA;	}&#xA;&#xA;	return parameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the business use case diagram&#xA;function getConnectionB(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var searchConnectors = [ null, null];&#xA;&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.Type==&quot;Actor&quot;) { //BauApv&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(type.substr(2,1)==&quot;u&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;UseCase&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;		}&#xA;	} else&#xA;	if(currentElement.Type==&quot;UseCase&quot;&amp;&amp;type==&quot;YuQlml&quot;) { //Yua&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(type.substr(1,1)==&quot;u&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;UseCase&quot;, nameElement2, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;		}&#xA;	} else	&#xA;	if(currentElement.Type==&quot;UseCase&quot;) { //BauApv&#xA;		theElement2=currentElement;&#xA;		parameters[0][1]=theElement2;&#xA;		if(type.substr(1,1)==&quot;a&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Actor&quot;, nameElement1, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][0]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;		}&#xA;	}	&#xA;	return parameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the business process diagram&#xA;function getConnectionA(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	//var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var parameters = [ [null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var searchConnectors = [ null, null];&#xA;	var index=0;&#xA;	var statesArray = [];&#xA;	var stateObject;&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(type.substr(0,4)==&quot;AivS&quot;) {&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(nameElement1==null||nameElement1==&quot;&quot;||nameElement1==&quot; &quot;||nameElement1.indexOf(&quot;:&quot;)&lt;0) &#xA;			nameElement1=&quot;:&quot;+(Repository.GetElementByID(theElement1.ClassifierID)).Name;&#xA;		statObject=getStatesOfObject(theElement1);&#xA;		if(statObject==null) &#xA;			return parameters;&#xA;		statesArray.push(statObject);&#xA;		searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, &quot;&quot;, 1);&#xA;		if(searchConnectors[0]!=null) {&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;			if(searchConnectors[0]!=null) {&#xA;				theElement3=searchConnectors[0];&#xA;				statObject=getStatesOfObject(theElement3);&#xA;				if(statObject==null) &#xA;					return parameters;&#xA;				statesArray.push(statObject);				&#xA;				searchConnector = [ null, null];&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, &quot;&quot;, 1);&#xA;				if(searchConnectors[0]!=null) {&#xA;					theElement2=searchConnectors[0];&#xA;					searchConnector = [ null, null];&#xA;					searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;					if(searchConnectors[0]!=null) {&#xA;						theElement3=searchConnectors[0];&#xA;						statObject=getStatesOfObject(theElement3);&#xA;						if(statObject==null) &#xA;							return parameters;&#xA;						statesArray.push(statObject);				&#xA;						searchConnector = [ null, null];&#xA;						searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, &quot;&quot;, 1);&#xA;						if(searchConnectors[0]!=null) {&#xA;							theElement2=searchConnectors[0];&#xA;							searchConnector = [ null, null];&#xA;							searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;							if(searchConnectors[0]!=null) {&#xA;								theElement3=searchConnectors[0];&#xA;								statObject=getStatesOfObject(theElement3);&#xA;								if(statObject==null) &#xA;									return parameters;&#xA;								statesArray.push(statObject);				&#xA;								searchConnector = [ null, null];&#xA;							}&#xA;						}&#xA;					}&#xA;				}&#xA;			}				&#xA;		}&#xA;		statesArray.reverse();&#xA;		searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, &quot;&quot;, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 0);&#xA;			if(searchConnectors[0]!=null) {&#xA;				theElement3=searchConnectors[0];&#xA;				statObject=getStatesOfObject(theElement3);&#xA;				if(statObject==null) &#xA;					return parameters;&#xA;				statesArray.push(statObject);				&#xA;				searchConnector = [ null, null];&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, &quot;&quot;, 0);&#xA;				if(searchConnectors[0]!=null) {&#xA;					theElement2=searchConnectors[0];&#xA;					searchConnector = [ null, null];&#xA;					searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 0);&#xA;					if(searchConnectors[0]!=null) {&#xA;						theElement3=searchConnectors[0];&#xA;						statObject=getStatesOfObject(theElement3);&#xA;						if(statObject==null) &#xA;							return parameters;&#xA;						statesArray.push(statObject);				&#xA;						searchConnector = [ null, null];&#xA;						searchConnectors=searchConnectorsinElement(thePackage, theElement3, &quot;Activity&quot;, &quot;&quot;, 0);&#xA;						if(searchConnectors[0]!=null) {&#xA;							theElement2=searchConnectors[0];&#xA;							searchConnector = [ null, null];&#xA;							searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 0);&#xA;							if(searchConnectors[0]!=null) {&#xA;								theElement3=searchConnectors[0];&#xA;								statObject=getStatesOfObject(theElement3);&#xA;								if(statObject==null) &#xA;									return parameters;&#xA;								statesArray.push(statObject);				&#xA;								searchConnector = [ null, null];&#xA;							}&#xA;						}&#xA;					}&#xA;				}&#xA;			}				&#xA;		}&#xA;		statesArray.reverse();&#xA;		var index=0;&#xA;		while(statesArray.length&gt;0) {&#xA;			statObject=statesArray.pop();&#xA;			parameters[1][index]=statObject;&#xA;			index++;&#xA;		}&#xA;	} else&#xA;	if(currentElement.Type==&quot;ActivityPartition&quot;) { //ApvUau&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		for(var i=0; i&lt;currentElement.Elements.Count(); i++) {&#xA;			theElement2=currentElement.Elements.GetAt(i);&#xA;			if(theElement2.Type==&quot;Action&quot;||theElement2.Type==&quot;Activity&quot;) {&#xA;				index++;&#xA;				parameters[0][index]=theElement2;				&#xA;			}&#xA;		}&#xA;	} else&#xA;	if(currentElement.Type==&quot;Object&quot;) { //AiviCczc&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		if(type.substr(2,1)==&quot;v&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Activity&quot;, nameElement2, 0);&#xA;		else&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement1, &quot;Object&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][1]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement2=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			if(type.substr(3,1)==&quot;i&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 5, theElement1);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][2]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;			}&#xA;		}&#xA;	} else&#xA;	if(currentElement.Type==&quot;Action&quot;||currentElement.Type==&quot;Activity&quot;) { //AiviCczc&#xA;		var reverseDirection=false;&#xA;		theElement2=currentElement;&#xA;		parameters[0][1]=theElement2;&#xA;		if(type.substr(2,1)==&quot;v&quot;)&#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 1);&#xA;		else &#xA;			searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement2, 0);&#xA;		if(searchConnectors[0]!=null) {&#xA;			parameters[0][0]= searchConnectors[0];&#xA;			parameters[1][0] = searchConnectors[1];&#xA;			theElement1=searchConnectors[0];&#xA;			searchConnector = [ null, null];&#xA;			if(type.substr(3,1)==&quot;i&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 5, theElement1);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][2]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;			} else &#xA;				reverseDirection=true;&#xA;		} else &#xA;			reverseDirection=true;&#xA;		if(reverseDirection) {&#xA;			if(type.substr(2,1)==&quot;v&quot;)&#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement1, 0);&#xA;			else &#xA;				searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement2, 1);&#xA;			if(searchConnectors[0]!=null) {&#xA;				parameters[0][2]= searchConnectors[0];&#xA;				parameters[1][1] = searchConnectors[1];&#xA;				theElement3=searchConnectors[0];&#xA;				searchConnector = [ null, null];&#xA;				if(type.substr(3,1)==&quot;i&quot;)&#xA;					searchConnectors=searchConnectorsinElement(thePackage, theElement2, &quot;Object&quot;, nameElement3, 6, theElement3);&#xA;				if(searchConnectors[0]!=null) {&#xA;					parameters[0][0]= searchConnectors[0];&#xA;					parameters[1][0] = searchConnectors[1];&#xA;				}&#xA;			}&#xA;		}&#xA;	} 	&#xA;	return parameters;&#xA;}&#xA;//Returning the state of a given element&#xA;function getStatesOfObject(theElement) {&#xA;	var sqlCommand=&quot;select StateFlags from t_object where object_id = &quot;+theElement.ElementID;&#xA;	var sqlRespond=Repository.SQLQuery(sqlCommand);&#xA;	var stateObject=null;&#xA;	if(sqlRespond!=null)&#xA;		stateObject=sqlRespond.substr(sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)+12, sqlRespond.indexOf(&quot;&lt;/StateFlags&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;StateFlags&gt;&quot;)-12);&#xA;	if(stateObject==null||stateObject==&quot;&quot;)&#xA;		return null;&#xA;	else&#xA;		return stateObject;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the sequence diagram&#xA;function getConnectionQ(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Connector;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.ObjectType==otConnector) { //QlmlMqyq&#xA;		theElement1=Repository.GetElementByID(currentElement.ClientID);&#xA;		theElement2=currentElement;&#xA;		theElement3=Repository.GetElementByID(currentElement.SupplierID);&#xA;		parameters[0][0]=theElement1;&#xA;		parameters[0][1]=theElement2;&#xA;		parameters[0][2]=theElement3;&#xA;		if((nameElement1==null||nameElement1==&quot;&quot;||nameElement1==&quot; &quot;)&amp;&amp;(nameElement2==null||nameElement2==&quot;&quot;||nameElement2==&quot; &quot;)&amp;&amp;(nameElement3==null||nameElement3==&quot;&quot;||nameElement3==&quot; &quot;)) {&#xA;			for( var k=0; k&lt;theElement3.Connectors.Count;k++) {&#xA;				theElement2=theElement3.Connectors.GetAt(k);&#xA;				if(theElement2.Type==&quot;Sequence&quot;&amp;&amp;theElement2.Name==currentElement.Name&amp;&amp;theElement2.ClientID==theElement3.ElementID&amp;&amp;theElement2.SupplierID!=theElement1.ElementID) {&#xA;					parameters[0][3]=theElement2;&#xA;					parameters[0][4]=Repository.GetElementByID(theElement2.SupplierID);&#xA;					break;&#xA;				}&#xA;			}&#xA;			/*if(parameters[0][4]!=null)&#xA;				Session.Output(&quot;getConnectionQ: parameters[0][4].Type=&quot;+parameters[0][4].Type);&#xA;			else&#xA;				Session.Output(&quot;getConnectionQ: parameters[0][4].Type=null&quot;);*/&#xA;			if(parameters[0][4]!=null&amp;&amp;parameters[0][4].Type==&quot;Sequence&quot;) {&#xA;				for( var k=0; k&lt;parameters[0][4].Connectors.Count;k++) {&#xA;					theElement2=parameters[0][4].Connectors.GetAt(k);&#xA;					if(theElement2.Type==&quot;Sequence&quot;&amp;&amp;theElement2.Name==currentElement.Name&amp;&amp;theElement2.ClientID==parameters[0][4].ElementID&amp;&amp;theElement2.SupplierID!=parameters[0][2].ElementID) {&#xA;						parameters[0][5]=theElement2;&#xA;						parameters[0][6]=Repository.GetElementByID(theElement2.SupplierID);&#xA;						break;&#xA;					}&#xA;				}				&#xA;			}&#xA;			/*if(parameters[0][6]!=null)&#xA;				Session.Output(&quot;getConnectionQ: parameters[0][6].Type=&quot;+parameters[0][6].Type);&#xA;			else&#xA;				Session.Output(&quot;getConnectionQ: parameters[0][6].Type=null&quot;);*/			&#xA;			if(parameters[0][6]!=null&amp;&amp;parameters[0][6].Type==&quot;Sequence&quot;) {&#xA;				for( var k=0; k&lt;parameters[0][6].Connectors.Count;k++) {&#xA;					theElement2=parameters[0][6].Connectors.GetAt(k);&#xA;					if(theElement2.Type==&quot;Sequence&quot;&amp;&amp;theElement2.Name==currentElement.Name&amp;&amp;theElement2.ClientID==parameters[0][6].ElementID&amp;&amp;theElement2.SupplierID!=parameters[0][4].ElementID) {&#xA;						parameters[0][7]=theElement2;&#xA;						parameters[0][8]=Repository.GetElementByID(theElement2.SupplierID);&#xA;						break;&#xA;					}&#xA;				}				&#xA;			}&#xA;		}&#xA;	} else&#xA;	if(currentElement.ObjectType==otElement) { //QlmlMqyq&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;		for( var k=0; k&lt;theElement1.Connectors.Count;k++) {&#xA;			theElement2=theElement1.Connectors.GetAt(k);&#xA;			if(theElement2.Type==&quot;Sequence&quot;&amp;&amp;theElement2.ClientID==theElement1.ElementID) {&#xA;				parameters[0][1]=theElement2;&#xA;				parameters[0][2]=Repository.GetElementByID(theElement2.SupplierID);&#xA;				break;&#xA;			}&#xA;		}&#xA;	} 	&#xA;	/*for(var k=0;k&lt;parameters[0].length;k++) {&#xA;		Session.Output(&quot;getConnectionQ(&quot;+k+&quot;):&quot;+parameters[0][k].Name+&quot;; &quot;+parameters[0][k].Type+&quot;; &quot;+parameters[0][k].ElementID);&#xA;	}*/&#xA;	return parameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the business class diagram&#xA;function getConnectionC(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.ObjectType==otConnector) { //CchZiv&#xA;		theElement1=Repository.GetElementByID(currentElement.ClientID);&#xA;		theElement2=currentElement;&#xA;		theElement3=Repository.GetElementByID(currentElement.SupplierID);&#xA;		parameters[0][0]=theElement1;&#xA;		parameters[0][1]=theElement2;&#xA;		parameters[0][2]=theElement3;&#xA;	} else&#xA;	if(currentElement.ObjectType==otElement) { //CchZiv&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;	} 	&#xA;	return parameters;&#xA;}&#xA;//Returns the source elements [0] of the consistency rule and the connections [1] of these elements from the business state machine diagram&#xA;function getConnectionS(thePackage, type, currentElement, nameElement1, nameElement2, nameElement3)&#xA;{&#xA;	//indicated by the new elements from the R diagram are connected to each other&#xA;	var theElement1 as EA.Element;&#xA;	var theElement2 as EA.Element;&#xA;	var theElement3 as EA.Element;&#xA;	var parameters = [ [null,null,null], [null,null], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	&#xA;	theElement1=null;&#xA;	theElement2=null;&#xA;	theElement3=null;&#xA;	if(currentElement.ObjectType==otConnector) { //SrsZiv&#xA;		theElement1=Repository.GetElementByID(currentElement.ClientID);&#xA;		theElement2=currentElement;&#xA;		theElement3=Repository.GetElementByID(currentElement.SupplierID);&#xA;		parameters[0][0]=theElement1;&#xA;		parameters[0][1]=theElement2;&#xA;		parameters[0][2]=theElement3;&#xA;	} else&#xA;	if(currentElement.ObjectType==otElement) { //SrsZiv&#xA;		theElement1=currentElement;&#xA;		parameters[0][0]=theElement1;&#xA;	} 	&#xA;	return parameters;&#xA;}&#xA;//Create target elements in composite consistency rule from context diagram to process decomposition diagram&#xA;function createXRcomplex(consistencyRule, correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var nameOfSub=null;&#xA;	var nameOfObject1=null;&#xA;	var nameOfObject1withState=null;&#xA;	var nameOfClass1=null;&#xA;	var identOfClass1=null;&#xA;	var nameOfObject2=null;&#xA;	var nameOfObject2withState=null;&#xA;	var nameOfClass2=null;&#xA;	var identOfClass2=null;&#xA;	var retParam1 = [ null, null, null, null];&#xA;	var retParam2 = [ null, null, null, null];&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;PDD&quot;,&quot;&quot;,consistencyRule,conns);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	//Set the name of the target element&#xA;	retParam1=setParameterValueRi(params, conns, 0, correctCR);//brakuje przeniesienia statusu z obiektu &#378;ród&#322;owego&#xA;	if(retParam1!=null) {&#xA;		nameOfObject1=retParam1[0];&#xA;		nameOfObject1withState=retParam1[1];&#xA;		nameOfClass1=retParam1[2];&#xA;		identOfClass1=retParam1[3];&#xA;	}&#xA;	nameOfSub=setParameterValueRv(params, conns, 1, &quot;subprocess&quot;);&#xA;	retParam2=setParameterValueRi(params, conns, 2, correctCR);&#xA;	if(retParam2!=null) {&#xA;		nameOfObject2=retParam2[0];&#xA;		nameOfObject2withState=retParam2[1];&#xA;		nameOfClass2=retParam2[2];&#xA;		identOfClass2=retParam2[3];&#xA;	}&#xA;	//Session.Output(&quot;1.&quot;+nameOfObject1+&quot;;&quot;+nameOfObject1withState+&quot;//&quot;+params[3][0]+&quot;;&quot;+nameOfClass1+&quot;;&quot;+identOfClass1);&#xA;	//Session.Output(&quot;2.&quot;+nameOfSub);	&#xA;	//Session.Output(&quot;3.&quot;+nameOfObject2+&quot;;&quot;+nameOfObject2withState+&quot;//&quot;+params[3][2]+&quot;;&quot;+nameOfClass2+&quot;;&quot;+identOfClass2);&#xA;&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var i = 0, j=0 ; i &lt; diagramObjects.Count ; i++ )&#xA;	{&#xA;		var coto as EA.Element;&#xA;		var cotoParent as EA.Element;&#xA;		var nameOfState=null;&#xA;		&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID&gt;0)&#xA;			coto=Repository.GetElementByID(diagramObject.ElementID);&#xA;		else&#xA;			coto=null;&#xA;		if(coto.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(coto.Type==&quot;Object&quot;)&#xA;			nameOfState=getStatesOfObject(coto);&#xA;		//Session.Output(&quot;A.&quot;+diagramObject.ElementID+&quot;;&quot;+coto.Type+&quot;;&lt;&quot;+coto.Name+&quot;&gt;;&quot;+coto.ClassifierID+&quot;;&quot;+nameOfState);&#xA;		if(diagramObject1==null&amp;&amp;conns[0][0]!=null&amp;&amp;conns[0][0].ElementID == diagramObject.ElementID) //verification of the element linked from the X diagram &#xA;			diagramObject1=diagramObject; //The element1 from X is linked to the object diagram&#xA;		else&#xA;		if(diagramObject1==null&amp;&amp;coto.Type==&quot;Event&quot;&amp;&amp;coto.Name==params[1][0]) //verification of an existing element in the R diagram&#xA;			diagramObject1=diagramObject; //The element1 from X is not linked to the object diagram&#xA;		else&#xA;		if(diagramObject1==null) {&#xA;			//Session.Output(&quot;A.a(&quot;+i+&quot;)&quot;+coto.Type+&quot;;&lt;&quot;+coto.Name==nameOfObject1+&quot;&gt;;identClass1=&quot;+identOfClass1+&quot;;nameOfClass1=&quot;+nameOfClass1);&#xA;			if(coto.Type==&quot;Object&quot;&amp;&amp;((coto.Name==&quot;&quot;||coto.Name==&quot; &quot;)&amp;&amp;(nameOfObject1==&quot;&quot;||nameOfObject1==&quot; &quot;)||coto.Name==nameOfObject1)&amp;&amp;(identOfClass1!=null&amp;&amp;cotoParent.ElementID==identOfClass1||nameOfClass1!=null&amp;&amp;nameOfClass1.substr(1)==cotoParent.Name)) {&#xA;				//Session.Output(&quot;AB.a&quot;);&#xA;				if(nameOfObject1withState==null&amp;&amp;nameOfState==null||nameOfObject1withState!=null&amp;&amp;nameOfState!=null&amp;&amp;nameOfState==nameOfObject1withState.substr(nameOfObject1withState.indexOf(&quot;[&quot;)+1,nameOfObject1withState.indexOf(&quot;]&quot;)-nameOfObject1withState.indexOf(&quot;[&quot;)-1))&#xA;					diagramObject1=diagramObject; &#xA;			}&#xA;		}&#xA;		else&#xA;		if(diagramObject2==null&amp;&amp;(coto.Type==&quot;Activity&quot;||coto.Type==&quot;Action&quot;)&amp;&amp;coto.Name==nameOfSub) //verification of an existing element in the R diagram&#xA;			diagramObject2=diagramObject; //The element1 from X is linked to the object diagram&#xA;		else&#xA;		if(diagramObject3==null&amp;&amp;conns[0][2]!=null&amp;&amp;conns[0][2].ElementID == diagramObject.ElementID) &#xA;			diagramObject3=diagramObject; //The element3 from X is linked to the object diagram&#xA;		else&#xA;		if(diagramObject3==null) {&#xA;			//Session.Output(&quot;A.a(&quot;+i+&quot;)&quot;+coto.Type+&quot;;&lt;&quot;+coto.Name+&quot;&gt;==&lt;&quot;+nameOfObject2+&quot;&gt;;identOfClass2=&quot;+identOfClass2+&quot;;nameOfClass2=&quot;+nameOfClass2);&#xA;			if(coto.Type==&quot;Object&quot;&amp;&amp;((coto.Name==&quot;&quot;||coto.Name==&quot; &quot;)&amp;&amp;(nameOfObject2==&quot;&quot;||nameOfObject2==&quot; &quot;)||coto.Name==nameOfObject2)&amp;&amp;(identOfClass2!=null&amp;&amp;cotoParent.ElementID==identOfClass2||nameOfClass2!=null&amp;&amp;nameOfClass2.substr(1)==cotoParent.Name)) {&#xA;				//Session.Output(&quot;AB.a&quot;);&#xA;				if(nameOfObject2withState==null&amp;&amp;nameOfState==null||nameOfObject2withState!=null&amp;&amp;nameOfState!=null&amp;&amp;nameOfState==nameOfObject2withState.substr(nameOfObject2withState.indexOf(&quot;[&quot;)+1,nameOfObject2withState.indexOf(&quot;]&quot;)-nameOfObject2withState.indexOf(&quot;[&quot;)-1))&#xA;					diagramObject3=diagramObject; &#xA;			}&#xA;		}&#xA;		//if(coto.Type==&quot;Object&quot;)&#xA;			//Session.Output(&quot;a(&quot;+i+&quot;):&lt;&quot;+coto.Name+&quot;&gt;;&quot;+cotoParent.ClassifierID+&quot;;&quot;+cotoParent.Name+&quot;;&quot;+nameOfState);&#xA;	}&#xA;	/*if(diagramObject1==null)&#xA;		Session.Output(&quot;g1. null&quot;);	&#xA;	else&#xA;		Session.Output(&quot;g1. &quot;+diagramObject1.ElementID);			&#xA;	if(diagramObject2==null)&#xA;		Session.Output(&quot;g2. null&quot;);	&#xA;	else&#xA;		Session.Output(&quot;g2. &quot;+diagramObject2.ElementID);		&#xA;	if(diagramObject3==null)&#xA;		Session.Output(&quot;g3. null&quot;);	&#xA;	else&#xA;		Session.Output(&quot;g3. &quot;+diagramObject3.ElementID);*/		&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		var parentElement as EA.Element;&#xA;		var nameOfState=null;&#xA;		&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.Type==&quot;Object&quot;) {&#xA;			nameOfState=getStatesOfObject(currentElement);&#xA;			if(currentElement.ClassifierID&gt;0) {&#xA;				parentElement=Repository.GetElementByID(currentElement.ClassifierID);&#xA;				//Session.Output(&quot;A.&quot;+currentElement.ElementID+&quot;;&quot;+currentElement.Type+&quot;;&lt;&quot;+currentElement.Name+&quot;&gt;;&quot;+currentElement.ClassifierID+&quot;;&quot;+parentElement.Name+&quot;;&quot;+nameOfState);&#xA;			} //else&#xA;				//Session.Output(&quot;A.&quot;+currentElement.ElementID+&quot;;&quot;+currentElement.Type+&quot;;&lt;&quot;+currentElement.Name+&quot;&gt;;&quot;+currentElement.ClassifierID+&quot;;null;&quot;+nameOfState);&#xA;		}&#xA;		else {&#xA;			parentElement=null;&#xA;			nameOfState=null;&#xA;		}&#xA;		if(currentElement.Type==&quot;Event&quot;&amp;&amp;currentElement.Name==nameOfObject1|| //XeviRe(name1)vi, XiviRi(name1)vi&#xA;			currentElement.Type==&quot;Object&quot;&amp;&amp;(currentElement.Name==nameOfObject1||(currentElement.Name==&quot;&quot;||currentElement.Name==&quot; &quot;)&amp;&amp;(nameOfObject1==&quot;&quot;||nameOfObject1==&quot; &quot;))&amp;&amp;&#xA;		    currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;&#xA;			(identOfClass1!=null&amp;&amp;identOfClass1==currentElement.ClassifierID||nameOfClass1!=null&amp;&amp;nameOfClass1.substr(1)==parentElement.Name)&amp;&amp;&#xA;			(nameOfObject1withState==null&amp;&amp;nameOfState==null||nameOfObject1withState!=null&amp;&amp;nameOfState!=null&amp;&amp;nameOfState==nameOfObject1withState.substr(nameOfObject1withState.indexOf(&quot;[&quot;)+1,nameOfObject1withState.indexOf(&quot;]&quot;)-nameOfObject1withState.indexOf(&quot;[&quot;)-1))) &#xA;			delement1=currentElement;&#xA;		else 		&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;(currentElement.Type==&quot;Activity&quot;||currentElement.Type==&quot;Action&quot;)&amp;&amp;currentElement.Name==nameOfSub) //XeviRev(name1)i, XiviRiv(name1)i&#xA;			delement2=currentElement;&#xA;		else 		&#xA;		if(currentElement.Type==&quot;Object&quot;&amp;&amp;&#xA;			(currentElement.Name==nameOfObject2||(currentElement.Name==&quot;&quot;||currentElement.Name==&quot; &quot;)&amp;&amp;(nameOfObject2==&quot;&quot;||nameOfObject2==&quot; &quot;))&amp;&amp;&#xA;		    currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;&#xA;			(identOfClass2!=null&amp;&amp;identOfClass2==currentElement.ClassifierID||nameOfClass2!=null&amp;&amp;nameOfClass2.substr(1)==parentElement.Name)&amp;&amp;&#xA;			(nameOfObject2withState==null&amp;&amp;nameOfState==null||nameOfObject2withState!=null&amp;&amp;nameOfState!=null&amp;&amp;nameOfState==nameOfObject2withState.substr(nameOfObject2withState.indexOf(&quot;[&quot;)+1,nameOfObject2withState.indexOf(&quot;]&quot;)-nameOfObject2withState.indexOf(&quot;[&quot;)-1))) &#xA;			delement3=currentElement;	&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;delement3!=null)&#xA;			break;&#xA;	}&#xA;	/*if(delement1==null)&#xA;		Session.Output(&quot;e1. null&quot;);	&#xA;	else&#xA;		Session.Output(&quot;e1. &quot;+delement1.Name+&quot;;&quot;+delement1.ElementID);		&#xA;	if(delement2==null)&#xA;		Session.Output(&quot;e2. null&quot;);	&#xA;	else&#xA;		Session.Output(&quot;e2. &quot;+delement2.Name+&quot;;&quot;+delement2.ElementID);		&#xA;	if(delement3==null)&#xA;		Session.Output(&quot;e3. null&quot;);	&#xA;	else&#xA;		Session.Output(&quot;e3. &quot;+delement3.Name+&quot;;&quot;+delement3.ElementID);*/		&#xA;	&#xA;	if(delement1==null) { //There is no element1 in the package, but this element could have been placed in the R diagram via a link from the package containing the X diagram&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null||conns[0][0].Name!=params[1][0].Name) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;e&quot;) { &#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0]!=conns[0][0].Name) {&#xA;					testElement = subPackage.Elements.AddNew( params[1][0], &quot;Event&quot; ); //&quot;Event&quot; equals &quot;Signal&quot; too&#xA;					testElement.Subtype=1; //Receive&#xA;					if(conns[0][0]!=null) {&#xA;						//an aggregation to the event from diagram X should be created&#xA;						// Create a connector between the two elements&#xA;						var connector = testElement.Connectors.AddNew(&quot;&quot;, &quot;Aggregation&quot;);&#xA;						connector.SupplierID = conns[0][0].ElementID;&#xA;						connector.Update();&#xA;						//testElement.Connectors.Refresh;&#xA;					}&#xA;					if((tagValue=getTagValueforElement(&quot;PDD&quot;,&quot;Event&quot;,params[1][0]))!=null) {&#xA;						var taggedValue as EA.TaggedValue;&#xA;						taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;						taggedValue.Update();&#xA;					}&#xA;					testElement.Update();&#xA;					diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;					setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;				} else&#xA;				if(params[1][0]!=null&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]!=&quot; &quot;&amp;&amp;params[1][0]==conns[0][0].Name)) {&#xA;					//XeviRe()vi||Xe(name1)viRe(name1)vi&#xA;					testElement=conns[0][0];&#xA;				} else&#xA;					Session.Output(&quot;Line 1695, params, conns:&quot;+params+&quot;\n&quot;+conns[0][0].Name+&quot;'&quot;+conns[0][1].Name+&quot;,&quot;+conns[0][2].Name);&#xA;			} else&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;) { &#xA;				if(nameOfObject1withState!=null)&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject1withState.substr(0,nameOfObject1withState.indexOf(&quot;[&quot;)-1), &quot;Object&quot; );&#xA;				else if(nameOfObject1!=null)&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject1, &quot;Object&quot; );&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( &quot;&quot;, &quot;Object&quot; );&#xA;				if(identOfClass1!=null)&#xA;					testElement.ClassifierID=identOfClass1;&#xA;				else&#xA;				if(nameOfClass1!=null&amp;&amp;nameOfClass1.substr(0,1)==&quot;:&quot;) {&#xA;					//new class - can we look at the class with the same name earlier?&#xA;					nameOfClass1=nameOfClass1.substr(1);&#xA;					coto=searchForElement(subPackage, nameOfClass1, &quot;Class&quot;);&#xA;					if(coto==null) {&#xA;						testClass = subPackage.Elements.AddNew(nameOfClass1, &quot;Class&quot;);&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					} else {&#xA;						testClass = coto;&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					}&#xA;				} else if(nameOfClass1!=null&amp;&amp;nameOfClass1==&quot; &quot;) {&#xA;					//without the class&#xA;					nameOfClass1=&quot;Class&quot;;&#xA;				} else {&#xA;					if(conns[0][0]!=null&amp;&amp;conns[0][0].Name!=&quot; &quot;)&#xA;						testElement.ClassifierID=conns[0][0].ClassifierID;&#xA;				}&#xA;				if((tagValue=getTagValueforElement(&quot;PDD&quot;,&quot;Object&quot;,(nameOfObject1withState!=null) ? nameOfObject1withState + &quot;:&quot; + nameOfClass1 : nameOfObject1+&quot;[]&quot;+&quot;:&quot;+nameOfClass1))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				//update the state of object&#xA;				if(params[3][0]!=&quot;&quot;&amp;&amp;params[3][0]!=&quot; &quot;)  {//the state of the object must be set&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+params[3][0]+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);&#xA;				} else {&#xA;					if(conns[0][0]!=null) {&#xA;						var stateObject=getStatesOfObject(conns[0][0]);&#xA;						if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;							var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;							Repository.Execute(sqlCommand);&#xA;						}							&#xA;					}							&#xA;				}	&#xA;				diagramObject1=null; //diagramObject1 is the object from the X diagram&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;			}&#xA;			delement1=testElement;&#xA;		} else &#xA;			delement1=conns[0][0];&#xA;	}&#xA;	if(delement2==null) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+2,1)==&quot;v&quot;) { &#xA;				testElement = subPackage.Elements.AddNew( nameOfSub, &quot;Activity&quot; );&#xA;				testElement.Stereotype=&quot;process&quot;;&#xA;				testElement.StereotypeEx=&quot;process&quot;;&#xA;				var tagValue=null;&#xA;				if((tagValue=getTagValueforElement(&quot;PDD&quot;,&quot;Activity&quot;,nameOfSub))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][1],testElement);&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} else &#xA;			delement2=conns[0][1];&#xA;	}&#xA;	if(delement3==null) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null||&#xA;			diagramObject3!=null&amp;&amp;conns[0][2].ElementID==diagramObject3.ElementID|| //the target element comes from the X diagram&#xA;			params[1][2]!=null&amp;&amp;params[1][2].indexOf(&quot;:&quot;)&gt;-1&amp;&amp;conns[0][2].ClassifierID&gt;0&amp;&amp;params[1][2].substr(params[1][2].indexOf(&quot;:&quot;)+1)!= (Repository.GetElementByID(conns[0][2].ClassfierID)).Name ) {  //inherited class is not the same as identified class&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+3,1)==&quot;i&quot;) { &#xA;				if(nameOfObject2withState!=null)&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject2withState.substr(0,nameOfObject2withState.indexOf(&quot;[&quot;)-1), &quot;Object&quot; );&#xA;				else if(nameOfObject2!=null)&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject2, &quot;Object&quot; );&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( &quot;&quot;, &quot;Object&quot; );&#xA;				if(identOfClass2!=null)&#xA;					testElement.ClassifierID=identOfClass2;&#xA;				else&#xA;				if(nameOfClass2.substr(0,1)==&quot;:&quot;) {&#xA;					//new class - can we look at the class with the same name earlier?&#xA;					nameOfClass2=nameOfClass2.substr(1);&#xA;					coto=searchForElement(subPackage, nameOfClass2, &quot;Class&quot;);&#xA;					if(coto==null) {&#xA;						testClass = subPackage.Elements.AddNew(nameOfClass2, &quot;Class&quot;);&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					} else {&#xA;						testClass = coto;&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					}&#xA;				} else if(nameOfClass2==&quot; &quot;) {&#xA;					//without the class&#xA;					nameOfClass2=&quot;Class&quot;;&#xA;				} else {&#xA;					if(conns[0][2]!=null&amp;&amp;conns[0][2].Name!=&quot; &quot;)&#xA;						testElement.ClassifierID=conns[0][2].ClassifierID;&#xA;				}&#xA;				if((tagValue=getTagValueforElement(&quot;PDD&quot;,&quot;Object&quot;,(nameOfObject2withState!=null) ? nameOfObject2withState + &quot;:&quot; + nameOfClass2 : nameOfObject2+&quot;[]&quot;+&quot;:&quot;+nameOfClass2))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				if(params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;)  {//the state of the object must be set&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+params[3][2]+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);&#xA;				} else {&#xA;					if(conns[0][2]!=null) {&#xA;						var stateObject=getStatesOfObject(conns[0][2]);&#xA;						//Session.Output(&quot;X.state=&quot;+stateObject);&#xA;						if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;							//Session.Output(&quot;X.xstate=&quot;+stateObject);&#xA;							var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;							Repository.Execute(sqlCommand);&#xA;						}							&#xA;					}							&#xA;				}					&#xA;				diagramObject3=null; //diagramObject3 is the object from the X diagram&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][2],testElement);&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} else {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+3,1)==&quot;i&quot;) {&#xA;				if(diagramObject3!=null)&#xA;					delement3=Repository.GetElementByID(diagramObject3.ElementID);&#xA;				else &#xA;					Session.Output(&quot;Unknown case: 1837 line&quot;);&#xA;			} else&#xA;				if(conns[0][2]!=null)&#xA;					delement3=conns[0][2];			&#xA;		}&#xA;	} &#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;(conns[1][0]!=null||params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;conns[0][0]!=null&amp;&amp;params[1][0]!=conns[0][0].Name)) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	if(delement3!=null&amp;&amp;delement2!=null&amp;&amp;(conns[1][1]!=null||params[1][2]!=null&amp;&amp;params[1][2]!=&quot; &quot;&amp;&amp;conns[0][1]!=null&amp;&amp;params[1][2]!=conns[0][1].Name)) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;			connector1=delement2.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement2.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			var connector = delement2.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;			connector.SupplierID = delement3.ElementID;&#xA;			connector.Update();&#xA;			delement2.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	var newObj3=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Event&quot;) {&#xA;			var left=30;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Event&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+70;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-40;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		} else &#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Object&quot;) {&#xA;			var left=30;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+70;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-40;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;Activity&quot;) {&#xA;			var left=150;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Activity&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1.top &lt; top) &#xA;				top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-40;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element1 to the diagram&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Object&quot;) {&#xA;			var left=300;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&gt;left-50) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1.top &lt; top||diagramObject2.top &lt; top) {&#xA;				if(diagramObject1.top&lt;diagramObject2.top)&#xA;					top=diagramObject1.top;&#xA;				else&#xA;					top=diagramObject2.top;&#xA;			}&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;					diagramObject1.top=top;&#xA;					diagramObject1.bottom=top-40;&#xA;					diagramObject1.Update();&#xA;			}&#xA;			if(newObj2&amp;&amp;diagramObject2.top &gt; top) {&#xA;					diagramObject2.top=top;&#xA;					diagramObject2.bottom=top-40;&#xA;					diagramObject2.Update(); &#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+70;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-40;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Setting parameter values &#8203;&#8203;for a rule  parameter nr is run for params[1][nr], then for params[0][nr], and then its equivalent in conns[0][nr] is checked&#xA;function setParameterValueRi(params, conns, nr, correctCR) {&#xA;var nameOfObject=null;&#xA;var nameOfObject1=null;&#xA;var nameOfClass=null;&#xA;var identOfClass = null;&#xA;var retParam = [ null,null,null,null];&#xA;	&#xA;	//in the one case object element does not have parent class&#xA;	if(params[1][nr]!=null&amp;&amp;params[1][nr]!=&quot; &quot;&amp;&amp;params[1][nr].indexOf(&quot;:&quot;)&gt;0&amp;&amp;params[1][nr].indexOf(&quot;:&quot;)&lt;params[1][nr].length) {&#xA;		//XeviRevi(name1:class1)&#xA;		nameOfObject=params[1][nr].substr(0,params[1][nr].indexOf(&quot;:&quot;));&#xA;		nameOfClass=params[1][nr].substr(params[1][nr].indexOf(&quot;:&quot;));&#xA;	} else if(params[1][nr]!=null&amp;&amp;params[1][nr]!=&quot; &quot;&amp;&amp;params[1][nr].indexOf(&quot;:&quot;)&lt;0) {&#xA;		nameOfObject=params[1][nr]; //XeviRevi(name1)&#xA;		if(nameOfObject==params[0][nr]) { //the class of name in the params[0][2] on the X diagram&#xA;			if(conns[0][nr]!=null&amp;&amp;conns[0][nr].Type==&quot;Object&quot;&amp;&amp;conns[0][nr].ClassfierID!=null&amp;&amp;conns[0][nr].ClassfierID&gt;0)&#xA;				identOfClass=conns[0][nr].ClassfierID;		&#xA;			else					&#xA;			if(conns[0][nr]!=null)&#xA;				nameOfClass=&quot;:&quot;+conns[0][nr].Name;&#xA;			else&#xA;				nameOfClass=&quot; &quot;; //object without of the class&#xA;		} else&#xA;			if(conns[0][nr]!=null&amp;&amp;conns[0][nr].Type==&quot;Object&quot;&amp;&amp;conns[0][nr].ClassfierID!=null&amp;&amp;conns[0][nr].ClassfierID&gt;0)&#xA;				identOfClass=conns[0][nr].ClassfierID;		&#xA;			else					&#xA;			if(conns[0][nr]!=null)&#xA;				nameOfClass=&quot;:&quot;+conns[0][nr].Name;&#xA;			else&#xA;				nameOfClass=&quot; &quot;; //object without of the class&#xA;	} else if(params[1][nr]!=null&amp;&amp;params[1][nr].indexOf(&quot;:&quot;)&gt;-1) {&#xA;		nameOfObject=&quot;&quot;; //XeviRevi(:class1)&#xA;		nameOfClass=params[1][nr].substr(params[1][nr].indexOf(&quot;:&quot;));&#xA;	} else {&#xA;		nameOfObject=&quot;&quot;; //XeviRevi()&#xA;		if(conns[0][nr]!=null&amp;&amp;conns[0][nr].Name!=&quot; &quot;&amp;&amp;conns[0][nr].ClassifierID!=null&amp;&amp;conns[0][nr].ClassifierID&gt;0) &#xA;			identOfClass=conns[0][nr].ClassifierID;	&#xA;		else&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;X&quot;)+1,1)==&quot;e&quot;&amp;&amp;conns[0][nr]!=null) //is it good idea:orrectCR.indexOf(&quot;X&quot;)+1,1)==&quot;e&quot;?&#xA;				nameOfClass=&quot;:&quot;+conns[0][nr].Name;&#xA;			else&#xA;				nameOfClass=params[1][nr].substr(params[1][nr].indexOf(&quot;:&quot;));		&#xA;	}&#xA;	if(params[3][nr]!=null&amp;&amp;params[3][nr]!=&quot;&quot;&amp;&amp;params[3][nr]!=&quot; &quot;)  //the state of the object must be set&#xA;		nameOfObject1=nameOfObject+&quot;[&quot;+params[3][nr]+&quot;]&quot;;	&#xA;	else if(conns[3][nr]!=null)&#xA;		nameOfObject1=nameOfObject+&quot;[&quot;+conns[3][nr]+&quot;]&quot;;&#xA;	retParam[0]=nameOfObject;&#xA;	retParam[1]=nameOfObject1;&#xA;	retParam[2]=nameOfClass;&#xA;	retParam[3]=identOfClass;&#xA;	&#xA;	return retParam;&#xA;}&#xA;//Setting parameter values &#8203;&#8203;for a rule  parameter nr is run for params[1][nr], then for params[0][nr], and then its equivalent in conns[0][nr] is checked&#xA;function setParameterValueRv(params, conns, nr, nameElement) {&#xA;var nameOfSub = &quot;&quot;;&#xA;	&#xA;	if(params[1][nr]==null||params[1][nr]==&quot; &quot;||params[1][nr]==&quot;&quot;)&#xA;		if(params[0][0]==null||params[0][0]==&quot; &quot;||params[0][0]==&quot;&quot;)&#xA;			if(params[1][0]==null||params[1][0]==&quot; &quot;||params[1][0]==&quot;&quot;)&#xA;				if(conns[0][0]==null||conns[0][0].Name==&quot;&quot;||conns[0][0].Name==&quot; &quot;)&#xA;					if(conns[0][nr]==null||conns[0][nr].Name==&quot;&quot;||conns[0][nr].Name==&quot; &quot;)&#xA;						if(conns[0][nr]!=null&amp;&amp;conns[0][nr].Type==&quot;Object&quot;&amp;&amp;conns[0][nr].ClassifierID&gt;0)&#xA;							nameOfSub = (Repository.GetElementByID(conns[0][nr].ClassifierID)).Name +&quot; &quot;+nameElement;&#xA;						else &#xA;							nameOfSub = &quot; Some &quot;+nameElement;							&#xA;					else&#xA;						if(conns[0][nr].Type==&quot;Action&quot;||conns[0][nr].Type==&quot;Activity&quot;)&#xA;							if(nr&lt;2&amp;&amp;conns[0][2]!=null&amp;&amp;conns[0][2].Type==&quot;Object&quot;)&#xA;								if(conns[0][2].Name!=&quot;&quot;&amp;&amp;conns[0][2].Name!=&quot; &quot;)&#xA;									nameOfSub = conns[0][2].Name + &quot; &quot;+nameElement;&#xA;								else if(conns[0][2].ClassifierID&gt;0)&#xA;									nameOfSub = (Repository.GetElementByID(conns[0][2].ClassifierID)).Name +&quot; &quot;+nameElement;&#xA;								else&#xA;									nameOfSub = &quot; Some &quot;+nameElement;&#xA;							else&#xA;								if(conns[0][0].Name!=&quot;&quot;&amp;&amp;conns[0][0].Name!=&quot; &quot;)&#xA;									nameOfSub = conns[0][0].Name + &quot; &quot;+nameElement;&#xA;								else if(conns[0][0].ClassifierID&gt;0)&#xA;									nameOfSub = (Repository.GetElementByID(conns[0][0].ClassifierID)).Name +&quot; &quot;+nameElement;&#xA;								else&#xA;									nameOfSub = &quot; Some &quot;+nameElement;&#xA;						else&#xA;							nameOfSub = conns[0][nr].Name + &quot; &quot;+nameElement;&#xA;				else&#xA;					nameOfSub = conns[0][0].Name + &quot; &quot;+nameElement;&#xA;			else&#xA;				nameOfSub = params[1][0] + &quot; &quot;+nameElement;&#xA;		else&#xA;			nameOfSub = params[0][0] + &quot; &quot;+nameElement;&#xA;	else&#xA;		nameOfSub = params[1][nr]; //here you can verify otherElements with nameOfSub&#xA;	return nameOfSub;&#xA;}&#xA;//Setting parameter values &#8203;&#8203;for a rule  parameter nr is run for params[1][nr], then for params[0][nr], and then its equivalent in conns[0][nr] is checked&#xA;function setParameterValueBu(params, conns, nr, nameElement) {&#xA;var nameOfSub = &quot;&quot;;&#xA;	&#xA;	if(params[1][nr]==null||params[1][nr]==&quot; &quot;||params[1][nr]==&quot;&quot;)&#xA;		if(params[0][nr]==null||params[0][nr]==&quot; &quot;||params[0][nr]==&quot;&quot;)&#xA;			if(conns[0][nr]==null||conns[0][nr].Name==&quot;&quot;||conns[0][nr].Name==&quot; &quot;)&#xA;				if(conns[0][nr]!=null&amp;&amp;conns[0][nr].Type==&quot;Object&quot;&amp;&amp;conns[0][nr].ClassifierID&gt;0)&#xA;					nameOfSub = (Repository.GetElementByID(conns[0][nr].ClassifierID)).Name +&quot; &quot;+nameElement;&#xA;				else &#xA;					nameOfSub = &quot; Some &quot;+nameElement;							&#xA;			else&#xA;				if(conns[0][nr].Type==&quot;Action&quot;||conns[0][nr].Type==&quot;Activity&quot;) {&#xA;					var firstElement=true;&#xA;					var lastElement=false;&#xA;					if(conns[0][0]!=null&amp;&amp;conns[0][0].Type==&quot;Object&quot;) {&#xA;						for( var i=0;i&lt;conns[0][0].Connectors.Count;i++) {&#xA;							var outgoingConnector = conns[0][0].Connectors.GetAt(i);&#xA;							if(outgoingConnector.Type==&quot;ObjectFlow&quot;&amp;&amp;outgoingConnector.ClientID!=conns[0][0].ElementID) {&#xA;								firstElement=false;&#xA;								break;&#xA;							}&#xA;						}&#xA;					}&#xA;					//Session.Output(&quot;setParameterValueBu(&quot;+nr+&quot;):&quot;+firstElement+&quot;Count:&quot;+conns[0][0].Connectors.Count);&#xA;					if(nr&lt;2&amp;&amp;!firstElement&amp;&amp;conns[0][2]!=null&amp;&amp;conns[0][2].Type==&quot;Object&quot;)&#xA;						if(conns[0][2].Name!=&quot;&quot;&amp;&amp;conns[0][2].Name!=&quot; &quot;)&#xA;							nameOfSub = conns[0][2].Name + &quot; &quot;+nameElement;&#xA;						else if(conns[0][2].ClassifierID&gt;0)&#xA;							nameOfSub = (Repository.GetElementByID(conns[0][2].ClassifierID)).Name +&quot; &quot;+nameElement;&#xA;						else&#xA;							nameOfSub = &quot; Some &quot;+nameElement;&#xA;					else&#xA;						if(conns[0][0].Name!=&quot;&quot;&amp;&amp;conns[0][0].Name!=&quot; &quot;)&#xA;							nameOfSub = conns[0][0].Name + &quot; &quot;+nameElement;&#xA;						else if(conns[0][0].ClassifierID&gt;0)&#xA;							nameOfSub = (Repository.GetElementByID(conns[0][0].ClassifierID)).Name +&quot; &quot;+nameElement;&#xA;						else&#xA;							nameOfSub = &quot; Some &quot;+nameElement;&#xA;				} else&#xA;					nameOfSub = conns[0][nr].Name + &quot; &quot;+nameElement;&#xA;		else&#xA;			nameOfSub = params[0][nr] + &quot; &quot;+nameElement;&#xA;	else&#xA;		nameOfSub = params[1][nr]; &#xA;	return nameOfSub;&#xA;}&#xA;//Create target elements in simple consistency rule from context diagram to process decomposition diagram&#xA;function createXRsimple(consistencyRule, correctCR, thePackage, parameters, currElement) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	//var otherElements = [];&#xA;	var connectorCR as EA.Connector;&#xA;	&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;PDD&quot;,&quot;&quot;,consistencyRule,null);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	diagramObject=null;&#xA;	diagramObject1=null;&#xA;&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var i = 0, j=0 ; i &lt; diagramObjects.Count; i++ )&#xA;	{&#xA;		var coto as EA.Element;&#xA;		var cotoParent as EA.Element;&#xA;		//Xeri, XiRi, XevRv, XivRv, XviRv, XjRj, XzRz&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID&gt;0)&#xA;			coto=Repository.GetElementByID(diagramObject.ElementID);&#xA;		else&#xA;			coto=null;&#xA;		if(coto.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;(params[1][0]==&quot;&quot;||params[1][0]==&quot; &quot;)&amp;&amp;&#xA;			currElement.Type==&quot;Event&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==&quot;&quot;&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.Name==currElement.Name) //XeRi&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XeRi(name1)&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;0&amp;&amp; //without the class1&#xA;			currElement.Type==&quot;Event&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==params[1][0]&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.Name==currElement.Name) //XeRi(name1)&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XeRi(name1:class1), XeRi(:class1)&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;params[0][0]!=&quot;&quot;&amp;&amp;params[0][0]!=&quot; &quot;&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;-1&amp;&amp; // with the class1&#xA;			currElement.Type==&quot;Event&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;))&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.Name==params[1][0].substr(params[1][0].indexOf(&quot;:&quot;)+1)) //XeRi(name1:class1), XeRi(:class1)&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XiRi&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;(params[1][0]==&quot;&quot;||params[1][0]==&quot; &quot;)&amp;&amp;&#xA;			currElement.Type==&quot;Object&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==&quot;&quot;&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.ElementID==currElement.ClassifierID)&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XiRi(name1)&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;0&amp;&amp; //without the class1&#xA;			currElement.Type==&quot;Object&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==params[1][0]&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.ElementID==currElement.ClassifierID) //XiRi(name1)&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XiRi(name1:class1), XiRi(:class1)&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;-1&amp;&amp;&#xA;			currElement.Type==&quot;Object&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;&#xA;			coto.Type==&quot;Object&quot;&amp;&amp;coto.Name==params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;))&amp;&amp;cotoParent!=null&amp;&amp;cotoParent.Name==params[1][0].substr(params[1][0].indexOf(&quot;:&quot;)+1))&#xA;			diagramObject1=diagramObject; &#xA;		//XevRv, XivRv, XviRv-brakuje nazwy z obiektu&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;(params[1][0]==&quot;&quot;||params[1][0]==&quot; &quot;)&amp;&amp;&#xA;			(currElement.Type==&quot;Event&quot;||currElement.Type==&quot;Activity&quot;)&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;&amp;&amp;&#xA;			coto.Type==&quot;Activity&quot;&amp;&amp;coto.Name==currElement.Name+&quot; subprocess&quot;) //XevRv&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		//XevRv(name1), XivRv(name1), XviRv(name1)-brakuje nazwy z obiektu&#xA;		if(diagramObject1==null&amp;&amp;&#xA;			params[0][0]!=null&amp;&amp;(params[0][0]==&quot;&quot;||params[0][0]==&quot; &quot;)&amp;&amp;&#xA;			params[1][0]!=null&amp;&amp;params[1][0].length&gt;1&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;0&amp;&amp; //without the class1&#xA;			(currElement.Type==&quot;Event&quot;||currElement.Type==&quot;Activity&quot;)&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;&amp;&amp;&#xA;			coto.Type==&quot;Activity&quot;&amp;&amp;coto.Name==params[1][0]) //XevRv(name1)&#xA;			diagramObject1=diagramObject; &#xA;		else {&#xA;			if(coto!=null)&#xA;				otherDiagObjects.push(diagramObject);&#xA;		}&#xA;		if (diagramObject1!=null)&#xA;			break;&#xA;	}&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	delement1 = null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Name==params[1][0] || //XiRi(name1), XiRi(name1), XevRv(name)&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;params[1][0]!=null&amp;&amp;params[1][0]!=&quot;&quot;&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;currentElement.Name==params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;))&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==params[1][0].substr(params[1][0].indexOf(&quot;:&quot;)+1) || //XiRi(name1:class1)&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;currentElement.Name==&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;params[1][0]!=null&amp;&amp;params[1][0]!=&quot;&quot;&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==params[1][0].substr(1) || //XiRi(:class1), XiRi(:class1)&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;currentElement.Name==&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]==&quot;&quot;)&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;(Repository.GetElementByID(currentElement.ClassifierID)).Name==currElement.Name|| //XeRi, XiRi for the Class, Event&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;&amp;&amp;currentElement.Name==&quot;&quot;&amp;&amp;currentElement.Type==&quot;Object&quot;&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]==&quot;&quot;)&amp;&amp;currentElement.ClassifierID!=null&amp;&amp;currentElement.ClassifierID&gt;0&amp;&amp;currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0&amp;&amp;currentElement.ClassifierID==currElement.ClassifierID || //XeRi, XiRi for the instance&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;&amp;&amp;currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Type==&quot;Activity&quot;&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]==&quot;&quot;)&amp;&amp;currentElement.Name==currElement.Name+&quot; subprocess&quot; || //XevRv, XivRv&#xA;			correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;&amp;&amp;currentElement.Name!=&quot;&quot;&amp;&amp;currentElement.Type==&quot;Activity&quot;&amp;&amp;(params[1][0]==&quot; &quot;||params[1][0]==&quot;&quot;)&amp;&amp;currElement.Name==&quot;&quot;&amp;&amp;currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0&amp;&amp;currentElement.Name==(Repository.GetElementByID(currElement.ClassifierID)).Name+&quot; subprocess&quot; ) //XviRv&#xA;			delement1=currentElement;&#xA;		//else&#xA;		//	if(currentElement!=null)&#xA;		//		otherElements.push(currentElement);&#xA;		if(delement1!=null)&#xA;			break;&#xA;	}&#xA;	if(delement1==null) { //There is no element1 in the package, but this element could have been placed in the R diagram via a link from the package containing the X diagram&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;e&quot;) { &#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;) {&#xA;					//Xe(name1)Re(name2)&#xA;					testElement = subPackage.Elements.AddNew( params[1][0], &quot;Event&quot; ); //&quot;Event&quot; to jest &quot;Signal&quot;&#xA;					testElement.Subtype=1; //Receive&#xA;					if(currElement!=null) {&#xA;						//an aggregation to the event from diagram X should be created&#xA;						// Create a connector between the two elements&#xA;						var connector = testElement.Connectors.AddNew(&quot;&quot;, &quot;Aggregation&quot;);&#xA;						connector.SupplierID = currElement.ElementID;&#xA;						connector.Update();&#xA;						//testElement.Connectors.Refresh;&#xA;					}&#xA;					testElement.Update();&#xA;					diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;					setCRDependency(consistencyRule,correctCR,currentElement,testElement);					&#xA;				} else&#xA;					Session.Output(&quot;Line 2330, params, conns:&quot;+params+&quot;\n&quot;+currElement.Name);&#xA;			} else&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;i&quot;) { &#xA;				var nameOfObject;&#xA;				var nameOfClass;&#xA;				var identOfClass=null;&#xA;				//in the one case object element does not have parent class&#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;0&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;params[1][0].length) { //XiRi(name1:class1)&#xA;					//what about the case &quot;Xevi(:Request)Revi(:Request)&quot; ?&#xA;					nameOfObject=params[1][0].substr(0,params[1][0].indexOf(&quot;:&quot;));&#xA;				    nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				} else if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot;&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&lt;0) { //XiRi(:class1)&#xA;					nameOfObject=params[1][0];&#xA;				    if(nameOfObject==params[0][0]) { //should be the class of element with name in params[0][0] on the X diagram&#xA;						if(currElement.ClassfierID!=null&amp;&amp;currElement.ClassfierID&gt;0)&#xA;							identOfClass=currElement.ClassfierID;		&#xA;						else					&#xA;							nameOfClass=&quot; &quot;; //object without of the class&#xA;					} else&#xA;						if(currElement!=null&amp;&amp;currElement.Type==&quot;Object&quot;&amp;&amp;currElement.ClassfierID&gt;0) &#xA;							identOfClass=currElement.ClassfierID;&#xA;						else	&#xA;						if(currElement!=null&amp;&amp;(currElement.Type==&quot;Class&quot;||currElement.Type==&quot;Event&quot;)) &#xA;							identOfClass=currElement.ElementID;&#xA;						else&#xA;							nameOfClass=&quot; &quot;; //object without of the class&#xA;				} else if(params[1][0]!=null&amp;&amp;params[1][0].indexOf(&quot;:&quot;)&gt;-1) { ////XiRi(name1:class1)&#xA;					nameOfObject=&quot;&quot;;&#xA;					nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				} else {&#xA;					nameOfObject=&quot;&quot;;&#xA;					if(currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0)&#xA;						identOfClass=currElement.ClassifierID;&#xA;					else&#xA;					if(currElement.Type==&quot;Class&quot;) &#xA;						nameOfClass=&quot;:&quot;+currElement.Name;		&#xA;					else&#xA;					if(correctCR.substr(correctCR.indexOf(&quot;X&quot;)+1,1)==&quot;e&quot;)&#xA;						nameOfClass=&quot;:&quot;+currElement.Name;&#xA;					else&#xA;						nameOfClass=params[1][0].substr(params[1][0].indexOf(&quot;:&quot;));&#xA;				}&#xA;				if(params[3][0]!=&quot;&quot;&amp;&amp;params[3][0]!=&quot; &quot;)  //the state of the object must be set&#xA;					nameOfObject=nameOfObject+&quot;[&quot;+params[3][0]+&quot;]&quot;;					&#xA;				testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; );&#xA;				if(identOfClass!=null)&#xA;					testElement.ClassifierID=identOfClass;&#xA;				else&#xA;				if(nameOfClass.substr(0,1)==&quot;:&quot;) {&#xA;					//new class - can we look at the class with the same name earlier?&#xA;					nameOfClass=nameOfClass.substr(1);&#xA;					coto=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(coto==null) {&#xA;						testClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					} else {&#xA;						testClass = coto;&#xA;						testElement.ClassifierID=testClass.ElementID;&#xA;					}&#xA;				} else if(nameOfClass==&quot; &quot;) {&#xA;					//without the class&#xA;					nameOfClass=&quot; &quot;;&#xA;				} else {&#xA;					if(currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0)&#xA;						testElement.ClassifierID=currElement.ClassifierID;&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is the object from the X diagram&#xA;				setCRDependency(consistencyRule,correctCR,currentElement,testElement);	&#xA;			} else&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+1,1)==&quot;v&quot;) { //XevRv, XivRv, XviRv&#xA;				if(params[1][0]!=null&amp;&amp;params[1][0]!=&quot; &quot; || params[1][0]!=null&amp;&amp;params[1][0]==&quot; &quot;) {&#xA;					//XevRv(name2) || XevRv&#xA;					var nameOfProcess;&#xA;					if(params[1][0]!=null&amp;&amp;params[1][0]==&quot; &quot;) &#xA;						if(currElement.Name!=&quot;&quot;)&#xA;							nameOfProcess = currElement.Name +&quot; subprocess&quot;; //sprawdzi&#263; jeszcze czy currElement nie jest instancj&#261;&#xA;						else&#xA;							if(currElement.ClassifierID!=null&amp;&amp;currElement.ClassifierID&gt;0)&#xA;								nameOfProcess = (Repository.GetElementByID(currElement.ClassifierID)).Name +&quot; subprocess&quot;; &#xA;							else&#xA;								nameOfProcess = &quot;Unknown subprocess&quot;;&#xA;					else&#xA;						nameOfProcess = params[1][0];						&#xA;					testElement = subPackage.Elements.AddNew( nameOfProcess, &quot;Activity&quot; );&#xA;					testElement.Stereotype=&quot;process&quot;;&#xA;					testElement.StereotypeEx=&quot;process&quot;;&#xA;					testElement.Update();&#xA;					diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;					setCRDependency(consistencyRule,correctCR,currentElement,testElement);	&#xA;				} else&#xA;					Session.Output(&quot;Line 2421, params, conns:&quot;+params+&quot;\n&quot;+currElement.Name);&#xA;			}			&#xA;			delement1=testElement;&#xA;		} else &#xA;			delement1=currElement;&#xA;	} else {&#xA;		var connectorsCR = delement1.Connectors;&#xA;		for(i=0;i&lt;connectorsCR.Count;i++) {&#xA;			var connCR = connectorsCR.GetAt(i);&#xA;			if(connCR.Type==&quot;Dependency&quot;&amp;&amp;connCR.Name==consistencyRule&amp;&amp;connCR.SupplierID==delement1.ElementID&amp;&amp;connCR.ClientID == currElement.ElementID)&#xA;				connectorCR=connCR;&#xA;			if(connectorCR!=null)&#xA;				break;&#xA;		}&#xA;		if(connectorCR==null)&#xA;			setCRDependency(consistencyRule,correctCR,currentElement,testElement);	&#xA;	}&#xA;	//Add elements to the diagram&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null&amp;&amp;&#xA;			(delement1.Type==&quot;Event&quot;||&#xA;		     delement1.Type==&quot;Object&quot; &amp;&amp; correctCR.substr(correctCR.indexOf(&quot;X&quot;)+1,1)==&quot;e&quot;)) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Event&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			// Get diagram links&#xA;			currentDiagramLinks = testDiagram.DiagramLinks;	&#xA;			for(var i = 0; i&lt;testDiagram.DiagramLinks.Count; i++) {&#xA;				var currentLink as EA.DiagramLink;&#xA;				currentLink = currentDiagramLinks.GetAt( i );&#xA;				if (currentLink.ConnectorID ==  connectorCR.ConnectorID)&#xA;				{&#xA;					currentLink.IsHidden = true;&#xA;					currentLink.Update();&#xA;					break;&#xA;				}&#xA;			}&#xA;		} else &#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Object&quot;) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			// Get diagram links&#xA;			currentDiagramLinks = testDiagram.DiagramLinks;	&#xA;			for(var i = 0; i&lt;testDiagram.DiagramLinks.Count; i++) {&#xA;				var currentLink as EA.DiagramLink;&#xA;				currentLink = currentDiagramLinks.GetAt( i );&#xA;				if (currentLink.ConnectorID ==  connectorCR.ConnectorID)&#xA;				{&#xA;					currentLink.IsHidden = true;&#xA;					currentLink.Update();&#xA;					break;&#xA;				}&#xA;			}&#xA;		} else&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Activity&quot;) {&#xA;			var left=400;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Activity&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			// Get diagram links&#xA;			currentDiagramLinks = testDiagram.DiagramLinks;	&#xA;			for(var i = 0; i&lt;testDiagram.DiagramLinks.Count; i++) {&#xA;				var currentLink as EA.DiagramLink;&#xA;				currentLink = currentDiagramLinks.GetAt( i );&#xA;				if (currentLink.ConnectorID ==  connectorCR.ConnectorID)&#xA;				{&#xA;					currentLink.IsHidden = true;&#xA;					currentLink.Update();&#xA;					break;&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from context diagram to business use case diagram&#xA;function createXBcomplex(consistencyRule, correctCR, thePackage, parameters, connectors) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var nameElement1;&#xA;	var nameElement2;&#xA;	var nameElement3;&#xA;	&#xA;	conns = connectors;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;BUCD&quot;,&quot;&quot;,consistencyRule,conns);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//The first element&#xA;	nameElement1=setParameterValue(params, conns, 0, &quot;Actor&quot;, 4);&#xA;	nameElement2=setParameterValueBu(params, conns, 1, &quot;service&quot;);&#xA;	if(conns[0][2]!=null)&#xA;		nameElement3=setParameterValue(params, conns, 2, &quot;Actor&quot;, 4);&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var i = 0, j=0 ; i &lt; diagramObjects.Count ; i++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		currentElement=Repository.GetElementByID(diagramObject.ElementID);&#xA;		if(diagramObject1==null&amp;&amp;currentElement.Type==&quot;Actor&quot;&amp;&amp;currentElement.Name==nameElement1) //verification of an existing element in the B diagram&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		if(diagramObject2==null&amp;&amp;currentElement.Type==&quot;UseCase&quot;&amp;&amp;currentElement.Name==nameElement2) //verification of an existing element in the R diagram&#xA;			diagramObject2=diagramObject; &#xA;		else&#xA;		if(conns[0][2]!=null&amp;&amp;diagramObject3==null&amp;&amp;currentElement.Type==&quot;Actor&quot;&amp;&amp;currentElement.Name==nameElement3) //verification of an existing element in the B diagram&#xA;			diagramObject3=diagramObject; &#xA;	}&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.Type==&quot;Actor&quot;&amp;&amp;currentElement.Name==nameElement1)&#xA;			delement1=currentElement;&#xA;		else 		&#xA;		if(currentElement.Type==&quot;UseCase&quot;&amp;&amp;currentElement.Name==nameElement2)&#xA;			delement2=currentElement;&#xA;		else&#xA;		if(conns[0][2]!=null&amp;&amp;currentElement.Type==&quot;Actor&quot;&amp;&amp;currentElement.Name==nameElement3)&#xA;			delement3=currentElement;&#xA;	}&#xA;	var delement1create=false;&#xA;	if(delement1==null) { //There is no element1 in the package, but this element could have been placed in the R diagram via a link from the package containing the X diagram&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1,1)==&quot;a&quot;) { &#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Actor&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;BUCD&quot;,&quot;Actor&quot;,nameElement1))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject1=null;&#xA;				delement1create=true;&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;			}  &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	var delement2create=false;&#xA;	if(delement2==null) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+2,1)==&quot;u&quot;) { &#xA;				testElement = subPackage.Elements.AddNew( nameElement2, &quot;Use Case&quot; );&#xA;				if((tagValue=getTagValueforElement(&quot;BUCD&quot;,&quot;Use Case&quot;,nameElement2))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject2=null;&#xA;				delement2create=true;&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][1],testElement);&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	var delement3create=false;&#xA;	if(conns[0][2]!=null&amp;&amp;delement3==null) { //There is no element1 in the package, but this element could have been placed in the R diagram via a link from the package containing the X diagram&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1,1)==&quot;a&quot;) { &#xA;				testElement = subPackage.Elements.AddNew( nameElement3, &quot;Actor&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;BUCD&quot;,&quot;Actor&quot;,nameElement3))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject3=null;&#xA;				delement3create=true;&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][2],testElement);&#xA;			}  &#xA;			delement3=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the elements&#xA;	//Session.Output(&quot;createXBcomplex1a:&quot;+((delement1==null)?&quot;null&quot;:&quot;notnull&quot;)+&quot;;&quot;+((delement2==null)?&quot;null&quot;:&quot;notnull&quot;)+&quot;;&quot;+delement1create+&quot;;&quot;+delement2create);&#xA;	//if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;(delement2create||delement1create)) {&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Association&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;			//Session.Output(&quot;createXBcomplex1b:&quot;+delement1.Name+&quot;;&quot;+delement2.Name);&#xA;		}			&#xA;	}&#xA;	//a connection must be created between the elements&#xA;	//Session.Output(&quot;createXBcomplex2a:&quot;+((delement2==null)?&quot;null&quot;:&quot;notnull&quot;)+&quot;;&quot;+((delement3==null)?&quot;null&quot;:&quot;notnull&quot;)+&quot;;&quot;+delement2create+&quot;;&quot;+delement3create);&#xA;	//if(conns[0][2]!=null&amp;&amp;delement3!=null&amp;&amp;delement2!=null&amp;&amp;(delement2create||delement3create)) {&#xA;	if(conns[0][2]!=null&amp;&amp;delement3!=null&amp;&amp;delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement3.Connectors.Count;i++) {&#xA;			connector1=delement3.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Association&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement3.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement3.Update();	&#xA;			//Session.Output(&quot;createXBcomplex2b:&quot;+delement2.Name+&quot;;&quot;+delement3.Name);&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Actor&quot;) {&#xA;			var left=50;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Actor&quot;) {&#xA;					if(existDiagramObject.left&lt;250&amp;&amp;existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;UseCase&quot;) {&#xA;			var left=150;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;UseCase&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1!=null&amp;&amp;diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(diagramObject1!=null&amp;&amp;newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+75;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	if(conns[0][2]!=null&amp;&amp;diagramObject3==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Actor&quot;) {&#xA;			var left=300;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Actor&quot;) {&#xA;					if(existDiagramObject.left&gt;250&amp;&amp;existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;		} &#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from process decomposition diagram to business use cases diagram&#xA;function createRBcomplex(consistencyRule, correctCR, thePackage, parameters, connectors) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	&#xA;	conns = connectors;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;BUCD&quot;,&quot;&quot;,consistencyRule,conns);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//The first element&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(params, conns, 0, &quot;Actor&quot;, 4);&#xA;	nameElement2=setParameterValueBu(params, conns, 1, &quot;service&quot;);&#xA;	if(conns[0][2]!=null)&#xA;		nameElement3=setParameterValue(params, conns, 2, &quot;Actor&quot;, 4);&#xA;	//Session.Output(&quot;cRB:&lt;&quot;+nameElement1+&quot;&gt;;&lt;&quot;+nameElement2+&quot;&gt;;&lt;&quot;+nameElement3+&quot;&gt;&quot;);&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var i = 0, j=0 ; i &lt; diagramObjects.Count ; i++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		currentElement=Repository.GetElementByID(diagramObject.ElementID);&#xA;		if(diagramObject1==null&amp;&amp;currentElement.Type==&quot;Actor&quot;&amp;&amp;currentElement.Name==nameElement1) //verification of an existing element in the B diagram&#xA;			diagramObject1=diagramObject; &#xA;		else&#xA;		if(diagramObject2==null&amp;&amp;currentElement.Type==&quot;UseCase&quot;&amp;&amp;currentElement.Name==nameElement2) //verification of an existing element in the R diagram&#xA;			diagramObject2=diagramObject; &#xA;		else&#xA;		if(conns[0][2]!=null&amp;&amp;diagramObject3==null&amp;&amp;currentElement.Type==&quot;Actor&quot;&amp;&amp;currentElement.Name==nameElement3) //verification of an existing element in the B diagram&#xA;			diagramObject3=diagramObject; &#xA;	}&#xA;	&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.Type==&quot;Actor&quot;&amp;&amp;currentElement.Name==nameElement1)&#xA;			delement1=currentElement;&#xA;		else 		&#xA;		if(currentElement.Type==&quot;UseCase&quot;&amp;&amp;currentElement.Name==nameElement2)&#xA;			delement2=currentElement;&#xA;		else&#xA;		if(conns[0][2]!=null&amp;&amp;currentElement.Type==&quot;Actor&quot;&amp;&amp;currentElement.Name==nameElement3)&#xA;			delement3=currentElement;&#xA;	}&#xA;	//Session.Output(&quot;cRB-rel1.0-0:&lt;&quot;+delement1+&quot;&gt;&quot;);&#xA;	var delement1create=false;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+1,1)==&quot;a&quot;) { //RevBau, ReviBaua, RviBau&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Actor&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;BUCD&quot;,&quot;Actor&quot;,nameElement1))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				delement1create=true;&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	var delement2create=false;&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+2,1)==&quot;u&quot;) { //RevBau, ReviBaua, RviBau&#xA;				testElement = subPackage.Elements.AddNew( nameElement2, &quot;Use Case&quot; );&#xA;				if((tagValue=getTagValueforElement(&quot;BUCD&quot;,&quot;Use Case&quot;,nameElement2))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				delement2create=true;&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][1],testElement);&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	var delement3create=false;&#xA;	if(conns[0][2]!=null&amp;&amp;delement3==null&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;B&quot;)).length&gt;3&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { //ReviBaua&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+3,1)==&quot;a&quot;) { &#xA;				testElement = subPackage.Elements.AddNew( nameElement3, &quot;Actor&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;BUCD&quot;,&quot;Actor&quot;,nameElement3))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject3=null; //diagramObject1 is not already a previously created element&#xA;				delement3create=true;&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][2],testElement);&#xA;			} &#xA;			delement3=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;(delement2create||delement1create)) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Association&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			//Session.Output(&quot;cRB-rel1.2:&quot;+delement2.Name+&quot;-&quot;+delement1.Name);&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(conns[0][2]!=null&amp;&amp;delement3!=null&amp;&amp;delement2!=null&amp;&amp;(delement2create||delement3create)) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement3.Connectors.Count;i++) {&#xA;			connector1=delement3.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Association&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement3.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement3.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	var newObj3=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Actor&quot;) {&#xA;			var left=50;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Actor&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		} else &#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;UseCase&quot;) {&#xA;			var left=50;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;UseCase&quot;) {&#xA;			var left=150;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;UseCase&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	if(conns[0][2]!=null&amp;&amp;diagramObject3==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Actor&quot;) {&#xA;			var left=300;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Actor&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1!=null&amp;&amp;diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1!=null&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		} else &#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;UseCase&quot;) {&#xA;			var left=300;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;UseCase&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;UseCase&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			if(diagramObject1!=null&amp;&amp;diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1!=null&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from business use cases diagram to business process diagram &#xA;function createBAcomplex(consistencyRule, correctCR, thePackage, parameters, connectors,mode) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var subChildPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var desiredDiagObjects = [ null,null]; //[ null,null,null]&#xA;	var desiredPackElements = [ null,null]; //[ null,null,null]&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var activityPartitions = [];&#xA;	var nameOfPackage;&#xA;&#xA;	&#xA;	//BauApv - it is the first and only rule&#xA;	//This means, that the conns array contains only the first two elements, and the params array contains only the first two elements&#xA;	conns = connectors;&#xA;	params = parameters;&#xA;	//BauApv-conns[0][1] means this parameter must contain an existing element - Use Case&#xA;	if(conns[0][1]==null||conns[0][1].Name==&quot;&quot;||conns[0][1].Name==&quot; &quot;)&#xA;		return;&#xA;	//retrieving the Business Use Case Realization package and the first diagram&#xA;	nameOfPackage=conns[0][1].Name;&#xA;	if(nameOfPackage.indexOf(&quot;service&quot;)&gt;-1)&#xA;		nameOfPackage=(conns[0][1].Name).substr(0,(conns[0][1].Name).indexOf(&quot;service&quot;))+&quot;subprocess&quot;+(conns[0][1].Name).substr((conns[0][1].Name).indexOf(&quot;service&quot;)+9);&#xA;	//Session.Output(&quot;createBAcomplex:&lt;&quot;+conns[0][1].Name+&quot;&gt;;&lt;&quot;+nameOfPackage+&quot;&gt;&quot;);&#xA;	packages=getTargetPackage(thePackage,&quot;BURD&quot;, nameOfPackage,consistencyRule,conns);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	//the Business Use Case Realization package&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	//Setting the names of the desired elements&#xA;	//The first element&#xA;	var nameOfElement1=&quot;&quot;;&#xA;	var nameOfElement2=&quot;&quot;;&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;B&quot;)+2,1)==&quot;u&quot;) {//BauApv&#xA;		nameOfElement1=&quot;Partition&quot;;&#xA;		nameOfElement2=&quot;Action&quot;;&#xA;	} else { //BuaApv&#xA;		nameOfElement2=&quot;Partition&quot;;&#xA;		nameOfElement1=&quot;Action&quot;;&#xA;	}&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, connectors, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, connectors, 1, nameOfElement2, 0);&#xA;	//pattern-driven rule in nameElement2 - BauAp(Actor1,Actor2,Actor3)v({pattern})&#xA;	if(nameElement2.substr(0,1)==&quot;{&quot; &amp;&amp; nameElement2.substr(nameElement2.length-1,1)==&quot;}&quot;) {&#xA;		var namePattern=nameElement2.substr(1);&#xA;		namePattern=namePattern.substr(0,namePattern.length-1);&#xA;		if(namePattern.substr(namePattern.length-15)!=&quot;BusinessProcess&quot;)&#xA;			namePattern+=&quot;BusinessProcess&quot;;		&#xA;		// Fetch XML content from URL&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;);&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		var nameOfPckg = &quot;&quot;;&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			//retrieve package name&#xA;			nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;);&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				//Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			//retrieve partition names&#xA;			activityPartitions=retrieveXMLNames(xmlContent, &quot;ActivityPartition&quot;, &quot;alias&quot;, &quot;UML:ActionState name=&quot;,0);&#xA;			activityPartitions=activityPartitions.sort();&#xA;			var project = Repository.GetProjectInterface();&#xA;			//Import the XMI file into the current model, download package content to subpackage&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1);&#xA;			subPackage.Packages.Refresh();&#xA;			if(result==null)&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null)&#xA;				return;&#xA;			//Rename partitions according to the values &#8203;&#8203;given in the partition rule parameter&#xA;			renamePatternPartitions(nameElement1, conns[0][1], activityPartitions, subChildPackage);&#xA;			//moving elements from the changed pattern to the current package&#xA;			if(subChildPackage !=null)&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			else&#xA;				changePatternPackage(consistencyRule, nameElement1, conns[0][1], objectClasses, activityPartitions, subPackage); //change the name of partitions&#xA;			if(testDiagram.DiagramObjects.Count==0) {&#xA;				var nameOfDiagram = testDiagram.Name;&#xA;				for(var i=0;i&lt;subPackage.Diagrams.Count;i++) {&#xA;					if((subPackage.Diagrams.GetAt(i)).Name==nameOfDiagram) {&#xA;						subPackage.Diagrams.Delete(i);&#xA;						break;&#xA;					}&#xA;				}&#xA;				subPackage.Diagrams.Refresh();&#xA;				testDiagram=subPackage.Diagrams.GetAt(0);&#xA;				testDiagram.Name=nameOfDiagram;&#xA;				testDiagram.Update();&#xA;			}&#xA;			return;		&#xA;		} /*else {&#xA;			Session.Output(&quot;Failed to fetch XML for the pattern &lt;&quot;+namePattern+&quot; from URL: &quot; + xhr.statusText);&#xA;		}*/&#xA;		//var result = projectInterface.ImportPackageXMI(projectInterface.GUIDtoXML(subPackage.PackageGUID), &quot;C:\\Users\\jerzy\\Documents\\skrypty\\Patterns\\uc-ecs517.xml&quot;, 1, 1);&#xA;	}&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, null);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;	} &#xA;	&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, null);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];	&#xA;		activityPartitions = desiredPackElements[3];&#xA;	} &#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+1,1)==&quot;p&quot;) { //BauApv&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;ActivityPartition&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;BURD&quot;,&quot;ActivityPartition&quot;,nameElement1))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	var delement2new=false;&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;v&quot;) { //RevBau, ReviBaua, RviBau&#xA;				testElement = subPackage.Elements.AddNew( nameElement2, &quot;Action&quot; ); &#xA;				testElement.ParentID=delement1.ElementID;&#xA;				if((tagValue=getTagValueforElement(&quot;BURD&quot;,&quot;Action&quot;,nameElement2))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				delement2new=true;&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][1],testElement);&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	} else &#xA;	if(delement2!=null) {&#xA;		delement2.ParentID=delement1.ElementID;&#xA;		delement2.Update();&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(var i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;			connector=delement2.Connectors.GetAt(i);&#xA;			if(connector.Type==&quot;ObjectFlow&quot;) {&#xA;				if(connector.SupplierID!=null&amp;&amp; (Repository.GetElementByID(connector.SupplierID)).Type==&quot;Object&quot;) {&#xA;					var objectTmp = Repository.GetElementByID(connector.SupplierID);&#xA;					objectTmp.ParentID=delement1.ElementID;&#xA;					objectTmp.Update();&#xA;				} &#xA;			} else&#xA;			if(connector.Type==&quot;ControlFlow&quot;) {&#xA;				if(connector.ClientID&gt;0&amp;&amp;connector.ClientID!=delement2.ElementID) {&#xA;					var elementTmp = Repository.GetElementByID(connector.ClientID);&#xA;					if(elementTmp.Type==&quot;Event&quot;&amp;&amp;elementTmp.Subtype==1||elementTmp.Type==&quot;StateNode&quot;&amp;&amp;(elementTmp.Subtype==100||elementTmp.Subtype==3)) {&#xA;						elementTmp.ParentID=delement1.ElementID;&#xA;						elementTmp.Update();						&#xA;					}&#xA;				}&#xA;				else &#xA;				if(connector.SupplierID&gt;0&amp;&amp;connector.SupplierID!=delement2.ElementID) {&#xA;					var elementTmp = Repository.GetElementByID(connector.SupplierID);&#xA;					if(elementTmp.Type==&quot;StateNode&quot;&amp;&amp;elementTmp.Subtype==102||elementTmp.Type==&quot;StateNode&quot;&amp;&amp;elementTmp.Subtype==101||elementTmp.Type==&quot;Decision&quot;||elementTmp.Type==&quot;MergeNode&quot;||elementTmp.Type==&quot;Event&quot;&amp;&amp;elementTmp.Subtype==0) {&#xA;						elementTmp.ParentID=delement1.ElementID;&#xA;						elementTmp.Update();						&#xA;					}&#xA;				}&#xA;			}			&#xA;		}&#xA;	}&#xA;	var diagramObject1new=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;ActivityPartition&quot;) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			if(activityPartitions.length&gt;0&amp;&amp;activityPartitions[0][0]!=null)&#xA;				left=(activityPartitions[0][0]).left;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(var i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject=Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existDiagramObject.ElementID!=delement2.ElementID) {&#xA;					if(existDiagramObject.right&lt;left)&#xA;						left=existDiagramObject.right+50;&#xA;					//if(existElementObject.Type==&quot;ActivityPartition&quot;||existElementObject.ParentID==0) {&#xA;						if(existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;					//}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+350;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-100;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			diagramObject1new=true;&#xA;		} &#xA;	}&#xA;	var left=diagramObject1.left;&#xA;	var top=diagramObject1.top-(diagramObject1.top-diagramObject1.bottom)/2+23;&#xA;	if(diagramObject2==null) {&#xA;		var diagramObjects as EA.Collection;&#xA;		&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;Activity&quot;||delement2.Type==&quot;Action&quot;)) {&#xA;			if(delement2.ParentID==delement1.ElementID) {&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;		&#xA;				//if there are other elements in the partition, we should set the left edge of the action to the right of the last element of the partition&#xA;				for(var i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null&amp;&amp;existElementObject.ParentID==delement1.ElementID&amp;&amp;&#xA;						(existElementObject.Type==&quot;Activity&quot;||existElementObject.Type==&quot;Action&quot;||existElementObject.Type==&quot;Object&quot;||&#xA;						 existElementObject.Type==&quot;Event&quot;||existElementObject.Type==&quot;StateNode&quot;||existElementObject.Type==&quot;Decision&quot;||existElementObject.Type==&quot;MergeNode&quot;)) {&#xA;						if(existDiagramObject.left&gt;diagramObject1.left&amp;&amp;existDiagramObject.right&lt;diagramObject1.right&amp;&amp;existDiagramObject.top&lt;diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;diagramObject1.bottom&amp;&amp;existDiagramObject.left&gt;left)&#xA;							left=existDiagramObject.right;&#xA;					}&#xA;				}				&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2new) { //new &quot;Action&quot; element&#xA;				testDiagramObject.left=left+25;&#xA;				testDiagramObject.right=left+100;&#xA;				testDiagramObject.top=top;  //-15;&#xA;				testDiagramObject.bottom=top-45;  //-60;&#xA;				testDiagramObject.Update();&#xA;			} else { //old &quot;Action&quot; element, but not in the diagram&#xA;				var left1=setLeftBorderOfPartition(diagramObjects, diagramObject1);&#xA;				if(left1&gt;left)&#xA;					left=left1;&#xA;				testDiagramObject.left=left+100;&#xA;				testDiagramObject.right=left+175;&#xA;				testDiagramObject.top=top;  //-15;&#xA;				testDiagramObject.bottom=top-45;  //-60;&#xA;				testDiagramObject.Update();&#xA;				placingElementOfAction(delement2, diagramObjects, diagramObject1, testDiagramObject,1); &#xA;			}			&#xA;			diagramObject2=testDiagramObject;&#xA;		} &#xA;	} else { &#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;Activity&quot;||delement2.Type==&quot;Action&quot;)) {&#xA;			if(delement2.ParentID==delement1.ElementID) { //if delement2 is the part of the partition&#xA;				//if delement2 is placed outside the partition&#xA;				if(diagramObject2.left&lt;diagramObject1.left||diagramObject2.right&gt;diagramObject1.right|| &#xA;					diagramObject2.top&gt;diagramObject1.top||diagramObject2.bottom&lt;diagramObject1.bottom) {&#xA;					//setting the left border inside the partition	&#xA;					var left1=setLeftBorderOfPartition(diagramObjects, diagramObject1);&#xA;					if(left1&gt;left)&#xA;						left=left1;&#xA;					diagramObject2.left=left+100;&#xA;					diagramObject2.right=left+175;&#xA;					diagramObject2.top=top;  //-15;&#xA;					diagramObject2.bottom=top-45;  //-60;&#xA;					diagramObject2.Update();&#xA;				}&#xA;				placingElementOfAction(delement2, diagramObjects, diagramObject1, diagramObject2,0); &#xA;			}&#xA;		}&#xA;	}&#xA;	if(mode==1) {&#xA;		diagramObjects.Refresh();&#xA;		placingElementOfActivityPartition(diagramObjects); &#xA;	}&#xA;	return;&#xA;}&#xA;//Setting the left border inside the partition	&#xA;function setLeftBorderOfPartition(diagramObjects, diagramObject1) {&#xA;	var existDiagramObject as EA.DiagramObject;&#xA;	var existElementObject as EA.Element;	&#xA;	var left=0;&#xA;&#xA;	if(diagramObject1.right-diagramObject1.left&lt;200) { //if the partition width is less than 200 points&#xA;		diagramObject1.right=diagramObject1.left+200;&#xA;		diagramObject1.Update();&#xA;	}&#xA;	if(-diagramObject1.bottom+diagramObject1.top&lt;50) { //if the partition height is less than 50 points&#xA;		diagramObject1.bottom=diagramObject1.top-125;&#xA;		diagramObject1.Update();&#xA;	}&#xA;	//if there are other elements in the partition, we should set the left edge of the action to the right of the last element of the partition&#xA;	for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;		existDiagramObject=diagramObjects.GetAt(i);&#xA;		if(existDiagramObject.ElementID&gt;0)&#xA;			existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;		else&#xA;			existElementObject=null;&#xA;		if(existElementObject!=null&amp;&amp;existElementObject.Type!=&quot;ActivityPartition&quot;&amp;&amp;existElementObject.ParentID==diagramObject1.ElementID&amp;&amp;&#xA;			existDiagramObject.top&lt;=diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;=diagramObject1.bottom&amp;&amp;&#xA;			existDiagramObject.left&gt;=diagramObject1.left&amp;&amp;existDiagramObject.right&lt;=diagramObject1.right) {&#xA;			if(existDiagramObject.left&gt;left)&#xA;				left=existDiagramObject.right;&#xA;		}&#xA;	}	&#xA;	return left;&#xA;}&#xA;//placing elements connected to delement2 (diagramObject2) and possibly correcting the dimensions of the partition (diagramObject1)&#xA;//mode==1 for the unsaved diagramObject2&#xA;function placingElementOfAction(delement2, diagramObjects, diagramObject1, diagramObject2, mode) {&#xA;	var topObjectLeft=0;  //elements placed on the left side delement2&#xA;	var topObjectRight=0; //elements placed on the right side delement2&#xA;	var connector as EA.Connector;&#xA;	if(mode!=2) {&#xA;		topObjectLeft=diagramObject1.top;  //elements placed on the left side delement2&#xA;		topObjectRight=diagramObject1.top; //elements placed on the right side delement2&#xA;	} else {&#xA;		topObjectLeft=diagramObject2.top;  //elements placed on the left side delement2&#xA;		topObjectRight=diagramObject2.top; //elements placed on the right side delement2&#xA;	}&#xA;	connector=null;&#xA;	//placing elements to the left and right of delement2&#xA;	for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;		connector=delement2.Connectors.GetAt(i);&#xA;		if(connector.Type==&quot;ObjectFlow&quot;) { //object elements connected to delement2&#xA;			if(connector.SupplierID!=delement2.ElementID&amp;&amp; (Repository.GetElementByID(connector.SupplierID)).Type==&quot;Object&quot;) {&#xA;				var objectTmp = Repository.GetElementByID(connector.SupplierID);&#xA;				for(j=0;j&lt;diagramObjects.Count;j++) {&#xA;					var existDiagramObject=diagramObjects.GetAt(j);&#xA;					if(existDiagramObject.ElementID==objectTmp.ElementID) {&#xA;						var widthTmp=existDiagramObject.right-existDiagramObject.left;&#xA;						var heightTmp=-existDiagramObject.bottom+existDiagramObject.top;&#xA;						if(mode!=2) {&#xA;							if(topObjectRight-heightTmp&lt;diagramObject1.bottom) {&#xA;								diagramObject1.bottom=diagramObject1.bottom-heightTmp;&#xA;								diagramObject1.Update();&#xA;							}&#xA;							if(diagramObject2.right+40+widthTmp&gt;diagramObject1.right) {&#xA;								diagramObject1.right=diagramObject2.right+40+widthTmp;&#xA;								diagramObject1.Update();&#xA;							}			&#xA;						}						&#xA;						existDiagramObject.left=diagramObject2.right+40;&#xA;						existDiagramObject.right=existDiagramObject.left+widthTmp;&#xA;						existDiagramObject.top=topObjectRight-3;&#xA;						existDiagramObject.bottom=existDiagramObject.top-heightTmp;&#xA;						topObjectRight=topObjectRight-heightTmp;&#xA;						existDiagramObject.Update();&#xA;						break;&#xA;					}&#xA;				}	&#xA;			} &#xA;		} else&#xA;		if(connector.Type==&quot;ControlFlow&quot;) { //elements connected to delement2&#xA;			if(connector.ClientID!=delement2.ElementID) {&#xA;				var elementTmp = Repository.GetElementByID(connector.ClientID);&#xA;				//Event&amp;InitialNode elements&#xA;				if(elementTmp.Type==&quot;Event&quot;&amp;&amp;elementTmp.Subtype==1||elementTmp.Type==&quot;StateNode&quot;&amp;&amp;(elementTmp.Subtype==100||elementTmp.Subtype==3)) {&#xA;					for(j=0;j&lt;diagramObjects.Count;j++) {&#xA;						var existDiagramObject=diagramObjects.GetAt(j);&#xA;						if(existDiagramObject.ElementID==elementTmp.ElementID) {&#xA;							var widthTmp=existDiagramObject.right-existDiagramObject.left;&#xA;							var heightTmp=-existDiagramObject.bottom+existDiagramObject.top;&#xA;							if(mode!=2) {&#xA;								if(topObjectRight-heightTmp&lt;diagramObject1.bottom) {&#xA;									diagramObject1.bottom=diagramObject1.bottom-heightTmp;&#xA;									diagramObject1.Update();&#xA;								}&#xA;							}&#xA;							existDiagramObject.left=diagramObject2.left-70; //40;&#xA;							existDiagramObject.right=existDiagramObject.left+widthTmp;&#xA;							if(elementTmp.Type==&quot;StateNode&quot;&amp;&amp;(elementTmp.Subtype==100||elementTmp.Subtype==3)&amp;&amp;topObjectLeft-3&gt;diagramObject2.top) {&#xA;								existDiagramObject.top=diagramObject2.top-(-diagramObject2.bottom+diagramObject2.top)/2+heightTmp/2;										&#xA;							} else &#xA;								existDiagramObject.top=topObjectLeft-3;&#xA;							existDiagramObject.bottom=existDiagramObject.top-heightTmp;&#xA;							topObjectLeft=topObjectLeft-heightTmp;&#xA;							existDiagramObject.Update();&#xA;							break;&#xA;						}&#xA;					}	&#xA;				}&#xA;			}&#xA;			else &#xA;			if(connector.SupplierID&gt;0&amp;&amp;connector.SupplierID!=delement2.ElementID) {&#xA;				var elementTmp = Repository.GetElementByID(connector.SupplierID);&#xA;				//Final&amp;ActivityFinal, Decision, Merge, Signal elements&#xA;				if(elementTmp.Type==&quot;StateNode&quot;&amp;&amp;elementTmp.Subtype==101||elementTmp.Type==&quot;StateNode&quot;&amp;&amp;elementTmp.Subtype==102||elementTmp.Type==&quot;Decision&quot;||elementTmp.Type==&quot;MergeNode&quot;||elementTmp.Type==&quot;Event&quot;&amp;&amp;elementTmp.Subtype==0) {&#xA;					for(j=0;j&lt;diagramObjects.Count;j++) {&#xA;						var existDiagramObject=diagramObjects.GetAt(j);&#xA;						if(existDiagramObject.ElementID==elementTmp.ElementID) {&#xA;							var widthTmp=existDiagramObject.right-existDiagramObject.left;&#xA;							var heightTmp=-existDiagramObject.bottom+existDiagramObject.top;&#xA;							if(mode!=2) {&#xA;								if(topObjectRight-heightTmp&lt;diagramObject1.bottom) {&#xA;									diagramObject1.bottom=diagramObject1.bottom-heightTmp;&#xA;									diagramObject1.Update();&#xA;								}	&#xA;								if(diagramObject2.right+40+widthTmp&gt;diagramObject1.right) {&#xA;									diagramObject1.right=diagramObject2.right+40+widthTmp;&#xA;									diagramObject1.Update();&#xA;								}&#xA;							}							&#xA;							existDiagramObject.left=diagramObject2.right+40;&#xA;							existDiagramObject.right=existDiagramObject.left+widthTmp;&#xA;							existDiagramObject.top=topObjectRight-3;&#xA;							existDiagramObject.bottom=existDiagramObject.top-heightTmp;&#xA;							topObjectRight=topObjectRight-heightTmp;&#xA;							existDiagramObject.Update();&#xA;							break;&#xA;						}&#xA;					}	&#xA;				}&#xA;			}&#xA;		}					&#xA;	}&#xA;	if(mode!=2) {&#xA;		var left=diagramObject1.right;&#xA;&#xA;		for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;			existDiagramObject=diagramObjects.GetAt(i);&#xA;			if(existDiagramObject.top&lt;diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;diagramObject1.bottom&amp;&amp;&#xA;				existDiagramObject.left&gt;diagramObject1.left&amp;&amp;existDiagramObject.right&lt;diagramObject1.right) {&#xA;				if(existDiagramObject.left&lt;left)&#xA;					left=existDiagramObject.left;&#xA;			}&#xA;		}&#xA;		//moving elements if there is too much empty space on the left&#xA;		if(left-diagramObject1.left&gt;100) {&#xA;			left=left-diagramObject1.left-50;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.top&lt;diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;diagramObject1.bottom&amp;&amp;&#xA;					existDiagramObject.left&gt;diagramObject1.left&amp;&amp;existDiagramObject.right&lt;diagramObject1.right) {&#xA;					existDiagramObject.left=existDiagramObject.left-left;&#xA;					existDiagramObject.right=existDiagramObject.right-left;&#xA;					existDiagramObject.Update();&#xA;				}&#xA;			}&#xA;			if(mode==1) {&#xA;				diagramObject2.left=diagramObject2.left-left;&#xA;				diagramObject2.right=diagramObject2.right-left;&#xA;				diagramObject2.Update();&#xA;			}&#xA;		}&#xA;	}&#xA;}&#xA;//placing elements connected to delement2 (diagramObject2) and possibly correcting the dimensions of the partition (diagramObject1)&#xA;//mode==1 for the unsaved diagramObject2&#xA;function placingElementOfActivityPartition(diagramObjects) {&#xA;var top=-1000;&#xA;&#xA;	for(var i=0;i&lt;diagramObjects.Count;i++) {&#xA;		existDiagramObject=diagramObjects.GetAt(i);&#xA;		if(existDiagramObject.top&gt;top) &#xA;			top=existDiagramObject.top;&#xA;	}&#xA;	//moving elements if there is too much empty space on the left&#xA;	if(top&lt;-30) {&#xA;		var shift=-30-top;&#xA;		for(var i=0;i&lt;diagramObjects.Count;i++) {&#xA;			existDiagramObject=diagramObjects.GetAt(i);&#xA;			existDiagramObject.top=existDiagramObject.top+shift;&#xA;			existDiagramObject.bottom=existDiagramObject.bottom+shift;&#xA;			existDiagramObject.Update();&#xA;		}&#xA;	}&#xA;}&#xA;//Rename pattern partitions according to rule parameters or according to actors connected to the use case&#xA;function renamePatternPartitions(nameElement, useCase, activityPartitions, subChildPackage) {&#xA;	var tmpAct = [];&#xA;	var delements as EA.Collection;&#xA;	var currentElement as EA.Element;&#xA;	var tmpElement = &quot;&quot;;&#xA;	var tmpPartition = activityPartitions.length;&#xA;	&#xA;	tmpAct=getActorsofUseCase(nameElement, useCase, activityPartitions.length);&#xA;	delements = subChildPackage.Elements; //imported package&#xA;	//changing the partition names of the imported package according to the names in the rule parameter&#xA;	for(i=0;i&lt;tmpPartition;i++) {&#xA;		currentElement=getByName(delements,activityPartitions[i][1]);&#xA;		if(currentElement!=null) {&#xA;			if(tmpAct.length&gt;i) {&#xA;				tmpElement = tmpAct[i];&#xA;				if(tmpElement!=null&amp;&amp;tmpElement!=&quot;&quot;&amp;&amp;tmpElement!=&quot; &quot;) {&#xA;					currentElement.Name = tmpElement;&#xA;					currentElement.Update;&#xA;				} else &#xA;					return;&#xA;			} else&#xA;				return;&#xA;		} else&#xA;			return;&#xA;	}&#xA;	return;&#xA;}&#xA;//change the name of partitions&#xA;function changePatternPackage(consistencyRule, nameElement, sourceElement, objectClasses, activityPartitions, subPackage) {&#xA;	if(consistencyRule.substr(0,1)==&quot;B&quot;) {&#xA;		//Session.Output(&quot;changePatternPackage:&quot;+nameElement+&quot;; source=&quot;+sourceElement.Name+&quot;; objects[0]=&quot;+objectClasses[0][0]+&quot;,&quot;+objectClasses[0][1]+&quot;; objects[1]=&quot;+objectClasses[1][0]+&quot;,&quot;+objectClasses[1][1]+&quot;; activityPartitions[0]=&quot;+activityPartitions[0][0]+activityPartitions[0][1]+&quot;; activityPartitions[1]=&quot;+activityPartitions[1][0]+activityPartitions[1][1]);&#xA;		renamePatternPartitions(nameElement, sourceElement, activityPartitions, subPackage);&#xA;	}&#xA;}	&#xA;//Rename pattern objects according to rule parameters or according to objects connected to the activity/action&#xA;function renamePatternObjects(consistencyRule, correctCR, nameElement, subProcess, classObjects, activityPartitions, subPackage, subChildPackage) {&#xA;	var tmpObj = [];&#xA;	var impdElements as EA.Collection;  	//the imported package elements&#xA;	var currElements as EA.Collection;		//the current package elements&#xA;	var targetElements as EA.Collection;	//the target package elements&#xA;	var currentElement as EA.Element;&#xA;	&#xA;	if(correctCR.substr(0,1)!=&quot;Y&quot;) {&#xA;		//The tmpObj array contains single instances resulting from the rule parameters - the first row - the input object, the last row - the output object&#xA;		tmpObj=getObjectsofSubProcess(consistencyRule,nameElement, subProcess, classObjects); //for RiviAvi rule&#xA;		tmpObj=tmpObj.sort();&#xA;		/*Session.Output(&quot;renamePatternObjects:&quot;+tmpObj.length);&#xA;		for(var i=0;i&lt;tmpObj.length;i++) {&#xA;			Session.Output(&quot;renamePatternObjects(&quot;+i+&quot;):&quot;+tmpObj[i][0]+&quot;,&quot;+tmpObj[i][1]);&#xA;		}*/	&#xA;	}	&#xA;	currElements = subPackage.Elements; //current package&#xA;	impdElements = subChildPackage.Elements; //imported package&#xA;	var otherElements=false; //if the imported package elements are in the current package elements&#xA;	for(var i=0;i&lt;impdElements.Count();i++) {&#xA;		currentElement=impdElements.GetAt(i);&#xA;		if(getByAlias(currElements,currentElement.Alias)==null) //if Element Alias in the imported package is not equal to Element Alias in the current package.&#xA;			otherElements=true; //at least one item from the imported package is missing in the current package&#xA;		if(consistencyRule.substr(0,1)==&quot;U&quot;) { //UauZpv: Action-&gt;System UC&#xA;			var sourceElement=null;&#xA;			for( var j=0; j&lt;subProcess.Connectors.Count; j++) {&#xA;				var connector=subProcess.Connectors.GetAt(j);&#xA;				if(connector.Type==&quot;Dependency&quot;&amp;&amp;connector.Alias==&quot;ApUau&quot;) { &#xA;					sourceElement=Repository.GetElementByID(connector.SupplierID);&#xA;					if(sourceElement.Type==&quot;UseCase&quot;)&#xA;						break;&#xA;					sourceElement=null;&#xA;				}&#xA;			}		&#xA;			if(sourceElement!=null) { //Action-&gt;System UC&#xA;				setCRDependency(consistencyRule,correctCR,sourceElement,currentElement);&#xA;				setCRDependency(correctCR,correctCR,sourceElement,currentElement);	&#xA;			}&#xA;		} else&#xA; 		if(consistencyRule.substr(0,1)==&quot;Y&quot;) { //Lifeline Action-&gt;Implementation UC&#xA;			setCRDependency(consistencyRule,correctCR,subProcess,currentElement);&#xA;			setCRDependency(correctCR,correctCR,subProcess,currentElement);	&#xA;		} else&#xA;			setCRDependency(consistencyRule,correctCR,subProcess,currentElement);&#xA;	}&#xA;	//The classObject array contains all instances from the imported package&#xA;	if(otherElements) //There are not imported partitions in the current package&#xA;		targetElements=impdElements;&#xA;	else { //There are imported partitions in the current package&#xA;		targetElements=impdElements;&#xA;		if(correctCR.substr(0,1)!=&quot;Y&quot;)&#xA;			renamePackageObjects(subPackage, tmpObj, classObjects, targetElements);&#xA;		else&#xA;			renamePackageLifelines(subPackage, classObjects, targetElements, nameElement);&#xA;		targetElements=currElements;&#xA;	}&#xA;	if(correctCR.substr(0,1)!=&quot;Y&quot;)&#xA;		renamePackageObjects(subPackage, tmpObj, classObjects, targetElements);&#xA;	else&#xA;		renamePackageLifelines(subPackage, classObjects, targetElements, nameElement);&#xA;	return otherElements;&#xA;}&#xA;//Rename lifeline properties according to names in the classObjectsX&#xA;function renamePackageLifelines(subPackage, classObjects, targetElements, nameElement) {&#xA;&#xA;	//Session.Output(&quot;renamePackageLifeLines:classObjects.length=&quot;+classObjects.length+&quot;targetElements.ID&quot;+(targetElements.GetAt(0)).ParentID);&#xA;	for(var i=0;i&lt;targetElements.Count;i++) {&#xA;		var lineLife = targetElements.GetAt(i);&#xA;		//Session.Output(&quot;renamePackageLifeLines(0): lineLife(&quot;+i+&quot;)=&quot;+lineLife.Name+&quot;; &quot;+lineLife.ClassifierID);&#xA;		for(var j=0;j&lt;classObjects.length;j++) {&#xA;			if(lineLife.Alias==classObjects[j][0]) {&#xA;				if(classObjects[j][1]==&quot;Lifeline1&quot;) {//first lifeline&#xA;					var name1=null;&#xA;					var class1=null;&#xA;					if(nameElement.indexOf(&quot;:&quot;)&gt;-1) {&#xA;						name1=nameElement.substr(0,nameElement.indexOf(&quot;:&quot;));&#xA;						class1=nameElement.substr(nameElement.indexOf(&quot;:&quot;)+1);&#xA;						if(class1.substr(0,1)==&quot;&quot;)&#xA;							class1=&quot;Module&quot;;&#xA;					} else {&#xA;						name1=nameElement;&#xA;						class1=&quot;Module&quot;;&#xA;					}&#xA;					var component=searchForElement(subPackage, class1, &quot;Component&quot;);&#xA;					if(component==null)&#xA;						component=subPackage.Elements.AddNew(class1,&quot;Component&quot;);&#xA;					lineLife.ClassifierID=component.ElementID;&#xA;					lineLife.Name=name1;&#xA;					lineLife.Update();&#xA;					classObjects.splice(j,1);&#xA;					break;&#xA;				} else {&#xA;					var component=searchForElement(subPackage, classObjects[j][1], &quot;Component&quot;);&#xA;					if(component==null)&#xA;						component=subPackage.Elements.AddNew(classObjects[j][1],&quot;Component&quot;);&#xA;					lineLife.ClassifierID=component.ElementID;&#xA;					lineLife.Name=&quot;&quot;;&#xA;					lineLife.Update();&#xA;					classObjects.splice(j,1);&#xA;					break;					&#xA;				}&#xA;			} //here you can make changes to the values in the messages (Object Classifiers)&#xA;		}&#xA;		//Session.Output(&quot;renamePackageLifeLines(1): lineLife(&quot;+i+&quot;)=&quot;+lineLife.Name+&quot;; &quot;+lineLife.ClassifierID);&#xA;	}&#xA;}&#xA;//Rename object package properties in partitions according to names in the tmpObj&#xA;function renamePackageObjects(subPackage, tmpObjX, classObjectsX, targetElements) {&#xA;	var currentElement as EA.Element;&#xA;	var currentObject as EA.Element;&#xA;	var tmpObjects = tmpObjX.length;&#xA;	var inElementClass;&#xA;	var inElementName;&#xA;	var inClassElement as EA.Element;&#xA;	var outElementClass;&#xA;	var outElementName;&#xA;	var outClassElement as EA.Element;&#xA;	var tmpObj=tmpObjX.slice();&#xA;	var classObjects=classObjectsX.slice();&#xA;&#xA;	inElementName=tmpObj[0][1].substr(0,tmpObj[0][1].indexOf(&quot;:&quot;));&#xA;	inElementClass=tmpObj[0][1].substr(tmpObj[0][1].indexOf(&quot;:&quot;)+1);&#xA;	if(inElementClass!=null&amp;&amp;inElementClass!=&quot;&quot;) {&#xA;		inClassElement=searchForElement(subPackage, inElementClass, &quot;Class&quot;);&#xA;		if(inClassElement==null)&#xA;			inClassElement=subPackage.Elements.AddNew(inElementClass, &quot;Class&quot;);&#xA;	}&#xA;	outElementName=tmpObj[tmpObjects-1][1].substr(0,tmpObj[tmpObjects-1][1].indexOf(&quot;:&quot;));&#xA;	outElementClass=tmpObj[tmpObjects-1][1].substr(tmpObj[tmpObjects-1][1].indexOf(&quot;:&quot;)+1);&#xA;	if(outElementClass!=null&amp;&amp;outElementClass!=&quot;&quot;) {&#xA;		outClassElement=searchForElement(subPackage, outElementClass, &quot;Class&quot;);&#xA;		if(outClassElement==null)&#xA;			outClassElement=subPackage.Elements.AddNew(outElementClass, &quot;Class&quot;);&#xA;	}&#xA;	for(var i=0; i&lt;targetElements.Count; i++) {&#xA;		currentElement=targetElements.GetAt(i); //the first element&#xA;		if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;			for(var j=0; j&lt;currentElement.Elements.Count(); j++) {&#xA;				currentObject=currentElement.Elements.GetAt(j);&#xA;				if(currentObject.Type==&quot;Object&quot;) { &#xA;					var execute=false;&#xA;					if(currentObject.Tag.substr(0,7)==tmpObj[0][0]) {&#xA;						if(currentObject.Tag==classObjects[0][0]) { //CMDA.eCMDA error: Nie mo&#380;na pobra&#263; w&#322;a&#347;ciwo&#347;ci 0 dla niezdefiniowanego lub pustego odwo&#322;ania, Line:3757&#xA;							if(inElementName.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;inElementName.indexOf(&quot;]&quot;)&gt;0&amp;&amp;inElementName.indexOf(&quot;]&quot;)&gt;inElementName.indexOf(&quot;[&quot;)) {&#xA;								currentObject.Name=inElementName.substr(0,inElementName.indexOf(&quot;[&quot;));&#xA;							} else&#xA;								currentObject.Name=inElementName;&#xA;							var stateObject=inElementName.substr(inElementName.indexOf(&quot;[&quot;)+1);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;								stateObject=stateObject.substr(0,stateObject.indexOf(&quot;]&quot;));&#xA;								if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;									var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+currentObject.ElementID;&#xA;									execute=true;&#xA;								}&#xA;							}&#xA;						}&#xA;						currentObject.ClassifierID=inClassElement.ElementID;&#xA;						currentObject.Update();&#xA;						if(execute) //it works&#xA;							Repository.Execute(sqlCommand);&#xA;					} else&#xA;					if(currentObject.Tag.substr(0,7)==tmpObj[tmpObjects-1][0]) {&#xA;						if(currentObject.Tag==classObjects[classObjects.length-1][0]) {&#xA;							if(outElementName.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;outElementName.indexOf(&quot;]&quot;)&gt;0&amp;&amp;outElementName.indexOf(&quot;]&quot;)&gt;outElementName.indexOf(&quot;[&quot;)) {&#xA;								currentObject.Name=outElementName.substr(0,outElementName.indexOf(&quot;[&quot;));&#xA;							} else&#xA;								currentObject.Name=outElementName;&#xA;							var stateObject=outElementName.substr(outElementName.indexOf(&quot;[&quot;)+1);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;								stateObject=stateObject.substr(0,stateObject.indexOf(&quot;]&quot;));&#xA;								if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;									var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+currentObject.ElementID;&#xA;									execute=true;&#xA;								}&#xA;							}							&#xA;						}&#xA;						currentObject.ClassifierID=outClassElement.ElementID;&#xA;						currentObject.Update();&#xA;						if(execute) //it works&#xA;							Repository.Execute(sqlCommand);&#xA;					}					&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	if(tmpObj.length&gt;2) {&#xA;		var tmpObjElement=tmpObj.shift();&#xA;		while(tmpObj.length&gt;0&amp;&amp;tmpObj[0][0]==tmpObjElement[0][0])&#xA;			tmpObj.shift();&#xA;		if(tmpObj.length&gt;0) {&#xA;			tmpObjElement=tmpObj.pop();&#xA;			var tmpObjElement1=tmpObj[tmpObj.length-1][0];&#xA;			var tmpObjElement2=tmpObjElement[0];&#xA;			while(tmpObj.length&gt;0&amp;&amp;tmpObjElement1==tmpObjElement2)&#xA;				tmpObj.pop();&#xA;		}&#xA;		while(classObjects.length&gt;0&amp;&amp;classObjects[0][0].substr(0,7)==&quot;ObjectA&quot;)&#xA;			classObjects.shift();&#xA;		while(classObjects.length&gt;0&amp;&amp;classObjects[classObjects.length-1][0].substr(0,7)==&quot;ObjectZ&quot;)&#xA;			classObjects.pop();&#xA;		if(classObjects.length&gt;0&amp;&amp;tmpObj.length&gt;0) {&#xA;			while(tmpObj.length&gt;0) {&#xA;				inElementName=tmpObj[0][1].substr(0,tmpObj[0][1].indexOf(&quot;:&quot;));&#xA;				inElementClass=tmpObj[0][1].substr(tmpObj[0][1].indexOf(&quot;:&quot;)+1);&#xA;				if(inElementClass!=null&amp;&amp;inElementClass!=&quot;&quot;) {&#xA;					inClassElement=searchForElement(subPackage, inElementClass, &quot;Class&quot;);&#xA;					if(inClassElement==null)&#xA;						inClassElement=subPackage.Elements.AddNew(inElementClass, &quot;Class&quot;);&#xA;				}				&#xA;				outElementName=classObjects[0][0].substr(0,7);&#xA;				for(var i=0; i&lt;targetElements.Count(); i++) {&#xA;					currentElement=targetElements.GetAt(i); //the first element&#xA;					if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;						for(var j=0; j&lt;currentElement.Elements.Count(); j++) {&#xA;							currentObject=currentElement.Elements.GetAt(j);&#xA;							if(currentObject.Type==&quot;Object&quot;) { &#xA;								var execute=false;&#xA;								if(currentObject.Tag.substr(0,7)==outElementName) {&#xA;									if(currentObject.Tag==classObjects[0][0]) {&#xA;										if(inElementName.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;inElementName.indexOf(&quot;]&quot;)&gt;0&amp;&amp;inElementName.indexOf(&quot;]&quot;)&gt;inElementName.indexOf(&quot;[&quot;)) {&#xA;											currentObject.Name=inElementName.substr(0,inElementName.indexOf(&quot;[&quot;));&#xA;										} else&#xA;											currentObject.Name=inElementName;&#xA;										var stateObject=inElementName.substr(inElementName.indexOf(&quot;[&quot;)+1);&#xA;										if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;											stateObject=stateObject.substr(0,stateObject.indexOf(&quot;]&quot;));&#xA;											if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;) {&#xA;												var sqlCommand=&quot;update t_object set StateFlags = '&quot;+stateObject+&quot;' where object_id = &quot;+currentObject.ElementID;&#xA;												execute=true;&#xA;											}&#xA;										}&#xA;									}&#xA;									currentObject.ClassifierID=inClassElement.ElementID;&#xA;									currentObject.Update();&#xA;									if(execute) //it works&#xA;										Repository.Execute(sqlCommand);&#xA;								} 					&#xA;							}&#xA;						}&#xA;					}&#xA;				}&#xA;				tmpObjElement=tmpObj.shift();&#xA;				while(tmpObj.length&gt;0&amp;&amp;tmpObj[0][0]==tmpObjElement)&#xA;					tmpObj.shift();				&#xA;				while(classObjects.length&gt;0&amp;&amp;classObjects[0][0].substr(0,7)==outElementName)&#xA;					classObjects.shift();&#xA;				if(classObjects.length&lt;=0)&#xA;					break;&#xA;			}&#xA;		}&#xA;	}&#xA;}&#xA;//Moving pattern elements from the imported package to the current package&#xA;function movePatternPackage(subPackage, subChildPackage) {&#xA;	var subElements as EA.Collection;&#xA;	var delements as EA.Collection;&#xA;	subElements = subPackage.Elements; //current package &#xA;	delements = subChildPackage.Elements; //imported package&#xA;	var moving = true;&#xA;	&#xA;	for ( var j = 0 ; j &lt; delements.Count() &amp;&amp; moving==true; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		var subPckElement as EA.Element;&#xA;		currentElement = delements.GetAt(j);&#xA;		for ( var k = 0; k &lt; subElements.Count(); k++) {&#xA;			subPckElement=subElements.GetAt(k);&#xA;			if(subPckElement.Type==currentElement.Type &amp;&amp;&#xA;				(subPckElement.Name==currentElement.Name || subPckElement.Alias==currentElement.Alias)) {&#xA;				moving=false;&#xA;				break;&#xA;			}&#xA;		}&#xA;	}&#xA;	if(moving) {&#xA;		for ( var j = 0 ; j &lt; delements.Count(); j++ )&#xA;		{&#xA;			var currentElement as EA.Element;&#xA;			currentElement = delements.GetAt(j);&#xA;			currentElement.PackageID=subPackage.PackageID;&#xA;			currentElement.Update();&#xA;		}&#xA;		subPackage.Diagrams.Refresh();&#xA;		var testDiagram = subChildPackage.Diagrams.GetAt(0);&#xA;		if(testDiagram!=null) {&#xA;			testDiagram.PackageID = subPackage.PackageID;&#xA;			testDiagram.ParentID=0;&#xA;			testDiagram.Update;&#xA;		}&#xA;	} else {  &#xA;		//You should check if the partition names are not the same as in the import package. &#xA;		//If so, it would be useful to change the partition names in the current directory to the ones imported by aliases.&#xA;		for ( var j = 0 ; j &lt; delements.Count() ; j++ )&#xA;		{&#xA;			var currentElement as EA.Element;&#xA;			var subPckElement as EA.Element; &#xA;			var changing = false;&#xA;			currentElement = delements.GetAt(j); //imported package&#xA;			for ( var k = 0; k &lt; subElements.Count(); k++) {&#xA;				subPckElement=subElements.GetAt(k); //current package&#xA;				if(subPckElement.Alias==currentElement.Alias &amp;&amp; subPckElement.Type==currentElement.Type) {&#xA;					changing=true;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(changing&amp;&amp;subPckElement.Name!=currentElement.Name) {&#xA;				subPckElement.Name=currentElement.Name;&#xA;				subPckElement.Update();&#xA;			}&#xA;		}&#xA;	}&#xA;}&#xA;//Return all actor names from 'nameElement' or if 'nameElement' values &#8203;&#8203;are less than 'nr', return all actor names connected to 'useCase'&#xA;function getActorsofUseCase(nameElement, useCase, nr) {&#xA;	var tmpA = [];&#xA;	var tmpA1 = [];&#xA;	var elUC as EA.Element;&#xA;&#xA;	if(nameElement!=null&amp;&amp;nameElement!=&quot;&quot;&amp;&amp;nameElement!=&quot; &quot;) {&#xA;		var tmpElement = nameElement;&#xA;		while(tmpElement.indexOf(&quot;,&quot;)&gt;0) {&#xA;			tmpA.push(tmpElement.substr(0,tmpElement.indexOf(&quot;,&quot;)));&#xA;			tmpElement=tmpElement.substr(tmpElement.indexOf(&quot;,&quot;)+1);&#xA;		}&#xA;		if(tmpElement!=null&amp;&amp;tmpElement!=&quot;&quot;) {&#xA;			tmpA.push(tmpElement);&#xA;		}&#xA;	}&#xA;	//if there are fewer elements in tmpElement than in activityPartitions - you can try to identify all actors connected to the use case (in the conn[0][1] array)&#xA;	if(nameElement==null||nameElement==&quot;&quot;||nameElement==&quot; &quot;||tmpA.length&lt;nr) {&#xA;		elUC=useCase;&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;elUC.Connectors.Count;i++) {&#xA;			connector=elUC.Connectors.GetAt(i);&#xA;			if(connector.Type==&quot;Association&quot;) {&#xA;				if(connector.ClientID!=null&amp;&amp; (Repository.GetElementByID(connector.ClientID)).Type==&quot;Actor&quot;) {&#xA;					var actor = Repository.GetElementByID(connector.ClientID);&#xA;					tmpA1.push(actor.Name);&#xA;				} else &#xA;				if(connector.SupplierID!=null&amp;&amp; (Repository.GetElementByID(connector.SupplierID)).Type==&quot;Actor&quot;) {&#xA;					var actor = Repository.GetElementByID(connector.SupplierID);&#xA;					tmpA1.push(actor.Name);&#xA;				} &#xA;			}&#xA;		}&#xA;		if(tmpA1.length&lt;nr) {&#xA;			if(tmpA1.length&gt;tmpA.length)&#xA;				return tmpA1;&#xA;			return tmpA;&#xA;		}&#xA;		return tmpA1;&#xA;	}&#xA;	return tmpA;&#xA;}&#xA;//Return all object names from 'nameElement' or if 'nameElement' values &#8203;&#8203;are less than 'nr', return all object names connected to 'subProcess'&#xA;function getObjectsofSubProcess(consistencyRule, nameElement, subProcess, classObjects) {&#xA;	var tmpA = [];&#xA;	var tmpA1 = [];&#xA;	var elsP as EA.Element;&#xA;	var nr=1;&#xA;	var objectName;&#xA;	&#xA;	objectName=&quot;ObjectA&quot;;&#xA;	if(nameElement!=null&amp;&amp;nameElement!=&quot;&quot;&amp;&amp;nameElement!=&quot; &quot;) {&#xA;		var tmpElement = nameElement;&#xA;		while(tmpElement.indexOf(&quot;,&quot;)&gt;0) {&#xA;			tmpA.push([objectName, tmpElement.substr(0,tmpElement.indexOf(&quot;,&quot;))]);&#xA;			tmpElement=tmpElement.substr(tmpElement.indexOf(&quot;,&quot;)+1);&#xA;			var strLiterka;&#xA;			if(objectName.substr(6)==&quot;A&quot;)&#xA;				strLiterka=&quot;B&quot;;&#xA;			else if(objectName.substr(6)==&quot;B&quot;)&#xA;				strLiterka=&quot;C&quot;;&#xA;			else if(objectName.substr(6)==&quot;C&quot;)&#xA;				strLiterka=&quot;D&quot;;&#xA;			else if(objectName.substr(6)==&quot;D&quot;)&#xA;				strLiterka=&quot;E&quot;;&#xA;			else &#xA;				strLiterka=&quot;F&quot;;&#xA;			objectName=objectName.substr(0,6)+strLiterka;&#xA;		}&#xA;		if(tmpElement!=null&amp;&amp;tmpElement!=&quot;&quot;) {&#xA;			tmpA.push([objectName, tmpElement]);&#xA;		}&#xA;		if(tmpA.length&gt;1)&#xA;			tmpA[tmpA.length-1][0]=&quot;ObjectZ&quot;;&#xA;	}&#xA;	//number of classes of objects in the imported package&#xA;	var nameObject=&quot;ObjectA&quot;;&#xA;	for(i=0;i&lt;classObjects.length;i++) {&#xA;		if(classObjects[i][0].substr(0,7)!=nameObject) {&#xA;			nr=nr+1;&#xA;			nameObject=classObjects[i][0].substr(0,7);&#xA;		}&#xA;	}&#xA;	//if there are fewer elements in tmpElement than in activityPartitions - you can try to identify all actors connected to the use case (in the conn[0][1] array)&#xA;	if(consistencyRule.substr(0,1)==&quot;R&quot;||consistencyRule.substr(0,1)==&quot;U&quot;) {&#xA;		if(nameElement==null||nameElement==&quot;&quot;||nameElement==&quot; &quot;||tmpA.length&lt;nr) {&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			elsP=subProcess;&#xA;			objectName=&quot;ObjectA&quot;;&#xA;			//input objects&#xA;			for(i=0;i&lt;elsP.Connectors.Count;i++) {&#xA;				connector=elsP.Connectors.GetAt(i);&#xA;				if(connector.Type==&quot;ControlFlow&quot;||connector.Type==&quot;ObjectFlow&quot;) {&#xA;					if(connector.ClientID!=null) {&#xA;						var elementX=Repository.GetElementByID(connector.ClientID);&#xA;						var classObject=&quot;Unknown&quot;;&#xA;						if(elementX.Type==&quot;Object&quot;) {&#xA;							if(elementX.ClassifierID!=null&amp;&amp; elementX.ClassifierID&gt;0)&#xA;								classObject = Repository.GetElementByID(elementX.ClassifierID);&#xA;							var stateObject=getStatesOfObject(elementX);&#xA;							if(stateObject==null||stateObject==&quot;&quot;)&#xA;								tmpA1.push([objectName, elementX.Name+&quot;:&quot;+classObject.Name]);&#xA;							else&#xA;								tmpA1.push([objectName, elementX.Name+&quot;[&quot;+stateObject+&quot;]&quot;+&quot;:&quot;+classObject.Name]);&#xA;							if(objectName.substr(6)==&quot;A&quot;)&#xA;								strLiterka=&quot;B&quot;;&#xA;							else if(objectName.substr(6)==&quot;B&quot;)&#xA;								strLiterka=&quot;C&quot;;&#xA;							else if(objectName.substr(6)==&quot;C&quot;)&#xA;								strLiterka=&quot;D&quot;;&#xA;							else if(objectName.substr(6)==&quot;D&quot;)&#xA;								strLiterka=&quot;E&quot;;&#xA;							else &#xA;								strLiterka=&quot;F&quot;;&#xA;							objectName=objectName.substr(0,6)+strLiterka;&#xA;							&#xA;						} else&#xA;						if(elementX.Type==&quot;Event&quot;) {&#xA;							tmpA1.push([objectName, elementX.Name]);&#xA;							if(objectName.substr(6)==&quot;A&quot;)&#xA;								strLiterka=&quot;B&quot;;&#xA;							else if(objectName.substr(6)==&quot;B&quot;)&#xA;								strLiterka=&quot;C&quot;;&#xA;							else if(objectName.substr(6)==&quot;C&quot;)&#xA;								strLiterka=&quot;D&quot;;&#xA;							else if(objectName.substr(6)==&quot;D&quot;)&#xA;								strLiterka=&quot;E&quot;;&#xA;							else &#xA;								strLiterka=&quot;F&quot;;&#xA;							objectName=objectName.substr(0,6)+strLiterka;&#xA;						}&#xA;					} &#xA;				}&#xA;			}&#xA;			//output objects&#xA;			objectName=&quot;ObjectZ&quot;;&#xA;			for(i=0;i&lt;elsP.Connectors.Count;i++) {&#xA;				connector=elsP.Connectors.GetAt(i);&#xA;				if(connector.Type==&quot;ObjectFlow&quot;) {&#xA;					if(connector.ClientID!=null) {&#xA;						var elementX=Repository.GetElementByID(connector.SupplierID);&#xA;						var classObject=&quot;Unknown&quot;;&#xA;						if(elementX.Type==&quot;Object&quot;) {&#xA;							if(elementX.ClassifierID!=null&amp;&amp; elementX.ClassifierID&gt;0)&#xA;								classObject = Repository.GetElementByID(elementX.ClassifierID);&#xA;							var stateObject=getStatesOfObject(elementX);&#xA;							if(stateObject==null||stateObject==&quot;&quot;)&#xA;								tmpA1.push([objectName, elementX.Name+&quot;:&quot;+classObject.Name]);&#xA;							else&#xA;								tmpA1.push([objectName, elementX.Name+&quot;[&quot;+stateObject+&quot;]&quot;+&quot;:&quot;+classObject.Name]);&#xA;							if(objectName.substr(6)==&quot;Z&quot;)&#xA;								strLiterka=&quot;Y&quot;;&#xA;							else if(objectName.substr(6)==&quot;Y&quot;)&#xA;								strLiterka=&quot;X&quot;;&#xA;							else if(objectName.substr(6)==&quot;X&quot;)&#xA;								strLiterka=&quot;W&quot;;&#xA;							else if(objectName.substr(6)==&quot;W&quot;)&#xA;								strLiterka=&quot;U&quot;;&#xA;							else &#xA;								strLiterka=&quot;T&quot;;&#xA;							objectName=objectName.substr(0,6)+strLiterka;&#xA;						} &#xA;					} &#xA;				}&#xA;			}&#xA;			if(tmpA1.length&lt;nr) {&#xA;				while(tmpA1.length&lt;nr) {&#xA;					tmpA1.push(tmpA1[tmpA1.length-1]);&#xA;				}&#xA;			}&#xA;			return tmpA1;&#xA;		}&#xA;	}&#xA;	return tmpA;&#xA;}&#xA;//Return an element named 'nameElement' from the 'elements' collection&#xA;function getByName(elements,nameElement) {&#xA;	for ( var j = 0 ; j &lt; elements.Count() ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = elements.GetAt(j);&#xA;		if(currentElement.Name == nameElement) &#xA;			return currentElement;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Return an element named 'nameElement' from the 'elements' collection&#xA;function getByAlias(elements,nameElement) {&#xA;	for ( var j = 0 ; j &lt; elements.Count() ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;		currentElement = elements.GetAt(j);&#xA;		if(currentElement.Alias == nameElement) &#xA;			return currentElement;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Setting the parameter values &#8203;&#8203;for the rule - for mode==0 parameter nr is run (conns[0][0] is run, then conns[0][1] when the parameters are empty), otherwise for mode==1 only conns[0][0] is run, for mode==2 only conns[0][1] is run&#xA;function setParameterValue(params, conns, nr, nameElement, mode, thePackage) {&#xA;	var nameElement1=&quot;&quot;;&#xA;	&#xA;	if(params[1][nr]==&quot;&quot;||params[1][nr]==&quot; &quot;) { //empty element name &#xA;		//BauAp()v&#xA;		if(params[0][nr]==&quot;&quot;||params[0][nr]==&quot; &quot;)  {//empty source element name&#xA;			//Ba()uAp()v&#xA;			if(mode==6) {&#xA;				if(conns[0][nr].ObjectType==otElement&amp;&amp;conns[0][nr].ClassifierID&gt;0)&#xA;					nameElement1=conns[0][nr].Name+&quot;:&quot;+(Repository.GetElementByID(conns[0][nr].ClassifierID)).Name;&#xA;				else&#xA;					nameElement1=conns[0][nr].Name+&quot;:Module&quot;;				&#xA;			} else if(mode==2||mode==3) { //RiviAvi&#xA;				if(mode==2&amp;&amp;(conns[0][1]!=null&amp;&amp;(conns[0][1].Type==&quot;Action&quot;||conns[0][1].Type==&quot;Activity&quot;)))&#xA;					nameElement1=conns[0][1].Name;&#xA;				else&#xA;					nameElement1=nameElement; //Revbau, ReviBaua, RiviBaua&#xA;			} else &#xA;			if (mode==5&amp;&amp;nr==0) //Lifeline&#xA;				nameElement1=setParameterValueLifeLine(conns[0][1],thePackage);&#xA;			else { //others&#xA;				if(conns[0][nr]==null||conns[0][nr].Name==&quot;&quot;) { //empty source diagram element name&#xA;					//Ba()uAp()v/Actor:(no name)&#xA;					if((mode==0||mode==4)&amp;&amp;conns[0][nr]!=null&amp;&amp;conns[0][nr].ClassifierID&gt;0) {&#xA;						if(mode==4)&#xA;							nameElement1=(Repository.GetElementByID(conns[0][nr].ClassifierID)).Name; &#xA;						else&#xA;							nameElement1=&quot;:&quot;+(Repository.GetElementByID(conns[0][nr].ClassifierID)).Name; &#xA;						if(mode==0) {&#xA;							if(params[2][nr]!=null&amp;&amp;params[2][nr]!=&quot;&quot;&amp;&amp;params[2][nr]!=&quot; &quot;)&#xA;								nameElement1=&quot;[&quot;+params[2][nr]+&quot;]&quot;+nameElement1;&#xA;							else {&#xA;								var stateObject=getStatesOfObject(conns[0][nr]);&#xA;								if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;									nameElement1=&quot;[&quot;+stateObject+&quot;]&quot;+nameElement1;						&#xA;							}&#xA;						}&#xA;					}&#xA;					else &#xA;					if(mode==1&amp;&amp;conns[0][0]!=null&amp;&amp;conns[0][0].ClassifierID&gt;0) {&#xA;						nameElement1=&quot;:&quot;+(Repository.GetElementByID(conns[0][0].ClassifierID)).Name; &#xA;						if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;)&#xA;							nameElement1=&quot;[&quot;+params[2][0]+&quot;]&quot;+nameElement1;&#xA;						else {&#xA;							var stateObject=getStatesOfObject(conns[0][0]);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;								nameElement1=&quot;[&quot;+stateObject+&quot;]&quot;+nameElement1;									&#xA;						}&#xA;					}&#xA;					else&#xA;						nameElement1=nameElement; //Revbau, ReviBaua, RiviBaua&#xA;&#xA;				} else { //the source diagram element has a name&#xA;					//Ba()uAp()v/Actor:name&#xA;					if(mode==0||mode==4)&#xA;						nameElement1=conns[0][nr].Name;&#xA;					else&#xA;					if((conns[0][0]==null||conns[0][0].Name==&quot;&quot;||conns[0][0].Name==&quot; &quot;)&amp;&amp;conns[0][0].ClassifierID&gt;0) {&#xA;						nameElement1=&quot;:&quot;+(Repository.GetElementByID(conns[0][0].ClassifierID)).Name; &#xA;						if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;)&#xA;							nameElement1=&quot;[&quot;+params[2][0]+&quot;]&quot;+nameElement1;	&#xA;						else {&#xA;							var stateObject=getStatesOfObject(conns[0][0]);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;								nameElement1=&quot;[&quot;+stateObject+&quot;]&quot;+nameElement1;									&#xA;						}&#xA;					}&#xA;					else&#xA;						nameElement1=nameElement; //Revbau, ReviBaua, RiviBaua&#xA;				}&#xA;			}&#xA;		} else if(params[0][nr].substr(0,1)==&quot;:&quot;) { //the source element name has only class type&#xA;			//Ba(:class)vAp()v&#xA;			//nameElement1=params[0][nr];&#xA;			nameElement1=getStateParameter(params[0][nr], params[2][nr])&#xA;		} else { //the source element can have a complex name&#xA;			nameElement1=getStateParameter(params[0][nr], params[2][nr])&#xA;			//if(params[0][nr].indexOf(&quot;:&quot;)&gt;0) //Ba(name:class)vAp()v&#xA;			//	nameElement1=params[0][nr].substr(0,params[0][nr].indexOf(&quot;:&quot;));&#xA;			//else //Ba(name[State])vAp()v&#xA;			//	nameElement1=params[0][nr];&#xA;		}&#xA;	} else if(params[1][nr].substr(0,1)==&quot;:&quot;) { //the element name has only class type&#xA;		//BavAp(:class)v&#xA;		if(mode==5||mode==3||mode==6)&#xA;			nameElement1=params[1][nr];&#xA;		else&#xA;			nameElement1=getStateParameter(params[1][nr], params[3][nr]);&#xA;	} else { //the element can have a complex name&#xA;		//Session.Output(&quot;setParameterValue(3):mode=&quot;+mode+&quot;; params[1][&quot;+nr+&quot;]=&quot;+params[1][nr]);&#xA;		if(mode!=5&amp;&amp;mode!=3&amp;&amp;mode!=6&amp;&amp;params[1][nr].indexOf(&quot;:&quot;)&gt;0) //BavAp(name[state]:class)v&#xA;			nameElement1=getStateParameter(params[1][nr], params[3][nr]);&#xA;		else //BavAp(name[state])v&#xA;			nameElement1=params[1][nr];&#xA;	}&#xA;	return nameElement1;&#xA;}&#xA;//Return nameElement for the first Lifeline of Seunce diagram&#xA;function setParameterValueLifeLine(systemUC,thePackage) {&#xA;var name1=null;&#xA;var class1=null;&#xA;var action1=null;&#xA;var action2=null;&#xA;var action3=null;&#xA;var nameElement1=null;&#xA;//conns[0][0]/[1] - implementation/system use case(ApUau)-&gt;Action(ParentID)-&gt;ActivityPartition(RiviAvi)-&gt;SubProcess&#xA;//system use case.Name:Subprocess.Name-message:downLoad(Data):Data&#xA;//thePackage.Name:theParenPackage.Name-message:downLoad(Data):Data&#xA;&#xA;	//Session.Output(&quot;setParameterValueLifeLine:systemUC=&quot;+systemUC.Name+&quot;;&quot;+systemUC.Type+&quot;; thePackage.Name=&quot;+thePackage.Name);&#xA;	if(systemUC!=null&amp;&amp;systemUC.Type==&quot;UseCase&quot;) { //system UseCase&#xA;		name1=systemUC.Name;&#xA;		while(name1.substr(0,1)&gt;=&quot;0&quot;&amp;&amp;name1.substr(0,1)&lt;=&quot;9&quot;||name1.substr(0,1)==&quot;.&quot;||name1.substr(0,1)==&quot; &quot;)&#xA;			name1=name1.substr(1);&#xA;		for(var i=0;i&lt;systemUC.Connectors.Count;i++) {&#xA;			var connector1=systemUC.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Dependency&quot;&amp;&amp;connector1.Alias==&quot;ApUau&quot;) { //Action in A diagram&#xA;				action1=Repository.GetElementByID(connector1.ClientID);&#xA;				if((action1.Type==&quot;Action&quot;||action1.Type==&quot;Activity&quot;)&amp;&amp;action1.ParentID&gt;0) {&#xA;					action3=action1;&#xA;					action1=Repository.GetElementByID(action1.ParentID);//&#xA;					break;&#xA;				}&#xA;				else&#xA;					action1=null;&#xA;			}&#xA;		}&#xA;		if(action1!=null) {//ActivityPartition&#xA;			//Session.Output(&quot;setParameterValueLifeLine:action1=&quot;+action1.Name);&#xA;			for(var i=0;i&lt;action1.Connectors.Count;i++) { //ActivityPartition&#xA;				var connector1=action1.Connectors.GetAt(i);&#xA;				if(connector1.Type==&quot;Dependency&quot;&amp;&amp;connector1.Alias==&quot;RiviAvi&quot;) { //Action in R diagram&#xA;					action2=Repository.GetElementByID(connector1.ClientID);&#xA;					if(action2.Type==&quot;Action&quot;||action2.Type==&quot;Activity&quot;)&#xA;						break;&#xA;					else&#xA;						action2=null;&#xA;				}&#xA;			}	&#xA;		} &#xA;		if(action2!=null) { //ActivityPartition&#xA;			//Session.Output(&quot;setParameterValueLifeLine:action2=&quot;+action2.Name);&#xA;			class1=action2.Name;&#xA;			while(class1.substr(0,1)&gt;=&quot;0&quot;&amp;&amp;class1.substr(0,1)&lt;=&quot;9&quot;||class1.substr(0,1)==&quot;.&quot;||class1.substr(0,1)==&quot; &quot;)&#xA;				class1=class1.substr(1);&#xA;		} else if (action3!=null) { //Action, Activity&#xA;			for(var i=0;i&lt;action3.Connectors.Count;i++) { //Action, Activity&#xA;				var connector1=action3.Connectors.GetAt(i);&#xA;				if(connector1.Type==&quot;Dependency&quot;&amp;&amp;connector1.Alias.substr(0,7)==&quot;RiviAvi&quot;) { //Action in R diagram&#xA;					action2=Repository.GetElementByID(connector1.ClientID);&#xA;					if(action2.Type==&quot;Action&quot;||action2.Type==&quot;Activity&quot;)&#xA;						break;&#xA;					else&#xA;						action2=null;&#xA;				}&#xA;			}	&#xA;			if(action2!=null) { //Action, Activity&#xA;				//Session.Output(&quot;setParameterValueLifeLine:action2=&quot;+action2.Name);&#xA;				class1=action2.Name;&#xA;				while(class1.substr(0,1)&gt;=&quot;0&quot;&amp;&amp;class1.substr(0,1)&lt;=&quot;9&quot;||class1.substr(0,1)==&quot;.&quot;||class1.substr(0,1)==&quot; &quot;)&#xA;					class1=class1.substr(1);&#xA;			}&#xA;		}&#xA;	}&#xA;	nameElement1=name1+&quot;:&quot;+class1;&#xA;	if(nameElement1==null||nameElement1==&quot;&quot;||nameElement1==&quot; &quot;||class1==null) {&#xA;		name1=thePackage.Name;&#xA;		class1=(Repository.GetPackageByID(thePackage.ParentID)).Name;&#xA;		while(name1.substr(0,1)&gt;=&quot;0&quot;&amp;&amp;name1.substr(0,1)&lt;=&quot;9&quot;||name1.substr(0,1)==&quot;.&quot;||name1.substr(0,1)==&quot; &quot;)&#xA;			name1=name1.substr(1);&#xA;		while(class1.substr(0,1)&gt;=&quot;0&quot;&amp;&amp;class1.substr(0,1)&lt;=&quot;9&quot;||class1.substr(0,1)==&quot;.&quot;||class1.substr(0,1)==&quot; &quot;)&#xA;			class1=class1.substr(1);&#xA;		nameElement1=name1+&quot;:&quot;+class1;&#xA;	}&#xA;&#xA;	return nameElement1;&#xA;}&#xA;//Completing instance names in the parameter with their states&#xA;function getStateParameter(nameParameter, stateParameter) {&#xA;	var stateObject;&#xA;	var nameElement1=&quot;&quot;;&#xA;	&#xA;	if(stateParameter!=null&amp;&amp;stateParameter!=&quot;&quot;&amp;&amp;stateParameter!=&quot; &quot;) {&#xA;		if(nameParameter.substr(0,1)==&quot; &quot;)&#xA;			nameParameter=nameParameter.substr(1);&#xA;		if(stateParameter.substr(0,1)==&quot; &quot;)&#xA;			stateParameter=stateParameter.substr(1);			&#xA;		while(nameParameter.indexOf(&quot;,&quot;)&gt;=0) {&#xA;			if(nameParameter.indexOf(&quot;,&quot;)&gt;nameParameter.indexOf(&quot;:&quot;))&#xA;				nameElement1=nameElement1+nameParameter.substr(0,nameParameter.indexOf(&quot;:&quot;));&#xA;			else&#xA;				nameElement1=nameElement1+nameParameter.substr(0,nameParameter.indexOf(&quot;,&quot;));&#xA;			stateObject=stateParameter.substr(0,stateParameter.indexOf(&quot;,&quot;));&#xA;			if(stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;				nameElement1=nameElement1+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;			stateParameter=stateParameter.substr(stateParameter.indexOf(&quot;,&quot;)+1);&#xA;			if(nameParameter.indexOf(&quot;,&quot;)&gt;nameParameter.indexOf(&quot;:&quot;))&#xA;				nameElement1=nameElement1+nameParameter.substr(nameParameter.indexOf(&quot;:&quot;),nameParameter.indexOf(&quot;,&quot;)-nameParameter.indexOf(&quot;:&quot;)+1);&#xA;			else&#xA;				nameElement1=nameElement1+nameParameter.substr(nameParameter.indexOf(&quot;,&quot;),1);&#xA;			nameParameter=nameParameter.substr(nameParameter.indexOf(&quot;,&quot;)+1);&#xA;		}&#xA;		if(nameParameter!=&quot;&quot;&amp;&amp;nameParameter!=&quot; &quot;&amp;&amp;stateParameter!=&quot;&quot;)&#xA;			nameElement1=nameElement1+nameParameter.substr(0,nameParameter.indexOf(&quot;:&quot;))+&quot;[&quot;+stateParameter+&quot;]&quot;+nameParameter.substr(nameParameter.indexOf(&quot;:&quot;));&#xA;		else&#xA;			nameElement1=nameElement1+nameParameter;&#xA;	} else&#xA;		nameElement1=nameParameter;&#xA;	//maybe look up the status in the EA database?&#xA;	return nameElement1;&#xA;}&#xA;//Retrieving partition names and their aliases from 'xmlContent' based on name1 (Partition), name2 (alias) and name3 (element name)&#xA;function retrieveXMLNames(xmlContent, name1, name2, name3, mode) {&#xA;	var activityPartitions = [];&#xA;	var namePartition1=&quot;&quot;;&#xA;	var tmpAlias1;&#xA;	var namePartition = xmlContent;&#xA;	var start=namePartition.indexOf(name1); //&quot;ActivityPartition&quot;/&quot;classname&quot;-kind of element&#xA;	//Session.Output(&quot;retrieveXMLNames(0):&quot;+start+&quot;; name1=&quot;+name1+&quot;; name2=&quot;+name2+&quot;; name3=&quot;+name3+&quot;;mode=&quot;+mode);&#xA;	while(start&gt;0) {&#xA;		var start1=namePartition.indexOf(name2,start); //&quot;alias&quot;/&quot;stateflags&quot; - partition alias&#xA;		//Session.Output(&quot;retrieveXMLNames(1):&quot;+start1);&#xA;		if(start1&gt;0) {&#xA;			start1=namePartition.indexOf('&quot;',start1+name2.length+1);&#xA;			var ile=namePartition.indexOf('&quot;',start1+1);&#xA;			tmpAlias1=namePartition.substr(start1+1, ile-start1-1);&#xA;		}&#xA;		//Session.Output(&quot;retrieveXMLNames(2):&quot;+start1+&quot;;&quot;+tmpAlias1);&#xA;		if(mode==0)&#xA;			start1=namePartition.lastIndexOf(name3,start); //&quot;UML:ActionState name=&quot;-partition name&#xA;		else&#xA;			start1=namePartition.lastIndexOf(name3,start1); //&quot;keywords&quot;-partition name&#xA;		//Session.Output(&quot;retrieveXMLNames(3):&quot;+start1);&#xA;		if(start1&lt;0)&#xA;			break;&#xA;		var ile=namePartition.indexOf('&quot;',start1+name3.length+1); //the first &quot; before the name of partition&#xA;		//Session.Output(&quot;retrieveXMLNames(4):&quot;+ile);&#xA;		if(ile&gt;0) {&#xA;			namePartition1=namePartition.substr(start1+name3.length+1,ile-start1-name3.length-1);&#xA;			//var i = activityPartitions.length;&#xA;			if(mode!=1)&#xA;				activityPartitions.push([tmpAlias1, namePartition1]);&#xA;			else&#xA;				activityPartitions.push([namePartition1, tmpAlias1]);&#xA;			//activityPartitions[i/2-1][0]=tmpAlias1;&#xA;			//activityPartitions[i/2-1][1]=namePartition1;&#xA;			//Session.Output(&quot;retrieveXMLNames(5):&lt;&quot;+tmpAlias1+&quot;&gt;;&lt;&quot;+namePartition1+&quot;&gt;&quot;);&#xA;			namePartition1=&quot;&quot;;&#xA;		}&#xA;		namePartition = namePartition.substr(start+name3.length);&#xA;		start=namePartition.indexOf(name1);&#xA;		//Session.Output(&quot;retrieveXMLNames():&quot;+start);&#xA;	}&#xA;	return activityPartitions;&#xA;}&#xA;//Retrieving the value of 'elementName' from 'xmlContent'&#xA;function retrieveXMLElement(xmlContent,elementName) {&#xA;	var nameOfPckg=&quot;&quot;;&#xA;	var start=xmlContent.indexOf(elementName); //&quot;UML:Package name=&quot;&#xA;	&#xA;	if(start&gt;0) {&#xA;		nameOfPckg = xmlContent.substr(start+elementName.length,100);&#xA;		var ile=nameOfPckg.indexOf('&quot;',1); //&quot; xmi&quot;)-1;&#xA;		if(ile&gt;0)&#xA;			nameOfPckg=nameOfPckg.substr(1,ile-1);&#xA;		else &#xA;			nameOfPckg=&quot;&quot;;&#xA;	}&#xA;	return nameOfPckg;&#xA;}&#xA;//Creating a business process diagram based on the process decomposition diagram according to the 'correctCR' rule&#xA;function createRAcomplex(consistencyRule, correctCR, thePackage, parameters, connectors, mode) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var subChildPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var desiredDiagObjects = [ null,null]; //[null,null,null]&#xA;	var desiredPackElements = [ null,null]; //[null,null,null]&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var activityPartitions = [];&#xA;	var objectClasses = [];&#xA;	&#xA;	//RiviAvi,RiviAvivi&#xA;	conns = connectors;&#xA;	params = parameters;&#xA;	//if the first element is missing&#xA;	if(conns[0][1]==null||conns[0][1].Name==&quot;&quot;||conns[0][1].Name==&quot; &quot;)&#xA;		return;&#xA;	packages=getTargetPackage(thePackage,&quot;BURD&quot;, conns[0][1].Name,consistencyRule,conns);&#xA;	//if the target package and diagram are missing in it&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	//the Business Use Case Realization package&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	//Setting the names of the desired elements&#xA;	//The first element&#xA;	var nameOfElement1=&quot;&quot;;&#xA;	var nameOfElement2=&quot;&quot;;&#xA;	var nameOfElement3=&quot;&quot;;&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;R&quot;)+2,1)==&quot;v&quot;) {//RiviAvi&#xA;		nameOfElement1=&quot;Action&quot;;&#xA;		nameOfElement2=&quot;ObjectIn&quot;;&#xA;		nameOfElement3=&quot;ObjectOut&quot;;&#xA;	} else { //RvivAvi&#xA;		nameOfElement1=&quot;ObjectIn&quot;;&#xA;		nameOfElement2=&quot;Action&quot;;&#xA;		nameOfElement3=&quot;ObjectOut&quot;;&#xA;	}&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, connectors, 0, nameOfElement1, 2);&#xA;	nameElement2=setParameterValue(parameters, connectors, 1, nameOfElement2, 1); &#xA;	nameElement3=setParameterValue(parameters, connectors, 2, nameOfElement3, 0);&#xA;	//pattern-driven rule in nameElement1 - RiviAv({pattern})i&#xA;	if(nameElement1.substr(0,1)==&quot;{&quot; &amp;&amp; nameElement1.substr(nameElement1.length-1,1)==&quot;}&quot;) {&#xA;		var namePattern=nameElement1.substr(1); //Retrieve name pattern from the first parameter&#xA;		namePattern=namePattern.substr(0,namePattern.length-1);&#xA;		if(namePattern.substr(namePattern.length-15)!=&quot;BusinessProcess&quot;)&#xA;			namePattern+=&quot;BusinessProcess&quot;;&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;); // Fetch XML content from URL&#xA;		//Session.Output(&quot;createRacomplex(0):&quot;+namePattern);&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			var nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;); //Retrieve package name&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			activityPartitions=retrieveXMLNames(xmlContent, &quot;ActivityPartition&quot;, &quot;alias&quot;, &quot;UML:ActionState name=&quot;,0); //Retrieve partition names&#xA;			activityPartitions=activityPartitions.sort();&#xA;			objectClasses=retrieveXMLNames(xmlContent, &quot;classname&quot;, &quot;stateflags&quot;, 'keywords&quot; value=', 1); //Retrieve objectclass names - option B: &quot;keywords&quot;, &quot;UML:ClassifierRole name=&quot;, 0&#xA;			objectClasses=objectClasses.sort();&#xA;			var project = Repository.GetProjectInterface();&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1); //the imported package&#xA;			if(result==null) //something wrong with the imported package&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null) //something wrong with the imported package&#xA;				return;&#xA;			var moving=renamePatternObjects(consistencyRule, correctCR, nameElement2, conns[0][1], objectClasses, activityPartitions, subPackage, subChildPackage); //Rename partitions according to the values &#8203;&#8203;given in the partition rule parameter&#xA;			if(subChildPackage !=null&amp;&amp;moving) //moving partitions from the changed pattern to the current package&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			else&#xA;				changePatternPackage(consistencyRule, nameElement1, conns[0][0], objectClasses, activityPartitions, subPackage); //change the name of partitions&#xA;			if(testDiagram.DiagramObjects.Count==0) {&#xA;				var nameOfDiagram = testDiagram.Name;&#xA;				for(var i=0;i&lt;subPackage.Diagrams.Count;i++) {&#xA;					if((subPackage.Diagrams.GetAt(i)).Name==nameOfDiagram) {&#xA;						subPackage.Diagrams.Delete(i);&#xA;						break;&#xA;					}&#xA;				}&#xA;				subPackage.Diagrams.Refresh();&#xA;				testDiagram=subPackage.Diagrams.GetAt(0);&#xA;				testDiagram.Name=nameOfDiagram;&#xA;				testDiagram.Update();&#xA;			}&#xA;			return;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML from URL: &quot; + xhr.statusText);&#xA;		}&#xA;	}&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;	&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;		diagramObject3=desiredDiagObjects[2];	&#xA;	} &#xA;	&#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;	} &#xA;	var delement1new=false;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+1,1)==&quot;v&quot;) { //RevBau, ReviBaua, RviBau,RiviAvi&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Action&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;BURD&quot;,&quot;Action&quot;,nameElement1))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				delement1new=true;&#xA;				if(correctCR.substr(0,2)==&quot;Rv&quot;)&#xA;					setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;				else&#xA;					setCRDependency(consistencyRule,correctCR,conns[0][1],testElement);&#xA;			} &#xA;			delement1=testElement;&#xA;		} //else it means that this element is outside of current package&#xA;	} &#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;i&quot;) { //RevBau, ReviBaua, RviBau&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement2;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(nameOfObject.indexOf(&quot;[&quot;)&lt;nameOfObject.indexOf(&quot;]&quot;)) {&#xA;					nameOfState=nameOfObject.substr(nameOfObject.indexOf(&quot;[&quot;)+1,nameOfObject.indexOf(&quot;]&quot;)-nameOfObject.indexOf(&quot;[&quot;)-1);&#xA;					var nameOfObject1=nameOfObject.substr(0,nameOfObject.indexOf(&quot;[&quot;))+nameOfObject.substr(nameOfObject.indexOf(&quot;]&quot;)+1);&#xA;					nameOfObject=nameOfObject1;&#xA;				}&#xA;				if(params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;) {&#xA;					if(params[3][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][1].substr(0,params[3][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][1];&#xA;				} else&#xA;				if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][0].substr(0,params[2][0].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][0];&#xA;				} else &#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(conns[0][0]!=null) {&#xA;					var stateObject=getStatesOfObject(conns[0][0]);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				} else&#xA;				if(conns[0][2]!=null) {&#xA;					var stateObject=getStatesOfObject(conns[0][0]);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				}&#xA;				if(nameOfObject==&quot;Start&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype==100;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				if((tagValue=getTagValueforElement(&quot;BURD&quot;,&quot;Object&quot;,nameOfObject+&quot;[&quot;+nameOfState+&quot;]&quot;+&quot;:&quot;+nameOfClass))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				if(nameOfState!=null&amp;&amp;nameOfObject!=&quot;Start&quot;) {&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);					&#xA;				}&#xA;				if(testElement.ClassfierID&gt;0&amp;&amp;conns[0][0]!=null&amp;&amp;conns[0][0].ClassifierID&gt;0&amp;&amp;testElement.ClassfierID==conns[0][0].ClassifierID)&#xA;					setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;				else&#xA;				if(testElement.ClassfierID&gt;0&amp;&amp;conns[0][2]!=null&amp;&amp;conns[0][2].ClassifierID&gt;0&amp;&amp;testElement.ClassfierID==conns[0][2].ClassifierID)&#xA;					setCRDependency(consistencyRule,correctCR,conns[0][2],testElement);&#xA;				else&#xA;					setCRDependency(consistencyRule,correctCR,conns[0][1],testElement);&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	} else {&#xA;		var connector1 as EA.Connector;&#xA;		var isThere=false;&#xA;		for(var i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;			connector1=delement2.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Dependency&quot;&amp;&amp;connector1.Name==consistencyRule) { //can be an Actor?&#xA;				isThere=true;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(!isThere)&#xA;			setCRDependency(consistencyRule,correctCR,(conns[0][1]==null)?((conns[0][0]=null)?conns[0][2]:conns[0][0]):conns[0][1],delement2);&#xA;	}&#xA;	var delement3new=false;&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;i&quot;) { //RevBau, ReviBaua, RviBau&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement3;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(nameOfObject.indexOf(&quot;[&quot;)&lt;nameOfObject.indexOf(&quot;]&quot;)) {&#xA;					nameOfState=nameOfObject.substr(nameOfObject.indexOf(&quot;[&quot;)+1,nameOfObject.indexOf(&quot;]&quot;)-nameOfObject.indexOf(&quot;[&quot;)-1);&#xA;					var nameOfObject1=nameOfObject.substr(0,nameOfObject.indexOf(&quot;[&quot;))+nameOfObject.substr(nameOfObject.indexOf(&quot;]&quot;)+1);&#xA;					nameOfObject=nameOfObject1;&#xA;				} else&#xA;				if(params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;) {&#xA;					if(params[3][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][2].substr(0,params[3][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][2];&#xA;				} else&#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(params[2][1]!=null&amp;&amp;params[2][1]!=&quot;&quot;&amp;&amp;params[2][1]!=&quot; &quot;) {&#xA;					if(params[2][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][1].substr(0,params[2][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][1];&#xA;				} else &#xA;				if(conns[0][2]!=null) {&#xA;					var stateObject=getStatesOfObject(conns[0][2]);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				} else&#xA;				if(conns[0][0]!=null) {&#xA;					var stateObject=getStatesOfObject(conns[0][2]);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				}&#xA;				if(nameOfObject==&quot;End&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype=101;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null&amp;&amp;!delement1new)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				if((tagValue=getTagValueforElement(&quot;BURD&quot;,&quot;Object&quot;,nameOfObject+&quot;[&quot;+nameOfState+&quot;]&quot;+&quot;:&quot;+nameOfClass))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				if(nameOfState!=null) {&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);					&#xA;				}&#xA;				delement3new=true;&#xA;				if(testElement.ClassfierID&gt;0&amp;&amp;conns[0][2]!=null&amp;&amp;conns[0][2].ClassifierID&gt;0&amp;&amp;testElement.ClassfierID==conns[0][2].ClassifierID)&#xA;					setCRDependency(consistencyRule,correctCR,conns[0][2],testElement);&#xA;				else&#xA;				if(testElement.ClassfierID&gt;0&amp;&amp;conns[0][0]!=null&amp;&amp;conns[0][0].ClassifierID&gt;0&amp;&amp;testElement.ClassfierID==conns[0][0].ClassifierID)&#xA;					setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;				else&#xA;					setCRDependency(consistencyRule,correctCR,conns[0][1],testElement);&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} &#xA;	} else {&#xA;		var connector1 as EA.Connector;&#xA;		var isThere=false;&#xA;		for(var i=0;i&lt;delement3.Connectors.Count;i++) {&#xA;			connector1=delement3.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Dependency&quot;&amp;&amp;connector1.Name==consistencyRule) { //can be an Actor?&#xA;				isThere=true;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(!isThere)&#xA;			setCRDependency(consistencyRule,correctCR,(conns[0][2]==null)?((conns[0][1]=null)?conns[0][0]:conns[0][1]):conns[0][2],delement3);&#xA;	}&#xA;&#xA;	//a connection must be created between the input element and the middle element&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+1,1)==&quot;v&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;i&quot;) { //RiviAvi&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i); //a nie delement2?&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement2.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement2.Name==&quot;Start&quot;)&#xA;					connector = delement2.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement2.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement1.ElementID;&#xA;				connector.Update();&#xA;				delement2.Update();	&#xA;			}	&#xA;			//a connection must be created between the element to which the input element is connected at the output and the middle element&#xA;			var tmpObject as EA.Element;&#xA;			tmpObject=null;&#xA;			for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;				var connector1=delement2.Connectors.GetAt(i);&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement2.ElementID&amp;&amp;connector1.ClientID!=delement1.ElementID) {&#xA;					tmpObject=Repository.GetElementByID(connector1.ClientID);&#xA;					if(tmpObject.Type==&quot;Action&quot; ||tmpObject.Type==&quot;Activity&quot;)					&#xA;						break; //The input object is connected as an output object to another action&#xA;					else&#xA;						tmpObject=null;&#xA;				}&#xA;			}&#xA;			if(tmpObject!=null) {&#xA;				//you need to check if this connection already exists&#xA;				for(i=0;i&lt;tmpObject.Connectors.Count;i++) {&#xA;					var connector1=tmpObject.Connectors.GetAt(i);&#xA;					if(connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==tmpObject.ElementID) {&#xA;						tmpObject=null;&#xA;						break;&#xA;					}&#xA;				}&#xA;				if(tmpObject!=null) {&#xA;					connector = tmpObject.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;					connector.SupplierID = delement1.ElementID;&#xA;					connector.Update();&#xA;					tmpObject.Update();		&#xA;				}					&#xA;			}&#xA;		}&#xA;	}&#xA;	//a connection must be created between the middle element and the output element&#xA;	if(delement1!=null&amp;&amp;delement3!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;A&quot;)+1,1)==&quot;v&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;A&quot;)+2,1)==&quot;i&quot;) { //RiviAvi&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i);&#xA;				if(delement3.Name!=&quot;End&quot;&amp;&amp;connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID||&#xA;				   delement3.Name==&quot;End&quot;&amp;&amp;connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement3.Name==&quot;End&quot;)&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement3.ElementID;&#xA;				connector.Update();&#xA;				delement1.Update();	&#xA;				delement1.Connectors.Refresh();&#xA;				delement3.Connectors.Refresh();&#xA;			}	&#xA;		}&#xA;	}&#xA;	//Add elements to the diagram&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null) {&#xA;			var left=100;&#xA;			var top=-100;&#xA;			var ifPartition=false;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			if(delement3new==false&amp;&amp;delement1new==true&amp;&amp;delement3.ParentID&gt;0) {&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID==delement3.ParentID) {&#xA;						left=existDiagramObject.left+75; //25; //right=left+100&#xA;						top=existDiagramObject.top-(existDiagramObject.top-existDiagramObject.bottom)/2+23; //bottom=top-45&#xA;						ifPartition=true;&#xA;						break;&#xA;					}&#xA;				}					&#xA;			} 	&#xA;			if(!ifPartition) //true-delement3 was in the partition&#xA;				delement1new=true;&#xA;			if(delement1new) { //new element&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null) {&#xA;						if(existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;						//if(existDiagramObject.Type!=&quot;ActivityPartition&quot;)&#xA;						//	if(existDiagramObject.right&gt;left)&#xA;						//		left=existDiagramObject.right+50;&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			if(ifPartition&amp;&amp;diagramObject3!=null) {//delement3 was here in the Partition&#xA;				testDiagramObject.left=diagramObject3.left-100;//left;&#xA;				testDiagramObject.right=diagramObject3.left-20; //left+80;&#xA;				testDiagramObject.top=diagramObject3.top; //top;&#xA;				testDiagramObject.bottom=diagramObject3.bottom; //top-40;&#xA;				delement1.ParentID=delement3.ParentID;		&#xA;				delement1.Update();&#xA;			} else {&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+80;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-40;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;			&#xA;		}  else {&#xA;			Session.Output(&quot;Error at identifying element1-4983 line&quot;);&#xA;			return;&#xA;		}		&#xA;	} &#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null) {&#xA;			var left=diagramObject1.left;&#xA;			var top=diagramObject1.top;&#xA;			/*if(delement2.ParentID&gt;0) { //if the partition exist&#xA;				var partycjaTmp=Repository.GetElementByID(delement2.ParentID);&#xA;				for ( var i = 0, j=0 ; i &lt; diagramObjects.Count ; i++ )&#xA;				{&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==partycjaTmp.ElementID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}*/&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			//At this point you should check other elements in the ActivityPartition&#xA;			if(delement2.Name==&quot;Start&quot;) { //InitialNode - at the beginning&#xA;				testDiagramObject.left=left-70;&#xA;				testDiagramObject.right=left-40;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-34;&#xA;			} else { //in the middle			&#xA;				testDiagramObject.left=left-90;&#xA;				testDiagramObject.right=left-20;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-37;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	} /*else {&#xA;		var left=diagramObject1.left;&#xA;		var top=diagramObject1.top;&#xA;&#xA;		if(delement2.Name==&quot;Start&quot;) { //InitialNode&#xA;			diagramObject2.left=left-70;&#xA;			diagramObject2.right=left-40;&#xA;			//diagramObject2.left=left+125;&#xA;			//diagramObject2.right=left+195;&#xA;			diagramObject2.top=top-3;&#xA;			diagramObject2.bottom=top-34;&#xA;			diagramObject2.Update();		&#xA;		}			&#xA;	}*/&#xA;	if(diagramObject3==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null) {&#xA;			var left=diagramObject1.left;&#xA;			var top=diagramObject1.top;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			if(delement3.ParentID&gt;0) {&#xA;				var partycjaTmp=Repository.GetElementByID(delement3.ParentID);&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;				{&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==partycjaTmp.ElementID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			if(delement3.Name==&quot;End&quot;) { //at the end&#xA;				testDiagramObject.left=left+145;&#xA;				testDiagramObject.right=left+175;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-33;&#xA;			} else {&#xA;				testDiagramObject.left=left+125;&#xA;				testDiagramObject.right=left+195;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-37;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	} else {&#xA;		var left=diagramObject1.left;&#xA;		var top=diagramObject1.top;&#xA;		if(delement3.ParentID&gt;0) {&#xA;			diagramObject=null;&#xA;			var partycjaTmp=Repository.GetElementByID(delement3.ParentID);&#xA;			for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;			{&#xA;				var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;				if(partycjaObjTmp.ElementID==partycjaTmp.ElementID) {&#xA;					diagramObject=partycjaObjTmp;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(diagramObject!=null) {&#xA;				if(diagramObject3.left&lt;diagramObject.left||diagramObject3.right&gt;diagramObject.right||diagramObject3.top&lt;diagramObject.top||diagramObject3.bottom&lt;diagramObject.bottom) {&#xA;					if(delement3.Name==&quot;End&quot;) {&#xA;						diagramObject3.left=left+145;&#xA;						diagramObject3.right=left+175;&#xA;						diagramObject3.top=top-3;&#xA;						diagramObject3.bottom=top-33;&#xA;					} else {&#xA;						diagramObject3.left=left+125;&#xA;						diagramObject3.right=left+195;&#xA;						diagramObject3.top=top;&#xA;						diagramObject3.bottom=top-37;&#xA;					}&#xA;					diagramObject3.Update();					&#xA;				}&#xA;			}&#xA;		} else {&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				diagramObject3.left=left+145;&#xA;				diagramObject3.right=left+175;&#xA;				diagramObject3.top=top-3;&#xA;				diagramObject3.bottom=top-33;&#xA;			} else {&#xA;				diagramObject3.left=left+125;&#xA;				diagramObject3.right=left+195;&#xA;				diagramObject3.top=top;&#xA;				diagramObject3.bottom=top-37;&#xA;			}&#xA;			diagramObject3.Update();				&#xA;		}&#xA;	}&#xA;	if(diagramObject3!=null&amp;&amp;mode==1) {&#xA;		diagramObjects.Refresh();&#xA;		if(delement1.ParentID&gt;0) {&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			existDiagramObject=null;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID==delement1.ParentID) &#xA;					break;&#xA;			}&#xA;			if(existDiagramObject!=null)&#xA;				placingElementOfAction(delement1, diagramObjects, existDiagramObject, diagramObject1, 0);&#xA;			else&#xA;				placingElementOfAction(delement1, diagramObjects, null, diagramObject1, 2);&#xA;		}&#xA;		else&#xA;			placingElementOfAction(delement1, diagramObjects, null, diagramObject1, 2);&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from business process diagram to system use cases diagram&#xA;function createAUcomplex(consistencyRule, correctCR, thePackage, parameters, connectors1,mode) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	//ApUau&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;SUCD&quot;,thePackage.Name,consistencyRule,conns);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Actor&quot;;&#xA;	nameOfElement2=&quot;UseCase&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, null);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, null);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;	} &#xA;	var delement1new=false;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;U&quot;)+1,1)==&quot;a&quot;) { //ApUau&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Actor&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;SUCD&quot;,&quot;Actor&quot;,nameElement1))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;U&quot;)+2,1)==&quot;u&quot;) { //ApUau&#xA;				var nameOfUC = nameElement2; &#xA;				testElement = subPackage.Elements.AddNew( nameOfUC, &quot;Use Case&quot; );&#xA;				if((tagValue=getTagValueforElement(&quot;SUCD&quot;,&quot;Use Case&quot;,nameOfUC))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				if(conns[0][mode+1]!=null)&#xA;					setCRDependency(consistencyRule,correctCR,conns[0][mode+1],testElement);&#xA;				else&#xA;					setCRDependency(consistencyRule,correctCR,conns[0][1],testElement);&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Association&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID||&#xA;				 connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement2.ElementID)) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	var newObj3=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Actor&quot;) {&#xA;			var left=50;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Actor&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		} else &#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;UseCase&quot;) {&#xA;			var left=50;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;UseCase&quot;) {&#xA;			var left=150;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;UseCase&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;		&#xA;			if(diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Create target elements in composite consistency rule from business process diagram to business class diagram&#xA;function createACcomplex(consistencyRule, correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;CLASSD&quot;,thePackage.Name,consistencyRule,conns);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Class&quot;;&#xA;	nameOfElement2=&quot;1,*&quot;;&#xA;	nameOfElement3=&quot;Class&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	if(nameElement1.substr(0,1)==&quot;:&quot;)&#xA;		nameElement1=nameElement1.substr(1);&#xA;	nameElement2=nameOfElement2;//setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	if(params[1][1]!=null&amp;&amp;params[1][1]!=&quot;&quot;&amp;&amp;params[1][1]!=&quot; &quot;)&#xA;		nameElement2=params[1][1];&#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0);&#xA;	if(nameElement3.substr(0,1)==&quot;:&quot;)&#xA;		nameElement3=nameElement3.substr(1);&#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;		diagramObject3=desiredDiagObjects[1];	&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;	} &#xA;	var delement1new=false;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements,	what about this element when it exists in another package&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		var className=nameElement1;&#xA;		if(className.indexOf(&quot;:&quot;)&gt;-1)&#xA;			className=className.substr(className.indexOf(&quot;:&quot;)+1);&#xA;		if(className.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;className.indexOf(&quot;]&quot;)&gt;className.indexOf(&quot;[&quot;))&#xA;			className=className.substr(0,className.indexOf(&quot;[&quot;))+className.substr(className.indexOf(&quot;]&quot;)+1);&#xA;		delement1=searchForElement(subPackage, className, &quot;Class&quot;); &#xA;		if(delement1==null&amp;&amp;diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;C&quot;)+1,1)==&quot;c&quot;) { //AiviCczc&#xA;				testElement = subPackage.Elements.AddNew( className, &quot;Class&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;CLASSD&quot;,&quot;Class&quot;,className))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				setCRDependency(consistencyRule,correctCR,(conns[0][0]==null)?conns[0][1]:conns[0][0],testElement);&#xA;			} &#xA;			delement1=testElement;&#xA;		} else {&#xA;			var connector1 as EA.Connector;&#xA;			var isThere=false;&#xA;			for(var i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				connector1=delement1.Connectors.GetAt(i);&#xA;				if(connector1.Type==&quot;Dependency&quot;&amp;&amp;connector1.Name==consistencyRule) { &#xA;					isThere=true;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(!isThere)&#xA;				setCRDependency(consistencyRule,correctCR,(conns[0][0]==null)?((conns[0][1]=null)?conns[0][2]:conns[0][1]):conns[0][0],delement1);&#xA;		}&#xA;	} else {&#xA;		var connector1 as EA.Connector;&#xA;		var isThere=false;&#xA;		for(var i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Dependency&quot;&amp;&amp;connector1.Name==consistencyRule) { &#xA;				isThere=true;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(!isThere)&#xA;			setCRDependency(consistencyRule,correctCR,(conns[0][0]==null)?((conns[0][1]=null)?conns[0][2]:conns[0][1]):conns[0][0],delement1);&#xA;	}&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		var className=nameElement3;&#xA;		if(className.indexOf(&quot;:&quot;)&gt;-1)&#xA;			className=className.substr(className.indexOf(&quot;:&quot;)+1);&#xA;		if(className.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;className.indexOf(&quot;]&quot;)&gt;className.indexOf(&quot;[&quot;))&#xA;			className=className.substr(0,className.indexOf(&quot;[&quot;))+className.substr(className.indexOf(&quot;]&quot;)+1);&#xA;		delement3=searchForElement(subPackage, className, &quot;Class&quot;); &#xA;		if(delement3==null&amp;&amp;diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;C&quot;)+3,1)==&quot;c&quot;) { //AiviCczc&#xA;				testElement = subPackage.Elements.AddNew( className, &quot;Class&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;CLASSD&quot;,&quot;Class&quot;,className))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject3=null; //diagramObject3 is not already a previously created element&#xA;				setCRDependency(consistencyRule,correctCR,(conns[0][2]==null)?((conns[0][0]==null)?conns[0][1]:conns[0][0]):conns[0][2],testElement);&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} else {&#xA;			var connector1 as EA.Connector;&#xA;			var isThere=false;&#xA;			for(var i=0;i&lt;delement3.Connectors.Count;i++) {&#xA;				connector1=delement3.Connectors.GetAt(i);&#xA;				if(connector1.Type==&quot;Dependency&quot;&amp;&amp;connector1.Name==consistencyRule) { &#xA;					isThere=true;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(!isThere)&#xA;				setCRDependency(consistencyRule,correctCR,(conns[0][2]==null)?((conns[0][0]=null)?conns[0][1]:conns[0][0]):conns[0][2],delement3);&#xA;		}&#xA;	} else {&#xA;		var connector1 as EA.Connector;&#xA;		var isThere=false;&#xA;		for(var i=0;i&lt;delement3.Connectors.Count;i++) {&#xA;			connector1=delement3.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Dependency&quot;&amp;&amp;connector1.Name==consistencyRule) { &#xA;				isThere=true;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(!isThere)&#xA;			setCRDependency(consistencyRule,correctCR,(conns[0][2]==null)?((conns[0][0]=null)?conns[0][1]:conns[0][0]):conns[0][2],delement3);&#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null&amp;&amp;delement3!=null&amp;&amp;delement1!=delement3) {&#xA;		var connector as EA.Connector.ClientEnd.Cardinality;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			var connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;Association&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID||&#xA;				 connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID)) {&#xA;				if(nameElement2.indexOf(&quot;,&quot;)&gt;-1) {&#xA;					if(connector1.ClientEnd.Cardinality==nameElement2.substr(0,nameElement2.indexOf(&quot;,&quot;))&amp;&amp;&#xA;						connector1.SupplierEnd.Cardinality==nameElement2.substr(nameElement2.indexOf(&quot;,&quot;)+1)) {&#xA;						connector=connector1;&#xA;						break;&#xA;					}&#xA;				} else {&#xA;					if(connector1.ClientEnd.Cardinality==&quot;1&quot;&amp;&amp;connector1.SupplierEnd.Cardinality==nameElement2) {&#xA;						connector=connector1;&#xA;						break;&#xA;					}&#xA;				}&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;Association&quot;);&#xA;			connector.SupplierID = delement3.ElementID;&#xA;			if(nameElement2.indexOf(&quot;,&quot;)&gt;-1) {&#xA;				//Session.Output(&quot;createACcomplex(1):&lt;&quot;+nameElement2+&quot;&gt;&quot;);&#xA;				connector.ClientEnd.Cardinality=nameElement2.substr(0,nameElement2.indexOf(&quot;,&quot;));&#xA;				connector.SupplierEnd.Cardinality=nameElement2.substr(nameElement2.indexOf(&quot;,&quot;)+1);&#xA;				//Session.Output(&quot;createACcomplex(2):&lt;&quot;+connector.ClientEnd.Cardinality+&quot;-&quot;+connector.SupplierEnd.Cardinality+&quot;&gt;&quot;);&#xA;			} else {&#xA;				//Session.Output(&quot;createACcomplex(3):&lt;&quot;+nameElement2+&quot;&gt;&quot;);&#xA;				connector.ClientEnd.Cardinality=&quot;1&quot;;&#xA;				connector.SupplierEnd.Cardinality=nameElement2;&#xA;				//Session.Output(&quot;createACcomplex(4):&lt;&quot;+connector.ClientEnd.Cardinality+&quot;-&quot;+connector.SupplierEnd.Cardinality+&quot;&gt;&quot;);&#xA;			}&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Class&quot;) {&#xA;			var left=50;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Class&quot;||existElementObject.Type==&quot;Object&quot;||existElementObject.Type==&quot;DataType&quot;||existElementObject.Type==&quot;Enumeration&quot;||existElementObject.Type==&quot;PrimitiveType&quot;)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		} &#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Class&quot;) {&#xA;			var left=150;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Class&quot;||existElementObject.Type==&quot;Object&quot;||existElementObject.Type==&quot;DataType&quot;||existElementObject.Type==&quot;Enumeration&quot;||existElementObject.Type==&quot;PrimitiveType&quot;)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;		&#xA;			if(diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			if(diagramObject1.right&gt;left)&#xA;				left=diagramObject1.right+100;&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+150;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Multiple calls to createAScomplex depending on multi-value parameters&#xA;function createAScomplexSrst(consistencyRule, correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=connectors[0].length; //how many use cases are there in the rule&#xA;&#xA;	parameter1[1][0]=(Repository.GetElementByID(connectors[0][0].ClassifierID)).Name;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		if(n==0) {&#xA;			parameter1[1][1]=&quot;Initial&quot;;&#xA;			parameter1[1][2]=connectors[1][0];&#xA;			if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;				parameter1[1][2]=&quot;1. State&quot;;&#xA;			createAScomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,0);&#xA;		}&#xA;		parameter1[1][1]=connectors[1][n];&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. State&quot;;	&#xA;		if(n+1&gt;iteration)&#xA;			parameter1[1][2]=&quot;Final&quot;;&#xA;		else {&#xA;			parameter1[1][2]=connectors[1][n+1];&#xA;			if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;				parameter1[1][2]=(n+2)+&quot;. State&quot;;&#xA;		}&#xA;		createAScomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;	if(iteration&gt;0) {&#xA;		parameter1[1][1]=connectors[1][n];&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. State&quot;;	&#xA;		parameter1[1][2]=&quot;Final&quot;;&#xA;		createAScomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,0);&#xA;	}&#xA;}&#xA;//Create target elements in composite consistency rule from business process diagram to business state machine diagram&#xA;function createAScomplex(consistencyRule, correctCR, thePackage, parameters, connectors1,mode) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	//AivSrst&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;&#xA;	if(conns[0]!=null&amp;&amp;conns[0][0]!=null)&#xA;		region = Repository.GetElementByID(conns[0][0].ClassifierID);&#xA;	var region1 as EA.Element;&#xA;	if(conns[0]!=null&amp;&amp;conns[0][1]!=null)&#xA;		region1 = Repository.GetElementByID(conns[0][1].ClassifierID);&#xA;	var region2 as EA.Element;&#xA;	if(conns[0]!=null&amp;&amp;conns[0][2]!=null)&#xA;		region2 = Repository.GetElementByID(conns[0][2].ClassifierID);&#xA;	/*if(conns[0]!=null&amp;&amp;conns[0][0]!=null)&#xA;		Session.Output(&quot;conns[0][0]:&quot;+conns[0][0].Name+&quot;:&quot;+region.Name+&quot;;&quot;+conns[0][0].ElementID);&#xA;	else&#xA;		Session.Output(&quot;conns[0][0]:&quot;+conns[0][0]);&#xA;	if(conns[0]!=null&amp;&amp;conns[0][1]!=null)&#xA;		Session.Output(&quot;conns[0][1]:&quot;+conns[0][1].Name+&quot;:&quot;+region1.Name+&quot;;&quot;+conns[0][1].ElementID);&#xA;	else&#xA;		Session.Output(&quot;conns[0][1]:&quot;+conns[0][1]);&#xA;	if(conns[0]!=null&amp;&amp;conns[0][2]!=null)&#xA;		Session.Output(&quot;conns[0][2]:&quot;+conns[0][2].Name+&quot;:&quot;+region2.Name+&quot;;&quot;+conns[0][2].ElementID);&#xA;	else&#xA;		Session.Output(&quot;conns[0][2]:&quot;+conns[0][2]);*/&#xA;&#xA;	if(region==null)&#xA;		return;&#xA;	packages=getTargetPackage(thePackage,&quot;BSTMD&quot;,region.Name,consistencyRule,conns);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Region&quot;;&#xA;	nameOfElement2=&quot;State&quot;;&#xA;	nameOfElement3=&quot;State&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0); &#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;		diagramObject3=desiredDiagObjects[2];&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;	} &#xA;	var delement2new=false;&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;S&quot;)+2,1)==&quot;s&quot;) { //AivSrst&#xA;				if(nameElement2==&quot;Initial&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;StateNode&quot; );&#xA;					testElement.Subtype=3; //Initial&#xA;				}&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;State&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;BSTMD&quot;,&quot;State&quot;,nameElement2))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject2=null; //diagramObject1 is not already a previously created element&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;			} &#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;S&quot;)+2,1)==&quot;s&quot;) { //AivSrst&#xA;				var nameOfState = nameElement3; &#xA;				if(nameOfState==&quot;Final&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfState, &quot;StateNode&quot; );&#xA;					testElement.Subtype=4;&#xA;				}&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfState, &quot;State&quot; );&#xA;				if((tagValue=getTagValueforElement(&quot;BSTMD&quot;,&quot;State&quot;,nameOfState))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} &#xA;	}	&#xA;	//a connection must be created between the elements&#xA;	if(delement3!=null&amp;&amp;delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;			var connector1=delement2.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;StateFlow&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement2.ElementID&amp;&amp;connector1.SupplierID==delement3.ElementID)) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement2.Connectors.AddNew(&quot;&quot;, &quot;StateFlow&quot;);&#xA;			connector.SupplierID = delement3.ElementID;&#xA;			connector.Update();&#xA;			delement3.Update();	&#xA;			delement2.Update();&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;State&quot;||delement2.Type==&quot;StateNode&quot;)) {&#xA;			var left=70;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;State&quot;||existElementObject.Type==&quot;StateNode&quot;)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2.Type==&quot;StateNode&quot;) {&#xA;				testDiagramObject.left=left+25;&#xA;				testDiagramObject.right=left+55;&#xA;			}&#xA;			else {&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+80;&#xA;			}&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-30;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			diagramObjects.Refresh();&#xA;		}&#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;(delement3.Type==&quot;State&quot;||delement3.Type==&quot;StateNode&quot;)) {&#xA;			var left=70;&#xA;			var top=-100;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;State&quot;||existElementObject.Type==&quot;StateNode&quot;)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			if(delement3.Type==&quot;StateNode&quot;) {&#xA;				testDiagramObject.left=left+25;&#xA;				testDiagramObject.right=left+55;&#xA;			}&#xA;			else {&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+80;&#xA;			}&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-30;&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;			diagramObjects.Refresh();&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Multiple calls to createZYcomplex depending on multi-value parameters&#xA;function createZYcomplexYu(consistencyRule, correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=connectors[0].length-1; //how many use cases are there in the rule&#xA;&#xA;	connectors[2][0]=null;&#xA;	if(connectors[0][0]!=null&amp;&amp;connectors[0][0].Type==&quot;ActivityPartition&quot;) {&#xA;		for( var n=0; n&lt;connectors[0][0].Connectors.Count; n++) {&#xA;			var connector=connectors[0][0].Connectors.GetAt(n);&#xA;			if(connector.Type==&quot;Dependency&quot;&amp;&amp;connector.Name==&quot;UauZpv&quot;) { //can be an Actor?&#xA;				//Session.Output(&quot;createZYcomplexYu: connector.ClientID=&quot;+connector.ClientID);&#xA;				connectors[2][0]=Repository.GetElementByID(connector.ClientID);&#xA;				break;&#xA;			}&#xA;		}&#xA;	}&#xA;	parameter1[1][0]=connectors[0][0].Name;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][1]=connectors[0][n+1].Name;&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. Use Case&quot;;&#xA;		createZYcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from system use case realization diagram to internal use case diagram&#xA;function createZYcomplex(consistencyRule, correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var theParentPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	//ZpvYu&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	theParentPackage=Repository.GetPackageByID(thePackage.ParentID);&#xA;	packages=getTargetPackage(thePackage,&quot;IUCD&quot;,theParentPackage.Name,consistencyRule,conns);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for IUCD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Use Case&quot;;&#xA;	nameOfElement2=&quot;Use Case&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	if(conns[2][0]!=null)&#xA;		nameElement1=setParameterValue(parameters, conns, 0, conns[2][0].Name, 0);&#xA;	else&#xA;		nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, null);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;	} &#xA;	if(conns[2][0]!=null)&#xA;		delement1=conns[2][0];&#xA;	&#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, null);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;	} &#xA;	var delement1new=false;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Y&quot;)+1,1)==&quot;u&quot;) { //ZpvYu&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Use Case&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;IUCD&quot;,&quot;Use Case&quot;,nameElement1))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Y&quot;)+1,1)==&quot;u&quot;) { //ZpvYu&#xA;				var nameOfUC = nameElement2; &#xA;				testElement = subPackage.Elements.AddNew( nameOfUC, &quot;Use Case&quot; );&#xA;				if((tagValue=getTagValueforElement(&quot;IUCD&quot;,&quot;Use Case&quot;,nameOfUC))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the elements&#xA;	if(delement1!=null &amp;&amp; delement2!=null) {&#xA;		var connector as EA.Connector;&#xA;		connector=null;&#xA;		//if(delement1!=null)&#xA;		//	Session.Output(&quot;createZYcomplex: delement1=&quot;+delement1.Name+&quot;; delement1.Type=&quot;+delement1.Type+&quot;(&quot;+delement1.ElementID+&quot;,&quot;+delement1.ConnectorID+&quot;); type=&quot;+delement1.ObjectType);&#xA;		//else&#xA;		//	Session.Output(&quot;createZYcomplex: delement1=null&quot;);&#xA;		for(var i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			var connector1=delement1.Connectors.GetAt(i);&#xA;			if(connector1.Type==&quot;UseCase&quot;&amp;&amp;connector1.Subtype==&quot;Includes&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;&#xA;				(connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID||&#xA;				 connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement2.ElementID)) {&#xA;				connector=connector1;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(connector==null) {&#xA;			connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;UseCase&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Subtype=&quot;Includes&quot;;&#xA;			connector.Stereotype=&quot;include&quot;;&#xA;			connector.Update();&#xA;			delement1.Update();	&#xA;		}			&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var newObj1=false;&#xA;	var newObj2=false;&#xA;	var newObj3=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;UseCase&quot;) {&#xA;			var left=30;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;(existElementObject.Type==&quot;Event&quot;&amp;&amp;existDiagramObject.left&lt;left+200||existElementObject.Type==&quot;Object&quot;&amp;&amp;existDiagramObject.left&lt;left+200)) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			newObj1=true;&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null&amp;&amp;delement2.Type==&quot;UseCase&quot;) {&#xA;			var left=150;&#xA;			var top=-30;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;UseCase&quot;) {&#xA;					if(existDiagramObject.bottom&lt;top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;		&#xA;			if(diagramObject1!=null&amp;&amp;diagramObject1.top &lt; top) &#xA;					top=diagramObject1.top;&#xA;			if(newObj1&amp;&amp;diagramObject1!=null&amp;&amp;diagramObject1.top &gt; top) {&#xA;				diagramObject1.top=top;&#xA;				diagramObject1.bottom=top-50;&#xA;				diagramObject1.Update();&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+50;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;			newObj2=true;&#xA;		}&#xA;	}&#xA;	return;&#xA;}&#xA;//Multiple calls to createYQcomplex depending on multi-value parameters&#xA;function createYQcomplexQlml(consistencyRule, correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var seria=0;&#xA;var iteration=parameters[1].length/2; //how many use cases are there in the rule&#xA;var instanceClasses = [];&#xA;var normalMode=true;&#xA;&#xA;	iteration=Math.floor(iteration);&#xA;	//Session.Output(&quot;iteration:&quot;+iteration+&quot;parameter[1][0]=&lt;&quot;+parameters[1][0]+&quot;&gt;; conns[0][0]:&quot;+connectors[0][0].Name+&quot;(&quot;+connectors[0][0].Type+&quot;); conns[0][1]:&quot;+connectors[0][1].Name+&quot;(&quot;+connectors[0][1].Type+&quot;)&quot;);&#xA;	if(iteration&gt;0&amp;&amp;(parameters[1][0]==&quot;&quot;||parameters[1][0]==&quot; &quot;)) {&#xA;		//:ObjectA on input of Action of SUCRD-&gt;downLoad(ObjectA)::ObjectA&#xA;		//:ObjectA on output of Action of SUCRD-&gt;update(ObjectA)::ObjectA - if ObjectA exists on input&#xA;		//:ObjectZ on output of Action of SUCRD-&gt;upLoad(ObjectZ)::ObjectZ&#xA;		var sourceAction=getSourceActionOfSysUC(connectors[0][0]);&#xA;		if(sourceAction!=null) {&#xA;			instanceClasses=getObjectsOfAction(sourceAction);&#xA;			instanceClasses.sort();&#xA;			if(instanceClasses.length&gt;0) { //there are objects&#xA;				//Session.Output(&quot;createYQcomplexQlml(2):instanceClassee.length=&quot;+instanceClasses.length);&#xA;				//for(var n=0;n&lt;instanceClasses.length;n++) {&#xA;				//	Session.Output(&quot;createYQcomplexQlml(3):instanceClasses=[&quot;+instanceClasses[n][0]+&quot;,&quot;+instanceClasses[n][1]+&quot;,&quot;+instanceClasses[n][2]+&quot;]&quot;);&#xA;				//}&#xA;				normalMode=false;&#xA;				for(var n=0;n&lt;instanceClasses.length;n++) {&#xA;					//dla instanceClasses[][0]=5,6,7,8 trzeba zrobi&#263; dwa razy:downLoad oraz update&#xA;					if(iteration==1) { //two lifelines: nameOfSystemUC:nameOfBusinessUC-&gt;:Database&#xA;						parameter1[1][0]=setParameterValueLifeLine(connectors[0][1],thePackage); //first Lifeline&#xA;						if(parameters[1][1]==null||parameters[1][1]==&quot;&quot;||parameters[1][1]==&quot; &quot;) { //first Message&#xA;							if(instanceClasses[n][0]&lt;5)&#xA;								parameter1[1][1]=&quot;downLoad&quot;;&#xA;							else if(instanceClasses[n][0]&gt;8)&#xA;								parameter1[1][1]=&quot;upLoad&quot;;&#xA;							else&#xA;								parameter1[1][1]=&quot;update&quot;;&#xA;							//3,7,9 -component,class&#xA;							if(instanceClasses[n][0]==3||instanceClasses[n][0]&gt;6&amp;&amp;instanceClasses[n][0]&lt;10) {&#xA;								var nameOfObject=(Repository.GetElementByID(instanceClasses[n][2])).Name;&#xA;								var nameOfClass=&quot;Data&quot;;&#xA;								if(instanceClasses[n][1]&gt;0)&#xA;									nameOfClass=(Repository.GetElementByID(instanceClasses[n][1])).Name;&#xA;								if(nameOfObject==null||nameOfObject==&quot;&quot;)&#xA;									nameOfObject=&quot;Data&quot;;&#xA;								if(instanceClasses[n][1]&gt;0) {&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;&lt;&quot;+nameOfObject+&quot;:&quot;+nameOfClass+&quot;&gt;::&quot;+nameOfObject;&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfClass;&#xA;								} else {&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;&lt;&quot;+nameOfClass+&quot;:&quot;+nameOfObject+&quot;&gt;::&quot;+nameOfClass;&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfObject;		&#xA;								}&#xA;							} else //instance of component&#xA;							if(instanceClasses[n][0]==2||instanceClasses[n][0]==6||instanceClasses[n][0]==10) {&#xA;								var nameOfObject=(Repository.GetElementByID(instanceClasses[n][2])).Name;&#xA;								var nameOfClass=&quot;Data&quot;;&#xA;								if(instanceClasses[n][1]&gt;0)&#xA;									nameOfClass=(Repository.GetElementByID(instanceClasses[n][1])).Name;&#xA;								if(nameOfObject==null||nameOfObject==&quot;&quot;)&#xA;									nameOfObject=&quot;Data&quot;;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;&lt;&quot;+nameOfObject+&quot;:&quot;+nameOfClass+&quot;&gt;::&quot;+nameOfObject;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfClass;&#xA;							} else {&#xA;								var nameOfObject=(Repository.GetElementByID(instanceClasses[n][2])).Name;&#xA;								var nameOfState=getStatesOfObject(Repository.GetElementByID(instanceClasses[n][2]));&#xA;								var nameOfClass=&quot;&quot;;&#xA;								if(instanceClasses[n][1]&gt;0)&#xA;									nameOfClass=(Repository.GetElementByID(instanceClasses[n][1])).Name;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;&lt;&quot;+nameOfObject;&#xA;								if(nameOfState!=null)&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;[&quot;+nameOfState+&quot;]&quot;;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfClass+&quot;&gt;::&quot;+nameOfObject;&#xA;								if(nameOfState!=null)&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;[&quot;+nameOfState+&quot;]&quot;;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfClass;&#xA;							}&#xA;						} else&#xA;							parameter1[1][1]=parameters[1][1];						&#xA;						if(instanceClasses[n][0]==3||instanceClasses[n][0]&gt;6&amp;&amp;instanceClasses[n][0]&lt;10) { //second Lifeline&#xA;							var nameOfObject=(Repository.GetElementByID(instanceClasses[n][2])).Name;&#xA;							var nameOfClass=&quot;Data&quot;;&#xA;							if(instanceClasses[n][1]&gt;0)&#xA;								nameOfClass=(Repository.GetElementByID(instanceClasses[n][1])).Name;&#xA;							if(nameOfObject==null||nameOfObject==&quot;&quot;)&#xA;								nameOfObject=&quot;Data&quot;;&#xA;							parameter1[1][2]=nameOfClass+&quot;:&quot;+nameOfObject;&#xA;						} else &#xA;						if(instanceClasses[n][0]==2||instanceClasses[n][0]==6||instanceClasses[n][0]==10) { //second Lifeline&#xA;							var nameOfObject=(Repository.GetElementByID(instanceClasses[n][2])).Name;&#xA;							var nameOfClass=&quot;Data&quot;;&#xA;							if(instanceClasses[n][1]&gt;0)&#xA;								nameOfClass=(Repository.GetElementByID(instanceClasses[n][1])).Name;&#xA;							if(nameOfObject==null||nameOfObject==&quot;&quot;)&#xA;								nameOfObject=&quot;Data&quot;;&#xA;							parameter1[1][2]=nameOfObject+&quot;:&quot;+nameOfClass;&#xA;						} else {&#xA;							if(parameters[1][2]==null||parameters[1][2]==&quot;&quot;||parameters[1][2]==&quot; &quot;)&#xA;								parameter1[1][2]=&quot;:Database&quot;;&#xA;							else&#xA;								parameter1[1][2]=parameters[1][2];			&#xA;						}							&#xA;						seria=createYQcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,0,seria);&#xA;						if(seria==-5)&#xA;							break;&#xA;					} else { //three lifelines: nameOfSystemUC:nameOfBusinessUC-&gt;:Middleware-&gt;:Database&#xA;						//parameters[1][1] - midlleware&#xA;						//parameters[1][2] - database&#xA;						//parameters[1][1] - database&#xA;						parameter1[1][0]=setParameterValueLifeLine(connectors[0][1],thePackage); //first Lifeline&#xA;						if(parameters[1][1]==null||parameters[1][1]==&quot;&quot;||parameters[1][1]==&quot; &quot;) { //first Message&#xA;							if(instanceClasses[n][0]&lt;5)&#xA;								parameter1[1][1]=&quot;downLoad&quot;;&#xA;							else if(instanceClasses[n][0]&gt;8)&#xA;								parameter1[1][1]=&quot;upLoad&quot;;&#xA;							else&#xA;								parameter1[1][1]=&quot;update&quot;;&#xA;							//3,7,9 -component,class&#xA;							if(instanceClasses[n][0]==3||instanceClasses[n][0]&gt;6&amp;&amp;instanceClasses[n][0]&lt;10) {&#xA;								var nameOfObject=(Repository.GetElementByID(instanceClasses[n][2])).Name;&#xA;								var nameOfClass=&quot;Data&quot;;&#xA;								if(instanceClasses[n][1]&gt;0)&#xA;									nameOfClass=(Repository.GetElementByID(instanceClasses[n][1])).Name;&#xA;								if(nameOfObject==null||nameOfObject==&quot;&quot;)&#xA;									nameOfObject=&quot;Data&quot;;&#xA;								if(instanceClasses[n][1]&gt;0) {&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;&lt;&quot;+nameOfObject+&quot;:&quot;+nameOfClass+&quot;&gt;::&quot;+nameOfObject;&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfClass;&#xA;								} else {&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;&lt;&quot;+nameOfClass+&quot;:&quot;+nameOfObject+&quot;&gt;::&quot;+nameOfClass;&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfObject;		&#xA;								}&#xA;								//parameter1[1][1]=parameter1[1][1]+&quot;&lt;&quot;+nameOfObject+&quot;:&quot;+nameOfClass+&quot;&gt;::&quot;+nameOfObject+&quot;:&quot;+nameOfClass;&#xA;							} else &#xA;							if(instanceClasses[n][0]==2||instanceClasses[n][0]==6||instanceClasses[n][0]==10) {&#xA;								var nameOfObject=(Repository.GetElementByID(instanceClasses[n][2])).Name;&#xA;								var nameOfClass=&quot;Data&quot;;&#xA;								if(instanceClasses[n][1]&gt;0)&#xA;									nameOfClass=(Repository.GetElementByID(instanceClasses[n][1])).Name;&#xA;								if(nameOfObject==null||nameOfObject==&quot;&quot;)&#xA;									nameOfObject=&quot;Data&quot;;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;&lt;&quot;+nameOfObject+&quot;:&quot;+nameOfClass+&quot;&gt;::&quot;+nameOfObject;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfClass;&#xA;							} else {&#xA;								var nameOfObject=(Repository.GetElementByID(instanceClasses[n][2])).Name;&#xA;								var nameOfState=getStatesOfObject(Repository.GetElementByID(instanceClasses[n][2]));&#xA;								var nameOfClass=&quot;&quot;;&#xA;								if(instanceClasses[n][1]&gt;0)&#xA;									nameOfClass=(Repository.GetElementByID(instanceClasses[n][1])).Name;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;&lt;&quot;+nameOfObject;&#xA;								if(nameOfState!=null)&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;[&quot;+nameOfState+&quot;]&quot;;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfClass+&quot;&gt;::&quot;+nameOfObject;&#xA;								if(nameOfState!=null)&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;[&quot;+nameOfState+&quot;]&quot;;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfClass;&#xA;							}&#xA;						} else&#xA;							parameter1[1][1]=parameters[1][1];	&#xA;						if(parameters[1][2]==null||parameters[1][2]==&quot;&quot;||parameters[1][2]==&quot; &quot;) //second Lifeline&#xA;							parameter1[1][2]=&quot;:Middleware&quot;;&#xA;						else&#xA;							parameter1[1][2]=parameters[1][2];&#xA;						createYQcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,0,seria);&#xA;						parameter1[1][0]=parameter1[1][2]; //second Lifeline&#xA;						if(parameters[1][3]==null||parameters[1][3]==&quot;&quot;||parameters[1][3]==&quot; &quot;) { //second Message&#xA;							if(instanceClasses[n][0]&lt;5)&#xA;								parameter1[1][1]=&quot;downLoad&quot;;&#xA;							else if(instanceClasses[n][0]&gt;8)&#xA;								parameter1[1][1]=&quot;upLoad&quot;;&#xA;							else&#xA;								parameter1[1][1]=&quot;update&quot;;&#xA;							//3,7,9 -component,class&#xA;							if(instanceClasses[n][0]==3||instanceClasses[n][0]&gt;6&amp;&amp;instanceClasses[n][0]&lt;10) {&#xA;								var nameOfObject=(Repository.GetElementByID(instanceClasses[n][2])).Name;&#xA;								var nameOfClass=&quot;Data&quot;;&#xA;								if(instanceClasses[n][1]&gt;0)&#xA;									nameOfClass=(Repository.GetElementByID(instanceClasses[n][1])).Name;&#xA;								if(nameOfObject==null||nameOfObject==&quot;&quot;)&#xA;									nameOfObject=&quot;Data&quot;;&#xA;								if(instanceClasses[n][1]&gt;0) {&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;&lt;&quot;+nameOfObject+&quot;:&quot;+nameOfClass+&quot;&gt;::&quot;+nameOfObject;&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfClass;&#xA;								} else {&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;&lt;&quot;+nameOfClass+&quot;:&quot;+nameOfObject+&quot;&gt;::&quot;+nameOfClass;&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfObject;		&#xA;								}&#xA;								//parameter1[1][1]=parameter1[1][1]+&quot;&lt;&quot;+nameOfObject+&quot;:&quot;+nameOfClass+&quot;&gt;::&quot;+nameOfObject+&quot;:&quot;+nameOfClass;&#xA;							} else &#xA;							if(instanceClasses[n][0]==2||instanceClasses[n][0]==6||instanceClasses[n][0]==10) {&#xA;								var nameOfObject=(Repository.GetElementByID(instanceClasses[n][2])).Name;&#xA;								var nameOfClass=&quot;Data&quot;;&#xA;								if(instanceClasses[n][1]&gt;0)&#xA;									nameOfClass=(Repository.GetElementByID(instanceClasses[n][1])).Name;&#xA;								if(nameOfObject==null||nameOfObject==&quot;&quot;)&#xA;									nameOfObject=&quot;Data&quot;;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;&lt;&quot;+nameOfObject+&quot;:&quot;+nameOfClass+&quot;&gt;::&quot;+nameOfObject;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfClass;&#xA;							} else {&#xA;								var nameOfObject=(Repository.GetElementByID(instanceClasses[n][2])).Name;&#xA;								var nameOfState=getStatesOfObject(Repository.GetElementByID(instanceClasses[n][2]));&#xA;								var nameOfClass=&quot;&quot;;&#xA;								if(instanceClasses[n][1]&gt;0)&#xA;									nameOfClass=(Repository.GetElementByID(instanceClasses[n][1])).Name;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;&lt;&quot;+nameOfObject;&#xA;								if(nameOfState!=null)&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;[&quot;+nameOfState+&quot;]&quot;;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfClass+&quot;&gt;::&quot;+nameOfObject;&#xA;								if(nameOfState!=null)&#xA;									parameter1[1][1]=parameter1[1][1]+&quot;[&quot;+nameOfState+&quot;]&quot;;&#xA;								parameter1[1][1]=parameter1[1][1]+&quot;:&quot;+nameOfClass;&#xA;							}&#xA;						} else&#xA;							parameter1[1][1]=parameter[1][3];&#xA;						if(instanceClasses[n][0]==3||instanceClasses[n][0]&gt;6&amp;&amp;instanceClasses[n][0]&lt;10) { //third Lifeline&#xA;							var obiekt as EA.Element;&#xA;							obiekt=Repository.GetElementByID(instanceClasses[n][2]);&#xA;							var nameOfObject=(Repository.GetElementByID(instanceClasses[n][2])).Name;&#xA;							var nameOfClass=&quot;Data&quot;;&#xA;							if(instanceClasses[n][1]&gt;0)&#xA;								nameOfClass=(Repository.GetElementByID(instanceClasses[n][1])).Name;&#xA;							if(nameOfObject==null||nameOfObject==&quot;&quot;)&#xA;								nameOfObject=&quot;Data&quot;;&#xA;							parameter1[1][2]=nameOfClass+&quot;:&quot;+nameOfObject;&#xA;						} else &#xA;						if(instanceClasses[n][0]==2||instanceClasses[n][0]==6||instanceClasses[n][0]==10) { //second Lifeline&#xA;							var nameOfObject=(Repository.GetElementByID(instanceClasses[n][2])).Name;&#xA;							var nameOfClass=&quot;Data&quot;;&#xA;							if(instanceClasses[n][1]&gt;0)&#xA;								nameOfClass=(Repository.GetElementByID(instanceClasses[n][1])).Name;&#xA;							if(nameOfObject==null||nameOfObject==&quot;&quot;)&#xA;								nameOfObject=&quot;Data&quot;;&#xA;							parameter1[1][2]=nameOfObject+&quot;:&quot;+nameOfClass;&#xA;						} else {&#xA;							if(parameters[1][4]==null||parameters[1][4]==&quot;&quot;||parameters[1][4]==&quot; &quot;)&#xA;								parameter1[1][2]=&quot;:Database&quot;;&#xA;							else&#xA;								parameter1[1][2]=parameters[1][4];&#xA;						}&#xA;						seria=createYQcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,1,seria);&#xA;					}&#xA;				}&#xA;			}&#xA;		} //else&#xA;			//Session.Output(&quot;SourceAction: null&quot;);&#xA;	}&#xA;	if(normalMode) {&#xA;		for(var n=0; n&lt;iteration; n++) {&#xA;			parameter1[1][0]=parameters[1][2*n];&#xA;			//if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;			//	parameter1[1][0]=&quot;Lifeline&quot;+(n+1);&#xA;			parameter1[1][1]=parameters[1][2*n+1];&#xA;			//if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			//	parameter1[1][1]=&quot;Message&quot;+(n+1);		&#xA;			parameter1[1][2]=parameters[1][2*n+2];&#xA;			//if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;			//	parameter1[1][2]=&quot;Lifeline&quot;+(n+2);		&#xA;			var what=createYQcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,n,seria);&#xA;			if(what==-5)&#xA;				break;&#xA;			&#xA;		} &#xA;	}&#xA;}&#xA;//Create target elements in composite consistency rule from internal use case diagram to sequence diagram&#xA;function createYQcomplex(consistencyRule, correctCR, thePackage, parameters, connectors1,mode,seria) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var diagramConnectors = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	//YuQlm&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	if(conns[0]==null||conns[0].length&lt;=0||conns[0][0].Type!=&quot;UseCase&quot;||conns[0][0].Name==&quot;&quot;||conns[0][0].Name==&quot; &quot;)&#xA;		return -1;&#xA;	packages=getTargetPackage(thePackage,&quot;SEQD&quot;,conns[0][0].Name,consistencyRule,conns);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for SEQD&quot;);&#xA;		return -1;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;LifeLine&quot;+(mode+0)+&quot;:Module&quot;;&#xA;	nameOfElement2=&quot;downLoad(Data)::Data&quot;;&#xA;	nameOfElement3=&quot;LifeLine&quot;+(mode+1)+&quot;:Module&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	if(mode==0)&#xA;		nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 5, thePackage);&#xA;	else&#xA;		nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 3);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 3); &#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 3); &#xA;	//Session.Output(&quot;createYQcomplex(&quot;+mode+&quot;):nameElement1:&quot;+nameElement1);&#xA;	//Session.Output(&quot;createYQcomplex(&quot;+mode+&quot;):nameElement2:&quot;+nameElement2);&#xA;	//Session.Output(&quot;createYQcomplex(&quot;+mode+&quot;):nameElement3:&quot;+nameElement3);&#xA;	//pattern-driven rule in nameElement2 - YuQlm({pattern})l&#xA;	if(nameElement2.substr(0,3)==&quot;{{{&quot; &amp;&amp; nameElement2.substr(nameElement2.length-3,3)==&quot;}}}&quot;) {&#xA;		var namePattern=nameElement2.substr(3);&#xA;		namePattern=namePattern.substr(0,namePattern.length-3);	&#xA;		if(namePattern.substr(namePattern.length-7)!=&quot;BackEnd&quot;)&#xA;			namePattern+=&quot;BackEnd&quot;;		&#xA;		// Fetch XML content from URL&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;);&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		var nameOfPckg = &quot;&quot;;&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			//retrieve package name&#xA;			nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;);&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return -5;&#xA;			}&#xA;			//activityPartitions=retrieveXMLNames(xmlContent, &quot;ActivityPartition&quot;, &quot;alias&quot;, &quot;UML:ActionState name=&quot;,0); //Retrieve partition names&#xA;			//activityPartitions=activityPartitions.sort();&#xA;			//objectClasses=retrieveXMLNames(xmlContent, &quot;classname&quot;, &quot;stateflags&quot;, 'keywords&quot; value=', 1); //Retrieve objectclass names - option B: &quot;keywords&quot;, &quot;UML:ClassifierRole name=&quot;, 0&#xA;			objectClasses=retrieveXMLNames(xmlContent, &quot;ClassifierRole &quot;, &quot;alias&quot;, 'classname&quot; value=', 2); //Retrieve lifeline names&#xA;			/*Session.Output(&quot;createYQcomplex(0): objectClasses.length=&quot;+objectClasses.length);&#xA;			for(var i=0;i&lt;objectClasses.length;i++)&#xA;				Session.Output(&quot;createYQcomplex(1): objectClasses[&quot;+i+&quot;][0]=&quot;+objectClasses[i][0]+&quot;; objectClasses[&quot;+i+&quot;][1]=&quot;+objectClasses[i][1]);*/&#xA;			objectClasses=objectClasses.sort();&#xA;			/*for(var i=0;i&lt;objectClasses.length;i++)&#xA;				Session.Output(&quot;createYQcomplex(2): objectClasses[&quot;+i+&quot;][0]=&quot;+objectClasses[i][0]+&quot;; objectClasses[&quot;+i+&quot;][1]=&quot;+objectClasses[i][1]);*/&#xA;			var project = Repository.GetProjectInterface();&#xA;			//Import the XMI file into the current model, download package content to subpackage&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1);&#xA;			subPackage.Packages.Refresh();&#xA;			if(result==null)&#xA;				return -5;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null)&#xA;				return -5;&#xA;			//moving elements from the changed pattern to the current package&#xA;			var sourceAction=null;&#xA;			if(conns[0][0]!=null) //conns[0][0]-&gt;UseCase&#xA;				sourceAction=/*getSourceActionOfSysUC(*/conns[0][0]/*)*/;&#xA;			nameElement=setParameterValueLifeLine(conns[0][1],thePackage)&#xA;			var moving=renamePatternObjects(consistencyRule, correctCR, nameElement, sourceAction, objectClasses, null, subPackage, subChildPackage); //Rename partitions according to the values &#8203;&#8203;given in the partition rule parameter&#xA;			if(subChildPackage !=null&amp;&amp;moving) //moving partitions from the changed pattern to the current package&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			else&#xA;				changePatternPackage(consistencyRule, &quot; &quot;, sourceAction, objectClasses, null, subPackage); //change the name of partitions&#xA;			if(testDiagram.DiagramObjects.Count==0) {&#xA;				var nameOfDiagram = testDiagram.Name;&#xA;				for(var i=0;i&lt;subPackage.Diagrams.Count;i++) {&#xA;					if((subPackage.Diagrams.GetAt(i)).Name==nameOfDiagram) {&#xA;						subPackage.Diagrams.Delete(i);&#xA;						break;&#xA;					}&#xA;				}&#xA;				subPackage.Diagrams.Refresh();&#xA;				testDiagram=subPackage.Diagrams.GetAt(0);&#xA;				testDiagram.Name=nameOfDiagram;&#xA;				testDiagram.Update();&#xA;			}&#xA;			return -5;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML for the pattern &lt;&quot;+namePattern+&quot; from URL: &quot; + xhr.statusText);&#xA;		}&#xA;	}&#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject3=null;&#xA;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, null, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject3=desiredDiagObjects[2];		&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Connector;&#xA;	var delement3 as EA.Element;&#xA;	var delement4 as EA.Connector;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	delement4 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackSequences(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;		delement4=desiredPackElements[3];	&#xA;	} &#xA;	//Session.Output(&quot;delement1:&quot;+delement1.Name);&#xA;	//Session.Output(&quot;delement2:&quot;+delement2.Name);&#xA;	//Session.Output(&quot;delement3:&quot;+delement3.Name);&#xA;	//Session.Output(&quot;delement4:&quot;+delement4.Name);&#xA;	if(delement1==null&amp;&amp;nameElement1!=null) {&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Q&quot;)+1,1)==&quot;l&quot;) { &#xA;			var name1=null;&#xA;			var class1=null;&#xA;			if(nameElement1.indexOf(&quot;:&quot;)&gt;-1) {&#xA;				name1=nameElement1.substr(0,nameElement1.indexOf(&quot;:&quot;));&#xA;				class1=nameElement1.substr(nameElement1.indexOf(&quot;:&quot;)+1);&#xA;				if(class1.substr(0,1)==&quot;&quot;)&#xA;					class1=&quot;Module&quot;;&#xA;			} else {&#xA;				name1=nameElement1;&#xA;				class1=&quot;Module&quot;;&#xA;			}&#xA;			var component=searchForElement(thePackage, class1, &quot;Component&quot;);&#xA;			if(component==null)&#xA;				component=subPackage.Elements.AddNew(class1,&quot;Component&quot;);&#xA;			testElement = subPackage.Elements.AddNew( name1,&quot;Sequence&quot; );&#xA;			testElement.ClassifierID=component.ElementID;&#xA;			testElement.Update();&#xA;			if((tagValue=getTagValueforElement(&quot;SEQD&quot;,&quot;Sequence&quot;,nameElement1))!=null) {&#xA;				var taggedValue as EA.TaggedValue;&#xA;				taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;				taggedValue.Update();&#xA;			}&#xA;			diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;			setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;		} &#xA;		delement1=testElement;&#xA;	}&#xA;	if(delement3==null&amp;&amp;nameElement3!=null) {&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Q&quot;)+3,1)==&quot;l&quot;) { //YuQlml&#xA;			var name1=null;&#xA;			var class1=null;&#xA;			if(nameElement3.indexOf(&quot;:&quot;)&gt;-1) {&#xA;				name1=nameElement3.substr(0,nameElement3.indexOf(&quot;:&quot;));&#xA;				class1=nameElement3.substr(nameElement3.indexOf(&quot;:&quot;)+1);&#xA;				if(class1.substr(0,1)==&quot;&quot;)&#xA;					class1=&quot;Module&quot;;&#xA;			} else {&#xA;				name1=nameElement3;&#xA;				class1=&quot;Module&quot;;&#xA;			}&#xA;			var component=searchForElement(thePackage, class1, &quot;Component&quot;);&#xA;			if(component==null)&#xA;				component=subPackage.Elements.AddNew(class1,&quot;Component&quot;);&#xA;			testElement = subPackage.Elements.AddNew( name1,&quot;Sequence&quot; ); &#xA;			testElement.ClassifierID=component.ElementID;&#xA;			testElement.Update();&#xA;			if((tagValue=getTagValueforElement(&quot;SEQD&quot;,&quot;Sequence&quot;,nameElement3))!=null) {&#xA;				var taggedValue as EA.TaggedValue;&#xA;				taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;				taggedValue.Update();&#xA;			}&#xA;			diagramObject3=null; //diagramObject1 is not already a previously created element&#xA;			setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;		} &#xA;		delement3=testElement;&#xA;	}&#xA;	var nameConnector2=null;&#xA;	var nameConnector2Parameter=null;&#xA;	var nameConnector4=null;&#xA;	var nameConnector4Parameter=null;&#xA;	if(nameElement2.indexOf(&quot;::&quot;)&gt;-1)&#xA;		nameConnector2 = nameElement2.substr(0,nameElement2.indexOf(&quot;::&quot;));&#xA;	else&#xA;		nameConnector2 = nameElement2;&#xA;	if(nameConnector2.indexOf(&quot;&lt;&quot;)&gt;-1&amp;&amp;nameConnector2.indexOf(&quot;&gt;&quot;)&gt;nameConnector2.indexOf(&quot;&lt;&quot;)) {&#xA;		nameConnector2Parameter = nameConnector2.substr(nameConnector2.indexOf(&quot;&lt;&quot;)+1,nameConnector2.indexOf(&quot;&gt;&quot;)-nameConnector2.indexOf(&quot;&lt;&quot;)-1);&#xA;		nameConnector2 = nameElement2.substr(0,nameElement2.indexOf(&quot;&lt;&quot;));&#xA;	} else&#xA;		nameConnector2Parameter=&quot;&quot;;&#xA;	nameConnector4=&quot;&quot;;&#xA;	if(nameElement2.indexOf(&quot;::&quot;)&gt;-1)&#xA;		nameConnector4Parameter=nameElement2.substr(nameElement2.indexOf(&quot;::&quot;)+2);&#xA;	else&#xA;		nameConnector4Parameter=&quot;&quot;;&#xA;	diagramConnectors=getDesiredDiagramSequences(testDiagram);	&#xA;	//if(diagramConnectors==null)&#xA;	//	Session.Output(&quot;A.testElement.SequenceNo:seria=&quot;+seria+&quot;; length=0&quot;);&#xA;	//else&#xA;	//	Session.Output(&quot;A.testElement.SequenceNo:seria=&quot;+seria+&quot;; length=&quot;+diagramConnectors.length);&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameConnector2!=null) { //message&#xA;		var testElement as EA.Connector;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Q&quot;)+2,1)==&quot;m&quot;) { //YuQlml&#xA;			testElement=delement1.Connectors.AddNew(nameConnector2, &quot;Sequence&quot;);	&#xA;			if(delement3==null) &#xA;				testElement.SupplierID=delement1.ElementID;&#xA;			else&#xA;				testElement.SupplierID=delement3.ElementID;&#xA;			testElement.TransitionGuard=&quot;retval=void;params=;paramsDlg=&quot;+nameConnector2Parameter+&quot;;&quot;;&#xA;			if(diagramConnectors!=null)	{&#xA;				testElement.SequenceNo=(diagramConnectors.length-seria)/2+1+seria;&#xA;				//Session.Output(&quot;B.testElement.SequenceNo=&quot;+testElement.SequenceNo+&quot;; name=&quot;+testElement.TransitionGuard);&#xA;				for(var m=seria; m&lt;diagramConnectors.length;m++) {&#xA;					var connector as EA.Connector;&#xA;					connector=diagramConnectors[m][1];&#xA;					//Session.Output(&quot;C.connector.SequenceNo=&quot;+connector.SequenceNo+&quot;; &gt;&quot;+(diagramConnectors.length-seria)/2+seria+&quot;; name=&quot;+connector.TransitionGuard);&#xA;					if(connector.SequenceNo&gt;(diagramConnectors.length-seria)/2+seria) {&#xA;						connector.SequenceNo=connector.SequenceNo+2;&#xA;						connector.Update();&#xA;						//Session.Output(&quot;D.connector.SequenceNo=&quot;+connector.SequenceNo+&quot;; name=&quot;+connector.TransitionGuard);&#xA;					}&#xA;				}&#xA;			} else {&#xA;				testElement.SequenceNo=1;&#xA;				//Session.Output(&quot;B.testElement.SequenceNo=&quot;+testElement.SequenceNo+&quot;; name=&quot;+nameConnector2);&#xA;			}&#xA;			//Session.Output(&quot;createYQcomplex(-3):&quot;+testElement.ClientID+&quot;-&quot;+testElement.SupplierID+&quot;; testElement=&quot;+testElement.Name+&quot;-&quot;+testElement.Type+&quot;(&quot;+testElement.ConnectorID+&quot;); Count=&quot;+testElement.TaggedValues.Count+&quot;; nameElement2=&lt;&quot;+nameElement2+&quot;&gt;; nameConnector2=&lt;&quot;+nameConnector2+&quot;&gt;&quot;);&#xA;			testElement.Update();&#xA;			//Session.Output(&quot;createYQcomplex(-2):&quot;+testElement.ClientID+&quot;-&quot;+testElement.SupplierID+&quot;; testElement=&quot;+testElement.Name+&quot;-&quot;+testElement.Type+&quot;(&quot;+testElement.ConnectorID+&quot;); Count=&quot;+testElement.TaggedValues.Count+&quot;; nameElement2=&lt;&quot;+nameElement2+&quot;&gt;; nameConnector2=&lt;&quot;+nameConnector2+&quot;&gt;&quot;);&#xA;			//delement1.Update();&#xA;			//Session.Output(&quot;createYQcomplex(-1):&quot;+testElement.ClientID+&quot;-&quot;+testElement.SupplierID+&quot;; testElement=&quot;+testElement.Name+&quot;-&quot;+testElement.Type+&quot;(&quot;+testElement.ConnectorID+&quot;); Count=&quot;+testElement.TaggedValues.Count+&quot;; nameElement2=&lt;&quot;+nameElement2+&quot;&gt;; nameConnector2=&lt;&quot;+nameConnector2+&quot;&gt;&quot;);&#xA;			//delement1.Connectors.Refresh();&#xA;			//Session.Output(&quot;createYQcomplex( 0):&quot;+testElement.ClientID+&quot;-&quot;+testElement.SupplierID+&quot;; testElement=&quot;+testElement.Name+&quot;-&quot;+testElement.Type+&quot;(&quot;+testElement.ConnectorID+&quot;); Count=&quot;+testElement.TaggedValues.Count+&quot;; nameElement2=&lt;&quot;+nameElement2+&quot;&gt;; nameConnector2=&lt;&quot;+nameConnector2+&quot;&gt;&quot;);&#xA;			//if(delement3!=null) &#xA;				//delement3.Connectors.Refresh();&#xA;			var connector1 as EA.Connector;&#xA;			connector1=Repository.GetConnectorByID(testElement.ConnectorID);&#xA;			if((tagValue=getTagValueforElement(&quot;SEQD&quot;,&quot;Sequence&quot;,nameElement2))!=null) {&#xA;				var taggedValue as EA.TaggedValue;&#xA;				taggedValue=connector1.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;				//Session.Output(&quot;createYQcomplex(1):&quot;+connector.Name+&quot;-&quot;+connector.Type+&quot;-&quot;+connector.ConnectorID+&quot;; Count=&quot;+connector.TaggedValues.Count+&quot;; taggedValue.Name=&lt;&quot;+taggedValue.Name+&quot;&gt;; taggedValue.Value=&lt;&quot;+taggedValue.Value+&quot;&gt;&quot;);&#xA;				var jakUpdate=taggedValue.Update();&#xA;				//Session.Output(&quot;createYQcomplex(2):&quot;+connector.Name+&quot;-&quot;+connector.Type+&quot;-&quot;+connector.ConnectorID+&quot;; taggedValue.Update()=&lt;&quot;+jakUpdate+&quot;&gt;&quot;);&#xA;				connector1.Update();&#xA;			}&#xA;			var sqlCommand=&quot;update t_connector set PDATA4 = 0 where Connector_ID = &quot;+testElement.ConnectorID;&#xA;			Repository.Execute(sqlCommand);				&#xA;			//setCRDependency(consistencyRule,conns[0][1],testElement); //Dependency cannot connect to Connector&#xA;		} &#xA;		delement2=testElement;&#xA;	}&#xA;	if(delement4==null&amp;&amp;nameConnector4!=null||delement4!=null&amp;&amp;delement2!=null&amp;&amp;delement4.SequenceNo&lt;delement2.SequenceNo) { //return&#xA;		var testElement as EA.Connector;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Q&quot;)+2,1)==&quot;m&quot;) { //YuQlml&#xA;			testElement=delement3.Connectors.AddNew(nameConnector4, &quot;Sequence&quot;);	&#xA;			if(delement1==null) &#xA;				testElement.SupplierID=delement3.ElementID;&#xA;			else&#xA;				testElement.SupplierID=delement1.ElementID;&#xA;			if(nameConnector4Parameter!=null&amp;&amp;nameConnector4Parameter!=&quot;&quot;)&#xA;				testElement.TransitionGuard=&quot;retval=&quot;+nameConnector4Parameter+&quot;;&quot;;&#xA;			else&#xA;				testElement.TransitionGuard=&quot;retval=void;&quot;;&#xA;			if(diagramConnectors==null)	&#xA;				testElement.SequenceNo=2;&#xA;			else&#xA;				testElement.SequenceNo=(diagramConnectors.length-seria)/2+2+seria;&#xA;			//Session.Output(&quot;E.testElement.SequenceNo=&quot;+testElement.SequenceNo+&quot;; name=&quot;+testElement.TransitionGuard);&#xA;&#xA;			/*if((tagValue=getTagValueforElement(&quot;SEQD&quot;,&quot;Sequence&quot;,nameConnector4))!=null) {&#xA;				var taggedValue as EA.TaggedValue;&#xA;				taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;				taggedValue.Update();&#xA;			}*/ //This is the return message&#xA;			testElement.Update();&#xA;			delement3.Update();&#xA;			var sqlCommand=&quot;update t_connector set PDATA4 = 1 where Connector_ID = &quot;+testElement.ConnectorID;&#xA;			Repository.Execute(sqlCommand);				&#xA;			//setCRDependency(consistencyRule,conns[0][3],testElement); //Dependency cannot connect to Connector&#xA;		} &#xA;		delement4=testElement;&#xA;	}&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Sequence&quot;) {&#xA;			var left=50;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Sequence&quot;) {&#xA;					if(existDiagramObject.left&gt;=left)&#xA;						left=existDiagramObject.left+150;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=-50;&#xA;			testDiagramObject.bottom=-400;&#xA;			testDiagramObject.Update();&#xA;			diagramObjects.Refresh();&#xA;			testDiagram.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;		}&#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element3 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Sequence&quot;) {&#xA;			var left=200;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Sequence&quot;) {&#xA;					if(existDiagramObject.left&gt;=left)&#xA;						left=existDiagramObject.left+150;&#xA;				}&#xA;			}&#xA;			if(diagramObject1!=null&amp;&amp;diagramObject1.left&gt;=left)&#xA;				left=diagramObject1.left+150;&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=-50;&#xA;			testDiagramObject.bottom=-400;&#xA;			testDiagramObject.Update();&#xA;			diagramObjects.Refresh();&#xA;			testDiagram.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	}&#xA;	diagramConnectors=getDesiredDiagramSequences(testDiagram);&#xA;	return 	diagramConnectors.length;&#xA;}&#xA;//Multiple calls to createQMcomplex depending on multi-value parameters&#xA;function createQMcomplexMqyq(consistencyRule, correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=Math.floor(connectors[0].length/2); //how many activities are there in the rule&#xA;var lastElement as EA.Element;&#xA;	&#xA;/*	Session.Output(&quot;createQMcomplexMqyq:iteration=&quot;+iteration);&#xA;	for(var n=0;n&lt;connectors[0].length;n++) {&#xA;		var nameClass=&quot;&quot;;&#xA;		if(connectors[0][n].ObjectType==otElement&amp;&amp;connectors[0][n].ClassifierID&gt;0)&#xA;			nameClass=(Repository.GetElementByID(connectors[0][n].ClassifierID)).Name;&#xA;		Session.Output(&quot;createQMcomplexMqyq: conns(&quot;+n+&quot;) name=&quot;+connectors[0][n].Name+&quot;:&quot;+nameClass+&quot;; type=&quot;+connectors[0][n].Type);&#xA;	}*/&#xA;	lastElement=null;&#xA;	if(iteration &lt;=1) {&#xA;		//Session.Output(&quot;createQMcomplexMqyq(1): params[1][0]=&quot;+parameters[1][0]);&#xA;		//Session.Output(&quot;createQMcomplexMqyq(1): params[1][1]=&quot;+parameters[1][1]);&#xA;		//Session.Output(&quot;createQMcomplexMqyq(1): params[1][2]=&quot;+parameters[1][2]);&#xA;		createQMcomplex(consistencyRule, correctCR, thePackage, parameters, connectors,0);&#xA;	}&#xA;	else {&#xA;		for(var n=0; n&lt;iteration; n++) {&#xA;			if(connectors[0][2*n].ObjectType==otElement&amp;&amp;connectors[0][2*n].ClassifierID&gt;0)&#xA;				parameter1[1][0]=/*connectors[0][2*n].Name+*/&quot;:&quot;+(Repository.GetElementByID(connectors[0][2*n].ClassifierID)).Name; //nie name, tylko class&#xA;			else&#xA;				parameter1[1][0]=/*connectors[0][2*n].Name+*/&quot;:Module&quot;;&#xA;			parameter1[1][1]=connectors[0][2*n+1].Name; &#xA;			if(connectors[0][2*n+2].ObjectType==otElement&amp;&amp;connectors[0][2*n+2].ClassifierID&gt;0)&#xA;				parameter1[1][2]=/*connectors[0][2*n+2].Name+*/&quot;:&quot;+(Repository.GetElementByID(connectors[0][2*n+2].ClassifierID)).Name; //nie name tylko class&#xA;			else&#xA;				parameter1[1][2]=/*connectors[0][2*n+2].Name+*/&quot;:Module&quot;;&#xA;			connectors[2][0]=lastElement;&#xA;			//Session.Output(&quot;createQMcomplexMqyq(2): param1[1][0]=&quot;+parameter1[1][0]);&#xA;			//Session.Output(&quot;createQMcomplexMqyq(2): param1[1][1]=&quot;+parameter1[1][1]);&#xA;			//Session.Output(&quot;createQMcomplexMqyq(2): param1[1][2]=&quot;+parameter1[1][2]);&#xA;			lastElement=createQMcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,0);&#xA;		} &#xA;	}&#xA;}&#xA;//Create target elements in composite consistency rule from sequence diagram to component diagram&#xA;function createQMcomplex(consistencyRule, correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	//QlmlMqyq&#xA;	&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;CMPD&quot;,thePackage.Name,consistencyRule,conns);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for CMPD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;:Module&quot;;&#xA;	nameOfElement2=&quot;Interface&quot;;&#xA;	nameOfElement3=&quot;:Component&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(params, conns, 0, nameOfElement1, 6);&#xA;	nameElement2=setParameterValue(params, conns, 1, nameOfElement2, 0); &#xA;	nameElement3=setParameterValue(params, conns, 2, nameOfElement3, 6); &#xA;	/*Session.Output(&quot;createQMcomplex:nameElement1=&quot;+nameElement1);&#xA;	Session.Output(&quot;createQMcomplex:nameElement2=&quot;+nameElement2);&#xA;	Session.Output(&quot;createQMcomplex:nameElement3=&quot;+nameElement3);*/&#xA;	//Diagram Search&#xA;	//Searching the target diagram&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, nameElement3);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;		diagramObject3=desiredDiagObjects[2];&#xA;	} &#xA;	//Searching the target package&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Connector;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;	} &#xA;	if(delement1==null&amp;&amp;nameElement1!=null) {&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;M&quot;)+1,1)==&quot;q&quot;) { //QlmlMqyq&#xA;			if(nameElement1!=null&amp;&amp;nameElement1.indexOf(&quot;:&quot;)&gt;-1)&#xA;				nameElement1=nameElement1.substr(nameElement1.indexOf(&quot;:&quot;)+1);&#xA;			var testParentElement as EA.Element;&#xA;			testParentElement=null;&#xA;			if((testParentElement=searchForElement(subPackage, nameElement1, &quot;Component&quot;))==null) {&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Component&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;CMPD&quot;,&quot;Component&quot;,nameElement1))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;			} else&#xA;				testElement=testParentElement;&#xA;			diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;		} &#xA;		delement1=testElement;&#xA;	}&#xA;	setCRDependency(consistencyRule,correctCR,conns[0][0],delement1);&#xA;	if(delement3==null&amp;&amp;nameElement3!=null) {&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;M&quot;)+3,1)==&quot;q&quot;) { //QlmlMqyq&#xA;			if(nameElement3!=null&amp;&amp;nameElement3.indexOf(&quot;:&quot;)&gt;-1)&#xA;				nameElement3=nameElement3.substr(nameElement3.indexOf(&quot;:&quot;)+1);&#xA;			var testParentElement as EA.Element;&#xA;			testParentElement=null;&#xA;			if((testParentElement=searchForElement(subPackage, nameElement3, &quot;Component&quot;))==null) {&#xA;				testElement = subPackage.Elements.AddNew( nameElement3, &quot;Component&quot; ); &#xA;				/*if((tagValue=getTagValueforElement(&quot;CMPD&quot;,&quot;Component&quot;,nameElement3))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}*/&#xA;				testElement.Update();&#xA;			} else&#xA;				testElement=testParentElement;&#xA;			diagramObject3=null; //diagramObject1 is not already a previously created element&#xA;		} &#xA;		delement3=testElement;&#xA;	}&#xA;	if(delement3!=null&amp;&amp;conns[0][2]!=null)&#xA;		setCRDependency(consistencyRule,correctCR,conns[0][2],delement3);&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;delement1!=null&amp;&amp;delement3!=null&amp;&amp;delement1!=delement3) {&#xA;		var testElement as EA.Connector;&#xA;		testElement=null;&#xA;		for(var i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;			var connector=delement1.Connectors.GetAt(i);&#xA;			/*if(delement3==null)&#xA;				Session.Output(&quot;createQM: nameElement2=&quot;+nameElement2+&quot;; type=&quot;+connector.Type+&quot;; Name=&quot;+connector.Name+&quot;; delement1.Name=&quot;+delement1.Name);&#xA;			else&#xA;				Session.Output(&quot;createQM: nameElement2=&quot;+nameElement2+&quot;; type=&quot;+connector.Type+&quot;; Name=&quot;+connector.Name+&quot;; delement1.Name=&quot;+delement1.Name+&quot;; delement3.Name=&quot;+delement3.Name);*/&#xA;			if(connector.Type==&quot;Assembly&quot;&amp;&amp;connector.Name==nameElement2&amp;&amp;&#xA;				(delement3==null&amp;&amp;connector.SupplierID==delement1.ElementID||&#xA;				 delement3!=null&amp;&amp;connector.SupplierID==delement3.ElementID)) {&#xA;				testElement=connector;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(testElement==null&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;M&quot;)+2,1)==&quot;y&quot;) { //QlmlMqyq&#xA;			testElement=delement1.Connectors.AddNew(nameElement2, &quot;Interface&quot;);	&#xA;			if(delement3==null) &#xA;				testElement.SupplierID=delement1.ElementID;&#xA;			else&#xA;				testElement.SupplierID=delement3.ElementID;&#xA;			/*if((tagValue=getTagValueforElement(&quot;CMPD&quot;,&quot;Interface&quot;,nameElement2))!=null) {&#xA;				var taggedValue as EA.TaggedValue;&#xA;				taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;				taggedValue.Update();&#xA;			}*/&#xA;			testElement.Update();&#xA;			//setCRDependency(consistencyRule,conns[0][1],testElement); //???&#xA;		} &#xA;		delement2=testElement;&#xA;	}&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;Component&quot;) {&#xA;			var left=50;&#xA;			var top=-50;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Component&quot;) {&#xA;					if(existDiagramObject.bottom&lt;=top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			testDiagram.Update();&#xA;			diagramObjects.Refresh();&#xA;			diagramObject1=testDiagramObject;&#xA;		}&#xA;	}&#xA;	if(diagramObject3==null) {&#xA;		// Add the element3 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null&amp;&amp;delement3.Type==&quot;Component&quot;) {&#xA;			var left=50;&#xA;			var top=-150;			&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			diagramObjects.Refresh();&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existElementObject.Type==&quot;Component&quot;) {&#xA;					if(existDiagramObject.bottom&lt;=top)&#xA;						top=existDiagramObject.bottom-50;&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+100;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-50;&#xA;			testDiagramObject.Update();&#xA;			testDiagram.Update();&#xA;			diagramObjects.Refresh();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	}&#xA;	return delement3;&#xA;}&#xA;//Multiple calls to createUZcomplex depending on multi-value parameters&#xA;function createUZcomplexZpv(consistencyRule, correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=Math.floor(parameters[1].length/2); //how many activities are there in the rule&#xA;var lastElement as EA.Element;&#xA;	&#xA;	lastElement=null;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1[1][0]=parameters[1][2*n]; //if the partition is empty&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;				parameter1[1][0]=&quot;User&quot;;&#xA;		parameter1[1][1]=parameters[1][2*n+1]; //if the action is empty&#xA;		if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;			parameter1[1][1]=(n+1)+&quot;. Action&quot;;&#xA;		connectors[2][0]=lastElement;&#xA;		lastElement=createUZcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from system use case diagram to system use case realization diagram&#xA;function createUZcomplex(consistencyRule, correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var otherDiagObjects = [];&#xA;	var otherElements = [];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var region as EA.Element;&#xA;	&#xA;	//UauZpv&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	if(conns[0]==null||conns[0].length&lt;=0||conns[0][1].Type!=&quot;UseCase&quot;||conns[0][1].Name==&quot;&quot;||conns[0][1].Name==&quot; &quot;)&#xA;		return;&#xA;	packages=getTargetPackage(thePackage,&quot;SUCRD&quot;,conns[0][1].Name,consistencyRule,conns);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for SUCRD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;&#xA;	//Setting the names of the desired elements&#xA;	if(correctCR.substr(correctCR.indexOf(&quot;U&quot;)+2,1)==&quot;u&quot;) {//UauZpv&#xA;		nameOfElement1=&quot;ActivityPartition&quot;;&#xA;		nameOfElement2=&quot;Action&quot;;&#xA;	} else { //BuaApv&#xA;		nameOfElement2=&quot;ActivityPartition&quot;;&#xA;		nameOfElement1=&quot;Action&quot;;&#xA;	}&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0);&#xA;	//pattern-driven rule in nameElement2 - UauZpv({pattern})&#xA;	if(nameElement2.substr(0,2)==&quot;{{&quot; &amp;&amp; nameElement2.substr(nameElement2.length-2,2)==&quot;}}&quot;) {&#xA;		var namePattern=nameElement2.substr(2);&#xA;		namePattern=namePattern.substr(0,namePattern.length-2);&#xA;		if(namePattern.substr(namePattern.length-8)!=&quot;FrontEnd&quot;)&#xA;			namePattern+=&quot;FrontEnd&quot;;		&#xA;		// Fetch XML content from URL&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;);&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		var nameOfPckg = &quot;&quot;;&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			//retrieve package name&#xA;			nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;);&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			activityPartitions=retrieveXMLNames(xmlContent, &quot;ActivityPartition&quot;, &quot;alias&quot;, &quot;UML:ActionState name=&quot;,0); //Retrieve partition names&#xA;			activityPartitions=activityPartitions.sort();&#xA;			objectClasses=retrieveXMLNames(xmlContent, &quot;classname&quot;, &quot;stateflags&quot;, 'keywords&quot; value=', 1); //Retrieve objectclass names - option B: &quot;keywords&quot;, &quot;UML:ClassifierRole name=&quot;, 0&#xA;			objectClasses=objectClasses.sort();&#xA;			var project = Repository.GetProjectInterface();&#xA;			//Import the XMI file into the current model, download package content to subpackage&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1);&#xA;			subPackage.Packages.Refresh();&#xA;			if(result==null)&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null)&#xA;				return;&#xA;			//moving elements from the changed pattern to the current package&#xA;			var sourceAction=null;&#xA;			if(conns[0][1]!=null) {&#xA;				for( var i=0; i&lt;conns[0][1].Connectors.Count; i++) {&#xA;					var connector=conns[0][1].Connectors.GetAt(i);&#xA;					//Session.Output(&quot;createUZcomplex: connector=&quot;+connector.Type+&quot; &lt;&quot;+connector.Alias+&quot;&gt;&quot;); &#xA;					if(connector.Type==&quot;Dependency&quot;&amp;&amp;connector.Alias==&quot;ApUau&quot;) { //can be an Actor?&#xA;						sourceAction=Repository.GetElementByID(connector.ClientID);&#xA;						//Session.Output(&quot;createUZcomplex: sourceAction=&quot;+sourceAction.Type+&quot; ;&quot;+sourceAction.Name+&quot;&gt;&quot;); &#xA;						if(sourceAction.Type==&quot;Action&quot;||sourceAction.Type==&quot;Activity&quot;)&#xA;							break;&#xA;						sourceAction=null;&#xA;					}&#xA;				}&#xA;			}&#xA;			var moving=renamePatternObjects(consistencyRule, correctCR, &quot; &quot;, sourceAction, objectClasses, activityPartitions, subPackage, subChildPackage); //Rename partitions according to the values &#8203;&#8203;given in the partition rule parameter&#xA;			if(subChildPackage !=null&amp;&amp;moving) //moving partitions from the changed pattern to the current package&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			else&#xA;				changePatternPackage(consistencyRule, &quot; &quot;, sourceAction, objectClasses, activityPartitions, subPackage); //change the name of partitions&#xA;			if(testDiagram.DiagramObjects.Count==0) {&#xA;				var nameOfDiagram = testDiagram.Name;&#xA;				for(var i=0;i&lt;subPackage.Diagrams.Count;i++) {&#xA;					if((subPackage.Diagrams.GetAt(i)).Name==nameOfDiagram) {&#xA;						subPackage.Diagrams.Delete(i);&#xA;						break;&#xA;					}&#xA;				}&#xA;				subPackage.Diagrams.Refresh();&#xA;				testDiagram=subPackage.Diagrams.GetAt(0);&#xA;				testDiagram.Name=nameOfDiagram;&#xA;				testDiagram.Update();&#xA;			}&#xA;			return;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML for the pattern &lt;&quot;+namePattern+&quot; from URL: &quot; + xhr.statusText);&#xA;		}&#xA;	}&#xA;	//Diagram Search&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	//searching for future diagram objects in the target diagram&#xA;	desiredDiagObjects=getDesiredDiagObjects(diagramObjects,nameElement1, nameElement2, null);&#xA;	if(desiredDiagObjects!=null) {&#xA;		diagramObject1=desiredDiagObjects[0];&#xA;		diagramObject2=desiredDiagObjects[1];		&#xA;	} &#xA;	&#xA;	//Package Search&#xA;	var delements as EA.Collection;&#xA;	delements = subPackage.Elements;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = conns[2][0];&#xA;	var desiredPackElements=getDesiredPackElements(delements, nameElement1, nameElement2, null);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];	&#xA;		//activityPartitions = desiredPackElements[3];&#xA;	} &#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;p&quot;) { //UauZpv&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;ActivityPartition&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;SUCRD&quot;,&quot;ActivityPartition&quot;,nameElement1))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);	&#xA;				setCRDependency(correctCR,correctCR,conns[0][1],testElement);	&#xA;			} &#xA;			delement1=testElement;&#xA;		} &#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //UauZpv&#xA;				if(nameElement2==&quot;Initial&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;StateNode&quot; ); &#xA;					testElement.Subtype==100;&#xA;				} else&#xA;				if(nameElement2==&quot;Final&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;StateNode&quot; ); &#xA;					testElement.Subtype=101;&#xA;				}&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameElement2, &quot;Action&quot; ); &#xA;				testElement.ParentID=delement1.ElementID;&#xA;				//testElement = delement1.Elements.AddNew( nameElement2, &quot;Activity&quot; );&#xA;				if((tagValue=getTagValueforElement(&quot;SUCRD&quot;,&quot;Action&quot;,nameElement2))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][1],testElement);&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	} &#xA;	if(delement3!=null) { //???&#xA;		var connector as EA.Connector;&#xA;		var connector1 as EA.Connector;&#xA;		connector=null;&#xA;		connector1=null;&#xA;		for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;			connector=delement2.Connectors.GetAt(i);&#xA;			if(connector.Type==&quot;ControlFlow&quot;) {&#xA;				if(connector.ClientID&gt;0&amp;&amp;connector.ClientID!=delement2.ElementID&amp;&amp;connector.ClientID==delement3.ElementID) {&#xA;					connector1=connector;&#xA;					break;&#xA;				}&#xA;			}			&#xA;		}&#xA;		if(connector1==null) {&#xA;			connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;			connector.SupplierID = delement2.ElementID;&#xA;			connector.Update();&#xA;			delement3.Update();	&#xA;			delement2.Update();			&#xA;		}&#xA;	}&#xA;	var diagramObject1new=false;&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		&#xA;		if(delement1!=null&amp;&amp;delement1.Type==&quot;ActivityPartition&quot;) {&#xA;			if(delement1.Name==&quot;User&quot;) {&#xA;				var left=50;&#xA;				var top=-50;&#xA;			} else {&#xA;				var left=250;&#xA;				var top=-50;&#xA;			}&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			var existElementObject as EA.Element;&#xA;			for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;				existDiagramObject=diagramObjects.GetAt(i);&#xA;				if(existDiagramObject.ElementID&gt;0)&#xA;					existElementObject=Repository.GetElementByID(existDiagramObject.ElementID);&#xA;				else&#xA;					existElementObject=null;&#xA;				if(existElementObject!=null&amp;&amp;existDiagramObject.ElementID!=delement2.ElementID) {&#xA;					if(existElementObject.Type==&quot;ActivityPartition&quot;) {&#xA;						if(existElementObject.Name==&quot;User&quot;) {&#xA;							left=existDiagramObject.right;&#xA;							top=existDiagramObject.top;&#xA;						} else {&#xA;							left=existDiagramObject.left-200;&#xA;							top=existDiagramObject.top;&#xA;						}&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left;&#xA;			testDiagramObject.right=left+200;&#xA;			testDiagramObject.top=top;&#xA;			testDiagramObject.bottom=top-350;&#xA;			var textStyle=testDiagramObject.Style;&#xA;			if(textStyle.indexOf(&quot;VPartition=&quot;)&gt;-1) {&#xA;				if(textStyle.indexOf(&quot;VPartition=0&quot;)&gt;-1) {&#xA;					textStyle.replace(&quot;VPartition=0&quot;,&quot;VPartition=1&quot;);&#xA;					testDiagramObject.Style=textStyle;&#xA;				}&#xA;			} else &#xA;				testDiagramObject.Style=testDiagramObject.Style+&quot;VPartition=1;&quot;;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;			diagramObject1new=true;&#xA;		} &#xA;	}&#xA;	var left=diagramObject1.left+(diagramObject1.right-diagramObject1.left)/2;&#xA;	var top=diagramObject1.top-100;&#xA;	var topOther=diagramObject1.top-100;&#xA;	if(diagramObject2==null) {&#xA;		var diagramObjects as EA.Collection;&#xA;		&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		diagramObjects.Refresh();&#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;Activity&quot;||delement2.Type==&quot;Action&quot;||delement2.Type==&quot;StateNode&quot;)) {&#xA;			if(delement2.ParentID==delement1.ElementID) {&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;		&#xA;				//if there are other elements in the partition, we should set the left edge of the action to the right of the last element of the partition&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null&amp;&amp;existElementObject.ParentID==delement1.ElementID&amp;&amp;&#xA;						(existElementObject.Type==&quot;Activity&quot;||existElementObject.Type==&quot;Action&quot;||existElementObject.Type==&quot;Object&quot;||&#xA;						 existElementObject.Type==&quot;Event&quot;||existElementObject.Type==&quot;StateNode&quot;||existElementObject.Type==&quot;Decision&quot;||existElementObject.Type==&quot;MergeNode&quot;)) {&#xA;						if(existDiagramObject.left&gt;diagramObject1.left&amp;&amp;existDiagramObject.right&lt;diagramObject1.right&amp;&amp;existDiagramObject.top&lt;diagramObject1.top&amp;&amp;existDiagramObject.bottom&gt;diagramObject1.bottom&amp;&amp;&#xA;							existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;						if(top&lt;diagramObject1.bottom+50) {&#xA;							diagramObject1.bottom=top-100;&#xA;							diagramObject1.Update();&#xA;						}&#xA;					} else&#xA;					if(existElementObject!=null&amp;&amp;delement2.ParentID&gt;0&amp;&amp;existElementObject.ParentID!=delement2.ParentID&amp;&amp;&#xA;						(existElementObject.Type==&quot;Activity&quot;||existElementObject.Type==&quot;Action&quot;)) {&#xA;						if(existDiagramObject.top&lt;=topOther)&#xA;							topOther=existDiagramObject.top;&#xA;					}&#xA;				}				&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2.Type==&quot;StateNode&quot;) {&#xA;				testDiagramObject.left=left-15;&#xA;				testDiagramObject.right=left+15;&#xA;				if(delement2.Name==&quot;Initial&quot;) {&#xA;					testDiagramObject.top=diagramObject1.top-40;  //-15;&#xA;					testDiagramObject.bottom=diagramObject1.top-70;  //-60;&#xA;				} else {&#xA;					testDiagramObject.top=top-10;  //-15;&#xA;					testDiagramObject.bottom=top-40;  //-60;&#xA;				}&#xA;			} else {&#xA;				testDiagramObject.left=left-35;&#xA;				testDiagramObject.right=left+35;&#xA;				if(topOther&lt;top) {&#xA;					testDiagramObject.top=topOther;  //-15;&#xA;					testDiagramObject.bottom=topOther-45;  //-60;&#xA;				} else {&#xA;					testDiagramObject.top=top;  //-15;&#xA;					testDiagramObject.bottom=top-45;  //-60;&#xA;				}&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;		} &#xA;	} else { &#xA;		if(delement2!=null&amp;&amp;(delement2.Type==&quot;Activity&quot;||delement2.Type==&quot;Action&quot;||delement2.Type==&quot;StateNode&quot;)) {&#xA;			if(delement2.ParentID==delement1.ElementID) { //if delement2 is the part of the partition&#xA;				//if delement2 is placed outside the partition&#xA;				if(diagramObject2.left&lt;diagramObject1.left||diagramObject2.right&gt;diagramObject1.right|| &#xA;					diagramObject2.top&gt;diagramObject1.top||diagramObject2.bottom&lt;diagramObject1.bottom) {&#xA;					//setting the left border inside the partition	&#xA;					var left1=setLeftBorderOfPartition(diagramObjects, diagramObject1);&#xA;					if(left1&gt;left)&#xA;						left=left1;&#xA;					diagramObject2.left=left+100;&#xA;					diagmObject2.Update();&#xA;				}&#xA;				//placingElementOfAction(delement2, diagramObjects, diagramObject1, diagramObject2,0); //comment?&#xA;			}&#xA;		}&#xA;	}&#xA;	return delement2;&#xA;}&#xA;//Multiple calls to createCZcomplex depending on multi-value parameters&#xA;function createCZcomplexZvi(consistencyRule, correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var parameter11;&#xA;var parameter31;&#xA;var parameter12;&#xA;var parameter32;&#xA;var pathToPackage;&#xA;var lastElement as EA.Element;&#xA;	&#xA;	iteration=Math.floor(iteration);&#xA;	pathToPackage=parameters.pop();&#xA;	lastElement=null;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1.push(pathToPackage);&#xA;		parameter1[1][0]=parameters[1][2*n+1];&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;			parameter1[1][0]=(n+1)+&quot;. Action&quot;;&#xA;		parameter11=parameters[1][2*n];&#xA;		if(parameter11==null||parameter11==&quot;&quot;||parameter11==&quot; &quot;)&#xA;			parameter11=&quot;:&quot;+connectors[0][0].Name;&#xA;		parameter31=parameters[3][2*n];&#xA;		parameter12=parameters[1][2*n+2];&#xA;		if(parameter12==null||parameter12==&quot;&quot;||parameter12==&quot; &quot;)&#xA;			parameter12=&quot;:&quot;+connectors[0][0].Name;&#xA;		parameter32=parameters[3][2*n+2];&#xA;		do {&#xA;			if(parameter11.indexOf(&quot;,&quot;)&gt;0) {&#xA;				parameter1[1][1]=parameter11.substr(0,parameter11.indexOf(&quot;,&quot;));&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter11=parameter11.substr(parameter11.indexOf(&quot;,&quot;)+1);&#xA;				parameter1[3][1]=parameter31.substr(0,parameter31.indexOf(&quot;,&quot;));&#xA;				parameter31=parameter31.substr(parameter31.indexOf(&quot;,&quot;)+1);&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter11.length&gt;0)&#xA;					parameter11=parameter11+&quot;,&quot;;&#xA;				if(parameter31.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter31.length&gt;0)&#xA;					parameter31=parameter31+&quot;,&quot;;&#xA;			} else {&#xA;				parameter1[1][1]=parameter11;&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter1[3][1]=parameter31;&#xA;			}&#xA;			do {&#xA;				if(parameter12.indexOf(&quot;,&quot;)&gt;0) {&#xA;					parameter1[1][2]=parameter12.substr(0,parameter12.indexOf(&quot;,&quot;));&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter12=parameter12.substr(parameter12.indexOf(&quot;,&quot;)+1);&#xA;					parameter1[3][2]=parameter32.substr(0,parameter32.indexOf(&quot;,&quot;));&#xA;					parameter32=parameter32.substr(parameter32.indexOf(&quot;,&quot;)+1);&#xA;					if(parameter12.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.length&gt;0)&#xA;						parameter12=parameter12+&quot;,&quot;;&#xA;					if(parameter32.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter32.length&gt;0)&#xA;						parameter32=parameter32+&quot;,&quot;;&#xA;				} else {&#xA;					parameter1[1][2]=parameter12;&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter1[3][2]=parameter32;&#xA;				}&#xA;				connectors[2][0]=lastElement;&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.indexOf(&quot;,&quot;)&lt;0)&#xA;					lastElement=createCZcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,1);&#xA;				else&#xA;					lastElement=createCZcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,0);&#xA;			} while(parameter12.indexOf(&quot;,&quot;)&gt;0);	&#xA;		} while(parameter11.indexOf(&quot;,&quot;)&gt;0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from business class diagram to system use case realization diagram&#xA;function createCZcomplex(consistencyRule, correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var targetDiagram;&#xA;	var activityPartitions = [];	&#xA;	&#xA;	targetDiagram==null;&#xA;	conns = connectors1;&#xA;	if(parameters.length&lt;=4)&#xA;		return;&#xA;	targetDiagram=parameters.pop();&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;SUCRD&quot;,targetDiagram,consistencyRule,conns);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for SUCRD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Action&quot;;&#xA;	nameOfElement2=&quot;Object&quot;;&#xA;	nameOfElement3=&quot;Object&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0); &#xA;	//pattern-driven rule in nameElement1 - CchZiv({{pattern}})&#xA;	//Session.Output(&quot;createCZcomplex: nameElement1=&lt;&quot;+nameElement1+&quot;&gt;; nameElement2=&lt;&quot;+nameElement2+&quot;&gt;&quot;);&#xA;	if(nameElement1.substr(0,2)==&quot;{{&quot; &amp;&amp; nameElement1.substr(nameElement1.length-2,2)==&quot;}}&quot;) {&#xA;		var namePattern=nameElement1.substr(2); //Retrieve name pattern from the first parameter&#xA;		namePattern=namePattern.substr(0,namePattern.length-2);		&#xA;		if(namePattern.substr(namePattern.length-8)!=&quot;FrontEnd&quot;)&#xA;			namePattern+=&quot;FrontEnd&quot;;	&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;); // Fetch XML content from URL&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			var nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;); //Retrieve package name&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			activityPartitions=retrieveXMLNames(xmlContent, &quot;ActivityPartition&quot;, &quot;alias&quot;, &quot;UML:ActionState name=&quot;,0); //Retrieve partition names&#xA;			activityPartitions=activityPartitions.sort();&#xA;			objectClasses=retrieveXMLNames(xmlContent, &quot;classname&quot;, &quot;stateflags&quot;, 'keywords&quot; value=', 1); //Retrieve objectclass names - option B: &quot;keywords&quot;, &quot;UML:ClassifierRole name=&quot;, 0&#xA;			objectClasses=objectClasses.sort();&#xA;			var project = Repository.GetProjectInterface();&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1); //the imported package&#xA;			if(result==null) //something wrong with the imported package&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null) //something wrong with the imported package&#xA;				return;&#xA;			var moving=renamePatternObjects(consistencyRule, correctCR, nameElement2, conns[0][0], objectClasses, null, subPackage, subChildPackage); //Rename object classes according to the values &#8203;&#8203;given in the objectClasses parameter&#xA;			if(subChildPackage !=null&amp;&amp;moving) //changing the object class in a higher package&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			else&#xA;				changePatternPackage(consistencyRule, nameElement1, conns[0][0], objectClasses, activityPartitions, subPackage); //change the class of objects&#xA;			if(testDiagram.DiagramObjects.Count==0) {&#xA;				var nameOfDiagram = testDiagram.Name;&#xA;				for(var i=0;i&lt;subPackage.Diagrams.Count;i++) {&#xA;					if((subPackage.Diagrams.GetAt(i)).Name==nameOfDiagram) {&#xA;						subPackage.Diagrams.Delete(i);&#xA;						break;&#xA;					}&#xA;				}&#xA;				subPackage.Diagrams.Refresh();&#xA;				testDiagram=subPackage.Diagrams.GetAt(0);&#xA;				testDiagram.Name=nameOfDiagram;&#xA;				testDiagram.Update();&#xA;			}&#xA;			return;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML from URL: &quot; + xhr.staxtusText);&#xA;		}&#xA;	}&#xA;	//Searching the target package&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredObjectElements(subPackage, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;		activityPartitions=desiredPackElements[3];&#xA;	} &#xA;	if(conns[2][0]!=null)&#xA;		delement3 = conns[2][0];&#xA;	//Searching the target diagram&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;	&#xA;&#xA;	if(delement1!=null)&#xA;		diagramObject1=searchedObjectinDiagram(subPackage, delement1);&#xA;	if(delement2!=null)&#xA;		diagramObject2=searchedObjectinDiagram(subPackage, delement2);	&#xA;	if(delement3!=null)&#xA;		diagramObject3=searchedObjectinDiagram(subPackage, delement3);&#xA;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //CchZiv&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Action&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;SUCRD&quot;,&quot;Action&quot;,nameElement1))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				delement1new=true;&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;			} &#xA;			delement1=testElement;&#xA;		} //else it means that this element is outside of current package&#xA;	}&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //CchZiv&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement2;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;) {&#xA;					if(params[3][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][1].substr(0,params[3][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][1];&#xA;				} else&#xA;				if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][0].substr(0,params[2][0].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][0];&#xA;				} else &#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} &#xA;				if(nameOfObject==&quot;Start&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype==100;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				if((tagValue=getTagValueforElement(&quot;SUCRD&quot;,&quot;Object&quot;,nameOfObject+&quot;[&quot;+nameOfState+&quot;]&quot;+&quot;:&quot;+nameOfClass))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][1],testElement);&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //CchZiv&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement3;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;) {&#xA;					if(params[3][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][2].substr(0,params[3][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][2];&#xA;				} else&#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(params[2][1]!=null&amp;&amp;params[2][1]!=&quot;&quot;&amp;&amp;params[2][1]!=&quot; &quot;) {&#xA;					if(params[2][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][1].substr(0,params[2][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][1];&#xA;				} &#xA;				if(nameOfObject==&quot;End&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype=101;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				if((tagValue=getTagValueforElement(&quot;SUCRD&quot;,&quot;Object&quot;,nameOfObject+&quot;[&quot;+nameOfState+&quot;]&quot;+&quot;:&quot;+nameOfClass))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][2],testElement);&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the input element and the middle element&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //CchZiv&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i); //a nie delement2?&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement2.Name==&quot;Start&quot;)&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement2.ElementID;&#xA;				connector.Update();&#xA;				delement1.Update();	&#xA;				delement2.Connectors.Refresh();&#xA;				delement1.Connectors.Refresh();&#xA;			}	&#xA;			//a connection must be created between the element to which the input element is connected at the output and the middle element&#xA;			var tmpObject as EA.Element;&#xA;			tmpObject=null;&#xA;			for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;				var connector1=delement2.Connectors.GetAt(i);&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement2.ElementID&amp;&amp;connector1.ClientID!=delement1.ElementID) {&#xA;					tmpObject=Repository.GetElementByID(connector1.ClientID);&#xA;					if(tmpObject.Type==&quot;Action&quot; ||tmpObject.Type==&quot;Activity&quot;)					&#xA;						break; //The input object is connected as an output object to another action&#xA;					else&#xA;						tmpObject=null;&#xA;				}&#xA;			}&#xA;			if(tmpObject!=null) {&#xA;				//you need to check if this connection already exists&#xA;				for(i=0;i&lt;tmpObject.Connectors.Count;i++) {&#xA;					var connector1=tmpObject.Connectors.GetAt(i);&#xA;					if(connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==tmpObject.ElementID) {&#xA;						tmpObject=null;&#xA;						break;&#xA;					}&#xA;				}&#xA;				if(tmpObject!=null) {&#xA;					connector = tmpObject.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;					connector.SupplierID = delement1.ElementID;&#xA;					connector.Update();&#xA;					tmpObject.Update();		&#xA;				}					&#xA;			}&#xA;		}&#xA;	}&#xA;	//a connection must be created between the middle element and the output element&#xA;	if(delement1!=null&amp;&amp;delement3!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //CchZiv&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i);&#xA;				if(delement3.Name!=&quot;End&quot;&amp;&amp;connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID||&#xA;				   delement3.Name==&quot;End&quot;&amp;&amp;connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement3.Name==&quot;End&quot;)&#xA;					connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement1.ElementID;&#xA;				connector.Update();&#xA;				delement3.Update();	&#xA;				delement1.Connectors.Refresh();&#xA;				delement3.Connectors.Refresh();&#xA;			}	&#xA;		}&#xA;	}&#xA;	//Add elements to the diagram&#xA;	var left=100;&#xA;	var top=-100;&#xA;	var thisActivityPartition as EA.DiagramObject;&#xA;	thisActivityPartition=null;&#xA;	if(delement1.ParentID&gt;0) {&#xA;		for( var i = 0; i &lt; testDiagram.DiagramObjects.Count; i++) {&#xA;			if((testDiagram.DiagramObjects.GetAt(i)).ElementID==delement1.ParentID) {&#xA;				thisActivityPartition=testDiagram.DiagramObjects.GetAt(i);&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(thisActivityPartition!=null) { &#xA;			left=thisActivityPartition.left+(thisActivityPartition.right-thisActivityPartition.left)/2;&#xA;			top=thisActivityPartition.top-100;&#xA;		}&#xA;	}&#xA;	if(diagramObject1==null) {&#xA;		var diagramObjects as EA.Collection;&#xA;		&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		diagramObjects.Refresh();&#xA;		if(delement1!=null&amp;&amp;(delement1.Type==&quot;Activity&quot;||delement1.Type==&quot;Action&quot;)) {&#xA;			if(thisActivityPartition!=null&amp;&amp;delement1.ParentID==thisActivityPartition.ElementID) {  //if the action is in the Activitypatition&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;		&#xA;				//if there are other elements in the partition, we should set the left edge of the action to the right of the last element of the partition&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null&amp;&amp;existElementObject.ParentID==thisActivityPartition.ElementID&amp;&amp;&#xA;						(existElementObject.Type==&quot;Activity&quot;||existElementObject.Type==&quot;Action&quot;||existElementObject.Type==&quot;Object&quot;||&#xA;						 existElementObject.Type==&quot;Event&quot;||existElementObject.Type==&quot;StateNode&quot;||existElementObject.Type==&quot;Decision&quot;||existElementObject.Type==&quot;MergeNode&quot;)) {&#xA;						if(existDiagramObject.left&gt;thisActivityPartition.left&amp;&amp;existDiagramObject.right&lt;thisActivityPartition.right&amp;&amp;&#xA;							existDiagramObject.top&lt;thisActivityPartition.top&amp;&amp;existDiagramObject.bottom&gt;thisActivityPartition.bottom&amp;&amp;existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;						if(top&lt;diagramObject1.bottom+50) {&#xA;							thisActivityPartition.bottom=top-100;&#xA;							thisActivityPartition.Update();&#xA;						}&#xA;					}&#xA;				}				&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			testDiagramObject.left=left-35;&#xA;			testDiagramObject.right=left+35;&#xA;			testDiagramObject.top=top;  //-15;&#xA;			testDiagramObject.bottom=top-45;  //-60;&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;&#xA;		} &#xA;	} else { &#xA;		if(delement1!=null&amp;&amp;(delement1.Type==&quot;Activity&quot;||delement1.Type==&quot;Action&quot;)) {&#xA;			if(thisActivityPartition!=null&amp;&amp;delement1.ParentID==thisActivityPartition.ElementID) { //if delement1 is the part of the partition&#xA;				//if delement1 is placed outside the partition&#xA;				if(diagramObject1.left&lt;thisActivityPartition.left||diagramObject1.right&gt;thisActivityPartition.right|| &#xA;					diagramObject1.top&gt;thisActivityPartition.top||diagramObject1.bottom&lt;thisActivityPartition.bottom) {&#xA;					//setting the left border inside the partition	&#xA;					var left1=setLeftBorderOfPartition(diagramObjects, thisActivityPartition);&#xA;					if(left1&gt;left)&#xA;						left=left1;&#xA;					diagramObject1.left=left+100;&#xA;					diagmObject1.Update();&#xA;				}&#xA;				//placingElementOfAction(delement2, diagramObjects, diagramObject1, diagramObject2,0); //comment?&#xA;			}&#xA;		}&#xA;	}&#xA;	if(diagramObject2==null) {&#xA;		// Add the element2 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null) {&#xA;			var left=diagramObject1.right;&#xA;			var top=diagramObject1.bottom;&#xA;			if(delement2.ParentID&gt;0) {&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ ) {&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==delement2.ParentID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;						if(top-50&lt;partycjaObjTmp.bottom) {&#xA;							partycjaObjTmp.bottom=top-100;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}			&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2.Name==&quot;Start&quot;) { //InitialNode&#xA;				testDiagramObject.left=left-70;&#xA;				testDiagramObject.right=left-40;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-34;&#xA;			} else {			&#xA;				testDiagramObject.left=left+50;&#xA;				testDiagramObject.right=left+120;&#xA;				testDiagramObject.top=top-13;&#xA;				testDiagramObject.bottom=top-50;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;		}&#xA;	} &#xA;	if(diagramObject3==null) {&#xA;		// Add the element3 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null) {&#xA;			var left=diagramObject1.right;&#xA;			var top=diagramObject1.top;&#xA;			if(delement3.ParentID&gt;0) {&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ ) {&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==delement3.ParentID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				testDiagramObject.left=left+145;&#xA;				testDiagramObject.right=left+175;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-33;&#xA;			} else {&#xA;				testDiagramObject.left=left+50;&#xA;				testDiagramObject.right=left+120;&#xA;				testDiagramObject.top=top+50;&#xA;				testDiagramObject.bottom=top+13;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	} else {&#xA;		var left=diagramObject1.right;&#xA;		var top=diagramObject1.top;&#xA;		if(delement3.ParentID&gt;0) {&#xA;			diagramObject=null;&#xA;			for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;			{&#xA;				var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;				if(partycjaObjTmp.ElementID==delement3.ParentID) {&#xA;					diagramObject=partycjaObjTmp;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(diagramObject!=null) {&#xA;				if(diagramObject3.left&lt;diagramObject.left||diagramObject3.right&gt;diagramObject.right||diagramObject3.top&gt;diagramObject.top||diagramObject3.bottom&lt;diagramObject.bottom) {&#xA;					if(delement3.Name==&quot;End&quot;) {&#xA;						diagramObject3.left=left+145;&#xA;						diagramObject3.right=left+175;&#xA;						diagramObject3.top=top-3;&#xA;						diagramObject3.bottom=top-33;&#xA;					} else {&#xA;						diagramObject3.left=left+50;&#xA;						diagramObject3.right=left+120;&#xA;						diagramObject3.top=top+50;&#xA;						diagramObject3.bottom=top+13;&#xA;					}&#xA;					diagramObject3.Update();					&#xA;				}&#xA;			}&#xA;		} else {&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				diagramObject3.left=left+145;&#xA;				diagramObject3.right=left+175;&#xA;				diagramObject3.top=top-3;&#xA;				diagramObject3.bottom=top-33;&#xA;			} else {&#xA;				diagramObject3.left=left+50;&#xA;				diagramObject3.right=left+120;&#xA;				diagramObject3.top=top+50;&#xA;				diagramObject3.bottom=top+13;&#xA;			}&#xA;			diagramObject3.Update();				&#xA;		}&#xA;	}&#xA;	return delement2;&#xA;}&#xA;//Multiple calls to createSZcomplex depending on multi-value parameters&#xA;function createSZcomplexZiv(consistencyRule, correctCR, thePackage, parameters, connectors) {&#xA;var parameter1 = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];	&#xA;var iteration=parameters[1].length/2; //how many activities are there in the rule&#xA;var parameter11;&#xA;var parameter31;&#xA;var parameter12;&#xA;var parameter32;&#xA;var pathToPackage;&#xA;var lastElement as EA.Element;&#xA;	&#xA;	iteration=Math.floor(iteration);&#xA;	pathToPackage=parameters.pop();&#xA;	lastElement=null;&#xA;	for(var n=0; n&lt;iteration; n++) {&#xA;		parameter1.push(pathToPackage);&#xA;		parameter1[1][0]=parameters[1][2*n+1];&#xA;		if(parameter1[1][0]==null||parameter1[1][0]==&quot;&quot;||parameter1[1][0]==&quot; &quot;)&#xA;			parameter1[1][0]=(n+1)+&quot;. Action&quot;;&#xA;		parameter11=parameters[1][2*n];&#xA;		if(parameter11==null||parameter11==&quot;&quot;||parameter11==&quot; &quot;)&#xA;			parameter11=&quot;:&quot;+connectors[0][0].Name;&#xA;		parameter32=parameters[3][2*n];&#xA;		parameter12=parameters[1][2*n+2];&#xA;		if(parameter12==null||parameter12==&quot;&quot;||parameter12==&quot; &quot;)&#xA;			parameter12=&quot;:&quot;+connectors[0][0].Name;&#xA;		parameter31=parameters[3][2*n+2];&#xA;		do {&#xA;			if(parameter11.indexOf(&quot;,&quot;)&gt;0) {&#xA;				parameter1[1][1]=parameter11.substr(0,parameter11.indexOf(&quot;,&quot;));&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter11=parameter11.substr(parameter11.indexOf(&quot;,&quot;)+1);&#xA;				parameter1[3][1]=parameter31.substr(0,parameter31.indexOf(&quot;,&quot;));&#xA;				parameter31=parameter31.substr(parameter31.indexOf(&quot;,&quot;)+1);&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter11.length&gt;0)&#xA;					parameter11=parameter11+&quot;,&quot;;&#xA;				if(parameter31.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter31.length&gt;0)&#xA;					parameter31=parameter31+&quot;,&quot;;&#xA;			} else {&#xA;				parameter1[1][1]=parameter11;&#xA;				if(parameter1[1][1]==null||parameter1[1][1]==&quot;&quot;||parameter1[1][1]==&quot; &quot;)&#xA;					parameter1[1][1]=&quot;Object&quot;+(2*n+1);&#xA;				parameter1[3][1]=parameter31;&#xA;			}&#xA;			do {&#xA;				if(parameter12.indexOf(&quot;,&quot;)&gt;0) {&#xA;					parameter1[1][2]=parameter12.substr(0,parameter12.indexOf(&quot;,&quot;));&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter12=parameter12.substr(parameter12.indexOf(&quot;,&quot;)+1);&#xA;					parameter1[3][2]=parameter32.substr(0,parameter32.indexOf(&quot;,&quot;));&#xA;					parameter32=parameter32.substr(parameter32.indexOf(&quot;,&quot;)+1);&#xA;					if(parameter12.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.length&gt;0)&#xA;						parameter12=parameter12+&quot;,&quot;;&#xA;					if(parameter32.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter32.length&gt;0)&#xA;						parameter32=parameter32+&quot;,&quot;;&#xA;				} else {&#xA;					parameter1[1][2]=parameter12;&#xA;					if(parameter1[1][2]==null||parameter1[1][2]==&quot;&quot;||parameter1[1][2]==&quot; &quot;)&#xA;						parameter1[1][2]=&quot;Object&quot;+(2*n+2);&#xA;					parameter1[3][2]=parameter32;&#xA;				}&#xA;				connectors[2][0]=lastElement;&#xA;				if(parameter11.indexOf(&quot;,&quot;)&lt;0&amp;&amp;parameter12.indexOf(&quot;,&quot;)&lt;0)&#xA;					lastElement=createSZcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,1);&#xA;				else&#xA;					lastElement=createSZcomplex(consistencyRule, correctCR, thePackage, parameter1, connectors,0);&#xA;			} while(parameter12.indexOf(&quot;,&quot;)&gt;0);	&#xA;		} while(parameter11.indexOf(&quot;,&quot;)&gt;0);&#xA;	} &#xA;}&#xA;//Create target elements in composite consistency rule from business state machine state diagram to system use case realization diagram&#xA;function createSZcomplex(consistencyRule, correctCR, thePackage, parameters, connectors1) {&#xA;	var packages = [ null,null];&#xA;	var subPackage as EA.Package;&#xA;	var testDiagram as EA.Diagram;	&#xA;	var conns = [ [null,null,null], [null,null],];	&#xA;	var params = [ [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], [&quot; &quot;, &quot; &quot;, &quot; &quot;], ];&#xA;	var nameElement1, nameElement2, nameElement3;&#xA;	var targetDiagram;&#xA;	var activityPartitions = [];	&#xA;	&#xA;	targetDiagram==null;&#xA;	conns = connectors1;&#xA;	if(parameters.length&lt;=4)&#xA;		return;&#xA;	targetDiagram=parameters.pop();&#xA;	conns = connectors1;&#xA;	params = parameters;&#xA;	packages=getTargetPackage(thePackage,&quot;SUCRD&quot;,targetDiagram,consistencyRule,conns);&#xA;	if(packages[0]==null||packages[1]==null) {&#xA;		Session.Output(&quot;Unknown error while creating subpackages for SUCRD&quot;);&#xA;		return;&#xA;	}&#xA;	subPackage=packages[0];&#xA;	testDiagram=packages[1];&#xA;	var diagramObjects as EA.Collection;&#xA;    diagramObjects = testDiagram.DiagramObjects;&#xA;	//Setting the names of the desired elements&#xA;	nameOfElement1=&quot;Action&quot;;&#xA;	nameOfElement2=&quot;Object&quot;;&#xA;	nameOfElement3=&quot;Object&quot;;&#xA;	//setting values &#8203;&#8203;in rule parameters&#xA;	nameElement1=setParameterValue(parameters, conns, 0, nameOfElement1, 0);&#xA;	nameElement2=setParameterValue(parameters, conns, 1, nameOfElement2, 0); &#xA;	nameElement3=setParameterValue(parameters, conns, 2, nameOfElement3, 0); &#xA;	//pattern-driven rule in nameElement1 - CchZiv({{pattern}})&#xA;	if(nameElement1.substr(0,2)==&quot;{{&quot; &amp;&amp; nameElement1.substr(nameElement1.length-2,2)==&quot;}}&quot;) {&#xA;		var namePattern=nameElement1.substr(2); //Retrieve name pattern from the first parameter&#xA;		namePattern=namePattern.substr(0,namePattern.length-2);		&#xA;		if(namePattern.substr(namePattern.length-8)!=&quot;FrontEnd&quot;)&#xA;			namePattern+=&quot;FrontEnd&quot;;	&#xA;		var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;); // Fetch XML content from URL&#xA;		xhr.open(&quot;GET&quot;, &quot;https://raw.githubusercontent.com/consistencyrules/pattern/main/&quot;+namePattern+&quot;.xml&quot;, false);&#xA;		xhr.send();&#xA;		if (xhr.status == 200) {&#xA;			var xmlContent = xhr.responseText;&#xA;			var nameOfPckg=retrieveXMLElement(xmlContent,&quot;UML:Package name=&quot;); //Retrieve package name&#xA;			if(nameOfPckg==&quot;&quot;) {&#xA;				Session.Output(&quot;Empty name of Package for &quot;+namePattern);&#xA;				return;&#xA;			}&#xA;			activityPartitions=retrieveXMLNames(xmlContent, &quot;ActivityPartition&quot;, &quot;alias&quot;, &quot;UML:ActionState name=&quot;,0); //Retrieve partition names&#xA;			activityPartitions=activityPartitions.sort();&#xA;			objectClasses=retrieveXMLNames(xmlContent, &quot;classname&quot;, &quot;stateflags&quot;, 'keywords&quot; value=', 1); //Retrieve objectclass names - option B: &quot;keywords&quot;, &quot;UML:ClassifierRole name=&quot;, 0&#xA;			objectClasses=objectClasses.sort();&#xA;			var project = Repository.GetProjectInterface();&#xA;			var result = project.ImportPackageXMI(subPackage.PackageGUID, xmlContent, 1, 1); //the imported package&#xA;			if(result==null) //something wrong with the imported package&#xA;				return;&#xA;			subChildPackage=Repository.GetPackageByGuid(result);&#xA;			if(subChildPackage==null) //something wrong with the imported package&#xA;				return;&#xA;			var moving=renamePatternObjects(consistencyRule, correctCR, nameElement2, conns[0][0], objectClasses, activityPartitions, subPackage, subChildPackage); //Rename object classes according to the values &#8203;&#8203;given in the objectClasses parameter&#xA;			if(subChildPackage !=null&amp;&amp;moving) //moving partitions from the changed pattern to the current package&#xA;				movePatternPackage(subPackage, subChildPackage);&#xA;			else&#xA;				changePatternPackage(consistencyRule, nameElement2, conns[0][0], objectClasses, activityPartitions, subPackage); //change the class of objects and their states&#xA;			if(testDiagram.DiagramObjects.Count==0) {&#xA;				var nameOfDiagram = testDiagram.Name;&#xA;				for(var i=0;i&lt;subPackage.Diagrams.Count;i++) {&#xA;					if((subPackage.Diagrams.GetAt(i)).Name==nameOfDiagram) {&#xA;						subPackage.Diagrams.Delete(i);&#xA;						break;&#xA;					}&#xA;				}&#xA;				subPackage.Diagrams.Refresh();&#xA;				testDiagram=subPackage.Diagrams.GetAt(0);&#xA;				testDiagram.Name=nameOfDiagram;&#xA;				testDiagram.Update();&#xA;			}&#xA;			return;			&#xA;		} else {&#xA;			Session.Output(&quot;Failed to fetch XML from URL: &quot; + xhr.staxtusText);&#xA;		}&#xA;	}&#xA;	//Searching the target package&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	//searching for future package elements in the target package&#xA;	desiredPackElements=getDesiredObjectElements(subPackage, nameElement1, nameElement2, nameElement3);&#xA;	if(desiredPackElements!=null) {&#xA;		delement1=desiredPackElements[0];&#xA;		delement2=desiredPackElements[1];		&#xA;		delement3=desiredPackElements[2];	&#xA;		activityPartitions=desiredPackElements[3];&#xA;	} &#xA;	if(conns[2][0]!=null)&#xA;		delement3 = conns[2][0];&#xA;	//Searching the target diagram&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;	&#xA;&#xA;	if(delement1!=null)&#xA;		diagramObject1=searchedObjectinDiagram(subPackage, delement1);&#xA;	if(delement2!=null)&#xA;		diagramObject2=searchedObjectinDiagram(subPackage, delement2);	&#xA;	if(delement3!=null)&#xA;		diagramObject3=searchedObjectinDiagram(subPackage, delement3);&#xA;&#xA;	if(delement1==null&amp;&amp;nameElement1!=null&amp;&amp;nameElement1!=&quot;&quot;&amp;&amp;nameElement1!=&quot; &quot;) { //There is no element1 in the package&#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject1==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;) { //SrsZiv&#xA;				testElement = subPackage.Elements.AddNew( nameElement1, &quot;Action&quot; ); &#xA;				if((tagValue=getTagValueforElement(&quot;SUCRD&quot;,&quot;Action&quot;,nameElement1))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				diagramObject1=null; //diagramObject1 is not already a previously created element&#xA;				delement1new=true;&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;			} &#xA;			delement1=testElement;&#xA;		} //else it means that this element is outside of current package&#xA;	}&#xA;	if(delement2!=null) {&#xA;		var stateObject=null;&#xA;		var nameOfState=null;&#xA;		&#xA;		stateObject=getStatesOfObject(delement2);		&#xA;		if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;			nameOfState=stateObject;	&#xA;		if(nameOfState==null) {//set the state of the current object&#xA;			if(nameElement2.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement2.indexOf(&quot;]&quot;)&gt;nameElement2.indexOf(&quot;[&quot;))&#xA;				nameOfState=nameElement2.substr(nameElement2.indexOf(&quot;[&quot;)+1,nameElement2.indexOf(&quot;]&quot;)-nameElement2.indexOf(&quot;[&quot;)-1);&#xA;			else&#xA;			if(params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;)&#xA;				nameOfState=params[3][1];&#xA;			if(nameOfState!=null&amp;&amp;nameOfState!=&quot;&quot;&amp;&amp;nameOfState!=&quot; &quot;) {&#xA;				var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+delement2.ElementID;&#xA;				Repository.Execute(sqlCommand);					&#xA;			}&#xA;		} else {&#xA;			if(nameElement2.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement2.indexOf(&quot;]&quot;)&gt;nameElement2.indexOf(&quot;[&quot;)&amp;&amp;&#xA;				nameElement2.substr(nameElement2.indexOf(&quot;[&quot;)+1,nameElement2.indexOf(&quot;]&quot;)-nameElement2.indexOf(&quot;[&quot;)-1)!=nameOfState||&#xA;				params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;&amp;&amp;nameOfState!=params[3][1]) //the found element has the other state&#xA;				delement2=null; //a new element&#xA;		}&#xA;	}	&#xA;	if(delement2==null&amp;&amp;nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject2==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //SrsZiv&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement2;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(nameOfObject.indexOf(&quot;[&quot;)&lt;nameOfObject.indexOf(&quot;]&quot;)) {&#xA;					nameOfState=nameOfObject.substr(nameOfObject.indexOf(&quot;[&quot;)+1,nameOfObject.indexOf(&quot;]&quot;)-nameOfObject.indexOf(&quot;[&quot;)-1);&#xA;					var nameOfObject1=nameOfObject.substr(0,nameOfObject.indexOf(&quot;[&quot;))+nameOfObject.substr(nameOfObject.indexOf(&quot;]&quot;)+1);&#xA;					nameOfObject=nameOfObject1;&#xA;				}&#xA;				if(params[3][1]!=null&amp;&amp;params[3][1]!=&quot;&quot;&amp;&amp;params[3][1]!=&quot; &quot;) {&#xA;					if(params[3][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][1].substr(0,params[3][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][1];&#xA;				} else&#xA;				if(params[2][0]!=null&amp;&amp;params[2][0]!=&quot;&quot;&amp;&amp;params[2][0]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][0].substr(0,params[2][0].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][0];&#xA;				} else &#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(conns[0][0]!=null) {&#xA;					var stateObject=getStatesOfObject(conns[0][0]);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				} else&#xA;				if(conns[0][2]!=null) {&#xA;					var stateObject=getStatesOfObject(conns[0][0]);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				}&#xA;				if(nameOfObject==&quot;Start&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype==100;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				if((tagValue=getTagValueforElement(&quot;SUCRD&quot;,&quot;Object&quot;,nameOfObject+&quot;[&quot;+nameOfState+&quot;]&quot;+&quot;:&quot;+nameOfClass))!=null) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=testElement.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}&#xA;				testElement.Update();&#xA;				if(nameOfState!=null&amp;&amp;nameOfObject!=&quot;Start&quot;) {&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);					&#xA;				}&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;			} 	&#xA;			delement2=testElement;&#xA;		} &#xA;	}&#xA;	if(delement3!=null) {&#xA;		var stateObject=null;&#xA;		var nameOfState=null;&#xA;		&#xA;		stateObject=getStatesOfObject(delement3);&#xA;		if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;			nameOfState=stateObject;	&#xA;		if(nameOfState==null) {//set the state of the current object&#xA;			if(nameElement3.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement3.indexOf(&quot;]&quot;)&gt;nameElement3.indexOf(&quot;[&quot;))&#xA;				nameOfState=nameElement3.substr(nameElement3.indexOf(&quot;[&quot;)+1,nameElement3.indexOf(&quot;]&quot;)-nameElement3.indexOf(&quot;[&quot;)-1);&#xA;			else&#xA;			if(params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;)&#xA;				nameOfState=params[3][2];&#xA;			if(nameOfState!=null&amp;&amp;nameOfState!=&quot;&quot;&amp;&amp;nameOfState!=&quot; &quot;) {&#xA;				var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+delement3.ElementID;&#xA;				Repository.Execute(sqlCommand);					&#xA;			}&#xA;		} else {&#xA;			if(nameElement3.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement3.indexOf(&quot;]&quot;)&gt;nameElement3.indexOf(&quot;[&quot;)&amp;&amp;&#xA;				nameElement3.substr(nameElement3.indexOf(&quot;[&quot;)+1,nameElement3.indexOf(&quot;]&quot;)-nameElement3.indexOf(&quot;[&quot;)-1)!=nameOfState||&#xA;				params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;&amp;&amp;nameOfState!=params[3][2]) //the found element has the other state&#xA;				delement3=null; //a new element&#xA;		}&#xA;	}	&#xA;	var delement3new=false;&#xA;	if(delement3==null&amp;&amp;nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;) { &#xA;		// Create elements&#xA;		var testElement as EA.Element;&#xA;		testElement=null;&#xA;		if(diagramObject3==null) {&#xA;			if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //SrsZiv&#xA;				var nameOfClass;&#xA;				var testOfClass=null;&#xA;				var nameOfObject=nameElement3;&#xA;				var nameOfState;&#xA;				if(nameOfObject.indexOf(&quot;:&quot;)&gt;-1) {&#xA;					nameOfClass = nameOfObject.substr(nameOfObject.indexOf(&quot;:&quot;)+1);&#xA;					nameOfObject=nameOfObject.substr(0,nameOfObject.indexOf(&quot;:&quot;));&#xA;					testOfClass=searchForElement(subPackage, nameOfClass, &quot;Class&quot;);&#xA;					if(testOfClass==null)&#xA;						testOfClass = subPackage.Elements.AddNew(nameOfClass, &quot;Class&quot;);&#xA;				}&#xA;				if(nameOfObject.indexOf(&quot;[&quot;)&lt;nameOfObject.indexOf(&quot;]&quot;)) {&#xA;					nameOfState=nameOfObject.substr(nameOfObject.indexOf(&quot;[&quot;)+1,nameOfObject.indexOf(&quot;]&quot;)-nameOfObject.indexOf(&quot;[&quot;)-1);&#xA;					var nameOfObject1=nameOfObject.substr(0,nameOfObject.indexOf(&quot;[&quot;))+nameOfObject.substr(nameOfObject.indexOf(&quot;]&quot;)+1);&#xA;					nameOfObject=nameOfObject1;&#xA;				} else&#xA;				if(params[3][2]!=null&amp;&amp;params[3][2]!=&quot;&quot;&amp;&amp;params[3][2]!=&quot; &quot;) {&#xA;					if(params[3][2].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[3][2].substr(0,params[3][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[3][2];&#xA;				} else&#xA;				if(params[2][2]!=null&amp;&amp;params[2][2]!=&quot;&quot;&amp;&amp;params[2][2]!=&quot; &quot;) {&#xA;					if(params[2][0].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][2].substr(0,params[2][2].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][2];&#xA;				} else &#xA;				if(params[2][1]!=null&amp;&amp;params[2][1]!=&quot;&quot;&amp;&amp;params[2][1]!=&quot; &quot;) {&#xA;					if(params[2][1].indexOf(&quot;,&quot;)&gt;-1)&#xA;						nameOfState=params[2][1].substr(0,params[2][1].indexOf(&quot;,&quot;));&#xA;					else&#xA;						nameOfState=params[2][1];&#xA;				} else &#xA;				if(conns[0][2]!=null) {&#xA;					var stateObject=getStatesOfObject(conns[0][2]);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				} else&#xA;				if(conns[0][0]!=null) {&#xA;					var stateObject=getStatesOfObject(conns[0][2]);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfState=stateObject;&#xA;				}&#xA;				if(nameOfObject==&quot;End&quot;) {&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;StateNode&quot; );&#xA;					testElement.Subtype=101;&#xA;				}					&#xA;				else&#xA;					testElement = subPackage.Elements.AddNew( nameOfObject, &quot;Object&quot; ); &#xA;				if(nameOfClass!=null&amp;&amp;testOfClass!=null) &#xA;					testElement.ClassifierID=testOfClass.ElementID;&#xA;				if(delement1!=null)&#xA;					testElement.ParentID=delement1.ParentID;&#xA;				testElement.Update();&#xA;				if(nameOfState!=null) {&#xA;					var sqlCommand=&quot;update t_object set StateFlags = '&quot;+nameOfState+&quot;' where object_id = &quot;+testElement.ElementID;&#xA;					Repository.Execute(sqlCommand);					&#xA;				}&#xA;				delement3new=true;&#xA;				setCRDependency(consistencyRule,correctCR,conns[0][0],testElement);&#xA;			} 	&#xA;			delement3=testElement;&#xA;		} &#xA;	}&#xA;	//a connection must be created between the input element and the middle element&#xA;	if(delement1!=null&amp;&amp;delement2!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //SrsZvi&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i); //a nie delement2?&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.ClientID==delement1.ElementID&amp;&amp;connector1.SupplierID==delement2.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement2.Name==&quot;Start&quot;)&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement1.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement2.ElementID;&#xA;				connector.Update();&#xA;				delement1.Update();	&#xA;			}	&#xA;			//a connection must be created between the element to which the input element is connected at the output and the middle element&#xA;			var tmpObject as EA.Element;&#xA;			tmpObject=null;&#xA;			for(i=0;i&lt;delement2.Connectors.Count;i++) {&#xA;				var connector1=delement2.Connectors.GetAt(i);&#xA;				if(connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement2.ElementID&amp;&amp;connector1.ClientID!=delement1.ElementID) {&#xA;					tmpObject=Repository.GetElementByID(connector1.ClientID);&#xA;					if(tmpObject.Type==&quot;Action&quot; ||tmpObject.Type==&quot;Activity&quot;)					&#xA;						break; //The input object is connected as an output object to another action&#xA;					else&#xA;						tmpObject=null;&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	//a connection must be created between the middle element and the output element&#xA;	if(delement1!=null&amp;&amp;delement3!=null) {&#xA;		if(correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+2,1)==&quot;v&quot;&amp;&amp;correctCR.substr(correctCR.indexOf(&quot;Z&quot;)+1,1)==&quot;i&quot;) { //RiviAvi&#xA;			var connector as EA.Connector;&#xA;			connector=null;&#xA;			for(i=0;i&lt;delement1.Connectors.Count;i++) {&#xA;				var connector1=delement1.Connectors.GetAt(i);&#xA;				if(delement3.Name!=&quot;End&quot;&amp;&amp;connector1.Type==&quot;ObjectFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID||&#xA;				   delement3.Name==&quot;End&quot;&amp;&amp;connector1.Type==&quot;ControlFlow&quot;&amp;&amp;connector1.Name==&quot;&quot;&amp;&amp;connector1.SupplierID==delement1.ElementID&amp;&amp;connector1.ClientID==delement3.ElementID) {&#xA;					connector=connector1;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(connector==null) {&#xA;				if(delement3.Name==&quot;End&quot;)&#xA;					connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ControlFlow&quot;);&#xA;				else&#xA;					connector = delement3.Connectors.AddNew(&quot;&quot;, &quot;ObjectFlow&quot;);&#xA;				connector.SupplierID = delement1.ElementID;&#xA;				connector.Update();&#xA;				delement3.Update();	&#xA;				delement1.Connectors.Refresh();&#xA;				delement3.Connectors.Refresh();&#xA;			}	&#xA;		}&#xA;	}&#xA;	var left=100;&#xA;	var top=-100;&#xA;	var thisActivityPartition as EA.DiagramObject;&#xA;	thisActivityPartition=null;&#xA;	if(delement1.ParentID&gt;0) {&#xA;		for( var i = 0; i &lt; testDiagram.DiagramObjects.Count; i++) {&#xA;			if((testDiagram.DiagramObjects.GetAt(i)).ElementID==delement1.ParentID) {&#xA;				thisActivityPartition=testDiagram.DiagramObjects.GetAt(i);&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(thisActivityPartition!=null) { &#xA;			left=thisActivityPartition.left+(thisActivityPartition.right-thisActivityPartition.left)/2;&#xA;			top=thisActivityPartition.top-100;&#xA;		}&#xA;	}&#xA;	//Add elements to the diagram&#xA;	if(diagramObject1==null) {&#xA;		// Add the element1 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement1!=null) {&#xA;			var ifPartition=false;&#xA;			var existDiagramObject as EA.DiagramObject;&#xA;			if(delement3new==false&amp;&amp;delement1new==true&amp;&amp;delement3.ParentID&gt;0) {&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID==delement3.ParentID) {&#xA;						left=existDiagramObject.left+75; //25; //right=left+100&#xA;						top=existDiagramObject.top-(existDiagramObject.top-existDiagramObject.bottom)/2+23; //bottom=top-45&#xA;						ifPartition=true;&#xA;						break;&#xA;					}&#xA;				}					&#xA;			} 	&#xA;			if(!ifPartition) //true-delement3 was in the partition&#xA;				delement1new=true;&#xA;			if(delement1new) { //new element&#xA;				var existDiagramObject as EA.DiagramObject;&#xA;				var existElementObject as EA.Element;&#xA;				for(i=0;i&lt;diagramObjects.Count;i++) {&#xA;					existDiagramObject=diagramObjects.GetAt(i);&#xA;					if(existDiagramObject.ElementID&gt;0)&#xA;						existElementObject =Repository.GetElementByID(existDiagramObject.ElementID);&#xA;					else&#xA;						existElementObject=null;&#xA;					if(existElementObject!=null) {&#xA;						if(existDiagramObject.bottom&lt;top)&#xA;							top=existDiagramObject.bottom-50;&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement1.ElementID );&#xA;			if(ifPartition&amp;&amp;diagramObject3!=null) {//delement3 was here in the Partition&#xA;				testDiagramObject.left=diagramObject3.left-100;//left;&#xA;				testDiagramObject.right=diagramObject3.left-20; //left+80;&#xA;				testDiagramObject.top=diagramObject3.top; //top;&#xA;				testDiagramObject.bottom=diagramObject3.bottom; //top-40;&#xA;				delement1.ParentID=delement3.ParentID;		&#xA;				delement1.Update();&#xA;			} else {&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+80;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-40;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject1=testDiagramObject;			&#xA;		}  else {&#xA;			Session.Output(&quot;Error at identifying element1-8486 line&quot;);&#xA;			return;&#xA;		}		&#xA;	} &#xA;	if(diagramObject2==null) {&#xA;		// Add the element2 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement2!=null) {&#xA;			var left=diagramObject1.right;&#xA;			var top=diagramObject1.bottom;&#xA;			if(delement2.ParentID&gt;0) {&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ ) {&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==delement2.ParentID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;						if(top-50&lt;partycjaObjTmp.bottom) {&#xA;							partycjaObjTmp.bottom=top-100;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}			&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement2.ElementID );&#xA;			if(delement2.Name==&quot;Start&quot;) { //InitialNode&#xA;				testDiagramObject.left=left-70;&#xA;				testDiagramObject.right=left-40;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-34;&#xA;			} else {			&#xA;				testDiagramObject.left=left+50;&#xA;				testDiagramObject.right=left+120;&#xA;				testDiagramObject.top=top-13;&#xA;				testDiagramObject.bottom=top-50;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject2=testDiagramObject;&#xA;		}&#xA;	} &#xA;	if(diagramObject3==null) {&#xA;		// Add the element3 to the diagram and positioning it&#xA;		var diagramObjects as EA.Collection;&#xA;		diagramObjects = testDiagram.DiagramObjects;&#xA;		if(delement3!=null) {&#xA;			var left=diagramObject1.right;&#xA;			var top=diagramObject1.top;&#xA;			if(delement3.ParentID&gt;0) {&#xA;				for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ ) {&#xA;					var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;					if(partycjaObjTmp.ElementID==delement3.ParentID) {&#xA;						if(left+195&gt;partycjaObjTmp.right) {&#xA;							partycjaObjTmp.right=left+195;&#xA;							partycjaObjTmp.Update();&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}&#xA;			var testDiagramObject as EA.DiagramObject;&#xA;			testDiagramObject = diagramObjects.AddNew( &quot;&quot;, &quot;&quot; );&#xA;			testDiagramObject.ElementID( delement3.ElementID );&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				testDiagramObject.left=left+145;&#xA;				testDiagramObject.right=left+175;&#xA;				testDiagramObject.top=top-3;&#xA;				testDiagramObject.bottom=top-33;&#xA;			} else {&#xA;				testDiagramObject.left=left+50;&#xA;				testDiagramObject.right=left+120;&#xA;				testDiagramObject.top=top+50;&#xA;				testDiagramObject.bottom=top+13;&#xA;			}&#xA;			testDiagramObject.Update();&#xA;			diagramObject3=testDiagramObject;&#xA;		}&#xA;	} else {&#xA;		var left=diagramObject1.right;&#xA;		var top=diagramObject1.top;&#xA;		if(delement3.ParentID&gt;0) {&#xA;			diagramObject=null;&#xA;			for ( var i = 0 ; i &lt; diagramObjects.Count ; i++ )&#xA;			{&#xA;				var partycjaObjTmp=diagramObjects.GetAt(i);&#xA;				if(partycjaObjTmp.ElementID==delement3.ParentID) {&#xA;					diagramObject=partycjaObjTmp;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(diagramObject!=null) {&#xA;				if(diagramObject3.left&lt;diagramObject.left||diagramObject3.right&gt;diagramObject.right||diagramObject3.top&gt;diagramObject.top||diagramObject3.bottom&lt;diagramObject.bottom) {&#xA;					if(delement3.Name==&quot;End&quot;) {&#xA;						diagramObject3.left=left+145;&#xA;						diagramObject3.right=left+175;&#xA;						diagramObject3.top=top-3;&#xA;						diagramObject3.bottom=top-33;&#xA;					} else {&#xA;						diagramObject3.left=left+50;&#xA;						diagramObject3.right=left+120;&#xA;						diagramObject3.top=top+50;&#xA;						diagramObject3.bottom=top+13;&#xA;					}&#xA;					diagramObject3.Update();					&#xA;				}&#xA;			}&#xA;		} else {&#xA;			if(delement3.Name==&quot;End&quot;) {&#xA;				diagramObject3.left=left+145;&#xA;				diagramObject3.right=left+175;&#xA;				diagramObject3.top=top-3;&#xA;				diagramObject3.bottom=top-33;&#xA;			} else {&#xA;				diagramObject3.left=left+50;&#xA;				diagramObject3.right=left+120;&#xA;				diagramObject3.top=top+50;&#xA;				diagramObject3.bottom=top+13;&#xA;			}&#xA;			diagramObject3.Update();				&#xA;		}&#xA;	}&#xA;	return delement2;&#xA;}&#xA;//Return of source action mapping the implementation UC&#xA;function getSourceActionOfSysUC(implementationUC) {&#xA;var sourceAction=null;&#xA;var internalUC=implementationUC;&#xA;&#xA;	//Session.Output(&quot;getSourceActionOfSysUC(1):Type=&quot;+internalUC.Type);&#xA;	if(internalUC.Type==&quot;UseCase&quot;) {&#xA;		var nameOfIntUC=internalUC.Name;&#xA;		while(nameOfIntUC.substr(0,1)&gt;=&quot;0&quot;&amp;&amp;nameOfIntUC.substr(0,1)&lt;=&quot;9&quot;||nameOfIntUC.substr(0,1)==&quot;.&quot;||nameOfIntUC.substr(0,1)==&quot; &quot;)&#xA;			nameOfIntUC=nameOfIntUC.substr(1);	&#xA;		if(nameOfIntUC!=&quot;&quot;) {&#xA;			var sourceElement=null;&#xA;			for(var n=0;internalUC.Connectors.Count;n++) {&#xA;				var connector as EA.Connector;&#xA;				connector=internalUC.Connectors.GetAt(n);&#xA;				if(connector.Type==&quot;Dependency&quot;&amp;&amp;connector.Alias==&quot;ZpvYu&quot;) {&#xA;					sourceElement=Repository.GetElementByID(connector.ClientID);&#xA;					if(sourceElement.Type==&quot;ActivityPartition&quot;)&#xA;						break;&#xA;					if(sourceElement.Type==&quot;Action&quot;||sourceElement.Type==&quot;Activity&quot;) {&#xA;						var nameOfAction=sourceElement.Name;&#xA;						while(nameOfAction.substr(0,1)&gt;=&quot;0&quot;&amp;&amp;nameOfAction.substr(0,1)&lt;=&quot;9&quot;||nameOfAction.substr(0,1)==&quot;.&quot;||nameOfAction.substr(0,1)==&quot; &quot;)&#xA;							nameOfAction=nameOfAction.substr(1);	&#xA;						if(nameOfAction==nameOfIntUC) {&#xA;							sourceAction=sourceElement;&#xA;							break;&#xA;						}&#xA;					}&#xA;				}&#xA;			}&#xA;			if(sourceAction==null&amp;&amp;sourceElement!=null) {&#xA;				if(sourceElement.Type==&quot;ActivityPartition&quot;) {&#xA;					for(var n=0; n&lt;sourceElement.Elements.Count; n++) {&#xA;						var tmpAction=Repository.GetElementByID((sourceElement.Elements.GetAt(n)).ElementID);&#xA;						if(tmpAction.Type==&quot;Action&quot;||tmpAction.Type==&quot;Activity&quot;) {&#xA;							var nameOfAction=tmpAction.Name;&#xA;							while(nameOfAction.substr(0,1)&gt;=&quot;0&quot;&amp;&amp;nameOfAction.substr(0,1)&lt;=&quot;9&quot;||nameOfAction.substr(0,1)==&quot;.&quot;||nameOfAction.substr(0,1)==&quot; &quot;)&#xA;								nameOfAction=nameOfAction.substr(1);	&#xA;							if(nameOfAction==nameOfIntUC) {&#xA;								sourceAction=tmpAction;&#xA;								break;&#xA;							}&#xA;						}&#xA;					}&#xA;				}  &#xA;			} &#xA;		} &#xA;	} //else //Actor&#xA;	return sourceAction;&#xA;}&#xA;//Return input and output elements from/to action mapping implementation use case&#xA;function getObjectsOfAction(action) {&#xA;var instanceClasses = [];&#xA;&#xA;	//Session.Output(&quot;getObjectsOfAction(0): action.Connectors.Count=&quot;+action.Connectors.Count);&#xA;	for(var i=0;i&lt;action.Connectors.Count;i++) {&#xA;		connector=action.Connectors.GetAt(i);&#xA;		//Session.Output(&quot;getObjectsOfAction(1): action.Connectors(&quot;+i+&quot;).type=&quot;+action.Connectors.GetAt(i).Type+&quot;; ClientID=&quot;+connector.ClientID+&quot;; SupplierID&quot;+connector.SupplierID);&#xA;		if(connector.Type==&quot;ObjectFlow&quot;) {&#xA;			if(connector.ClientID!=action.ElementID) {//input connector&#xA;				var sourceObject=Repository.GetElementByID(connector.ClientID);&#xA;				//Session.Output(&quot;getObjectsOfAction(2): sourceObject.Type=&quot;+sourceObject.Type);&#xA;				if(sourceObject.Type==&quot;Object&quot;) {&#xA;					for(var j=0; j&lt;instanceClasses.length;j++)&#xA;						if(instanceClasses[j][1]==sourceObject.ClassifierID&amp;&amp;instanceClasses[j][0]==11)&#xA;								instanceClasses[j][0]=&quot;05&quot;;&#xA;					instanceClasses.push([&quot;01&quot;,sourceObject.ClassifierID,sourceObject.ElementID]);&#xA;					//Session.Output(&quot;getObjectsOfAction(6a):instanceClasses.length=&quot;+instanceClasses.length);&#xA;				} else &#xA;				if(sourceObject.ClassifierID&gt;0) {&#xA;					for(var j=0; j&lt;instanceClasses.length;j++)&#xA;						if(instanceClasses[j][1]==sourceObject.ClassifierID&amp;&amp;instanceClasses[j][0]==10)&#xA;							instanceClasses[j][0]=&quot;06&quot;;&#xA;					instanceClasses.push([&quot;02&quot;,sourceObject.ClassifierID,sourceObject.ElementID]);&#xA;					//Session.Output(&quot;getObjectsOfAction(6b):instanceClasses.length=&quot;+instanceClasses.length);&#xA;				} else {&#xA;					for(var j=0; j&lt;instanceClasses.length;j++)&#xA;						if(instanceClasses[j][2]==sourceObject.ElementID&amp;&amp;instanceClasses[j][0]==9) &#xA;							instanceClasses[j][0]=&quot;07&quot;;&#xA;					instanceClasses.push([&quot;03&quot;,0,sourceObject.ElementID]);&#xA;					//Session.Output(&quot;getObjectsOfAction(6c):instanceClasses.length=&quot;+instanceClasses.length);&#xA;				}&#xA;			} else&#xA;			if(connector.SupplierID!=action.ElementID) {&#xA;				var sourceObject=Repository.GetElementByID(connector.SupplierID);&#xA;				//Session.Output(&quot;getObjectsOfAction(3): sourceObject.Type=&quot;+sourceObject.Type);&#xA;				if(sourceObject.Type==&quot;Object&quot;) {&#xA;					var itIs=false;&#xA;					for(var j=0; j&lt;instanceClasses.length;j++)&#xA;						if(instanceClasses[j][1]==sourceObject.ClassifierID&amp;&amp;(instanceClasses[j][0]==&quot;01&quot;||instanceClasses[j][0]==&quot;05&quot;))&#xA;							itIs=true;&#xA;					instanceClasses.push([(itIs?&quot;05&quot;:&quot;11&quot;),sourceObject.ClassifierID,sourceObject.ElementID]);&#xA;					//Session.Output(&quot;getObjectsOfAction(6d):instanceClasses.length=&quot;+instanceClasses.length);&#xA;				} else if(sourceObject.ClassifierID&gt;0) {&#xA;					var itIs=false;&#xA;					for(var j=0; j&lt;instanceClasses.length;j++)&#xA;						if(instanceClasses[j][1]==sourceObject.ClassifierID&amp;&amp;(instanceClasses[j][0]==&quot;02&quot;||instanceClasses[j][0]==&quot;06&quot;))&#xA;							itIs=true;&#xA;					instanceClasses.push([(itIs?&quot;06&quot;:&quot;10&quot;),sourceObject.ClassifierID,sourceObject.ElementID]);&#xA;					//Session.Output(&quot;getObjectsOfAction(6e):instanceClasses.length=&quot;+instanceClasses.length);&#xA;				} else {&#xA;					var itIs=false;&#xA;					for(var j=0; j&lt;instanceClasses.length;j++)&#xA;						if(instanceClasses[j][2]==sourceObject.ElementID&amp;&amp;(instanceClasses[j][0]==&quot;03&quot;|instanceClasses[j][0]==&quot;07&quot;))&#xA;							itIs=true;&#xA;					instanceClasses.push([(itIs?&quot;07&quot;:&quot;09&quot;),0,sourceObject.ElementID]);&#xA;					//Session.Output(&quot;getObjectsOfAction(6f):instanceClasses.length=&quot;+instanceClasses.length);&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	//for(var i=0;i&lt;instanceClasses.length;i++)&#xA;		//Session.Output(&quot;A.instanceClasses(&quot;+i+&quot;):&lt;&quot;+instanceClasses[i][0]+&quot;,&quot;+instanceClasses[i][1]+&quot;,&quot;+instanceClasses[i][2]+&quot;&gt;&quot;);&#xA;	instanceClasses=instanceClasses.sort();&#xA;	//for(var i=0;i&lt;instanceClasses.length;i++)&#xA;		//Session.Output(&quot;B.instanceClasses(&quot;+i+&quot;):&lt;&quot;+instanceClasses[i][0]+&quot;,&quot;+instanceClasses[i][1]+&quot;,&quot;+instanceClasses[i][2]+&quot;&gt;&quot;);&#xA;	return instanceClasses;&#xA;}&#xA;//Write a consistency rule dependency&#xA;function setCRDependency(consistencyRule,correctCR,source,target,testDiagram) {&#xA;	if(source!=null&amp;&amp;target!=null) {&#xA;		var itIs=false&#xA;		var connector as EA.Connector;&#xA;		for(var i=0;i&lt;source.Connectors.Count;i++) {&#xA;			connector=source.Connectors.GetAt(i);&#xA;			if(connector.ClientID==source.ElementID&amp;&amp;connector.SupplierID==target.ElementID&amp;&amp;connector.Name==consistencyRule&amp;&amp;connector.Type==&quot;Dependency&quot;) {&#xA;				itIs=true;&#xA;				break;&#xA;			}&#xA;		}&#xA;		if(!itIs) {&#xA;			connector = source.Connectors.AddNew(consistencyRule, &quot;Dependency&quot;);&#xA;			connector.SupplierID = target.ElementID;&#xA;			connector.Alias=correctCR;&#xA;			connector.Update();&#xA;			source.Update();&#xA;			if(testDiagram!=null) {&#xA;				for(var i = 0; i&lt;testDiagram.DiagramLinks.Count; i++) {&#xA;					var currentLink as EA.DiagramLink;&#xA;					currentLink = testDiagram.DiagramLinks.GetAt( i );&#xA;					if (currentLink.ConnectorID ==  connector.ConnectorID)&#xA;					{&#xA;						currentLink.IsHidden = true;&#xA;						currentLink.Update();&#xA;						break;&#xA;					}&#xA;				}	&#xA;			}&#xA;		}&#xA;	}	&#xA;}&#xA;//Searching for future package elements in the target diagram&#xA;function getDesiredPackElements(delements, nameElement1, nameElement2, nameElement3, mode) {&#xA;	var activityPartitions = [];&#xA;	var parameters = [ null,null,null,null]&#xA;	var currentElement as EA.Element;&#xA;	var cotoParent as EA.Element;&#xA;	var nameOfElement;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	ifComponent=false;&#xA;	//activityPartitions=null;&#xA;	&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(currentElement.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(currentElement.Type==&quot;Object&quot;) {&#xA;			var nameOfState;&#xA;			nameOfElement=currentElement.Name;&#xA;			var stateObject=getStatesOfObject(currentElement);&#xA;			if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;				nameOfElement=nameOfElement+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;			if(cotoParent!=null)&#xA;				nameOfElement=nameOfElement+&quot;:&quot;+cotoParent.Name;&#xA;		} else&#xA;			nameOfElement=currentElement.Name;&#xA;&#xA;		if(nameOfElement==nameElement1||currentElement.Type==&quot;Component&quot;&amp;&amp;(&quot;:&quot;+nameOfElement==nameElement1))&#xA;			delement1=currentElement;&#xA;		else 		&#xA;		if(nameOfElement==nameElement2)&#xA;			delement2=currentElement;&#xA;		else 		&#xA;		if(nameOfElement==nameElement3||currentElement.Type==&quot;Component&quot;&amp;&amp;(&quot;:&quot;+nameOfElement==nameElement3))&#xA;			delement3=currentElement;&#xA;		if(currentElement.Type==&quot;Component&quot;)&#xA;			ifComponent=true;&#xA;		if(delement1!=null&amp;&amp;delement2!=null&amp;&amp;delement3!=null)&#xA;			break;&#xA;		if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;			var brakDiagObj=false;&#xA;			for(var k = 0; k&lt; activityPartitions.length; k++) {&#xA;				if((activityPartitions[k][0]!=null&amp;&amp;activityPartitions[k][0]).ElementID==currentElement.ElementID) {&#xA;					activityPartitions[k][1]=currentElement;&#xA;					brakDiagObj=true;&#xA;					break;&#xA;				}&#xA;			}&#xA;			if(!brakDiagObj)&#xA;				activityPartitions.push([null, currentElement]);&#xA;			for ( var k = 0 ; k &lt; currentElement.Elements.Count ; k++ )&#xA;			{&#xA;				var currentElement1 as EA.Element;&#xA;				var cotoParent1 as EA.Element;&#xA;				var nameOfElement1;&#xA;&#xA;				currentElement1 = currentElement.Elements.GetAt( k );&#xA;				if(currentElement1.ClassifierID&gt;0)&#xA;					cotoParent1=Repository.GetElementByID(currentElement1.ClassifierID);&#xA;				else&#xA;					cotoParent1=null;&#xA;				if(currentElement1.Type==&quot;Object&quot;) {&#xA;					var nameOfState;&#xA;					nameOfElement1=currentElement1.Name;&#xA;					var stateObject=getStatesOfObject(currentElement1);&#xA;					if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;						nameOfElement1=nameOfElement1+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;					if(cotoParent1!=null)&#xA;						nameOfElement1=nameOfElement1+&quot;:&quot;+cotoParent1.Name;&#xA;				} else&#xA;					nameOfElement1=currentElement1.Name;&#xA;				&#xA;				if(nameOfElement1==nameElement1) //RevBa()u&#xA;					delement1=currentElement1;&#xA;				else 		&#xA;				if(nameOfElement1==nameElement2) //RevBau()&#xA;					delement2=currentElement1;&#xA;				else 		&#xA;				if(nameOfElement1==nameElement3) //RevBau()&#xA;					delement3=currentElement1;&#xA;				if(delement1!=null&amp;&amp;(delement2!=null||nameElement2==null)&amp;&amp;(delement3!=null||nameElement3==null))&#xA;					break;&#xA;				if(currentElement1.Type==&quot;ActivityPartition&quot;) {&#xA;					var brakDiagObj=false;&#xA;					for(var l = 0; m&lt; activityPartitions.length; l++) {&#xA;						if((activityPartitions[l][0]!=null&amp;&amp;activityPartitions[l][0]).ElementID==currentElement.ElementID) {&#xA;							activityPartitions[l][1]=currentElement1;&#xA;							brakDiagObj=true;&#xA;							break;&#xA;						}&#xA;					}&#xA;					if(!brakDiagObj)&#xA;						activityPartitions.push([null, currentElement1]);					&#xA;					for ( var l = 0 ; l &lt; currentElement1.Elements.Count ; l++ )&#xA;					{&#xA;						var currentElement2 as EA.Element;&#xA;						var cotoParent2 as EA.Element;&#xA;						var nameOfElement2;&#xA;						&#xA;						currentElement2 = currentElement1.Elements.GetAt( l );&#xA;						if(currentElement2.ClassifierID&gt;0)&#xA;							cotoParent2=Repository.GetElementByID(currentElement2.ClassifierID);&#xA;						else&#xA;							cotoParent2=null;&#xA;						if(currentElement2.Type==&quot;Object&quot;) {&#xA;							var nameOfState;&#xA;							&#xA;							nameOfElement2=currentElement2.Name;&#xA;							var stateObject=getStatesOfObject(currentElement2);&#xA;							if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;								nameOfElement2=nameOfElement2+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;							if(cotoParent2!=null)&#xA;								nameOfElement2=nameOfElement2+&quot;:&quot;+cotoParent2.Name;&#xA;						} else&#xA;							nameOfElement2=currentElement2.Name;&#xA;						&#xA;						if(nameOfElement2==nameElement1) //RevBa()u&#xA;							delement1=currentElement2;&#xA;						else 		&#xA;						if(nameOfElement2==nameElement2) //RevBau()&#xA;							delement2=currentElement2;&#xA;						else 		&#xA;						if(nameOfElement2==nameElement3) //RevBau()&#xA;							delement3=currentElement2;&#xA;						if(delement1!=null&amp;&amp;(delement2!=null||nameElement2==null)&amp;&amp;(delement3!=null||nameElement3==null))&#xA;							break;						&#xA;					}					&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	if(ifComponent&amp;&amp;delement1!=null&amp;&amp;delement3!=null&amp;&amp;delement2==null) {&#xA;		for(var k = 0; k&lt; delement1.Connectors.Count; k++) {&#xA;			var currentElement as EA.Connector;&#xA;			currentElement=delement1.Connectors.GetAt(k);&#xA;			if(currentElement.ClientID==delement1.ElementID&amp;&amp;currentElement.SupplierID==delement3.ElementID&amp;&amp;currentElement.Name==nameElement2) {&#xA;				delement2=currentElement;&#xA;				break;&#xA;			}&#xA;		}	&#xA;	}			&#xA;	parameters[0]=delement1;&#xA;	parameters[1]=delement2;&#xA;	parameters[2]=delement3;&#xA;	parameters[3]=activityPartitions;&#xA;	return parameters;&#xA;}&#xA;//Searching for future package elements in the target diagram&#xA;function getDesiredPackSequences(delements, nameElement1, nameElement2, nameElement3, mode) {&#xA;	var parameters = [ null,null,null,null]&#xA;	var currentElement as EA.Element;&#xA;	var cotoParent as EA.Element;&#xA;	var nameConnector2;&#xA;	var nameConnector2Parameter;&#xA;	var nameConnector4;&#xA;	var nameConnector4Parameter;&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Connector;&#xA;	var delement3 as EA.Element;&#xA;	var delement4 as EA.Connector;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	delement4 = null;&#xA;	&#xA;	//downLoad&lt;Requests&gt;::Request&#xA;	if(nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;) {&#xA;		if(nameElement2.indexOf(&quot;::&quot;)&gt;-1)&#xA;			nameConnector2 = nameElement2.substr(0,nameElement2.indexOf(&quot;::&quot;));&#xA;		else&#xA;			nameConnector2 = nameElement2;&#xA;		if(nameConnector2.indexOf(&quot;&lt;&quot;)&gt;-1&amp;&amp;nameConnector2.indexOf(&quot;&gt;&quot;)&gt;nameConnector2.indexOf(&quot;&lt;&quot;)) {&#xA;			nameConnector2Parameter = nameConnector2.substr(nameConnector2.indexOf(&quot;&lt;&quot;)+1,nameConnector2.indexOf(&quot;&gt;&quot;)-nameConnector2.indexOf(&quot;&lt;&quot;)-1);&#xA;			nameConnector2 = nameElement2.substr(0,nameElement2.indexOf(&quot;&lt;&quot;));&#xA;		} else&#xA;			nameConnector2Parameter=&quot;&quot;;&#xA;		if(nameElement2.indexOf(&quot;::&quot;)&gt;-1)&#xA;			nameConnector4Parameter=nameElement2.substr(nameElement2.indexOf(&quot;::&quot;)+2);&#xA;		else&#xA;			nameConnector4Parameter=&quot;&quot;;&#xA;	}&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; delements.Count ; j++ )&#xA;	{&#xA;		currentElement = delements.GetAt( j );&#xA;		if(currentElement.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(currentElement.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(currentElement.Type==&quot;Sequence&quot;) {&#xA;			if(cotoParent==null&amp;&amp;currentElement.Name==nameElement1||currentElement.Name+&quot;:&quot;+cotoParent.Name==nameElement1) &#xA;				delement1=currentElement;&#xA;			else 		&#xA;			if(cotoParent==null&amp;&amp;currentElement.Name==nameElement3||currentElement.Name+&quot;:&quot;+cotoParent.Name==nameElement3)&#xA;				delement3=currentElement;&#xA;		}&#xA;	}&#xA;	if(delement1!=null&amp;&amp;delement1.Connectors.Count&gt;0) {&#xA;		for(var k = 0; k&lt; delement1.Connectors.Count; k++) {&#xA;			var connector = delement1.Connectors.GetAt(k);&#xA;			var sqlCommand=&quot;select PDATA4 from t_connector where Connector_ID = &quot;+connector.ConnectorID;&#xA;			var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;			var returnObject=null;&#xA;			if(sqlRespond!=null) {&#xA;				var start = sqlRespond.indexOf(&quot;&lt;PDATA4&gt;&quot;)+8;&#xA;				var koniec= sqlRespond.indexOf(&quot;&lt;/PDATA4&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;PDATA4&gt;&quot;)-8;&#xA;				returnObject=sqlRespond.substr(start, koniec);&#xA;			}&#xA;			if(delement2==null&amp;&amp;(delement3!=null&amp;&amp;connector.Name==nameConnector2&amp;&amp;connector.ClientID==delement1.ElementID&amp;&amp;connector.SupplierID==delement3.ElementID||&#xA;				delement3==null&amp;&amp;connector.Name==nameConnector2&amp;&amp;connector.ClientID==delement1.ElementID&amp;&amp;connector.SupplierID==delement1.ElementID)) //samecall&#xA;				delement2=getDesiredPackSequencesConnectors(connector,returnObject,nameConnector2Parameter);&#xA;			else&#xA;			if(delement4==null&amp;&amp;(delement3!=null&amp;&amp;connector.Name==&quot;&quot;&amp;&amp;connector.ClientID==delement3.ElementID&amp;&amp;connector.SupplierID==delement1.ElementID||&#xA;				delement3==null&amp;&amp;connector.Name==&quot;&quot;&amp;&amp;connector.ClientID==delement1.ElementID&amp;&amp;connector.SupplierID==delement1.ElementID))&#xA;				delement4=getDesiredPackSequencesConnectors(connector,returnObject,nameConnector4Parameter);	&#xA;			if(delement2!=null&amp;&amp;delement4!=null)&#xA;				break;&#xA;		}&#xA;	}&#xA;	if(delement3!=null&amp;&amp;delement3.Connectors.Count&gt;0) {&#xA;		for(var k = 0; k&lt; delement3.Connectors.Count; k++) {&#xA;			if(delement2!=null&amp;&amp;delement4!=null)&#xA;				break;&#xA;			var connector = delement3.Connectors.GetAt(k);&#xA;			var sqlCommand=&quot;select PDATA4 from t_connector where Connector_ID = &quot;+connector.ConnectorID;&#xA;			var sqlRespond=Repository.SQLQuery(sqlCommand);	&#xA;			var returnObject=null;&#xA;			if(sqlRespond!=null) {&#xA;				var start = sqlRespond.indexOf(&quot;&lt;PDATA4&gt;&quot;)+8;&#xA;				var koniec= sqlRespond.indexOf(&quot;&lt;/PDATA4&gt;&quot;)-sqlRespond.indexOf(&quot;&lt;PDATA4&gt;&quot;)-8;&#xA;				returnObject=sqlRespond.substr(start, koniec);&#xA;			}&#xA;			if(delement2!=null&amp;&amp;(delement1!=null&amp;&amp;connector.Name==nameConnector2&amp;&amp;connector.ClientID==delement3.ElementID&amp;&amp;connector.SupplierID==delement1.ElementID||&#xA;				delement1==null&amp;&amp;connector.Name==nameConnector2&amp;&amp;connector.ClientID==delement3.ElementID&amp;&amp;connector.SupplierID==delement3.ElementID))&#xA;				delement2=getDesiredPackSequencesConnectors(connector,returnObject,nameConnector2Parameter);&#xA;			else&#xA;			if(delement4!=null&amp;&amp;(delement1!=null&amp;&amp;connector.Name==&quot;&quot;&amp;&amp;connector.ClientID==delement1.ElementID&amp;&amp;connector.SupplierID==delement3.ElementID||&#xA;				delement1==null&amp;&amp;connector.Name==&quot;&quot;&amp;&amp;connector.ClientID==delement3.ElementID&amp;&amp;connector.SupplierID==delement3.ElementID))&#xA;				delement4=getDesiredPackSequencesConnectors(connector,returnObject,nameConnector4Parameter);		&#xA;		}&#xA;	}	&#xA;	parameters[0]=delement1;&#xA;	parameters[1]=delement2;&#xA;	parameters[2]=delement3;&#xA;	parameters[3]=delement4;&#xA;	return parameters;&#xA;}&#xA;function getDesiredPackSequencesConnectors(connector,returnObject,nameConnectorParameter) {&#xA;	var connParameter=connector.TransitionGuard;&#xA;	&#xA;	if(returnObject!=null&amp;&amp;returnObject!=&quot;&quot;&amp;&amp;returnObject==&quot;0&quot;&amp;&amp;connParameter!=null&amp;&amp;connParameter.indexOf(&quot;paramsDlg=&quot;)&gt;-1) {&#xA;		connParameter=connParameter.substr(connParameter.indexOf(&quot;paramsDlg=&quot;)+10);&#xA;		if(connParameter!=null&amp;&amp;connParameter!=&quot;&quot;)&#xA;			connParameter=connParameter.substr(0,connParameter.indexOf(&quot;;&quot;));&#xA;	} else&#xA;	if(returnObject!=null&amp;&amp;returnObject!=&quot;&quot;&amp;&amp;returnObject==&quot;1&quot;&amp;&amp;connParameter!=null&amp;&amp;connParameter!=&quot;&quot;) {&#xA;		connParameter=connParameter.substr(connParameter.indexOf(&quot;retval=&quot;)+7);&#xA;		if(connParameter!=null&amp;&amp;connParameter!=&quot;&quot;)&#xA;			connParameter=connParameter.substr(0,connParameter.indexOf(&quot;;&quot;));&#xA;	} else&#xA;		connParameter=&quot;&quot;;&#xA;	if(nameConnectorParameter!=null&amp;&amp;nameConnectorParameter!=&quot;&quot;&amp;&amp;connParameter!=null&amp;&amp;connParameter!=&quot;&quot;&amp;&amp;connParameter==nameConnectorParameter||&#xA;		(nameConnectorParameter==null||nameConnectorParameter==&quot;&quot;)&amp;&amp;(connParameter==null||connParameter==&quot;&quot;||connParameter==&quot;null&quot;||connParameter==&quot;void&quot;)) {&#xA;		return connector;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Return all messages from the testDiagram&#xA;function getDesiredDiagramSequences(testDiagram) {&#xA;	var diagramConnectors = [];&#xA;	var diagramConnectors1 = [];&#xA;	var diagramSequences = [];&#xA;	var objectDiagram as EA.DiagramObject;&#xA;	&#xA;	for( var k = 0; k&lt;testDiagram.DiagramObjects.Count; k++) {&#xA;		var objectDiagram=testDiagram.DiagramObjects.GetAt(k);&#xA;		var elementDiagram=Repository.GetElementByID(objectDiagram.ElementID);&#xA;		if(elementDiagram.Type==&quot;Sequence&quot;) {&#xA;			for( var l = 0; l&lt;elementDiagram.Connectors.Count; l++) {&#xA;				var connector=elementDiagram.Connectors.GetAt(l);&#xA;				if(connector.ClientID==elementDiagram.ElementID) {&#xA;					if(connector.SequenceNo&lt;10) {&#xA;						diagramConnectors.push([&quot;0&quot;+connector.SequenceNo, connector]);&#xA;						diagramSequences.push(&quot;0&quot;+connector.SequenceNo);&#xA;					} else {&#xA;						diagramConnectors.push([&quot;&quot;+connector.SequenceNo, connector]);&#xA;						diagramSequences.push(&quot;&quot;+connector.SequenceNo);&#xA;					}&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	//Session.Output(&quot;diagramConnectors(-1):diagramConnectors.length=&quot;+diagramConnectors.length+&quot;; diagramSequences.length=&quot;+diagramSequences.length);&#xA;	if(diagramConnectors.length&lt;=0)&#xA;		return null;&#xA;	//for(var l=0;l&lt;diagramConnectors.length;l++)&#xA;	//	Session.Output(&quot;diagramConnectors(&quot;+l+&quot;):&lt;&quot;+diagramConnectors[l][0]+&quot;,&quot;+diagramConnectors[l][1].ConnectorID+&quot;&gt;&quot;);&#xA;	diagramSequences=diagramSequences.sort();&#xA;	for(var k=0;k&lt;diagramSequences.length;k++) {&#xA;		//Session.Output(&quot;diagramSequences(&quot;+k+&quot;):&lt;&quot;+diagramSequences[k]+&quot;&gt;-diagramConnectors.length=&quot;+diagramConnectors.length);&#xA;		for(var l=0;l&lt;diagramConnectors.length;l++) {&#xA;			if(diagramSequences[k]==diagramConnectors[l][0]) {&#xA;				var removed=diagramConnectors.splice(l,1)&#xA;				diagramConnectors1.push([removed[0][0],removed[0][1]]);&#xA;				//Session.Output(&quot;diagramConnectors1:&lt;&quot;+removed[0][0]+&quot;,&quot;+removed[0][1].ConnectorID+&quot;&gt;&quot;);&#xA;				break;&#xA;			}&#xA;		}&#xA;	}&#xA;	//for(var l=0;l&lt;diagramConnectors1.length;l++)&#xA;	//	Session.Output(&quot;diagramConnectors1(&quot;+l+&quot;):&lt;&quot;+diagramConnectors1[l][0]+&quot;,&quot;+diagramConnectors1[l][1].ConnectorID+&quot;&gt;&quot;);&#xA;&#xA;	return diagramConnectors1;&#xA;}	&#xA;//Searching for future package objects connected to nameElement1 with input as nameElement2 and output as nameElement3&#xA;function getDesiredObjectElements(subPackage, nameElement1, nameElement2, nameElement3) {&#xA;	var parameters = [ null,null,null,null]&#xA;	var delement1 as EA.Element;&#xA;	var delement2 as EA.Element;&#xA;	var delement3 as EA.Element;&#xA;	delement1 = null;&#xA;	delement2 = null;&#xA;	delement3 = null;&#xA;	var activityPartition=[];&#xA;	&#xA;	//Navigate through the set of elements of the target package&#xA;	for ( var j = 0 ; j &lt; subPackage.Elements.Count ; j++ )&#xA;	{&#xA;		var currentElement as EA.Element;&#xA;&#xA;		currentElement = subPackage.Elements.GetAt( j );&#xA;		if(delement1==null&amp;&amp;currentElement.Name==nameElement1)  {//CchZiv&#xA;			delement1=currentElement;&#xA;			//break;&#xA;		}&#xA;		if(currentElement.Type==&quot;ActivityPartition&quot;) {&#xA;			activityPartition.push(currentElement);&#xA;			for ( var k = 0 ; k &lt; currentElement.Elements.Count ; k++ )&#xA;			{&#xA;				var currentElement1 as EA.Element;&#xA;&#xA;				currentElement1 = currentElement.Elements.GetAt( k );&#xA;				if(delement1==null&amp;&amp;currentElement1.Name==nameElement1) {//CchZiv&#xA;					delement1=currentElement1;&#xA;					break;&#xA;				}&#xA;				if(currentElement1.Type==&quot;ActivityPartition&quot;) {&#xA;					activityPartition.push(currentElement1);&#xA;					for ( var l = 0 ; l &lt; currentElement1.Elements.Count ; l++ )&#xA;					{&#xA;						var currentElement2 as EA.Element;&#xA;						&#xA;						currentElement2 = currentElement1.Elements.GetAt( l );&#xA;						if(delement1==null&amp;&amp;currentElement2.Name==nameElement1) { //CchZiv&#xA;							delement1=currentElement2;&#xA;							break;&#xA;						}&#xA;					}					&#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	if(delement1==null)&#xA;		return parameters;&#xA;	parameters[0]=delement1;&#xA;	var tmpObjectIn as EA.Element;&#xA;	var tmpObjectOut as EA.Element;&#xA;	tmpObjectIn=null;&#xA;	tmpObjectOut=null;&#xA;	//Navigate through the set of elements of the target package&#xA;	for( var j = 0; j &lt; delement1.Connectors.Count; j++) {&#xA;		var connector = delement1.Connectors.GetAt(j);&#xA;		&#xA;		if(delement3==null&amp;&amp;connector.SupplierID==delement1.ElementID) { //input object&#xA;			tmpObjectIn=Repository.GetElementByID(connector.ClientID);&#xA;			if(tmpObjectIn.Type==&quot;Object&quot;) {&#xA;				var tmpClassObject = Repository.GetElementByID(tmpObjectIn.ClassifierID);&#xA;				if(nameElement3!=null&amp;&amp;nameElement3!=&quot;&quot;&amp;&amp;nameElement3!=&quot; &quot;&amp;&amp;nameElement3.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement3.indexOf(&quot;[&quot;)&lt;nameElement3.indexOf(&quot;]&quot;)) {&#xA;					var nameTmpElement=nameElement3.substr(0,nameElement3.indexOf(&quot;[&quot;))+nameElement3.substr(nameElement3.indexOf(&quot;]&quot;)+1);&#xA;					if(tmpObjectIn.Name+&quot;:&quot;+tmpClassObject.Name==nameTmpElement) {&#xA;						var nameOfStateTarget=nameElement3.substr(nameElement3.indexOf(&quot;[&quot;)+1, nameElement3.indexOf(&quot;]&quot;)-nameElement3.indexOf(&quot;[&quot;)-1);&#xA;						var nameOfStateSource=null;&#xA;						var stateObject=getStatesOfObject(tmpObjectIn);&#xA;						if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;							nameOfStateSource=stateObject;&#xA;						if(nameOfStateSource==null||nameOfStateTarget==&quot;&quot;||nameOfStateSource==nameOfStateTarget)&#xA;							delement3=tmpObjectIn;	&#xA;					}						&#xA;				} else&#xA;				if(tmpObjectIn.Name+&quot;:&quot;+tmpClassObject.Name==nameElement3)&#xA;					delement3=tmpObjectIn;&#xA;			}&#xA;		} else&#xA;		if(delement2==null&amp;&amp;connector.ClientID==delement1.ElementID) { //output object&#xA;			tmpObjectOut=Repository.GetElementByID(connector.SupplierID);&#xA;			if(tmpObjectOut.Type==&quot;Object&quot;) {&#xA;				var tmpClassObject = Repository.GetElementByID(tmpObjectOut.ClassifierID);&#xA;				if(nameElement2!=null&amp;&amp;nameElement2!=&quot;&quot;&amp;&amp;nameElement2!=&quot; &quot;&amp;&amp;nameElement2.indexOf(&quot;[&quot;)&gt;-1&amp;&amp;nameElement2.indexOf(&quot;[&quot;)&lt;nameElement2.indexOf(&quot;]&quot;)) {&#xA;					var nameTmpElement=nameElement2.substr(0,nameElement2.indexOf(&quot;[&quot;))+nameElement2.substr(nameElement2.indexOf(&quot;]&quot;)+1);&#xA;					if(tmpObjectOut.Name+&quot;:&quot;+tmpClassObject.Name==nameElement2) {&#xA;						var nameOfStateTarget=nameElement3.substr(nameElement2.indexOf(&quot;[&quot;)+1, nameElement2.indexOf(&quot;]&quot;)-nameElement2.indexOf(&quot;[&quot;)-1);&#xA;						var nameOfStateSource=null;&#xA;						var stateObject=getStatesOfObject(tmpObjectOut);&#xA;						if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;							nameOfStateSource=stateObject;&#xA;						if(nameOfStateSource==null||nameOfStateTarget==&quot;&quot;||nameOfStateSource==nameOfStateTarget)&#xA;							delement2=tmpObjectOut;	&#xA;					}						&#xA;					else&#xA;					if(tmpObjectOut.Name+&quot;:&quot;+tmpClassObject.Name==nameTmpElement)&#xA;						delement2=tmpObjectOut;						&#xA;				} else&#xA;				if(tmpObjectOut.Name+&quot;:&quot;+tmpClassObject.Name==nameElement2)&#xA;					delement2=tmpObjectOut;&#xA;			}&#xA;		} &#xA;		if(delement2!=null&amp;&amp;delement3!=null)&#xA;			break;&#xA;	}&#xA;	parameters[1]=delement2;&#xA;	parameters[2]=delement3;&#xA;	parameters[3]=activityPartition;&#xA;&#xA;	return parameters;&#xA;}&#xA;//Searching for future diagram objects in the target diagram&#xA;function getDesiredDiagObjects(diagramObjects, nameElement1, nameElement2, nameElement3) {&#xA;	//var activityPartitions = [];&#xA;	var parameters = [ null,null,null,null]&#xA;	var coto as EA.Element;&#xA;	var cotoParent as EA.Element;&#xA;	var nameOfElement=&quot;&quot;;	&#xA;	var diagramObject as EA.DiagramObject;&#xA;	var diagramObject1 as EA.DiagramObject;&#xA;	var diagramObject2 as EA.DiagramObject;&#xA;	var diagramObject3 as EA.DiagramObject;&#xA;	diagramObject=null;&#xA;	diagramObject1=null;&#xA;	diagramObject2=null;&#xA;	diagramObject3=null;&#xA;	&#xA;	// Navigate the elements collection of desired diagram&#xA;	for ( var ii = 0; ii &lt; diagramObjects.Count ; ii++ )&#xA;	{&#xA;		diagramObject = diagramObjects.GetAt(ii);&#xA;		if(diagramObject.ElementID&gt;0)&#xA;			coto=Repository.GetElementByID(diagramObject.ElementID);&#xA;		else&#xA;			coto=null;&#xA;		if(coto.ClassifierID&gt;0)&#xA;			cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;		else&#xA;			cotoParent=null;&#xA;		if(coto.Type==&quot;Object&quot;||coto.Type==&quot;Sequence&quot;) {&#xA;			var nameOfState;&#xA;			&#xA;			nameOfElement=coto.Name;&#xA;			if(coto.Type!=&quot;Sequence&quot;) {&#xA;				var stateObject=getStatesOfObject(coto);&#xA;				if(stateObject!=null&amp;&amp;stateObject!=&quot;&quot;&amp;&amp;stateObject!=&quot; &quot;)&#xA;					nameOfElement=nameOfElement+&quot;[&quot;+stateObject+&quot;]&quot;;&#xA;			}&#xA;			if(cotoParent!=null)&#xA;				nameOfElement=nameOfElement+&quot;:&quot;+cotoParent.Name;&#xA;		} else&#xA;			nameOfElement=coto.Name;&#xA;		//Session.Output(&quot;getDesiredDiagObjects: nameOfElement=&lt;&quot;+nameOfElement+&quot;&gt;; nameElement1=&lt;&quot;+nameElement1+&quot;&gt;; nameElement3=&lt;&quot;+nameElement3+&quot;&gt;&quot;);&#xA;		//Session.Output(&quot;getDesiredDiagObjects: nameOfElement==nameElement1=&quot;+(nameOfElement==nameElement1)+&quot;; nameOfElement==nameElement3=&quot;+(nameOfElement==nameElement3));&#xA;		if(diagramObject1==null&amp;&amp;(nameOfElement==nameElement1||coto.Type==&quot;Component&quot;&amp;&amp;(&quot;:&quot;+nameOfElement==nameElement1))) {//verification of an existing element in the target diagram&#xA;			diagramObject1=diagramObject; &#xA;			//Session.Output(&quot;getDesiredDiagObjects: diagramObject1=&quot;+diagramObject1.ElementID+&quot;; diagramObject=&quot;+diagramObject.ElementID);&#xA;		}&#xA;		else&#xA;		if(diagramObject2==null&amp;&amp;(nameOfElement==nameElement2)) //verification of an existing element in the target diagram&#xA;			diagramObject2=diagramObject; &#xA;		else&#xA;		if(diagramObject3==null&amp;&amp;(nameOfElement==nameElement3||coto.Type==&quot;Component&quot;&amp;&amp;(&quot;:&quot;+nameOfElement==nameElement3))) //verification of an existing element in the trget diagram&#xA;			diagramObject3=diagramObject; 		//else&#xA;		//if(coto.Type==&quot;ActivityPartition&quot;)&#xA;		//	activityPartitions.push([diagramObject, null]);			&#xA;	}&#xA;	/*if(diagramObject1==null)&#xA;		Session.Output(&quot;getDesiredDiagObjects: parameters[0]:=null&quot;);&#xA;	else&#xA;		Session.Output(&quot;getDesiredDiagObjects: parameters[0]:=&quot;+diagramObject1.ElementID);&#xA;	if(diagramObject3==null)&#xA;		Session.Output(&quot;getDesiredDiagObjects: parameters[2]:=null&quot;);&#xA;	else&#xA;		Session.Output(&quot;getDesiredDiagObjects: parameters[2]:=&quot;+diagramObject3.ElementID);*/&#xA;	parameters[0]=diagramObject1;&#xA;	parameters[1]=diagramObject2;&#xA;	parameters[2]=diagramObject3;&#xA;	//parameters[3]=activityPartitions;	&#xA;	return parameters;&#xA;}&#xA;//Get the target package and target diagram, and if they don't exist, create them&#xA;function getTargetPackage(thePackage, type, nameOfSubPack,consistencyRule,conns) {&#xA;	var parameters = [ null,null];&#xA;	var childPackage as EA.Package;&#xA;	var subChildPackage as EA.Package;&#xA;	var theParentPackage as EA.Package;&#xA;	var nameOfsubPackageDiagram;&#xA;	var nameOfSubPackage;&#xA;	var nameOftheParent;&#xA;	var testSMDiagram; //Business State Diagram&#xA;	var testDiagram as EA.Diagram;	&#xA;	var stateMachine as EA.Element;&#xA;	&#xA;	if(type!=null&amp;&amp;type==&quot;SUCRD&quot;&amp;&amp;nameOfSubPack!=null&amp;&amp;nameOfSubPack.indexOf(&quot;,&quot;)&gt;-1) {&#xA;		nameOfsubPackageDiagram=nameOfSubPack.substr(0,nameOfSubPack.indexOf(&quot;,&quot;));&#xA;		nameOfSubPackage=nameOfSubPack.substr(nameOfSubPack.indexOf(&quot;,&quot;)+1);&#xA;	} else {&#xA;		nameOfSubPackage=nameOfSubPack;&#xA;		nameOfsubPackageDiagram=thePackage.Name;&#xA;	}&#xA;	if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;		tmp=nameOfsubPackageDiagram;&#xA;		nameOfsubPackageDiagram=nameOfSubPackage;&#xA;		nameOfSubPackage=tmp;&#xA;	} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;		tmp=nameOfsubPackageDiagram;&#xA;		nameOfsubPackageDiagram=nameOfSubPackage;&#xA;		nameOfSubPackage=tmp;		&#xA;	}&#xA;	subChildPackage=null;	&#xA;	// Get the parent package of the currently selected package&#xA;	theParentPackage = Repository.GetPackageByID(thePackage.ParentID); //Business Process Layer&#xA;	if(type==&quot;SEQD&quot;)&#xA;		nameOftheParent=theParentPackage.Name;&#xA;	if(thePackage.Name === &quot;Decomposition Processes&quot;||thePackage.Name === &quot;Business Use Cases&quot;)	&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID);&#xA;	if(thePackage.Name === &quot;Business Use Cases&quot;||thePackage.Name === &quot;Decomposition Processes&quot;&amp;&amp;type==&quot;BURD&quot;)&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID);&#xA;	if(type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;||type==&quot;SUCRD&quot;||type==&quot;IUCD&quot;||type==&quot;SEQD&quot;)&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //Business View&#xA;	if(type==&quot;SUCRD&quot;||type==&quot;IUCD&quot;||type==&quot;SEQD&quot;) {&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //System View&#xA;		if(type==&quot;SUCRD&quot;&amp;&amp;thePackage.Name!=&quot;Business Class&quot;&amp;&amp;thePackage.Name!=&quot;Business State&quot;||type==&quot;SEQD&quot;)&#xA;			theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //Model&#xA;		if(type==&quot;SEQD&quot;)&#xA;			theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //Model&#xA;	}&#xA;	if(type!=null&amp;&amp;type==&quot;CMPD&quot;) {&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //System View&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //System View&#xA;		theParentPackage = Repository.GetPackageByID(theParentPackage.ParentID); //System View&#xA;	}&#xA;	// Recursively process any child packages of the parent package of the currently selected package&#xA;	var childPackageEnumerator = new Enumerator( theParentPackage.Packages );&#xA;	if(type==&quot;BURD&quot;||type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;||type==&quot;SUCRD&quot;||type==&quot;IUCD&quot;||type==&quot;SEQD&quot;) {&#xA;		while ( !childPackageEnumerator.atEnd() )&#xA;		{&#xA;			childPackage = childPackageEnumerator.item();&#xA;				&#xA;			if((type==&quot;BURD&quot;)&amp;&amp;childPackage.Name === &quot;Business View&quot;||&#xA;				(type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;)&amp;&amp;childPackage.Name === &quot;Logic Layer&quot;)&#xA;				break;&#xA;			else if((type==&quot;SUCRD&quot;)&amp;&amp;childPackage.Name === &quot;System View&quot;)&#xA;				break;&#xA;			else if((type==&quot;IUCD&quot;)&amp;&amp;childPackage.Name === &quot;Internal Layer&quot;)&#xA;				break;				&#xA;			else if((type==&quot;SEQD&quot;)&amp;&amp;childPackage.Name === &quot;Deployment View&quot;)&#xA;				break;	&#xA;			childPackageEnumerator.moveNext();&#xA;		}	&#xA;		if(type==&quot;BURD&quot;&amp;&amp;childPackage.Name !== &quot;Business View&quot;||&#xA;			(type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;)&amp;&amp;childPackage.Name !== &quot;Logic Layer&quot;||&#xA;		    (type==&quot;SUCRD&quot;)&amp;&amp;childPackage.Name !== &quot;System View&quot;||(type==&quot;IUCD&quot;)&amp;&amp;childPackage.Name !== &quot;Internal Layer&quot;||&#xA;			childPackage.Name !== &quot;Deployment View&quot;&amp;&amp;type==&quot;SEQD&quot;) &#xA;		{&#xA;			var packages as EA.Collection;&#xA;			packages = theParentPackage.Packages;&#xA;			var nameOfPackage = &quot;Business View&quot;;&#xA;			&#xA;			if(type==&quot;SUCD&quot;||type==&quot;CLASSD&quot;||type==&quot;BSTMD&quot;)&#xA;				nameOfPackage = &quot;Logic Layer&quot;;&#xA;			else if(type==&quot;SUCRD&quot;)&#xA;				nameOfPackage = &quot;System View&quot;;					&#xA;			else if(type==&quot;IUCD&quot;)&#xA;				nameOfPackage = &quot;Internal Layer&quot;;	&#xA;			else if(type==&quot;SEQD&quot;)&#xA;				nameOfPackage = &quot;Deployment View&quot;;	&#xA;			// Create package&#xA;			var subPackage as EA.Package;&#xA;			var subPackage1 as EA.Package;&#xA;			&#xA;			if(type==&quot;BURD&quot;||type==&quot;SUCRD&quot;)&#xA;				subPackage = CreatePackage(/*theParentPackage, */packages, nameOfPackage, &quot;Activity&quot;);&#xA;			else if(type==&quot;IUCD&quot;)&#xA;				subPackage = CreatePackage(/*theParentPackage, */packages, nameOfPackage, &quot;UseCase&quot;);&#xA;			else if(type==&quot;SEQD&quot;)&#xA;				subPackage = CreatePackage(/*theParentPackage, */packages, nameOfPackage, &quot;Sequence&quot;);&#xA;			else if(type==&quot;BSTMD&quot;)&#xA;				subPackage = CreatePackage(/*theParentPackage, */packages, nameOfPackage, &quot;Class&quot;); &#xA;			theParentPackage=subPackage;		&#xA;			// Create subpackage&#xA;			packages = subPackage.Packages;&#xA;		} else&#xA;			theParentPackage=childPackage;&#xA;	}&#xA;	var childPackageEnumerator = new Enumerator( theParentPackage.Packages ); //Business View&#xA;	while ( !childPackageEnumerator.atEnd() )&#xA;	{&#xA;&#xA;		childPackage = childPackageEnumerator.item();  //Business Proces Layer/Logic Layer&#xA;			&#xA;		if((type==&quot;BUCD&quot;||type==&quot;PDD&quot;)&amp;&amp;childPackage.Name === &quot;Decomposition Layer&quot;)&#xA;		{&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if((type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === &quot;Decomposition Processes&quot;) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				} else&#xA;				if(type!=null&amp;&amp;type==&quot;BUCD&quot;&amp;&amp;childPackage.Packages.GetAt(i).Name === &quot;Business Use Cases&quot;) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if((type==&quot;BURD&quot;)&amp;&amp;childPackage.Name === &quot;Business Process Layer&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;type==&quot;BURD&quot;&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOfSubPackage) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;SUCD&quot;&amp;&amp;childPackage.Name === &quot;System Use Case&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;SUCD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOfSubPackage) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(	type==&quot;BSTMD&quot;&amp;&amp;childPackage.Name === &quot;Business State&quot;) {&#xA;			for(i=0;i&lt;childPackage.Elements.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;BSTMD&quot;)&amp;&amp;childPackage.Elements.GetAt(i).Name === nameOfSubPackage) {&#xA;					stateMachine=childPackage.Elements.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;CLASSD&quot;&amp;&amp;childPackage.Name === &quot;Business Class&quot;) {&#xA;			subChildPackage=childPackage;&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;SUCRD&quot;&amp;&amp;childPackage.Name === &quot;User Layer&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;SUCRD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOfsubPackageDiagram) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;IUCD&quot;&amp;&amp;childPackage.Name === &quot;Internal Use Cases&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;IUCD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOfsubPackageDiagram) {&#xA;					subChildPackage=childPackage.Packages.GetAt(i);&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;SEQD&quot;&amp;&amp;childPackage.Name === &quot;Sequence Layer&quot;) {&#xA;			for(i=0;i&lt;childPackage.Packages.Count();i++) {&#xA;				if(type!=null&amp;&amp;(type==&quot;SEQD&quot;)&amp;&amp;childPackage.Packages.GetAt(i).Name === nameOftheParent) { //1.Request service&#xA;					subChildPackage=childPackage.Packages.GetAt(i); //1.Request service&#xA;					break;&#xA;				}				&#xA;			}&#xA;			break;&#xA;		} else&#xA;		if(type==&quot;CMPD&quot;&amp;&amp;childPackage.Name === &quot;Component Layer&quot;) {&#xA;			subChildPackage=childPackage;&#xA;			break;&#xA;		}			&#xA;		childPackageEnumerator.moveNext();&#xA;	}&#xA;	if((type==null||type==&quot;&quot;||type==&quot;PDD&quot;||type==&quot;BUCD&quot;)&amp;&amp;childPackage.Name !== &quot;Decomposition Layer&quot; ||&#xA;		type==&quot;BURD&quot;&amp;&amp;childPackage.Name !== &quot;Business Process Layer&quot;||&#xA;		type==&quot;SUCD&quot;&amp;&amp;childPackage.Name !== &quot;System Use Case&quot;||&#xA;		type==&quot;BSTMD&quot;&amp;&amp;childPackage.Name !== &quot;Business State&quot;||&#xA;		type==&quot;CLASSD&quot;&amp;&amp;childPackage.Name !== &quot;Business Class&quot;||&#xA;		type==&quot;SUCRD&quot;&amp;&amp;childPackage.Name !== &quot;User Layer&quot;||&#xA;		type==&quot;IUCD&quot;&amp;&amp;childPackage.Name !== &quot;Internal Use Cases&quot;||&#xA;		type==&quot;SEQD&quot;&amp;&amp;childPackage.Name !== &quot;Sequence Layer&quot;||&#xA;		type==&quot;CMPD&quot;&amp;&amp;childPackage.Name !== &quot;Component Layer&quot;) {&#xA;		var packages as EA.Collection;&#xA;		var subPackage as EA.Package;&#xA;		var subPackage1 as EA.Package;&#xA;		var subPackage2 as EA.Package;&#xA;			&#xA;		packages = theParentPackage.Packages;&#xA;		// Create package&#xA;		if(type==&quot;BURD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Business Process Layer&quot;, &quot;Activity&quot;);&#xA;		else if(type==&quot;SUCD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;System Use Case&quot;, &quot;Class&quot;);&#xA;		else if(type==&quot;BSTMD&quot;) {&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Business State&quot;, &quot;State&quot;);&#xA;			testSMDiagram = CreateDiagram(subPackage, &quot;Business State&quot;, &quot;Statechart&quot;);&#xA;		}&#xA;		else if(type==&quot;CLASSD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Business Class&quot;, &quot;Class&quot;);&#xA;		else if(type==&quot;SUCRD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;User Layer&quot;, &quot;Activity&quot;);&#xA;		else if(type==&quot;IUCD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Internal Use Cases&quot;, &quot;UseCase&quot;);&#xA;		else if(type==&quot;SEQD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Sequence Layer&quot;, &quot;Sequence&quot;);&#xA;		else if(type==&quot;CMPD&quot;)&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Component Layer&quot;, &quot;Deployment&quot;);&#xA;		else&#xA;			subPackage = CreatePackage(/*theParentPackage, */packages, &quot;Decomposition Layer&quot;, &quot;Activity&quot;);&#xA;		// Create subpackage&#xA;		packages = subPackage.Packages;&#xA;		if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, &quot;Decomposition Processes&quot;, &quot;Activity&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;BUCD&quot;)&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, &quot;Business Use Cases&quot;, &quot;UseCase&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;BURD&quot;)&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;Activity&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;SUCD&quot;)&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;UseCase&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;			stateMachine = subPackage.Elements.AddNew( nameOfSubPackage,&quot;StateMachine&quot;);&#xA;			if((tagValue=getTagValueforElement(&quot;BSTMD&quot;,&quot;StateMachine&quot;,nameOfSubPackage))) {&#xA;				var taggedValue as EA.TaggedValue;&#xA;				taggedValue=stateMachine.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;				taggedValue.Update();&#xA;			}&#xA;			stateMachine.Update();	&#xA;			setCRDependency(consistencyRule,&quot;AivSrst&quot;,conns[0][0],stateMachine);&#xA;			subPackage.Diagrams.Refresh();&#xA;			for( var l=0; l&lt;subPackage.Diagrams.Count; l++) {&#xA;				testDiagram=subPackage.Diagrams.GetAt(l);&#xA;				if(testDiagram.Name==subPackage.Name&amp;&amp;testDiagram.Type==&quot;Statechart&quot;)&#xA;					break;&#xA;				else&#xA;					testDiagram=null;&#xA;			}&#xA;			if(testDiagram!=null) {&#xA;				var left=50;&#xA;				var top=-50;&#xA;				testDiagram.DiagramObjects.Refresh();&#xA;				for( var l=0; l&lt;testDiagram.DiagramObjects.Count; l++) {&#xA;					var diagramObject=testDiagram.DiagramObjects.GetAt(l);&#xA;					if(diagramObject.right&gt;=left)&#xA;						left = diagramObject.right+50;&#xA;				}&#xA;				var testDiagramObject = testDiagram.DiagramObjects.AddNew(&quot;&quot;, &quot;&quot; );&#xA;				testDiagramObject.ElementID( stateMachine.ElementID );&#xA;				testDiagramObject.left=left;&#xA;				testDiagramObject.right=left+100;&#xA;				testDiagramObject.top=top;&#xA;				testDiagramObject.bottom=top-150;&#xA;				testDiagramObject.Update();&#xA;			}&#xA;			testDiagram=null;&#xA;		}&#xA;		else if(type!=null&amp;&amp;type==&quot;CLASSD&quot;)&#xA;			subPackage1 = subPackage;&#xA;		else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;			subPackage2 = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;Activity&quot;);&#xA;			packages=subPackage2.Packages;&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;Activity&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;			subPackage2 = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;UseCase&quot;);&#xA;			packages=subPackage2.Packages;&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;UseCase&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;			subPackage2 = CreatePackage(/*subPackage, */packages, nameOftheParent, &quot;UseCase&quot;);&#xA;			packages=subPackage2.Packages;&#xA;			subPackage2 = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;UseCase&quot;);&#xA;			packages=subPackage2.Packages;&#xA;			subPackage1 = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;CMPD&quot;)&#xA;			subPackage1 = subPackage;&#xA;		else&#xA;			return parameters;&#xA;		if(type!=null&amp;&amp;type==&quot;BSTMD&quot;)&#xA;			parameters[0]=stateMachine;&#xA;		else&#xA;			parameters[0]=subPackage1;&#xA;		// Create a diagram in the package&#xA;		if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;			testDiagram = CreateDiagram(subPackage1, &quot;Decomposition Processes&quot;, &quot;EPProfile_dg::Eriksson-Penker Diagram&quot;);&#xA;		else if(type!=null&amp;&amp;type==&quot;BUCD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, &quot;Business Use Cases&quot;, &quot;UseCase&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;BURD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfSubPackage, &quot;Activity&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;SUCD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfSubPackage, &quot;Use Case&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;			testDiagram = stateMachine.Diagrams.AddNew( nameOfSubPackage, &quot;Statechart&quot;);&#xA;			testDiagram.Update();&#xA;		} else if(type!=null&amp;&amp;type==&quot;CLASSD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, &quot;Business Class&quot;, &quot;Class&quot;); &#xA;		} else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfSubPackage, &quot;Activity&quot;); &#xA;		} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfSubPackage, &quot;Use Case&quot;); &#xA;		} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;		} else if(type!=null&amp;&amp;type==&quot;CMPD&quot;) {&#xA;			testDiagram = CreateDiagram(subPackage1, &quot;Component Layer&quot;, &quot;Component&quot;);&#xA;		}&#xA;		parameters[1]=testDiagram;&#xA;	}&#xA;	else {&#xA;		if(type!=null&amp;&amp;type==&quot;BSTMD&quot;&amp;&amp;stateMachine==null||&#xA;			(type==null||type!=&quot;BSTMD&quot;)&amp;&amp;subChildPackage==null) {&#xA;			// Create subpackage&#xA;			var packages as EA.Collection;&#xA;			var packages1 as EA.Collection;&#xA;			//packages = theParentPackage.Packages;&#xA;			packages = childPackage.Packages;&#xA;			if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;				subChildPackage = CreatePackage(/*childPackage, */packages, &quot;Decomposition Processes&quot;, &quot;Class&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;BUCD&quot;)&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, &quot;Business Use Cases&quot;, &quot;Class&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;BURD&quot;)&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;Activity&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;SUCD&quot;)&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOfSubPackage, &quot;Class&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;				stateMachine = childPackage.Elements.AddNew( nameOfSubPackage,&quot;StateMachine&quot;);&#xA;				if((tagValue=getTagValueforElement(&quot;BSTMD&quot;,&quot;StateMachine&quot;,nameOfSubPackage))) {&#xA;					var taggedValue as EA.TaggedValue;&#xA;					taggedValue=stateMachine.TaggedValues.AddNew(&quot;Consistency rules&quot;,tagValue);&#xA;					taggedValue.Update();&#xA;				}				&#xA;				stateMachine.Update();		&#xA;				setCRDependency(consistencyRule,&quot;AivSrst&quot;,conns[0][0],stateMachine);&#xA;				childPackage.Diagrams.Refresh();				&#xA;				for( var l=0; l&lt;childPackage.Diagrams.Count; l++) {&#xA;					testDiagram=childPackage.Diagrams.GetAt(l);&#xA;					if(testDiagram.Name==childPackage.Name&amp;&amp;testDiagram.Type==&quot;Statechart&quot;)&#xA;						break;&#xA;					else&#xA;						testDiagram=null;&#xA;				}&#xA;				if(testDiagram!=null) {&#xA;					var left=50;&#xA;					var top=-50;&#xA;					testDiagram.DiagramObjects.Refresh();&#xA;					for( var l=0; l&lt;testDiagram.DiagramObjects.Count; l++) {&#xA;						var diagramObject=testDiagram.DiagramObjects.GetAt(l);&#xA;						if(diagramObject.right&gt;=left)&#xA;							left = diagramObject.right+50;&#xA;					}&#xA;					var testDiagramObject = testDiagram.DiagramObjects.AddNew(&quot;&quot;, &quot;&quot; );&#xA;					testDiagramObject.ElementID( stateMachine.ElementID );&#xA;					testDiagramObject.left=left;&#xA;					testDiagramObject.right=left+100;&#xA;					testDiagramObject.top=top;&#xA;					testDiagramObject.bottom=top-150;&#xA;					testDiagramObject.Update();&#xA;				}&#xA;				testDiagram=null;&#xA;			}&#xA;			else if(type!=null&amp;&amp;type==&quot;CLASSD&quot;)&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, &quot;Business Class&quot;, &quot;Class&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;Activity&quot;);&#xA;				packages1=subChildPackage.Packages;&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;Activity&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOfsubPackageDiagram, &quot;UseCase&quot;);&#xA;				packages1=subChildPackage.Packages;&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;UseCase&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages, nameOftheParent, &quot;UseCase&quot;);&#xA;				packages1=subChildPackage.Packages;&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;UseCase&quot;);&#xA;				packages1=subChildPackage.Packages;&#xA;				subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;			} else&#xA;			if(type!=&quot;CMPD&quot;)&#xA;				return parameters; &#xA;			if(type!=null&amp;&amp;type==&quot;BSTMD&quot;)&#xA;				parameters[0]=stateMachine;&#xA;			else&#xA;				parameters[0]=subChildPackage;	 &#xA;			// Create a diagram in the package&#xA;			if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;				testDiagram = CreateDiagram(subChildPackage, &quot;Decomposition Processes&quot;, &quot;EPProfile_dg::Eriksson-Penker Diagram&quot;);&#xA;			else if(type!=null&amp;&amp;type==&quot;BUCD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, &quot;Business Use Cases&quot;, &quot;UseCase&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;BURD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Activity&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;SUCD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Use Case&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;				testDiagram = stateMachine.Diagrams.AddNew( nameOfSubPackage, &quot;Statechart&quot;);&#xA;				testDiagram.Update();&#xA;			} else if(type!=null&amp;&amp;type==&quot;SUCD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, &quot;Business Class&quot;, &quot;Class&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Activity&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Use Case&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;			} else if(type!=null&amp;&amp;type==&quot;CMPD&quot;) {&#xA;				testDiagram = CreateDiagram(subChildPackage, &quot;Component Layer&quot;, &quot;Component&quot;);&#xA;			}&#xA;			parameters[1]=testDiagram;			&#xA;		} else { //the target package, there is Sequence Layer&#xA;			if(type==&quot;SUCRD&quot;||type==&quot;IUCD&quot;||type==&quot;SEQD&quot;) {&#xA;				var subChildPackageS as EA.Package;&#xA;				for(var i=0;i&lt;subChildPackage.Packages.Count();i++) {&#xA;					if(subChildPackage.Packages.GetAt(i).Name === nameOfSubPackage) {&#xA;						subChildPackageS=subChildPackage.Packages.GetAt(i);&#xA;						break;&#xA;					}				&#xA;				}	&#xA;				if(subChildPackageS==null) {&#xA;					var packages1 as EA.Collection;&#xA;					packages1=subChildPackage.Packages;&#xA;					if(type==&quot;SUCRD&quot;)&#xA;						subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;Activity&quot;);&#xA;					else if(type==&quot;SEQD&quot;)&#xA;						subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;Sequence&quot;);&#xA;					else&#xA;						subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfSubPackage, &quot;UseCase&quot;);&#xA;				} else&#xA;					subChildPackage=subChildPackageS;&#xA;				if(type==&quot;SEQD&quot;) {&#xA;					var subChildPackageS as EA.Package;&#xA;					subChildPackageS=null;&#xA;					for(var i=0;i&lt;subChildPackage.Packages.Count();i++) {&#xA;						if(subChildPackage.Packages.GetAt(i).Name === nameOfsubPackageDiagram) {&#xA;							subChildPackageS=subChildPackage.Packages.GetAt(i);&#xA;							break;&#xA;						}				&#xA;					}&#xA;					if(subChildPackageS==null) {&#xA;						var packages1 as EA.Collection;&#xA;						packages1=subChildPackage.Packages;&#xA;						subChildPackage = CreatePackage(/*subPackage, */packages1, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;					} else&#xA;						subChildPackage=subChildPackageS;&#xA;				}&#xA;			}&#xA;			if(type!=null&amp;&amp;type==&quot;BSTMD&quot;)&#xA;				parameters[0]=stateMachine;&#xA;			else&#xA;				parameters[0]=subChildPackage;&#xA;			testDiagram=null;&#xA;			if(type!=null&amp;&amp;type==&quot;BSTMD&quot;&amp;&amp;stateMachine.Diagrams.Count&gt;0) {&#xA;				for(i=0;i&lt;stateMachine.Diagrams.Count&gt;0;i++) {&#xA;					var test1Diagram = stateMachine.Diagrams.GetAt(i);&#xA;					if(test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Statechart&quot;) {&#xA;						testDiagram=test1Diagram;&#xA;						break;&#xA;					}&#xA;				}&#xA;			} else &#xA;			if(type!=null&amp;&amp;type!=&quot;BSTMD&quot;&amp;&amp;subChildPackage.Diagrams.Count&gt;0) {&#xA;				for(i=0;i&lt;subChildPackage.Diagrams.Count&gt;0;i++) {&#xA;					var test1Diagram = subChildPackage.Diagrams.GetAt(i);&#xA;					if((type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&amp;&amp;test1Diagram.Name==&quot;Decomposition Processes&quot;&amp;&amp;test1Diagram.Type==&quot;Analysis&quot; ||&#xA;						type!=null&amp;&amp;type==&quot;BUCD&quot;&amp;&amp;test1Diagram.Name==&quot;Business Use Cases&quot;&amp;&amp;test1Diagram.Type==&quot;UseCase&quot; ||&#xA;						type!=null&amp;&amp;type==&quot;BURD&quot;&amp;&amp;test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Activity&quot; ||&#xA;						type!=null&amp;&amp;type==&quot;SUCD&quot;&amp;&amp;test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Use Case&quot;||&#xA;						type!=null&amp;&amp;type==&quot;CLASSD&quot;&amp;&amp;test1Diagram.Name==&quot;Business Class&quot;&amp;&amp;test1Diagram.Type==&quot;Class&quot;||&#xA;						type!=null&amp;&amp;type==&quot;SUCRD&quot;&amp;&amp;test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Activity&quot;||&#xA;						type!=null&amp;&amp;type==&quot;IUCD&quot;&amp;&amp;test1Diagram.Name==nameOfSubPackage&amp;&amp;test1Diagram.Type==&quot;Use Case&quot;||&#xA;						type!=null&amp;&amp;type==&quot;SEQD&quot;&amp;&amp;test1Diagram.Name==nameOfsubPackageDiagram&amp;&amp;test1Diagram.Type==&quot;Sequence&quot;||&#xA;						type!=null&amp;&amp;type==&quot;CMPD&quot;&amp;&amp;test1Diagram.Name==&quot;Component Layer&quot;&amp;&amp;test1Diagram.Type==&quot;Component&quot;) {&#xA;						testDiagram=test1Diagram;&#xA;						break;&#xA;					}&#xA;				}&#xA;			}&#xA;			if(testDiagram==null) {&#xA;				if(type==null||type==&quot;&quot;||type==&quot;PDD&quot;)&#xA;					testDiagram = CreateDiagram(subChildPackage, &quot;Decomposition Processes&quot;, &quot;EPProfile_dg::Eriksson-Penker Diagram&quot;);&#xA;				else if(type!=null&amp;&amp;type==&quot;BUCD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, &quot;Business Use Cases&quot;, &quot;Use Case&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;BURD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Activity&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;SUCD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Use Case&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;BSTMD&quot;) {&#xA;					testDiagram = stateMachine.Diagrams.AddNew( nameOfSubPackage, &quot;Statechart&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;CLASSD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, &quot;Business Class&quot;, &quot;Class&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;SUCRD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Activity&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;IUCD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfSubPackage, &quot;Use Case&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;SEQD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, nameOfsubPackageDiagram, &quot;Sequence&quot;);&#xA;				} else if(type!=null&amp;&amp;type==&quot;CMPD&quot;) {&#xA;					testDiagram = CreateDiagram(subChildPackage, &quot;Component Layer&quot;, &quot;Component&quot;);&#xA;				}&#xA;				else&#xA;					return parameters;&#xA;			}&#xA;			parameters[1]=testDiagram;	&#xA;		}			&#xA;	}&#xA;	return parameters;&#xA;}&#xA;//Look up the name of an element with the specified type in the current package, otherwise in the repository&#xA;function searchForElement(subPackage, nameOfElement, typeOfElement) {&#xA;	var coto as EA.Collection;&#xA;	var currentPackage as EA.Package;&#xA;	var delements as EA.Collection;&#xA;	var packageElement as EA.Element;&#xA;	&#xA;	currentPackage=subPackage;&#xA;	delements = currentPackage.Elements;&#xA;	for(i=0;i&lt;delements.Count();i++) {&#xA;		packageElement=delements.GetAt(i);&#xA;		if(packageElement.Name==nameOfElement&amp;&amp;packageElement.Type==typeOfElement)&#xA;			return packageElement;&#xA;	}&#xA;	coto=Repository.GetElementsByQuery(&quot;Simple&quot;,nameOfElement);&#xA;	for(i=0; i&lt;coto.Count(); i++) {&#xA;		var searchElement as EA.Element;&#xA;		searchElement=coto.GetAt(i);&#xA;		if(searchElement.Name==nameOfElement&amp;&amp;searchElement.Type==typeOfElement)&#xA;			return searchElement;&#xA;	} &#xA;	return null;&#xA;}&#xA;//Returning an object on the diagram corresponding to the given element&#xA;function searchedObjectinDiagram(thePackage, theElement) {&#xA;	var diagramObjects as EA.Collection;&#xA;	var diagramObject as EA.DiagramObject;&#xA;&#xA;	diagramObjects = thePackage.Diagrams.GetAt(0).DiagramObjects;&#xA;	for(i=0;i&lt;diagramObjects.Count();i++) {&#xA;		diagramObject = diagramObjects.GetAt(i);&#xA;		if(diagramObject.ElementID==theElement.ElementID)&#xA;			return diagramObject;&#xA;	}&#xA;	return null;&#xA;}&#xA;//Return next connected element(nameElementtype) back(kind=1 or 6) or forward (kind=0) to the given element (theElement) and this connection in the diagram&#xA;//For kind=5 or 6, the found objects must have different classes, and for kind=4, the found objects must be different. For kind=3, the element must be a class.&#xA;function searchConnectorsinElement(thePackage, theElement, type, nameElement, kind, notElement) {&#xA;	var Connectors as EA.Collection;&#xA;	var theConnector as EA.Connector;&#xA;	var coto as EA.Element;&#xA;	var cotoParent as EA.Element;&#xA;	var searchConnectors = [null, null, null];&#xA;	&#xA;	//Session.Output(&quot;sCE:&quot;+theElement.ElementID);&#xA;	Connectors = theElement.Connectors;&#xA;	for(var i=0;i&lt;Connectors.Count();i++)&#xA;	{&#xA;		theConnector=Connectors.GetAt(i);&#xA;		if(kind==1&amp;&amp;theConnector.ClientID&gt;0 || kind!=1&amp;&amp;theConnector.SupplierID&gt;0) {&#xA;			if(kind==1||kind==6)&#xA;				coto=Repository.GetElementByID(theConnector.ClientID);&#xA;			else&#xA;				coto=Repository.GetElementByID(theConnector.SupplierID);&#xA;			cotoParent=null;&#xA;			if(coto.Type==&quot;Object&quot;)&#xA;				cotoParent=Repository.GetElementByID(coto.ClassifierID);&#xA;			//Session.Output(&quot;S(&quot;+i+&quot;):&quot;+coto.ElementID);&#xA;			//here can find a propriete element&#xA;			if(type==&quot;Action&quot;||type==&quot;Activity&quot;) {&#xA;				if((coto.Type==&quot;Action&quot;||coto.Type==&quot;Activity&quot;)&amp;&amp; (nameElement!=&quot; &quot;&amp;&amp;nameElement==coto.Name||nameElement==&quot;&quot;||nameElement==&quot; &quot;)) {&#xA;					if(searchedObjectinDiagram(thePackage, coto)!=null) {&#xA;						searchConnectors[0]=coto;&#xA;						searchConnectors[1]=theConnector;&#xA;						return searchConnectors;&#xA;					}&#xA;				}&#xA;			} else {&#xA;				if(kind!=3&amp;&amp;kind!=4&amp;&amp;kind!=5&amp;&amp;kind!=6&amp;&amp;coto.Type==type &amp;&amp; (nameElement!=&quot; &quot;&amp;&amp;nameElement==coto.Name||nameElement==&quot;&quot;||nameElement==&quot; &quot;||coto.Type==&quot;Object&quot;&amp;&amp;nameElement.substr(0,1)==&quot;:&quot;&amp;&amp;nameElement.substr(1)==cotoParent.Name)) {&#xA;					if(kind!=2||notElement!=null&amp;&amp;coto.ElementID!=notElement.elementID) {&#xA;						if(searchedObjectinDiagram(thePackage, coto)!=null) {&#xA;							searchConnectors[0]=coto;&#xA;							searchConnectors[1]=theConnector;&#xA;							if(coto.Type==&quot;Object&quot;) &#xA;								searchConnectors[2]=getStatesOfObject(coto);&#xA;							return searchConnectors;&#xA;						}&#xA;					}&#xA;				} else&#xA;				if(kind==3) {&#xA;					if(coto.Type==&quot;Class&quot; &amp;&amp; (nameElement!=&quot; &quot;&amp;&amp;nameElement==coto.Name||nameElement==&quot;&quot;||nameElement==&quot; &quot;)) {&#xA;						if(searchedObjectinDiagram(thePackage, coto)!=null) {&#xA;							searchConnectors[0]=coto;&#xA;							searchConnectors[1]=theConnector;&#xA;							return searchConnectors;&#xA;						}&#xA;					} &#xA;				} else&#xA;				if(kind==4) {&#xA;					if(coto.Type==&quot;Object&quot; &amp;&amp; (nameElement!=&quot; &quot;&amp;&amp;nameElement==coto.Name||nameElement==&quot;&quot;||nameElement==&quot; &quot;)) {&#xA;						if(coto.ElementID!=notElement.elementID) {&#xA;							if(searchedObjectinDiagram(thePackage, coto)!=null) {&#xA;								searchConnectors[0]=coto;&#xA;								searchConnectors[1]=theConnector;&#xA;								return searchConnectors;&#xA;							}&#xA;						}&#xA;					} &#xA;				} else&#xA;				if(kind==5||kind==6) {&#xA;					if(coto.Type==&quot;Object&quot; &amp;&amp; (nameElement!=&quot; &quot;&amp;&amp;nameElement==coto.Name||nameElement==&quot;&quot;||nameElement==&quot; &quot;)) {&#xA;						if(coto.ClassifierID&gt;0&amp;&amp;notElement.ClassifierID&gt;0&amp;&amp;coto.ClassifierID!=notElement.ClassifierID) {&#xA;							if(searchedObjectinDiagram(thePackage, coto)!=null) {&#xA;								searchConnectors[0]=coto;&#xA;								searchConnectors[1]=theConnector;&#xA;								return searchConnectors;&#xA;							}&#xA;						}&#xA;					} &#xA;				}&#xA;			}&#xA;		}&#xA;	}&#xA;	return searchConnectors;&#xA;}&#xA;//Importing the given package from URL&#xA;function importXMLPackageFromURL(url) {&#xA;    //var repository = EA.Repository;&#xA;	var projectInterface as EA.Project;&#xA;    var xmlContent = &quot;&quot;;&#xA;&#xA;    // Fetch XML content from URL&#xA;    var xhr = new ActiveXObject(&quot;MSXML2.XMLHTTP&quot;);&#xA;    xhr.open(&quot;GET&quot;, url, false);&#xA;    xhr.send();&#xA;    if (xhr.status == 200) {&#xA;        xmlContent = xhr.responseText;&#xA;    } else {&#xA;        Session.Output(&quot;Failed to fetch XML from URL: &quot; + xhr.statusText);&#xA;        return;&#xA;    }&#xA;&#xA;    // Import XML package into the model&#xA;    var importResult = projectInterface.ImportPackageXMI(xmlContent, 0);&#xA;    if (importResult) {&#xA;        Session.Output(&quot;XML package imported successfully.&quot;);&#xA;    } else {&#xA;        Session.Output(&quot;Failed to import XML package.&quot;);&#xA;    }&#xA;}&#xA;//Get TaggedValues for selected diagram elements&#xA;function getTagValueforElement(diagram, element, name) {&#xA;var taggedValue as EA.TaggedValue;	&#xA;var tagValue;	&#xA;var rootPackage = Repository.Models.GetAt(0);&#xA;var childPackage = rootPackage.Packages.GetAt(0);&#xA;	&#xA;	//Session.Output(&quot;getTaggedValueforElement:&lt;&quot;+diagram+&quot;.&quot;+element+&quot;.&quot;+name+&quot;&gt;&quot;);&#xA;	if(childPackage.Element.TaggedValues.Count&lt;=0)&#xA;		loadTagValuefromFile();&#xA;	tagValue=null;&#xA;	childPackage.Element.TaggedValues.Refresh();&#xA;	//Session.Output(&quot;getTaggedValueforElement-Count:&quot;+childPackage.Element.TaggedValues.Count);&#xA;	for ( var i = 0 ; i &lt; childPackage.Element.TaggedValues.Count ; i++ )&#xA;	{&#xA;		taggedValue = childPackage.Element.TaggedValues.GetAt( i );&#xA;		//Session.Output(&quot;Global0:&lt;&quot;+taggedValue.Name+&quot;&gt;==&lt;&quot;+diagram+&quot;.&quot;+element+&quot;.&quot;+name+&quot;&gt;&quot;);&#xA;		if ( taggedValue.Name == diagram+&quot;.&quot;+element+&quot;.&quot;+name ) {&#xA;			//Session.Output(&quot;Global1:&quot;+taggedValue.Value);&#xA;			return taggedValue.Value;&#xA;		} else&#xA;		if ( taggedValue.Name == diagram+&quot;.&quot;+element+&quot;.*&quot;)&#xA;			tagValue=taggedValue.Value;&#xA;		&#xA;	}&#xA;	return tagValue;&#xA;}&#xA;//Load TaggedValues for selected diagram elements&#xA;function loadTagValuefromFile() {&#xA;var taggedValue as EA.TaggedValue;	&#xA;var rootPackage = Repository.Models.GetAt(0);&#xA;var childPackage = rootPackage.Packages.GetAt(0);&#xA;&#xA;	if(fileeCMDA!=null&amp;&amp;!fileeCMDA||childPackage.Element.TaggedValues.Count&gt;0)&#xA;		return;&#xA;	var filePath = Repository.ConnectionString;&#xA;	filePath=filePath.substr(0,filePath.lastIndexOf('\\')+1)+&quot;eCMDA.csv&quot;; &#xA;	var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);&#xA;	if (fso.FileExists(filePath)) {&#xA;		var file = fso.OpenTextFile(filePath, 1); // 1 = ForReading&#xA;		var header = file.ReadLine().split(&quot;;&quot;);&#xA;		 while (!file.AtEndOfStream) {&#xA;			var line = file.ReadLine();&#xA;			var values = line.split(&quot;;&quot;);&#xA;			taggedValue=childPackage.Element.TaggedValues.AddNew((values[0].substr(0,1)=='&quot;')?values[0].substr(1):values[0], (values[1].substr(0,1)=='&quot;')?values[1].substr(1):values[1]);&#xA;			taggedValue.Update();&#xA;		}&#xA;		file.Close();&#xA;		fileeCMDA=true;&#xA;		childPackage.Element.Update();&#xA;		childPackage.Update();			&#xA;	} else&#xA;		fileeCMDA=false;&#xA;	/*taggedValue=childPackage.Element.TaggedValues.AddNew(&quot;PDD.Activity.*&quot;, &quot;RiviBaua&quot;);&#xA;	taggedValue.Update();&#xA;	taggedValue=childPackage.Element.TaggedValues.AddNew(&quot;PDD.Activity.Request subprocess&quot;, &quot;RiviBaua&quot;);&#xA;	taggedValue.Update();&#xA;	taggedValue=childPackage.Element.TaggedValues.AddNew(&quot;BUCD.UseCase.Request service&quot;,&quot;BauAp(Client)v(1. Send request)p(Employee)v(2. Registration)p(Manager)v(3. Approve)p(Employee)v(4. Send decision)p(Client)v(5. Receive)&quot;);&#xA;	taggedValue.Update();&#xA;	childPackage.Element.Update();&#xA;	childPackage.Update();	&#xA;&#xA;    // Prepare CSV file&#xA;    var filePath = &quot;C:\\Temp\\eCMDA.csv&quot;; // Replace with your desired file path&#xA;    var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);&#xA;    var file = fso.CreateTextFile(filePath, true);&#xA;&#xA;    // Write CSV header&#xA;    file.WriteLine(&quot;Name,Notes&quot;);&#xA;    var line;&#xA;	line = taggedValue.Name + &quot;,&quot; + taggedValue.Value;&#xA;	line = 	&quot;PDD.Activity.*,RiviBaua&quot;;&#xA;    file.WriteLine(line);	&#xA;	line = 	&quot;PDD.Activity.Request subprocess,RiviBaua&quot;;&#xA;    file.WriteLine(line);	&#xA;	line = 	&quot;BUCD.UseCase.Request service,BauAp(Client)v(1. Send request)p(Employee)v(2. Registration)p(Manager)v(3. Approve)p(Employee)v(4. Send decision)p(Client)v(5. Receive)&quot;;&#xA;    file.WriteLine(line);	&#xA;    // Close the file&#xA;    file.Close();*/&#xA;}&#xA;&#xA;main();&#xA;"/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="4"/>
			<Column name="ScriptCategory" value="ScriptDebugging"/>
			<Column name="ScriptName" value="ScriptDebugging"/>
			<Column name="ScriptAuthor" value="ScriptDebugging"/>
			<Column name="Notes" value="&lt;?xml version=&quot;1.0&quot;?&gt;&#xA;&lt;DATA&gt;&lt;Debugger value=&quot;Scripting&quot;/&gt;&lt;/DATA&gt;&#xA;"/>
			<Column name="Script" value=" "/>
		</DataRow>
		<DataRow>
			<Column name="ScriptID" value="5"/>
			<Column name="ScriptCategory" value="ScriptDebugging"/>
			<Column name="ScriptName" value="ScriptDebugging"/>
			<Column name="ScriptAuthor" value="ScriptDebugging"/>
			<Column name="Notes" value="&lt;?xml version=&quot;1.0&quot;?&gt;&#xA;&lt;DATA&gt;&lt;Debugger value=&quot;Scripting&quot;/&gt;&lt;/DATA&gt;&#xA;"/>
			<Column name="Script" value=" "/>
		</DataRow>
	</DataSet>
</RefData>
